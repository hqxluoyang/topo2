!function(g){function I(A){if(C[A])return C[A].exports;var n=C[A]={i:A,l:!1,exports:{}};return g[A].call(n.exports,n,n.exports,I),n.l=!0,n.exports}var C={};return I.m=g,I.c=C,I.i=function(g){return g},I.d=function(g,C,A){I.o(g,C)||Object.defineProperty(g,C,{configurable:!1,enumerable:!0,get:A})},I.n=function(g){var C=g&&g.__esModule?function(){return g.default}:function(){return g};return I.d(C,"a",C),C},I.o=function(g,I){return Object.prototype.hasOwnProperty.call(g,I)},I.p="",I(I.s=103)}([,function(module,exports){eval("var util={\r\n    getLinkNotThis:getLinkNotThis,\r\n    getNums:getNums,\r\n    linkArrow:linkArrow,\r\n    getBorderPoint:getBorderPoint,\r\n    makeQuadraticPoint:makeQuadraticPoint,\r\n    isOverlay:isOverlay\r\n};\r\nmodule.exports=util;\r\nfunction getLinksBetween(start, end) {\r\n    var d = getPublicLink(start, end);\r\n    var e = getPublicLink(end, start);\r\n    return d.concat(e);\r\n}\r\nfunction getPublicLink(elementA, elementB) {\r\n    var result = [];\r\n    if (null == elementA || null == elementB)return result;\r\n    if (elementA && elementB && elementA.outLinks && elementB.inLinks)\r\n        for (var i = 0; i < elementA.outLinks.length; i++) {\r\n            var outLink = elementA.outLinks[i];\r\n            for (var f = 0; f < elementB.inLinks.length; f++) {\r\n                var inlink = elementB.inLinks[f];\r\n                if (outLink === inlink) {\r\n                    result.push(inlink);\r\n                }\r\n            }\r\n        }\r\n    return result\r\n}\r\n/**\r\n * 获取两点之间线段的求y公式\r\n * @param x1\r\n * @param y1\r\n * @param x2\r\n * @param y2\r\n * @returns {getY}\r\n */\r\nfunction lineF(x1, y1, x2, y2) {\r\n    var tan = (y2 - y1) / (x2 - x1);\r\n    var g = y1 - x1 * tan;\r\n    getY.tan = tan;\r\n    getY.b = g;\r\n    getY.x1 = x1;\r\n    getY.x2 = x2;\r\n    getY.y1 = y1;\r\n    getY.y2 = y2;\r\n    return getY;\r\n    function getY(x) {\r\n        return x * tan + g\r\n    }\r\n}\r\nfunction inRange(a1, a2, a3) {\r\n    var d = Math.abs(a2 - a3);\r\n    var e = Math.abs(a2 - a1);\r\n    var f = Math.abs(a3 - a1);\r\n    var g = Math.abs(d - (e + f));\r\n    return 1e-6 > g ? !0 : !1\r\n}\r\nfunction isPointInLineSeg(x, y, fn) {\r\n    return inRange(x, fn.x1, fn.x2) && inRange(y, fn.y1, fn.y2)\r\n}\r\n/**\r\n * 根据两条线的坐标公式查找交点\r\n * @param fnA\r\n * @param fnB\r\n * @returns {*}\r\n */\r\nfunction intersection(fnA, fnB) {\r\n    var x, y;\r\n    if (fnA.tan != fnB.tan) {//夹角相同则存在两线共线\r\n        if(1 / 0 == fnA.tan || fnA.tan == -1 / 0){//垂直时\r\n            x = fnA.x1;\r\n            y = fnB(fnA.x1);\r\n        }else if(1 / 0 == fnB.tan || fnB.tan == -1 / 0){//垂直时\r\n            x = fnB.x1;\r\n            y = fnA(fnB.x1);\r\n        }else{\r\n            x = (fnB.b - fnA.b) / (fnA.tan - fnB.tan);\r\n            y = fnA(x)\r\n        }\r\n        if(0!= isPointInLineSeg(x, y, fnA)&&0!= isPointInLineSeg(x, y, fnB)){\r\n            return {\r\n                x: x,\r\n                y: y\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * 获取直线公式与方形四条边的交点\r\n * @param lineFn\r\n * @param bound\r\n * @returns {{x, y}}\r\n */\r\nfunction intersectionLineBound(lineFn, bound) {\r\n    var newLineFn = lineF(bound.left, bound.top, bound.left, bound.bottom);\r\n    var d = intersection(lineFn, newLineFn);\r\n    if (null == d) {\r\n        newLineFn = lineF(bound.left, bound.top, bound.right, bound.top);\r\n        d = intersection(lineFn, newLineFn);\r\n        if (null == d) {\r\n            newLineFn = lineF(bound.right, bound.top, bound.right, bound.bottom);\r\n            d = intersection(lineFn, newLineFn);\r\n            if (null == d) {\r\n                newLineFn = lineF(bound.left, bound.bottom, bound.right, bound.bottom);\r\n                d = intersection(lineFn, newLineFn);\r\n            }\r\n        }\r\n    }\r\n\r\n    return d;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//--------------\r\nfunction getLinkNotThis(link) {\r\n    var b = getLinksBetween(link.nodeA, link.nodeZ);\r\n    return b = b.filter(function (b) {\r\n        return link !== b\r\n    })\r\n}\r\n//--------------\r\nfunction getNums(a, b) {\r\n    return getLinksBetween(a, b).length\r\n}\r\n//--------------\r\nfunction getBorderPoint(start, end) {\r\n    var lineFn = lineF(start.cx, start.cy, end.cx, end.cy);\r\n    var bound = start.getBound();\r\n    return intersectionLineBound(lineFn, bound);\r\n}\r\n//---------------\r\nfunction linkArrow(context, startPoint, endPoint, radius, offset, type) {\r\n    var atanAngle = Math.atan2(endPoint.y - startPoint.y, endPoint.x - startPoint.x);\r\n    var length = JTopo.util.getDistance(startPoint, endPoint) - radius;\r\n    var COS = startPoint.x + (length + offset) * Math.cos(atanAngle);\r\n    var SIN = startPoint.y + (length + offset) * Math.sin(atanAngle);\r\n    var m = endPoint.x + offset * Math.cos(atanAngle);\r\n    var n = endPoint.y + offset * Math.sin(atanAngle);\r\n    atanAngle -= Math.PI / 2;\r\n    var o = {\r\n        x: COS + (radius / 2) * Math.cos(atanAngle),\r\n        y: SIN + (radius / 2) * Math.sin(atanAngle)\r\n    };\r\n    var p = {\r\n        x: COS + (radius / 2) * Math.cos(atanAngle - Math.PI),\r\n        y: SIN + (radius / 2) * Math.sin(atanAngle - Math.PI)\r\n    };\r\n    context.moveTo(o.x, o.y);\r\n    context.lineTo(m, n);\r\n    context.lineTo(p.x, p.y);\r\n    if (type) {\r\n        context.fill();\r\n    } else {\r\n        context.stroke();\r\n    }\r\n}\r\n//---------------\r\n//制造一个二次贝塞尔曲线的阶段点\r\nfunction makeQuadraticPoint(start, middle, end, time) {\r\n    return {\r\n        x: (1 - time) * (1 - time) * start.x + 2 * time * (1 - time) * middle.x + time * time * end.x,\r\n        y: (1 - time) * (1 - time) * start.y + 2 * time * (1 - time) * middle.y + time * time * end.y\r\n    }\r\n}\r\n//---------------\r\nfunction isOverlay(nodeA,nodeZ){\r\n    return ((nodeA.cx<nodeZ.x+nodeZ.width)&&(nodeA.cx>nodeZ.x))&&((nodeA.cy>nodeZ.y)&&(nodeA.cy)<nodeZ.y+nodeZ.height);\r\n}\r\n//---------------\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vbGluay91dGlsLmpzP2VmYWYiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDhCQUE4QjtBQUNyRDtBQUNBLDJCQUEyQiw2QkFBNkI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QixrREFBa0Q7QUFDbEQ7QUFDQTtBQUNBLFNBQVMsK0NBQStDO0FBQ3hEO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7Ozs7Ozs7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIxLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHV0aWw9e1xyXG4gICAgZ2V0TGlua05vdFRoaXM6Z2V0TGlua05vdFRoaXMsXHJcbiAgICBnZXROdW1zOmdldE51bXMsXHJcbiAgICBsaW5rQXJyb3c6bGlua0Fycm93LFxyXG4gICAgZ2V0Qm9yZGVyUG9pbnQ6Z2V0Qm9yZGVyUG9pbnQsXHJcbiAgICBtYWtlUXVhZHJhdGljUG9pbnQ6bWFrZVF1YWRyYXRpY1BvaW50LFxyXG4gICAgaXNPdmVybGF5OmlzT3ZlcmxheVxyXG59O1xyXG5tb2R1bGUuZXhwb3J0cz11dGlsO1xyXG5mdW5jdGlvbiBnZXRMaW5rc0JldHdlZW4oc3RhcnQsIGVuZCkge1xyXG4gICAgdmFyIGQgPSBnZXRQdWJsaWNMaW5rKHN0YXJ0LCBlbmQpO1xyXG4gICAgdmFyIGUgPSBnZXRQdWJsaWNMaW5rKGVuZCwgc3RhcnQpO1xyXG4gICAgcmV0dXJuIGQuY29uY2F0KGUpO1xyXG59XHJcbmZ1bmN0aW9uIGdldFB1YmxpY0xpbmsoZWxlbWVudEEsIGVsZW1lbnRCKSB7XHJcbiAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICBpZiAobnVsbCA9PSBlbGVtZW50QSB8fCBudWxsID09IGVsZW1lbnRCKXJldHVybiByZXN1bHQ7XHJcbiAgICBpZiAoZWxlbWVudEEgJiYgZWxlbWVudEIgJiYgZWxlbWVudEEub3V0TGlua3MgJiYgZWxlbWVudEIuaW5MaW5rcylcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRBLm91dExpbmtzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBvdXRMaW5rID0gZWxlbWVudEEub3V0TGlua3NbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIGYgPSAwOyBmIDwgZWxlbWVudEIuaW5MaW5rcy5sZW5ndGg7IGYrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGlubGluayA9IGVsZW1lbnRCLmluTGlua3NbZl07XHJcbiAgICAgICAgICAgICAgICBpZiAob3V0TGluayA9PT0gaW5saW5rKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goaW5saW5rKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIHJldHVybiByZXN1bHRcclxufVxyXG4vKipcclxuICog6I635Y+W5Lik54K55LmL6Ze057q/5q6155qE5rGCeeWFrOW8j1xyXG4gKiBAcGFyYW0geDFcclxuICogQHBhcmFtIHkxXHJcbiAqIEBwYXJhbSB4MlxyXG4gKiBAcGFyYW0geTJcclxuICogQHJldHVybnMge2dldFl9XHJcbiAqL1xyXG5mdW5jdGlvbiBsaW5lRih4MSwgeTEsIHgyLCB5Mikge1xyXG4gICAgdmFyIHRhbiA9ICh5MiAtIHkxKSAvICh4MiAtIHgxKTtcclxuICAgIHZhciBnID0geTEgLSB4MSAqIHRhbjtcclxuICAgIGdldFkudGFuID0gdGFuO1xyXG4gICAgZ2V0WS5iID0gZztcclxuICAgIGdldFkueDEgPSB4MTtcclxuICAgIGdldFkueDIgPSB4MjtcclxuICAgIGdldFkueTEgPSB5MTtcclxuICAgIGdldFkueTIgPSB5MjtcclxuICAgIHJldHVybiBnZXRZO1xyXG4gICAgZnVuY3Rpb24gZ2V0WSh4KSB7XHJcbiAgICAgICAgcmV0dXJuIHggKiB0YW4gKyBnXHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gaW5SYW5nZShhMSwgYTIsIGEzKSB7XHJcbiAgICB2YXIgZCA9IE1hdGguYWJzKGEyIC0gYTMpO1xyXG4gICAgdmFyIGUgPSBNYXRoLmFicyhhMiAtIGExKTtcclxuICAgIHZhciBmID0gTWF0aC5hYnMoYTMgLSBhMSk7XHJcbiAgICB2YXIgZyA9IE1hdGguYWJzKGQgLSAoZSArIGYpKTtcclxuICAgIHJldHVybiAxZS02ID4gZyA/ICEwIDogITFcclxufVxyXG5mdW5jdGlvbiBpc1BvaW50SW5MaW5lU2VnKHgsIHksIGZuKSB7XHJcbiAgICByZXR1cm4gaW5SYW5nZSh4LCBmbi54MSwgZm4ueDIpICYmIGluUmFuZ2UoeSwgZm4ueTEsIGZuLnkyKVxyXG59XHJcbi8qKlxyXG4gKiDmoLnmja7kuKTmnaHnur/nmoTlnZDmoIflhazlvI/mn6Xmib7kuqTngrlcclxuICogQHBhcmFtIGZuQVxyXG4gKiBAcGFyYW0gZm5CXHJcbiAqIEByZXR1cm5zIHsqfVxyXG4gKi9cclxuZnVuY3Rpb24gaW50ZXJzZWN0aW9uKGZuQSwgZm5CKSB7XHJcbiAgICB2YXIgeCwgeTtcclxuICAgIGlmIChmbkEudGFuICE9IGZuQi50YW4pIHsvL+WkueinkuebuOWQjOWImeWtmOWcqOS4pOe6v+WFsee6v1xyXG4gICAgICAgIGlmKDEgLyAwID09IGZuQS50YW4gfHwgZm5BLnRhbiA9PSAtMSAvIDApey8v5Z6C55u05pe2XHJcbiAgICAgICAgICAgIHggPSBmbkEueDE7XHJcbiAgICAgICAgICAgIHkgPSBmbkIoZm5BLngxKTtcclxuICAgICAgICB9ZWxzZSBpZigxIC8gMCA9PSBmbkIudGFuIHx8IGZuQi50YW4gPT0gLTEgLyAwKXsvL+WeguebtOaXtlxyXG4gICAgICAgICAgICB4ID0gZm5CLngxO1xyXG4gICAgICAgICAgICB5ID0gZm5BKGZuQi54MSk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHggPSAoZm5CLmIgLSBmbkEuYikgLyAoZm5BLnRhbiAtIGZuQi50YW4pO1xyXG4gICAgICAgICAgICB5ID0gZm5BKHgpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKDAhPSBpc1BvaW50SW5MaW5lU2VnKHgsIHksIGZuQSkmJjAhPSBpc1BvaW50SW5MaW5lU2VnKHgsIHksIGZuQikpe1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgeDogeCxcclxuICAgICAgICAgICAgICAgIHk6IHlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcbi8qKlxyXG4gKiDojrflj5bnm7Tnur/lhazlvI/kuI7mlrnlvaLlm5vmnaHovrnnmoTkuqTngrlcclxuICogQHBhcmFtIGxpbmVGblxyXG4gKiBAcGFyYW0gYm91bmRcclxuICogQHJldHVybnMge3t4LCB5fX1cclxuICovXHJcbmZ1bmN0aW9uIGludGVyc2VjdGlvbkxpbmVCb3VuZChsaW5lRm4sIGJvdW5kKSB7XHJcbiAgICB2YXIgbmV3TGluZUZuID0gbGluZUYoYm91bmQubGVmdCwgYm91bmQudG9wLCBib3VuZC5sZWZ0LCBib3VuZC5ib3R0b20pO1xyXG4gICAgdmFyIGQgPSBpbnRlcnNlY3Rpb24obGluZUZuLCBuZXdMaW5lRm4pO1xyXG4gICAgaWYgKG51bGwgPT0gZCkge1xyXG4gICAgICAgIG5ld0xpbmVGbiA9IGxpbmVGKGJvdW5kLmxlZnQsIGJvdW5kLnRvcCwgYm91bmQucmlnaHQsIGJvdW5kLnRvcCk7XHJcbiAgICAgICAgZCA9IGludGVyc2VjdGlvbihsaW5lRm4sIG5ld0xpbmVGbik7XHJcbiAgICAgICAgaWYgKG51bGwgPT0gZCkge1xyXG4gICAgICAgICAgICBuZXdMaW5lRm4gPSBsaW5lRihib3VuZC5yaWdodCwgYm91bmQudG9wLCBib3VuZC5yaWdodCwgYm91bmQuYm90dG9tKTtcclxuICAgICAgICAgICAgZCA9IGludGVyc2VjdGlvbihsaW5lRm4sIG5ld0xpbmVGbik7XHJcbiAgICAgICAgICAgIGlmIChudWxsID09IGQpIHtcclxuICAgICAgICAgICAgICAgIG5ld0xpbmVGbiA9IGxpbmVGKGJvdW5kLmxlZnQsIGJvdW5kLmJvdHRvbSwgYm91bmQucmlnaHQsIGJvdW5kLmJvdHRvbSk7XHJcbiAgICAgICAgICAgICAgICBkID0gaW50ZXJzZWN0aW9uKGxpbmVGbiwgbmV3TGluZUZuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZDtcclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuLy8tLS0tLS0tLS0tLS0tLVxyXG5mdW5jdGlvbiBnZXRMaW5rTm90VGhpcyhsaW5rKSB7XHJcbiAgICB2YXIgYiA9IGdldExpbmtzQmV0d2VlbihsaW5rLm5vZGVBLCBsaW5rLm5vZGVaKTtcclxuICAgIHJldHVybiBiID0gYi5maWx0ZXIoZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICByZXR1cm4gbGluayAhPT0gYlxyXG4gICAgfSlcclxufVxyXG4vLy0tLS0tLS0tLS0tLS0tXHJcbmZ1bmN0aW9uIGdldE51bXMoYSwgYikge1xyXG4gICAgcmV0dXJuIGdldExpbmtzQmV0d2VlbihhLCBiKS5sZW5ndGhcclxufVxyXG4vLy0tLS0tLS0tLS0tLS0tXHJcbmZ1bmN0aW9uIGdldEJvcmRlclBvaW50KHN0YXJ0LCBlbmQpIHtcclxuICAgIHZhciBsaW5lRm4gPSBsaW5lRihzdGFydC5jeCwgc3RhcnQuY3ksIGVuZC5jeCwgZW5kLmN5KTtcclxuICAgIHZhciBib3VuZCA9IHN0YXJ0LmdldEJvdW5kKCk7XHJcbiAgICByZXR1cm4gaW50ZXJzZWN0aW9uTGluZUJvdW5kKGxpbmVGbiwgYm91bmQpO1xyXG59XHJcbi8vLS0tLS0tLS0tLS0tLS0tXHJcbmZ1bmN0aW9uIGxpbmtBcnJvdyhjb250ZXh0LCBzdGFydFBvaW50LCBlbmRQb2ludCwgcmFkaXVzLCBvZmZzZXQsIHR5cGUpIHtcclxuICAgIHZhciBhdGFuQW5nbGUgPSBNYXRoLmF0YW4yKGVuZFBvaW50LnkgLSBzdGFydFBvaW50LnksIGVuZFBvaW50LnggLSBzdGFydFBvaW50LngpO1xyXG4gICAgdmFyIGxlbmd0aCA9IEpUb3BvLnV0aWwuZ2V0RGlzdGFuY2Uoc3RhcnRQb2ludCwgZW5kUG9pbnQpIC0gcmFkaXVzO1xyXG4gICAgdmFyIENPUyA9IHN0YXJ0UG9pbnQueCArIChsZW5ndGggKyBvZmZzZXQpICogTWF0aC5jb3MoYXRhbkFuZ2xlKTtcclxuICAgIHZhciBTSU4gPSBzdGFydFBvaW50LnkgKyAobGVuZ3RoICsgb2Zmc2V0KSAqIE1hdGguc2luKGF0YW5BbmdsZSk7XHJcbiAgICB2YXIgbSA9IGVuZFBvaW50LnggKyBvZmZzZXQgKiBNYXRoLmNvcyhhdGFuQW5nbGUpO1xyXG4gICAgdmFyIG4gPSBlbmRQb2ludC55ICsgb2Zmc2V0ICogTWF0aC5zaW4oYXRhbkFuZ2xlKTtcclxuICAgIGF0YW5BbmdsZSAtPSBNYXRoLlBJIC8gMjtcclxuICAgIHZhciBvID0ge1xyXG4gICAgICAgIHg6IENPUyArIChyYWRpdXMgLyAyKSAqIE1hdGguY29zKGF0YW5BbmdsZSksXHJcbiAgICAgICAgeTogU0lOICsgKHJhZGl1cyAvIDIpICogTWF0aC5zaW4oYXRhbkFuZ2xlKVxyXG4gICAgfTtcclxuICAgIHZhciBwID0ge1xyXG4gICAgICAgIHg6IENPUyArIChyYWRpdXMgLyAyKSAqIE1hdGguY29zKGF0YW5BbmdsZSAtIE1hdGguUEkpLFxyXG4gICAgICAgIHk6IFNJTiArIChyYWRpdXMgLyAyKSAqIE1hdGguc2luKGF0YW5BbmdsZSAtIE1hdGguUEkpXHJcbiAgICB9O1xyXG4gICAgY29udGV4dC5tb3ZlVG8oby54LCBvLnkpO1xyXG4gICAgY29udGV4dC5saW5lVG8obSwgbik7XHJcbiAgICBjb250ZXh0LmxpbmVUbyhwLngsIHAueSk7XHJcbiAgICBpZiAodHlwZSkge1xyXG4gICAgICAgIGNvbnRleHQuZmlsbCgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgfVxyXG59XHJcbi8vLS0tLS0tLS0tLS0tLS0tXHJcbi8v5Yi26YCg5LiA5Liq5LqM5qyh6LSd5aGe5bCU5puy57q/55qE6Zi25q6154K5XHJcbmZ1bmN0aW9uIG1ha2VRdWFkcmF0aWNQb2ludChzdGFydCwgbWlkZGxlLCBlbmQsIHRpbWUpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgeDogKDEgLSB0aW1lKSAqICgxIC0gdGltZSkgKiBzdGFydC54ICsgMiAqIHRpbWUgKiAoMSAtIHRpbWUpICogbWlkZGxlLnggKyB0aW1lICogdGltZSAqIGVuZC54LFxyXG4gICAgICAgIHk6ICgxIC0gdGltZSkgKiAoMSAtIHRpbWUpICogc3RhcnQueSArIDIgKiB0aW1lICogKDEgLSB0aW1lKSAqIG1pZGRsZS55ICsgdGltZSAqIHRpbWUgKiBlbmQueVxyXG4gICAgfVxyXG59XHJcbi8vLS0tLS0tLS0tLS0tLS0tXHJcbmZ1bmN0aW9uIGlzT3ZlcmxheShub2RlQSxub2RlWil7XHJcbiAgICByZXR1cm4gKChub2RlQS5jeDxub2RlWi54K25vZGVaLndpZHRoKSYmKG5vZGVBLmN4Pm5vZGVaLngpKSYmKChub2RlQS5jeT5ub2RlWi55KSYmKG5vZGVBLmN5KTxub2RlWi55K25vZGVaLmhlaWdodCk7XHJcbn1cclxuLy8tLS0tLS0tLS0tLS0tLS1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vbGluay91dGlsLmpzXG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==")},function(module,exports){eval('/**\r\n * @module core\r\n */\r\nmodule.exports = Element;\r\n/**\r\n * 元素基类,用以继承\r\n * @class [E] Element\r\n * @constructor\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\nfunction Element(jtopo) {\r\n    if (jtopo) {\r\n        /**\r\n         * 核心Jtopo对象\r\n         * @property [E] jtopo {Object}\r\n         */\r\n        this.jtopo = jtopo;\r\n        jtopo.qtopo = this;\r\n    }\r\n    if (!this.attr.jsonId) {\r\n        this.attr.jsonId = QTopo.util.makeId();\r\n    }\r\n    /**\r\n     * 预定义的额外属性,参考实际元素\r\n     * @property [E] extra {object}\r\n     */\r\n    this.extra = {};\r\n    /**\r\n     * 预定义的基本属性，参考实际元素\r\n     * @property [E] attr {object}\r\n     */\r\n}\r\n/**\r\n *  设置jsonId\r\n *  @method [E] setJsonId\r\n *  @param id {string} id\r\n */\r\nElement.prototype.setJsonId = function (id) {\r\n    this.attr.jsonId = id;\r\n};\r\n/**\r\n *  显示元素\r\n *  @method [E] show\r\n */\r\nElement.prototype.show = function () {\r\n    this.jtopo.show();\r\n};\r\n/**\r\n *  隐藏元素\r\n *  @method [E] hide\r\n */\r\nElement.prototype.hide = function () {\r\n    this.jtopo.hide();\r\n};\r\n/**\r\n *  设置使用类型\r\n *  @method [E] setUseType\r\n *  @param type {string}\r\n */\r\nElement.prototype.setUseType = function (type) {\r\n    this.attr.useType = type;\r\n};\r\n/**\r\n *  获取使用类型\r\n *  @method [E] getUseType\r\n *  @return {string}\r\n */\r\nElement.prototype.getUseType = function () {\r\n    return this.attr.useType;\r\n};\r\n/**\r\n *  设置元素文本\r\n *  @method [E] setText\r\n *  @param text {string}\r\n */\r\nElement.prototype.setText = function (text) {\r\n    if (text) {\r\n        this.jtopo.text = (text + "").trim();\r\n    }\r\n    this.attr.text = this.jtopo.text;\r\n};\r\n/**\r\n *  设置元素边框\r\n *  @method [E] setBorder\r\n *  @param border {object}\r\n *  color:颜色,width:宽度,radius:角弧度\r\n */\r\nElement.prototype.setBorder = function (border) {\r\n    var jtopo = this.jtopo;\r\n    if (border.color) {\r\n        jtopo.borderColor = QTopo.util.transHex(border.color.toLowerCase());\r\n    }\r\n    if ($.isNumeric(border.width)) {\r\n        jtopo.borderWidth = parseInt(border.width);\r\n    }\r\n    if ($.isNumeric(border.radius)) {\r\n        jtopo.borderRadius = parseInt(border.radius);\r\n    }\r\n    this.attr.border.color = jtopo.borderColor;\r\n    this.attr.border.width = jtopo.borderWidth;\r\n    this.attr.border.radius = jtopo.borderRadius;\r\n};\r\n/**\r\n *  绑定事件,可用off删除对应事件\r\n *  @method [E] on\r\n *  @param name {string} 事件名\r\n *\r\n *  click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup\r\n *\r\n *  @param fn {function} 处理函数\r\n */\r\nElement.prototype.on = function (name, fn) {\r\n    this.jtopo.addEventListener(name, function (e) {\r\n        if (e.target && e.target.qtopo) {\r\n            fn(e, e.target.qtopo);\r\n        } else {\r\n            fn(e);\r\n        }\r\n    });\r\n};\r\n/**\r\n *  解除事件，可删除on绑定的事件\r\n *  @method [E] off\r\n *  @param name {string} 事件名\r\n *\r\n *  click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup\r\n *\r\n *   @param [fn]{function} 处理的函数对象，若无参则删除该事件下所有函数\r\n */\r\nElement.prototype.off = function (name, fn) {\r\n    this.jtopo.removeEventListener(name);\r\n};\r\n/**\r\n *  设置元素层级\r\n *  @method [E] setZIndex\r\n *  @param zIndex {number} 值高的元素覆盖在值低的元素上,默认节点>链接>分组\r\n */\r\nElement.prototype.setZIndex = function (zIndex) {\r\n    if ($.isNumeric(zIndex)) {\r\n        this.jtopo.zIndex = parseInt(zIndex);\r\n    }\r\n    this.attr.zIndex = this.jtopo.zIndex;\r\n};\r\n/**\r\n *  设置元素字体\r\n *  @method [E] setFont\r\n *  @param font {object}\r\n *\r\n *  type:字体,\r\n *  color:颜色,\r\n *  size:大小\r\n */\r\nElement.prototype.setFont = function (font) {\r\n    var type = this.attr.font.type;\r\n    var size = this.attr.font.size;\r\n    if (font) {\r\n        if ($.isNumeric(font.size)) {\r\n            size = font.size;\r\n        }\r\n        if (font.type) {\r\n            type = font.type;\r\n        }\r\n        this.jtopo.font = (size ? size : 14) + "px " + type;\r\n        if (font.color) {\r\n            this.jtopo.fontColor = QTopo.util.transHex(font.color.toLowerCase());\r\n        }\r\n    }\r\n    this.attr.font.type = type;\r\n    this.attr.font.size = size;\r\n    this.attr.font.color = this.jtopo.fontColor;\r\n};\r\n/**\r\n *  设置元素透明度\r\n *  @method [E] setAlpha\r\n *  @param alpha {number} 值域0-1\r\n */\r\nElement.prototype.setAlpha = function (alpha) {\r\n    if ($.isNumeric(alpha) && alpha <= 1 && alpha > 0) {\r\n        this.jtopo.alpha = alpha;\r\n    } else {\r\n        this.jtopo.alpha = 1;\r\n    }\r\n    this.attr.alpha = this.jtopo.alpha;\r\n};\r\n/**\r\n *  设置元素位置\r\n *  @method [E] setPosition\r\n *  @param position {array} [x,y]在图层上的坐标\r\n */\r\nElement.prototype.setPosition = function (position) {\r\n    if ($.isArray(position) && position.length >= 2) {\r\n        if ($.isNumeric(position[0]) && $.isNumeric(position[1])) {\r\n            this.jtopo.setLocation(parseInt(position[0]), parseInt(position[1]));\r\n        }\r\n    }\r\n};\r\n/**\r\n *  设置元素大小\r\n *  @method [E] setSize\r\n *  @param size {array} [width,height]\r\n */\r\nElement.prototype.setSize = function (size) {\r\n    if ($.isArray(size) && $.isNumeric(size[0]) && $.isNumeric(size[1])) {\r\n        this.jtopo.setSize(parseInt(size[0]), parseInt(size[1]));\r\n    } else {\r\n        this.jtopo.setSize(64, 64);\r\n    }\r\n    this.attr.size = [this.jtopo.width, this.jtopo.height];\r\n};\r\n/**\r\n *  元素是否锁定位置\r\n *  @method [E] setDraggable\r\n *  @param draggable {boolean}\r\n */\r\nElement.prototype.setDraggable = function (draggable) {\r\n    if (typeof draggable == \'boolean\') {\r\n        this.jtopo.draggable = draggable;\r\n    }\r\n    this.attr.draggable = this.jtopo.draggable;\r\n};\r\n/**\r\n *  设置元素文字位置\r\n *  @method [E] setNamePosition\r\n *  @param [namePosition] {string} 无参则设为bottom\r\n *\r\n *  hide,bottom,top,left,right,center\r\n *\r\n */\r\nElement.prototype.setNamePosition = function (namePosition) {\r\n    var jtopo = this.jtopo;\r\n    jtopo.text = this.attr.name || "";\r\n    jtopo.textOffsetX = 0;\r\n    jtopo.textOffsetY = 0;\r\n    switch (namePosition) {\r\n        case \'hide\':\r\n            jtopo.text = \'\';\r\n            this.attr.namePosition = "hide";\r\n            break;\r\n        case \'bottom\':\r\n            jtopo.textPosition = "Bottom_Center";\r\n            this.attr.namePosition = "bottom";\r\n            break;\r\n        case \'top\':\r\n            jtopo.textPosition = "Top_Center";\r\n            this.attr.namePosition = "top";\r\n            break;\r\n        case \'left\':\r\n            jtopo.textPosition = "Middle_Left";\r\n            this.attr.namePosition = "left";\r\n            break;\r\n        case \'right\':\r\n            jtopo.textPosition = "Middle_Right";\r\n            this.attr.namePosition = "right";\r\n            break;\r\n        case "center":\r\n            jtopo.textPosition = "Middle_Center";\r\n            this.attr.namePosition = "center";\r\n            break;\r\n        default:\r\n            jtopo.textPosition = \'Bottom_Center\';\r\n            this.attr.namePosition = "bottom";\r\n            QTopo.util.error(this, "set wrong namePosition,default is bottom");\r\n            break;\r\n    }\r\n};\r\n/**\r\n *  私有函数,设置元素属性,只要有对应函数则传入参数设置,不应直接调用\r\n *\r\n *  实际元素中应重写set函数，在set函数中对特殊参数做处理后再调用该函数\r\n *  @method [E] _setAttr\r\n *  @param config {object}\r\n */\r\nElement.prototype._setAttr = function (config) {\r\n    var self = this;\r\n    $.each(config, function (k, v) {\r\n        try {\r\n            var fn = self[\'set\' + QTopo.util.upFirst(k)];\r\n            if (fn) {\r\n                fn.call(self, v);\r\n            }\r\n        } catch (e) {\r\n            QTopo.util.error(self, "Element _setAttr error :" + k, e);\r\n        }\r\n    });\r\n};\r\n/**\r\n * 获取元素基本属性\r\n *  @method [E] get\r\n *  @param name {string} 属性名\r\n *  @example\r\n *          Element.setPosition([100,100])\r\n *          Element.get(\'position\')       //[100,100]\r\n */\r\nElement.prototype.get = function (name) {\r\n    return this.attr[name];\r\n};\r\n/**\r\n * 获取元素的属性,修改/赋值元素额外属性\r\n *  @method [E] val\r\n *  @param key {string} 属性名\r\n *\r\n *  要操作的属性名,与get不同，该函数会在整个对象中查找与key匹配的属性\r\n *\r\n *  无论是额外属性还是基本属性又或是Element.xx属性，只要匹配成功即返回.\r\n *\r\n *  优先级为 额外属性>基本属性>Element.xx属性\r\n *\r\n *  用该函数赋予额外属性时，可以直接传入一个对象作为参数\r\n *\r\n *  该函数会遍历该参数对象将其内容全部覆盖到额外属性上\r\n *\r\n *  @param [value] {string|object|void} 值,无参则为取值\r\n *  @example\r\n *\r\n *       赋值操作   1. Element.val(\'pid\',\'12345\')\r\n *                  2. Element.val({\r\n *                          pid:"12345",\r\n *                          path:[]\r\n *                      })\r\n *       取属性操作 Element.val(\'pid\')       //"12345"\r\n *                  Element.val(\'position\') //[x,y]\r\n *                  Element.val(\'path\')       //[]\r\n *                  Element.val(\'name\')       //""\r\n */\r\nElement.prototype.val = function (key, value) {\r\n    if (QTopo.util.getClass(key) == \'Object\') {\r\n        var self = this;\r\n        $.each(key, function (name, value) {\r\n            self.extra[name] = value;\r\n        })\r\n    } else {\r\n        if (typeof value == \'undefined\') {\r\n            var result;\r\n            if (typeof this.extra[key]!=\'undefined\') {\r\n                result = this.extra[key];\r\n            } else if (typeof this.attr[key]!=\'undefined\') {\r\n                result = this.attr[key];\r\n            } else {\r\n                result = this[key];\r\n            }\r\n            return result;\r\n        } else {\r\n            this.extra[key] = value;\r\n        }\r\n    }\r\n};\r\n/**\r\n * 获取元素中心坐标\r\n *  @method [E] getCenterPosition\r\n *  @return {object} {x,y}\r\n */\r\nElement.prototype.getCenterPosition = function () {\r\n    return {\r\n        x: this.jtopo.cx,\r\n        y: this.jtopo.cy\r\n    }\r\n};\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9FbGVtZW50LmpzPzg1ZDAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsT0FBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixPQUFPO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixPQUFPO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLE1BQU07QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixNQUFNO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLE9BQU87QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsT0FBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixPQUFPO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsbUJBQW1CO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPLEVBQUU7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbm1vZHVsZS5leHBvcnRzID0gRWxlbWVudDtcclxuLyoqXHJcbiAqIOWFg+e0oOWfuuexuyznlKjku6Xnu6fmib9cclxuICogQGNsYXNzIFtFXSBFbGVtZW50XHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAcGFyYW0ganRvcG8g5YWD57Sg5qC45b+D55qEanRvcG/lr7nosaFcclxuICovXHJcbmZ1bmN0aW9uIEVsZW1lbnQoanRvcG8pIHtcclxuICAgIGlmIChqdG9wbykge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaguOW/g0p0b3Bv5a+56LGhXHJcbiAgICAgICAgICogQHByb3BlcnR5IFtFXSBqdG9wbyB7T2JqZWN0fVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuanRvcG8gPSBqdG9wbztcclxuICAgICAgICBqdG9wby5xdG9wbyA9IHRoaXM7XHJcbiAgICB9XHJcbiAgICBpZiAoIXRoaXMuYXR0ci5qc29uSWQpIHtcclxuICAgICAgICB0aGlzLmF0dHIuanNvbklkID0gUVRvcG8udXRpbC5tYWtlSWQoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6aKE5a6a5LmJ55qE6aKd5aSW5bGe5oCnLOWPguiAg+WunumZheWFg+e0oFxyXG4gICAgICogQHByb3BlcnR5IFtFXSBleHRyYSB7b2JqZWN0fVxyXG4gICAgICovXHJcbiAgICB0aGlzLmV4dHJhID0ge307XHJcbiAgICAvKipcclxuICAgICAqIOmihOWumuS5ieeahOWfuuacrOWxnuaAp++8jOWPguiAg+WunumZheWFg+e0oFxyXG4gICAgICogQHByb3BlcnR5IFtFXSBhdHRyIHtvYmplY3R9XHJcbiAgICAgKi9cclxufVxyXG4vKipcclxuICogIOiuvue9rmpzb25JZFxyXG4gKiAgQG1ldGhvZCBbRV0gc2V0SnNvbklkXHJcbiAqICBAcGFyYW0gaWQge3N0cmluZ30gaWRcclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLnNldEpzb25JZCA9IGZ1bmN0aW9uIChpZCkge1xyXG4gICAgdGhpcy5hdHRyLmpzb25JZCA9IGlkO1xyXG59O1xyXG4vKipcclxuICogIOaYvuekuuWFg+e0oFxyXG4gKiAgQG1ldGhvZCBbRV0gc2hvd1xyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuanRvcG8uc2hvdygpO1xyXG59O1xyXG4vKipcclxuICogIOmakOiXj+WFg+e0oFxyXG4gKiAgQG1ldGhvZCBbRV0gaGlkZVxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuaGlkZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuanRvcG8uaGlkZSgpO1xyXG59O1xyXG4vKipcclxuICogIOiuvue9ruS9v+eUqOexu+Wei1xyXG4gKiAgQG1ldGhvZCBbRV0gc2V0VXNlVHlwZVxyXG4gKiAgQHBhcmFtIHR5cGUge3N0cmluZ31cclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLnNldFVzZVR5cGUgPSBmdW5jdGlvbiAodHlwZSkge1xyXG4gICAgdGhpcy5hdHRyLnVzZVR5cGUgPSB0eXBlO1xyXG59O1xyXG4vKipcclxuICogIOiOt+WPluS9v+eUqOexu+Wei1xyXG4gKiAgQG1ldGhvZCBbRV0gZ2V0VXNlVHlwZVxyXG4gKiAgQHJldHVybiB7c3RyaW5nfVxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuZ2V0VXNlVHlwZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB0aGlzLmF0dHIudXNlVHlwZTtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7lhYPntKDmlofmnKxcclxuICogIEBtZXRob2QgW0VdIHNldFRleHRcclxuICogIEBwYXJhbSB0ZXh0IHtzdHJpbmd9XHJcbiAqL1xyXG5FbGVtZW50LnByb3RvdHlwZS5zZXRUZXh0ID0gZnVuY3Rpb24gKHRleHQpIHtcclxuICAgIGlmICh0ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby50ZXh0ID0gKHRleHQgKyBcIlwiKS50cmltKCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIudGV4dCA9IHRoaXMuanRvcG8udGV4dDtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7lhYPntKDovrnmoYZcclxuICogIEBtZXRob2QgW0VdIHNldEJvcmRlclxyXG4gKiAgQHBhcmFtIGJvcmRlciB7b2JqZWN0fVxyXG4gKiAgY29sb3I66aKc6ImyLHdpZHRoOuWuveW6pixyYWRpdXM66KeS5byn5bqmXHJcbiAqL1xyXG5FbGVtZW50LnByb3RvdHlwZS5zZXRCb3JkZXIgPSBmdW5jdGlvbiAoYm9yZGVyKSB7XHJcbiAgICB2YXIganRvcG8gPSB0aGlzLmp0b3BvO1xyXG4gICAgaWYgKGJvcmRlci5jb2xvcikge1xyXG4gICAgICAgIGp0b3BvLmJvcmRlckNvbG9yID0gUVRvcG8udXRpbC50cmFuc0hleChib3JkZXIuY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICB9XHJcbiAgICBpZiAoJC5pc051bWVyaWMoYm9yZGVyLndpZHRoKSkge1xyXG4gICAgICAgIGp0b3BvLmJvcmRlcldpZHRoID0gcGFyc2VJbnQoYm9yZGVyLndpZHRoKTtcclxuICAgIH1cclxuICAgIGlmICgkLmlzTnVtZXJpYyhib3JkZXIucmFkaXVzKSkge1xyXG4gICAgICAgIGp0b3BvLmJvcmRlclJhZGl1cyA9IHBhcnNlSW50KGJvcmRlci5yYWRpdXMpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmJvcmRlci5jb2xvciA9IGp0b3BvLmJvcmRlckNvbG9yO1xyXG4gICAgdGhpcy5hdHRyLmJvcmRlci53aWR0aCA9IGp0b3BvLmJvcmRlcldpZHRoO1xyXG4gICAgdGhpcy5hdHRyLmJvcmRlci5yYWRpdXMgPSBqdG9wby5ib3JkZXJSYWRpdXM7XHJcbn07XHJcbi8qKlxyXG4gKiAg57uR5a6a5LqL5Lu2LOWPr+eUqG9mZuWIoOmZpOWvueW6lOS6i+S7tlxyXG4gKiAgQG1ldGhvZCBbRV0gb25cclxuICogIEBwYXJhbSBuYW1lIHtzdHJpbmd9IOS6i+S7tuWQjVxyXG4gKlxyXG4gKiAgY2xpY2ssZGJjbGljayxtb3VzZWRvd24sbW91c2V1cCxtb3VzZW92ZXIsbW91c2VvdXQsbW91c2Vtb3ZlLG1vdXNlZHJhZyxtb3VzZXdoZWVsLHRvdWNoc3RhcnQsdG91Y2htb3ZlLHRvdWNoZW5kLGtleWRvd24sa2V5dXBcclxuICpcclxuICogIEBwYXJhbSBmbiB7ZnVuY3Rpb259IOWkhOeQhuWHveaVsFxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUub24gPSBmdW5jdGlvbiAobmFtZSwgZm4pIHtcclxuICAgIHRoaXMuanRvcG8uYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGlmIChlLnRhcmdldCAmJiBlLnRhcmdldC5xdG9wbykge1xyXG4gICAgICAgICAgICBmbihlLCBlLnRhcmdldC5xdG9wbyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZm4oZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcbi8qKlxyXG4gKiAg6Kej6Zmk5LqL5Lu277yM5Y+v5Yig6Zmkb27nu5HlrprnmoTkuovku7ZcclxuICogIEBtZXRob2QgW0VdIG9mZlxyXG4gKiAgQHBhcmFtIG5hbWUge3N0cmluZ30g5LqL5Lu25ZCNXHJcbiAqXHJcbiAqICBjbGljayxkYmNsaWNrLG1vdXNlZG93bixtb3VzZXVwLG1vdXNlb3Zlcixtb3VzZW91dCxtb3VzZW1vdmUsbW91c2VkcmFnLG1vdXNld2hlZWwsdG91Y2hzdGFydCx0b3VjaG1vdmUsdG91Y2hlbmQsa2V5ZG93bixrZXl1cFxyXG4gKlxyXG4gKiAgIEBwYXJhbSBbZm5de2Z1bmN0aW9ufSDlpITnkIbnmoTlh73mlbDlr7nosaHvvIzoi6Xml6Dlj4LliJnliKDpmaTor6Xkuovku7bkuIvmiYDmnInlh73mlbBcclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uIChuYW1lLCBmbikge1xyXG4gICAgdGhpcy5qdG9wby5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUpO1xyXG59O1xyXG4vKipcclxuICogIOiuvue9ruWFg+e0oOWxgue6p1xyXG4gKiAgQG1ldGhvZCBbRV0gc2V0WkluZGV4XHJcbiAqICBAcGFyYW0gekluZGV4IHtudW1iZXJ9IOWAvOmrmOeahOWFg+e0oOimhuebluWcqOWAvOS9jueahOWFg+e0oOS4iizpu5jorqToioLngrk+6ZO+5o6lPuWIhue7hFxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0WkluZGV4ID0gZnVuY3Rpb24gKHpJbmRleCkge1xyXG4gICAgaWYgKCQuaXNOdW1lcmljKHpJbmRleCkpIHtcclxuICAgICAgICB0aGlzLmp0b3BvLnpJbmRleCA9IHBhcnNlSW50KHpJbmRleCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuekluZGV4ID0gdGhpcy5qdG9wby56SW5kZXg7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5YWD57Sg5a2X5L2TXHJcbiAqICBAbWV0aG9kIFtFXSBzZXRGb250XHJcbiAqICBAcGFyYW0gZm9udCB7b2JqZWN0fVxyXG4gKlxyXG4gKiAgdHlwZTrlrZfkvZMsXHJcbiAqICBjb2xvcjrpopzoibIsXHJcbiAqICBzaXplOuWkp+Wwj1xyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0Rm9udCA9IGZ1bmN0aW9uIChmb250KSB7XHJcbiAgICB2YXIgdHlwZSA9IHRoaXMuYXR0ci5mb250LnR5cGU7XHJcbiAgICB2YXIgc2l6ZSA9IHRoaXMuYXR0ci5mb250LnNpemU7XHJcbiAgICBpZiAoZm9udCkge1xyXG4gICAgICAgIGlmICgkLmlzTnVtZXJpYyhmb250LnNpemUpKSB7XHJcbiAgICAgICAgICAgIHNpemUgPSBmb250LnNpemU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChmb250LnR5cGUpIHtcclxuICAgICAgICAgICAgdHlwZSA9IGZvbnQudHlwZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5qdG9wby5mb250ID0gKHNpemUgPyBzaXplIDogMTQpICsgXCJweCBcIiArIHR5cGU7XHJcbiAgICAgICAgaWYgKGZvbnQuY29sb3IpIHtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5mb250Q29sb3IgPSBRVG9wby51dGlsLnRyYW5zSGV4KGZvbnQuY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmZvbnQudHlwZSA9IHR5cGU7XHJcbiAgICB0aGlzLmF0dHIuZm9udC5zaXplID0gc2l6ZTtcclxuICAgIHRoaXMuYXR0ci5mb250LmNvbG9yID0gdGhpcy5qdG9wby5mb250Q29sb3I7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5YWD57Sg6YCP5piO5bqmXHJcbiAqICBAbWV0aG9kIFtFXSBzZXRBbHBoYVxyXG4gKiAgQHBhcmFtIGFscGhhIHtudW1iZXJ9IOWAvOWfnzAtMVxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0QWxwaGEgPSBmdW5jdGlvbiAoYWxwaGEpIHtcclxuICAgIGlmICgkLmlzTnVtZXJpYyhhbHBoYSkgJiYgYWxwaGEgPD0gMSAmJiBhbHBoYSA+IDApIHtcclxuICAgICAgICB0aGlzLmp0b3BvLmFscGhhID0gYWxwaGE7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuanRvcG8uYWxwaGEgPSAxO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmFscGhhID0gdGhpcy5qdG9wby5hbHBoYTtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7lhYPntKDkvY3nva5cclxuICogIEBtZXRob2QgW0VdIHNldFBvc2l0aW9uXHJcbiAqICBAcGFyYW0gcG9zaXRpb24ge2FycmF5fSBbeCx5XeWcqOWbvuWxguS4iueahOWdkOagh1xyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0UG9zaXRpb24gPSBmdW5jdGlvbiAocG9zaXRpb24pIHtcclxuICAgIGlmICgkLmlzQXJyYXkocG9zaXRpb24pICYmIHBvc2l0aW9uLmxlbmd0aCA+PSAyKSB7XHJcbiAgICAgICAgaWYgKCQuaXNOdW1lcmljKHBvc2l0aW9uWzBdKSAmJiAkLmlzTnVtZXJpYyhwb3NpdGlvblsxXSkpIHtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5zZXRMb2NhdGlvbihwYXJzZUludChwb3NpdGlvblswXSksIHBhcnNlSW50KHBvc2l0aW9uWzFdKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogIOiuvue9ruWFg+e0oOWkp+Wwj1xyXG4gKiAgQG1ldGhvZCBbRV0gc2V0U2l6ZVxyXG4gKiAgQHBhcmFtIHNpemUge2FycmF5fSBbd2lkdGgsaGVpZ2h0XVxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0U2l6ZSA9IGZ1bmN0aW9uIChzaXplKSB7XHJcbiAgICBpZiAoJC5pc0FycmF5KHNpemUpICYmICQuaXNOdW1lcmljKHNpemVbMF0pICYmICQuaXNOdW1lcmljKHNpemVbMV0pKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zZXRTaXplKHBhcnNlSW50KHNpemVbMF0pLCBwYXJzZUludChzaXplWzFdKSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuanRvcG8uc2V0U2l6ZSg2NCwgNjQpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLnNpemUgPSBbdGhpcy5qdG9wby53aWR0aCwgdGhpcy5qdG9wby5oZWlnaHRdO1xyXG59O1xyXG4vKipcclxuICogIOWFg+e0oOaYr+WQpumUgeWumuS9jee9rlxyXG4gKiAgQG1ldGhvZCBbRV0gc2V0RHJhZ2dhYmxlXHJcbiAqICBAcGFyYW0gZHJhZ2dhYmxlIHtib29sZWFufVxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0RHJhZ2dhYmxlID0gZnVuY3Rpb24gKGRyYWdnYWJsZSkge1xyXG4gICAgaWYgKHR5cGVvZiBkcmFnZ2FibGUgPT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5kcmFnZ2FibGUgPSBkcmFnZ2FibGU7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuZHJhZ2dhYmxlID0gdGhpcy5qdG9wby5kcmFnZ2FibGU7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5YWD57Sg5paH5a2X5L2N572uXHJcbiAqICBAbWV0aG9kIFtFXSBzZXROYW1lUG9zaXRpb25cclxuICogIEBwYXJhbSBbbmFtZVBvc2l0aW9uXSB7c3RyaW5nfSDml6Dlj4LliJnorr7kuLpib3R0b21cclxuICpcclxuICogIGhpZGUsYm90dG9tLHRvcCxsZWZ0LHJpZ2h0LGNlbnRlclxyXG4gKlxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0TmFtZVBvc2l0aW9uID0gZnVuY3Rpb24gKG5hbWVQb3NpdGlvbikge1xyXG4gICAgdmFyIGp0b3BvID0gdGhpcy5qdG9wbztcclxuICAgIGp0b3BvLnRleHQgPSB0aGlzLmF0dHIubmFtZSB8fCBcIlwiO1xyXG4gICAganRvcG8udGV4dE9mZnNldFggPSAwO1xyXG4gICAganRvcG8udGV4dE9mZnNldFkgPSAwO1xyXG4gICAgc3dpdGNoIChuYW1lUG9zaXRpb24pIHtcclxuICAgICAgICBjYXNlICdoaWRlJzpcclxuICAgICAgICAgICAganRvcG8udGV4dCA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIubmFtZVBvc2l0aW9uID0gXCJoaWRlXCI7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2JvdHRvbSc6XHJcbiAgICAgICAgICAgIGp0b3BvLnRleHRQb3NpdGlvbiA9IFwiQm90dG9tX0NlbnRlclwiO1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIubmFtZVBvc2l0aW9uID0gXCJib3R0b21cIjtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAndG9wJzpcclxuICAgICAgICAgICAganRvcG8udGV4dFBvc2l0aW9uID0gXCJUb3BfQ2VudGVyXCI7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5uYW1lUG9zaXRpb24gPSBcInRvcFwiO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdsZWZ0JzpcclxuICAgICAgICAgICAganRvcG8udGV4dFBvc2l0aW9uID0gXCJNaWRkbGVfTGVmdFwiO1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIubmFtZVBvc2l0aW9uID0gXCJsZWZ0XCI7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3JpZ2h0JzpcclxuICAgICAgICAgICAganRvcG8udGV4dFBvc2l0aW9uID0gXCJNaWRkbGVfUmlnaHRcIjtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLm5hbWVQb3NpdGlvbiA9IFwicmlnaHRcIjtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcImNlbnRlclwiOlxyXG4gICAgICAgICAgICBqdG9wby50ZXh0UG9zaXRpb24gPSBcIk1pZGRsZV9DZW50ZXJcIjtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLm5hbWVQb3NpdGlvbiA9IFwiY2VudGVyXCI7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIGp0b3BvLnRleHRQb3NpdGlvbiA9ICdCb3R0b21fQ2VudGVyJztcclxuICAgICAgICAgICAgdGhpcy5hdHRyLm5hbWVQb3NpdGlvbiA9IFwiYm90dG9tXCI7XHJcbiAgICAgICAgICAgIFFUb3BvLnV0aWwuZXJyb3IodGhpcywgXCJzZXQgd3JvbmcgbmFtZVBvc2l0aW9uLGRlZmF1bHQgaXMgYm90dG9tXCIpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqICDnp4HmnInlh73mlbAs6K6+572u5YWD57Sg5bGe5oCnLOWPquimgeacieWvueW6lOWHveaVsOWImeS8oOWFpeWPguaVsOiuvue9rizkuI3lupTnm7TmjqXosIPnlKhcclxuICpcclxuICogIOWunumZheWFg+e0oOS4reW6lOmHjeWGmXNldOWHveaVsO+8jOWcqHNldOWHveaVsOS4reWvueeJueauiuWPguaVsOWBmuWkhOeQhuWQjuWGjeiwg+eUqOivpeWHveaVsFxyXG4gKiAgQG1ldGhvZCBbRV0gX3NldEF0dHJcclxuICogIEBwYXJhbSBjb25maWcge29iamVjdH1cclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLl9zZXRBdHRyID0gZnVuY3Rpb24gKGNvbmZpZykge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgJC5lYWNoKGNvbmZpZywgZnVuY3Rpb24gKGssIHYpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB2YXIgZm4gPSBzZWxmWydzZXQnICsgUVRvcG8udXRpbC51cEZpcnN0KGspXTtcclxuICAgICAgICAgICAgaWYgKGZuKSB7XHJcbiAgICAgICAgICAgICAgICBmbi5jYWxsKHNlbGYsIHYpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBRVG9wby51dGlsLmVycm9yKHNlbGYsIFwiRWxlbWVudCBfc2V0QXR0ciBlcnJvciA6XCIgKyBrLCBlKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufTtcclxuLyoqXHJcbiAqIOiOt+WPluWFg+e0oOWfuuacrOWxnuaAp1xyXG4gKiAgQG1ldGhvZCBbRV0gZ2V0XHJcbiAqICBAcGFyYW0gbmFtZSB7c3RyaW5nfSDlsZ7mgKflkI1cclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIEVsZW1lbnQuc2V0UG9zaXRpb24oWzEwMCwxMDBdKVxyXG4gKiAgICAgICAgICBFbGVtZW50LmdldCgncG9zaXRpb24nKSAgICAgICAvL1sxMDAsMTAwXVxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgIHJldHVybiB0aGlzLmF0dHJbbmFtZV07XHJcbn07XHJcbi8qKlxyXG4gKiDojrflj5blhYPntKDnmoTlsZ7mgKcs5L+u5pS5L+i1i+WAvOWFg+e0oOmineWkluWxnuaAp1xyXG4gKiAgQG1ldGhvZCBbRV0gdmFsXHJcbiAqICBAcGFyYW0ga2V5IHtzdHJpbmd9IOWxnuaAp+WQjVxyXG4gKlxyXG4gKiAg6KaB5pON5L2c55qE5bGe5oCn5ZCNLOS4jmdldOS4jeWQjO+8jOivpeWHveaVsOS8muWcqOaVtOS4quWvueixoeS4reafpeaJvuS4jmtleeWMuemFjeeahOWxnuaAp1xyXG4gKlxyXG4gKiAg5peg6K665piv6aKd5aSW5bGe5oCn6L+Y5piv5Z+65pys5bGe5oCn5Y+I5oiW5pivRWxlbWVudC54eOWxnuaAp++8jOWPquimgeWMuemFjeaIkOWKn+WNs+i/lOWbni5cclxuICpcclxuICogIOS8mOWFiOe6p+S4uiDpop3lpJblsZ7mgKc+5Z+65pys5bGe5oCnPkVsZW1lbnQueHjlsZ7mgKdcclxuICpcclxuICogIOeUqOivpeWHveaVsOi1i+S6iOmineWkluWxnuaAp+aXtu+8jOWPr+S7peebtOaOpeS8oOWFpeS4gOS4quWvueixoeS9nOS4uuWPguaVsFxyXG4gKlxyXG4gKiAg6K+l5Ye95pWw5Lya6YGN5Y6G6K+l5Y+C5pWw5a+56LGh5bCG5YW25YaF5a655YWo6YOo6KaG55uW5Yiw6aKd5aSW5bGe5oCn5LiKXHJcbiAqXHJcbiAqICBAcGFyYW0gW3ZhbHVlXSB7c3RyaW5nfG9iamVjdHx2b2lkfSDlgLws5peg5Y+C5YiZ5Li65Y+W5YC8XHJcbiAqICBAZXhhbXBsZVxyXG4gKlxyXG4gKiAgICAgICDotYvlgLzmk43kvZwgICAxLiBFbGVtZW50LnZhbCgncGlkJywnMTIzNDUnKVxyXG4gKiAgICAgICAgICAgICAgICAgIDIuIEVsZW1lbnQudmFsKHtcclxuICogICAgICAgICAgICAgICAgICAgICAgICAgIHBpZDpcIjEyMzQ1XCIsXHJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoOltdXHJcbiAqICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAqICAgICAgIOWPluWxnuaAp+aTjeS9nCBFbGVtZW50LnZhbCgncGlkJykgICAgICAgLy9cIjEyMzQ1XCJcclxuICogICAgICAgICAgICAgICAgICBFbGVtZW50LnZhbCgncG9zaXRpb24nKSAvL1t4LHldXHJcbiAqICAgICAgICAgICAgICAgICAgRWxlbWVudC52YWwoJ3BhdGgnKSAgICAgICAvL1tdXHJcbiAqICAgICAgICAgICAgICAgICAgRWxlbWVudC52YWwoJ25hbWUnKSAgICAgICAvL1wiXCJcclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLnZhbCA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICBpZiAoUVRvcG8udXRpbC5nZXRDbGFzcyhrZXkpID09ICdPYmplY3QnKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICQuZWFjaChrZXksIGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICBzZWxmLmV4dHJhW25hbWVdID0gdmFsdWU7XHJcbiAgICAgICAgfSlcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0O1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuZXh0cmFba2V5XSE9J3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuZXh0cmFba2V5XTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdGhpcy5hdHRyW2tleV0hPSd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLmF0dHJba2V5XTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXNba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXh0cmFba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIOiOt+WPluWFg+e0oOS4reW/g+WdkOagh1xyXG4gKiAgQG1ldGhvZCBbRV0gZ2V0Q2VudGVyUG9zaXRpb25cclxuICogIEByZXR1cm4ge29iamVjdH0ge3gseX1cclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLmdldENlbnRlclBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB4OiB0aGlzLmp0b3BvLmN4LFxyXG4gICAgICAgIHk6IHRoaXMuanRvcG8uY3lcclxuICAgIH1cclxufTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9FbGVtZW50LmpzXG4vLyBtb2R1bGUgaWQgPSAyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=');
},function(module,exports,__webpack_require__){eval("/**\r\n * @module core\r\n */\r\n/**\r\n * 链路基类,用以继承 [E]开头继承于Element,[L]开头为自身api\r\n * @class [L] Link\r\n * @constructor\r\n * @extends [E] Element\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\nvar Element = __webpack_require__(2);\r\nmodule.exports = Link;\r\nfunction Link(jtopo) {\r\n    if (!jtopo) {\r\n        QTopo.util.error(\"create Link without jtopo\", this);\r\n        return;\r\n    }\r\n    Element.call(this, jtopo);\r\n    /**\r\n     * 记录链路的首尾元素\r\n     * @property [L] path {object}\r\n     * @param start {object} 起始元素\r\n     * @param end {object} 终点元素\r\n     */\r\n    this.path = {\r\n        start: this.jtopo.nodeA.qtopo,\r\n        end: this.jtopo.nodeZ.qtopo\r\n    };\r\n    //在线路两端的对象上的links属性中更新自己\r\n    if (this.path.start.links && $.isArray(this.path.start.links.out)) {\r\n        if (this.path.start.links.out.indexOf(this) < 0) {\r\n            this.path.start.links.out.push(this);\r\n        }\r\n    }\r\n    if (this.path.end.links && $.isArray(this.path.end.links.in)) {\r\n        if (this.path.end.links.in.indexOf(this) < 0) {\r\n            this.path.end.links.in.push(this);\r\n        }\r\n    }\r\n}\r\nQTopo.util.inherits(Link, Element);\r\n/**\r\n *  获取元素基本类型,详细参考QTopo.constant中的类型定义\r\n *  @method [L] getType\r\n *  @return QTopo.constant.LINK\r\n */\r\nLink.prototype.getType = function () {\r\n    return QTopo.constant.LINK;\r\n};\r\n/**\r\n *  设置颜色\r\n *  @method [L] setColor\r\n *  @param color {string} \"255,255,255\"/\"#ffffff\"\r\n */\r\nLink.prototype.setColor = function (color) {\r\n    if (color) {\r\n        this.jtopo.strokeColor = QTopo.util.transHex(color.toLowerCase());\r\n    }\r\n    this.attr.color = this.jtopo.strokeColor;\r\n};\r\n/**\r\n *  计数设置\r\n *\r\n *  计数大于1时在链路上显示(+number)\r\n *\r\n *  QTopo.constant.link.DIRECT类型的链路可以基于此数展开\r\n *  @method [L] setNumber\r\n *  @param number {number}\r\n */\r\nLink.prototype.setNumber = function (number) {\r\n    if ($.isNumeric(number)) {\r\n        number = parseInt(number);\r\n        if (number > 1) {\r\n            this.jtopo.text = '(+' + number + ')';\r\n        } else {\r\n            number = 1;\r\n            this.jtopo.text = '';\r\n        }\r\n        this.attr.number = number;\r\n        this.jtopo.childs=number;\r\n    }\r\n};\r\n/**\r\n *  设置链路宽度,小于0则默认为1\r\n *  @method [L] setWidth\r\n *  @param width {number}\r\n */\r\nLink.prototype.setWidth = function (width) {\r\n    if ($.isNumeric(width)) {\r\n        var newWidth = parseInt(width);\r\n        this.jtopo.lineWidth = newWidth > 0 ? newWidth : 1; // 线宽\r\n    }\r\n    this.attr.width = this.jtopo.lineWidth;\r\n};\r\n/**\r\n *  设置链路两端的箭头属性\r\n *  @method [L] setArrow\r\n *  @param arrow {object}\r\n *\r\n *          arrow={\r\n *              size:箭头大小{number},\r\n *              offset:箭头在链路上的偏移量{number},\r\n *              start:是否显示起点箭头{boolean},\r\n *              end:是否显示终点箭头{boolean},\r\n *          }\r\n */\r\nLink.prototype.setArrow = function (arrow) {\r\n    if (arrow) {\r\n        if(typeof arrow.size!='undefined'){\r\n            this.jtopo.arrowsRadius = $.isNumeric(arrow.size) ? parseInt(arrow.size) : 0;\r\n        }\r\n        if(typeof arrow.offset!='undefined'){\r\n            this.jtopo.arrowsOffset = $.isNumeric(arrow.offset) ? parseInt(arrow.offset) : 0;\r\n        }\r\n        if(typeof arrow.type!='undefined'){\r\n            this.jtopo.arrowsType = arrow.type;\r\n        }\r\n        if (!this.attr.arrow) {\r\n            this.attr.arrow = {};\r\n        }\r\n        if (typeof arrow.start!='undefined') {\r\n            this.attr.arrow.start = typeof arrow.start == \"boolean\" ? arrow.start : arrow.start == \"true\";\r\n        }\r\n        if (typeof arrow.end!='undefined') {\r\n            this.attr.arrow.end = typeof arrow.end == \"boolean\" ? arrow.end : arrow.end == \"true\";\r\n        }\r\n    }\r\n    this.attr.arrow.type=this.jtopo.arrowsType;\r\n    this.attr.arrow.size = this.jtopo.arrowsRadius;\r\n    this.attr.arrow.offset = this.jtopo.arrowsOffset;\r\n};\r\n/**\r\n *  设置相同起点和终点的链路之间的间隔大小\r\n *\r\n *  常用于设置QTopo.constant.link.DIRECT类型的链路展开时,其子链路之间的间距大小\r\n *  @method [L] setGap\r\n *  @param gap {number}\r\n */\r\nLink.prototype.setGap = function (gap) {\r\n    if (gap) {\r\n        this.jtopo.gap = $.isNumeric(gap) ? parseInt(gap) : 0; // 线条之间的间隔\r\n    }\r\n    this.attr.gap = this.jtopo.gap;\r\n};\r\n/**\r\n *  折线类链路两端的偏移线段长度，或曲线相对中轴线的偏移量\r\n *\r\n *  @method setOffset\r\n *  @param offset {number}\r\n */\r\nLink.prototype.setOffset = function (offset) {\r\n    if ($.isNumeric(offset)) {\r\n        this.jtopo.offset = parseInt(offset);\r\n    }\r\n    this.attr.offset = this.jtopo.offset;\r\n};\r\n/**\r\n *  设置链路的虚线线段长度\r\n *\r\n *  设置不为number类型或小于0时，则认为不要虚线\r\n *\r\n *  @method [L] setDashed\r\n *  @param dashedPattern {array} [虚线长度,虚线间隔]\r\n */\r\nLink.prototype.setDashed = function (dashedPattern) {\r\n    if ($.isArray(dashedPattern) && dashedPattern.length == 2) {\r\n        dashedPattern[0]=$.isNumeric(dashedPattern[0])&&dashedPattern[0]>0?parseInt(dashedPattern[0]):0;\r\n        dashedPattern[1]=$.isNumeric(dashedPattern[1])&&dashedPattern[1]>0?parseInt(dashedPattern[1]):0;\r\n        this.jtopo.dashedPattern = dashedPattern;\r\n    } else {\r\n        this.jtopo.dashedPattern = [0,0];\r\n    }\r\n    this.attr.dashed = this.jtopo.dashedPattern;\r\n};\r\n/**\r\n *  单个对象的属性提取\r\n *  @method [L] toJson\r\n *  @return {object}\r\n */\r\nLink.prototype.toJson=function(){\r\n    var json=$.extend({},this.attr);\r\n    json.extra=$.extend({},this.extra);\r\n    json.start=this.path.start.get('jsonId');\r\n    json.end=this.path.end.get('jsonId');\r\n    return json;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0xpbmsuanM/NTYwMCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLHFCQUFxQixPQUFPO0FBQzVCLG1CQUFtQixPQUFPO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsT0FBTztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBLDBCQUEwQixPQUFPO0FBQ2pDLGtDQUFrQyxPQUFPO0FBQ3pDLCtCQUErQixRQUFRO0FBQ3ZDLDZCQUE2QixRQUFRO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0EsOERBQThEO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLE1BQU07QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEIsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQG1vZHVsZSBjb3JlXHJcbiAqL1xyXG4vKipcclxuICog6ZO+6Lev5Z+657G7LOeUqOS7pee7p+aJvyBbRV3lvIDlpLTnu6fmib/kuo5FbGVtZW50LFtMXeW8gOWktOS4uuiHqui6q2FwaVxyXG4gKiBAY2xhc3MgW0xdIExpbmtcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBleHRlbmRzIFtFXSBFbGVtZW50XHJcbiAqIEBwYXJhbSBqdG9wbyDlhYPntKDmoLjlv4PnmoRqdG9wb+WvueixoVxyXG4gKi9cclxudmFyIEVsZW1lbnQgPSByZXF1aXJlKFwiLi4vRWxlbWVudC5qc1wiKTtcclxubW9kdWxlLmV4cG9ydHMgPSBMaW5rO1xyXG5mdW5jdGlvbiBMaW5rKGp0b3BvKSB7XHJcbiAgICBpZiAoIWp0b3BvKSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcImNyZWF0ZSBMaW5rIHdpdGhvdXQganRvcG9cIiwgdGhpcyk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgRWxlbWVudC5jYWxsKHRoaXMsIGp0b3BvKTtcclxuICAgIC8qKlxyXG4gICAgICog6K6w5b2V6ZO+6Lev55qE6aaW5bC+5YWD57SgXHJcbiAgICAgKiBAcHJvcGVydHkgW0xdIHBhdGgge29iamVjdH1cclxuICAgICAqIEBwYXJhbSBzdGFydCB7b2JqZWN0fSDotbflp4vlhYPntKBcclxuICAgICAqIEBwYXJhbSBlbmQge29iamVjdH0g57uI54K55YWD57SgXHJcbiAgICAgKi9cclxuICAgIHRoaXMucGF0aCA9IHtcclxuICAgICAgICBzdGFydDogdGhpcy5qdG9wby5ub2RlQS5xdG9wbyxcclxuICAgICAgICBlbmQ6IHRoaXMuanRvcG8ubm9kZVoucXRvcG9cclxuICAgIH07XHJcbiAgICAvL+WcqOe6v+i3r+S4pOerr+eahOWvueixoeS4iueahGxpbmtz5bGe5oCn5Lit5pu05paw6Ieq5bexXHJcbiAgICBpZiAodGhpcy5wYXRoLnN0YXJ0LmxpbmtzICYmICQuaXNBcnJheSh0aGlzLnBhdGguc3RhcnQubGlua3Mub3V0KSkge1xyXG4gICAgICAgIGlmICh0aGlzLnBhdGguc3RhcnQubGlua3Mub3V0LmluZGV4T2YodGhpcykgPCAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGF0aC5zdGFydC5saW5rcy5vdXQucHVzaCh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5wYXRoLmVuZC5saW5rcyAmJiAkLmlzQXJyYXkodGhpcy5wYXRoLmVuZC5saW5rcy5pbikpIHtcclxuICAgICAgICBpZiAodGhpcy5wYXRoLmVuZC5saW5rcy5pbi5pbmRleE9mKHRoaXMpIDwgMCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhdGguZW5kLmxpbmtzLmluLnB1c2godGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblFUb3BvLnV0aWwuaW5oZXJpdHMoTGluaywgRWxlbWVudCk7XHJcbi8qKlxyXG4gKiAg6I635Y+W5YWD57Sg5Z+65pys57G75Z6LLOivpue7huWPguiAg1FUb3BvLmNvbnN0YW505Lit55qE57G75Z6L5a6a5LmJXHJcbiAqICBAbWV0aG9kIFtMXSBnZXRUeXBlXHJcbiAqICBAcmV0dXJuIFFUb3BvLmNvbnN0YW50LkxJTktcclxuICovXHJcbkxpbmsucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gUVRvcG8uY29uc3RhbnQuTElOSztcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7popzoibJcclxuICogIEBtZXRob2QgW0xdIHNldENvbG9yXHJcbiAqICBAcGFyYW0gY29sb3Ige3N0cmluZ30gXCIyNTUsMjU1LDI1NVwiL1wiI2ZmZmZmZlwiXHJcbiAqL1xyXG5MaW5rLnByb3RvdHlwZS5zZXRDb2xvciA9IGZ1bmN0aW9uIChjb2xvcikge1xyXG4gICAgaWYgKGNvbG9yKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zdHJva2VDb2xvciA9IFFUb3BvLnV0aWwudHJhbnNIZXgoY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuY29sb3IgPSB0aGlzLmp0b3BvLnN0cm9rZUNvbG9yO1xyXG59O1xyXG4vKipcclxuICogIOiuoeaVsOiuvue9rlxyXG4gKlxyXG4gKiAg6K6h5pWw5aSn5LqOMeaXtuWcqOmTvui3r+S4iuaYvuekuigrbnVtYmVyKVxyXG4gKlxyXG4gKiAgUVRvcG8uY29uc3RhbnQubGluay5ESVJFQ1TnsbvlnovnmoTpk77ot6/lj6/ku6Xln7rkuo7mraTmlbDlsZXlvIBcclxuICogIEBtZXRob2QgW0xdIHNldE51bWJlclxyXG4gKiAgQHBhcmFtIG51bWJlciB7bnVtYmVyfVxyXG4gKi9cclxuTGluay5wcm90b3R5cGUuc2V0TnVtYmVyID0gZnVuY3Rpb24gKG51bWJlcikge1xyXG4gICAgaWYgKCQuaXNOdW1lcmljKG51bWJlcikpIHtcclxuICAgICAgICBudW1iZXIgPSBwYXJzZUludChudW1iZXIpO1xyXG4gICAgICAgIGlmIChudW1iZXIgPiAxKSB7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8udGV4dCA9ICcoKycgKyBudW1iZXIgKyAnKSc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbnVtYmVyID0gMTtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby50ZXh0ID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYXR0ci5udW1iZXIgPSBudW1iZXI7XHJcbiAgICAgICAgdGhpcy5qdG9wby5jaGlsZHM9bnVtYmVyO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogIOiuvue9rumTvui3r+WuveW6pizlsI/kuo4w5YiZ6buY6K6k5Li6MVxyXG4gKiAgQG1ldGhvZCBbTF0gc2V0V2lkdGhcclxuICogIEBwYXJhbSB3aWR0aCB7bnVtYmVyfVxyXG4gKi9cclxuTGluay5wcm90b3R5cGUuc2V0V2lkdGggPSBmdW5jdGlvbiAod2lkdGgpIHtcclxuICAgIGlmICgkLmlzTnVtZXJpYyh3aWR0aCkpIHtcclxuICAgICAgICB2YXIgbmV3V2lkdGggPSBwYXJzZUludCh3aWR0aCk7XHJcbiAgICAgICAgdGhpcy5qdG9wby5saW5lV2lkdGggPSBuZXdXaWR0aCA+IDAgPyBuZXdXaWR0aCA6IDE7IC8vIOe6v+WuvVxyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLndpZHRoID0gdGhpcy5qdG9wby5saW5lV2lkdGg7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u6ZO+6Lev5Lik56uv55qE566t5aS05bGe5oCnXHJcbiAqICBAbWV0aG9kIFtMXSBzZXRBcnJvd1xyXG4gKiAgQHBhcmFtIGFycm93IHtvYmplY3R9XHJcbiAqXHJcbiAqICAgICAgICAgIGFycm93PXtcclxuICogICAgICAgICAgICAgIHNpemU6566t5aS05aSn5bCPe251bWJlcn0sXHJcbiAqICAgICAgICAgICAgICBvZmZzZXQ6566t5aS05Zyo6ZO+6Lev5LiK55qE5YGP56e76YePe251bWJlcn0sXHJcbiAqICAgICAgICAgICAgICBzdGFydDrmmK/lkKbmmL7npLrotbfngrnnrq3lpLR7Ym9vbGVhbn0sXHJcbiAqICAgICAgICAgICAgICBlbmQ65piv5ZCm5pi+56S657uI54K5566t5aS0e2Jvb2xlYW59LFxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5MaW5rLnByb3RvdHlwZS5zZXRBcnJvdyA9IGZ1bmN0aW9uIChhcnJvdykge1xyXG4gICAgaWYgKGFycm93KSB7XHJcbiAgICAgICAgaWYodHlwZW9mIGFycm93LnNpemUhPSd1bmRlZmluZWQnKXtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5hcnJvd3NSYWRpdXMgPSAkLmlzTnVtZXJpYyhhcnJvdy5zaXplKSA/IHBhcnNlSW50KGFycm93LnNpemUpIDogMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodHlwZW9mIGFycm93Lm9mZnNldCE9J3VuZGVmaW5lZCcpe1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLmFycm93c09mZnNldCA9ICQuaXNOdW1lcmljKGFycm93Lm9mZnNldCkgPyBwYXJzZUludChhcnJvdy5vZmZzZXQpIDogMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodHlwZW9mIGFycm93LnR5cGUhPSd1bmRlZmluZWQnKXtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5hcnJvd3NUeXBlID0gYXJyb3cudHlwZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmF0dHIuYXJyb3cpIHtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLmFycm93ID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2YgYXJyb3cuc3RhcnQhPSd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5hcnJvdy5zdGFydCA9IHR5cGVvZiBhcnJvdy5zdGFydCA9PSBcImJvb2xlYW5cIiA/IGFycm93LnN0YXJ0IDogYXJyb3cuc3RhcnQgPT0gXCJ0cnVlXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2YgYXJyb3cuZW5kIT0ndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIuYXJyb3cuZW5kID0gdHlwZW9mIGFycm93LmVuZCA9PSBcImJvb2xlYW5cIiA/IGFycm93LmVuZCA6IGFycm93LmVuZCA9PSBcInRydWVcIjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuYXJyb3cudHlwZT10aGlzLmp0b3BvLmFycm93c1R5cGU7XHJcbiAgICB0aGlzLmF0dHIuYXJyb3cuc2l6ZSA9IHRoaXMuanRvcG8uYXJyb3dzUmFkaXVzO1xyXG4gICAgdGhpcy5hdHRyLmFycm93Lm9mZnNldCA9IHRoaXMuanRvcG8uYXJyb3dzT2Zmc2V0O1xyXG59O1xyXG4vKipcclxuICogIOiuvue9ruebuOWQjOi1t+eCueWSjOe7iOeCueeahOmTvui3r+S5i+mXtOeahOmXtOmalOWkp+Wwj1xyXG4gKlxyXG4gKiAg5bi455So5LqO6K6+572uUVRvcG8uY29uc3RhbnQubGluay5ESVJFQ1TnsbvlnovnmoTpk77ot6/lsZXlvIDml7Ys5YW25a2Q6ZO+6Lev5LmL6Ze055qE6Ze06Led5aSn5bCPXHJcbiAqICBAbWV0aG9kIFtMXSBzZXRHYXBcclxuICogIEBwYXJhbSBnYXAge251bWJlcn1cclxuICovXHJcbkxpbmsucHJvdG90eXBlLnNldEdhcCA9IGZ1bmN0aW9uIChnYXApIHtcclxuICAgIGlmIChnYXApIHtcclxuICAgICAgICB0aGlzLmp0b3BvLmdhcCA9ICQuaXNOdW1lcmljKGdhcCkgPyBwYXJzZUludChnYXApIDogMDsgLy8g57q/5p2h5LmL6Ze055qE6Ze06ZqUXHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuZ2FwID0gdGhpcy5qdG9wby5nYXA7XHJcbn07XHJcbi8qKlxyXG4gKiAg5oqY57q/57G76ZO+6Lev5Lik56uv55qE5YGP56e757q/5q616ZW/5bqm77yM5oiW5puy57q/55u45a+55Lit6L2057q/55qE5YGP56e76YePXHJcbiAqXHJcbiAqICBAbWV0aG9kIHNldE9mZnNldFxyXG4gKiAgQHBhcmFtIG9mZnNldCB7bnVtYmVyfVxyXG4gKi9cclxuTGluay5wcm90b3R5cGUuc2V0T2Zmc2V0ID0gZnVuY3Rpb24gKG9mZnNldCkge1xyXG4gICAgaWYgKCQuaXNOdW1lcmljKG9mZnNldCkpIHtcclxuICAgICAgICB0aGlzLmp0b3BvLm9mZnNldCA9IHBhcnNlSW50KG9mZnNldCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIub2Zmc2V0ID0gdGhpcy5qdG9wby5vZmZzZXQ7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u6ZO+6Lev55qE6Jma57q/57q/5q616ZW/5bqmXHJcbiAqXHJcbiAqICDorr7nva7kuI3kuLpudW1iZXLnsbvlnovmiJblsI/kuo4w5pe277yM5YiZ6K6k5Li65LiN6KaB6Jma57q/XHJcbiAqXHJcbiAqICBAbWV0aG9kIFtMXSBzZXREYXNoZWRcclxuICogIEBwYXJhbSBkYXNoZWRQYXR0ZXJuIHthcnJheX0gW+iZmue6v+mVv+W6pizomZrnur/pl7TpmpRdXHJcbiAqL1xyXG5MaW5rLnByb3RvdHlwZS5zZXREYXNoZWQgPSBmdW5jdGlvbiAoZGFzaGVkUGF0dGVybikge1xyXG4gICAgaWYgKCQuaXNBcnJheShkYXNoZWRQYXR0ZXJuKSAmJiBkYXNoZWRQYXR0ZXJuLmxlbmd0aCA9PSAyKSB7XHJcbiAgICAgICAgZGFzaGVkUGF0dGVyblswXT0kLmlzTnVtZXJpYyhkYXNoZWRQYXR0ZXJuWzBdKSYmZGFzaGVkUGF0dGVyblswXT4wP3BhcnNlSW50KGRhc2hlZFBhdHRlcm5bMF0pOjA7XHJcbiAgICAgICAgZGFzaGVkUGF0dGVyblsxXT0kLmlzTnVtZXJpYyhkYXNoZWRQYXR0ZXJuWzFdKSYmZGFzaGVkUGF0dGVyblsxXT4wP3BhcnNlSW50KGRhc2hlZFBhdHRlcm5bMV0pOjA7XHJcbiAgICAgICAgdGhpcy5qdG9wby5kYXNoZWRQYXR0ZXJuID0gZGFzaGVkUGF0dGVybjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5kYXNoZWRQYXR0ZXJuID0gWzAsMF07XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuZGFzaGVkID0gdGhpcy5qdG9wby5kYXNoZWRQYXR0ZXJuO1xyXG59O1xyXG4vKipcclxuICogIOWNleS4quWvueixoeeahOWxnuaAp+aPkOWPllxyXG4gKiAgQG1ldGhvZCBbTF0gdG9Kc29uXHJcbiAqICBAcmV0dXJuIHtvYmplY3R9XHJcbiAqL1xyXG5MaW5rLnByb3RvdHlwZS50b0pzb249ZnVuY3Rpb24oKXtcclxuICAgIHZhciBqc29uPSQuZXh0ZW5kKHt9LHRoaXMuYXR0cik7XHJcbiAgICBqc29uLmV4dHJhPSQuZXh0ZW5kKHt9LHRoaXMuZXh0cmEpO1xyXG4gICAganNvbi5zdGFydD10aGlzLnBhdGguc3RhcnQuZ2V0KCdqc29uSWQnKTtcclxuICAgIGpzb24uZW5kPXRoaXMucGF0aC5lbmQuZ2V0KCdqc29uSWQnKTtcclxuICAgIHJldHVybiBqc29uO1xyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbGluay9MaW5rLmpzXG4vLyBtb2R1bGUgaWQgPSAzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=")},function(module,exports){eval('module.exports=Element;\r\nfunction Element() {\r\n    this.elementType = "element";\r\n    this.serializedProperties = ["elementType"];\r\n    this.propertiesStack = [];\r\n}\r\nElement.prototype.removeHandler = function () {\r\n};\r\nElement.prototype.attr = function (name, value) {\r\n    if (null != name && null != value){\r\n        this[name] = value;\r\n    }else if (null != name){\r\n        return this[name];\r\n    }\r\n    return this\r\n};\r\nElement.prototype.save = function () {\r\n    var a = this;\r\n    var b = {};\r\n    this.serializedProperties.forEach(function (properties) {\r\n        b[properties] = a[properties];\r\n    });\r\n    this.propertiesStack.push(b);\r\n};\r\nElement.prototype.restore = function () {\r\n    if (null != this.propertiesStack && 0 != this.propertiesStack.length) {\r\n        var a = this, b = this.propertiesStack.pop();\r\n        this.serializedProperties.forEach(function (c) {\r\n            a[c] = b[c]\r\n        })\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vYmFzZS9FbGVtZW50LmpzP2NkODYiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSIsImZpbGUiOiI0LmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHM9RWxlbWVudDtcclxuZnVuY3Rpb24gRWxlbWVudCgpIHtcclxuICAgIHRoaXMuZWxlbWVudFR5cGUgPSBcImVsZW1lbnRcIjtcclxuICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMgPSBbXCJlbGVtZW50VHlwZVwiXTtcclxuICAgIHRoaXMucHJvcGVydGllc1N0YWNrID0gW107XHJcbn1cclxuRWxlbWVudC5wcm90b3R5cGUucmVtb3ZlSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxufTtcclxuRWxlbWVudC5wcm90b3R5cGUuYXR0ciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xyXG4gICAgaWYgKG51bGwgIT0gbmFtZSAmJiBudWxsICE9IHZhbHVlKXtcclxuICAgICAgICB0aGlzW25hbWVdID0gdmFsdWU7XHJcbiAgICB9ZWxzZSBpZiAobnVsbCAhPSBuYW1lKXtcclxuICAgICAgICByZXR1cm4gdGhpc1tuYW1lXTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzXHJcbn07XHJcbkVsZW1lbnQucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYSA9IHRoaXM7XHJcbiAgICB2YXIgYiA9IHt9O1xyXG4gICAgdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wZXJ0aWVzKSB7XHJcbiAgICAgICAgYltwcm9wZXJ0aWVzXSA9IGFbcHJvcGVydGllc107XHJcbiAgICB9KTtcclxuICAgIHRoaXMucHJvcGVydGllc1N0YWNrLnB1c2goYik7XHJcbn07XHJcbkVsZW1lbnQucHJvdG90eXBlLnJlc3RvcmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAobnVsbCAhPSB0aGlzLnByb3BlcnRpZXNTdGFjayAmJiAwICE9IHRoaXMucHJvcGVydGllc1N0YWNrLmxlbmd0aCkge1xyXG4gICAgICAgIHZhciBhID0gdGhpcywgYiA9IHRoaXMucHJvcGVydGllc1N0YWNrLnBvcCgpO1xyXG4gICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICBhW2NdID0gYltjXVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vYmFzZS9FbGVtZW50LmpzXG4vLyBtb2R1bGUgaWQgPSA0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports){eval('module.exports=function(jtopo){\r\n    jtopo.DisplayElement = DisplayElement;\r\n    function DisplayElement() {\r\n        jtopo.Element.apply(this,arguments);\r\n        this.elementType = "displayElement";\r\n        this.x = 0;\r\n        this.y = 0;\r\n        this.width = 32;\r\n        this.height = 32;\r\n        this.visible = !0;\r\n        this.alpha = 1;\r\n        this.rotate = 0;\r\n        this.scaleX = 1;\r\n        this.scaleY = 1;\r\n        this.strokeColor = "22,124,255";\r\n        this.borderColor = "22,124,255";\r\n        this.fillColor = "22,124,255";\r\n        this.shadow = !1;\r\n        this.shadowBlur = 5;\r\n        this.shadowColor = "rgba(0,0,0,0.5)";\r\n        this.shadowOffsetX = 3;\r\n        this.shadowOffsetY = 6;\r\n        this.transformAble = !1;\r\n        this.zIndex = 0;\r\n        var a = "x,y,width,height,visible,alpha,rotate,scaleX,scaleY,strokeColor,fillColor,shadow,shadowColor,shadowOffsetX,shadowOffsetY,transformAble,zIndex".split(",");\r\n        this.serializedProperties = this.serializedProperties.concat(a);\r\n    }\r\n    jtopo.util.inherits(DisplayElement,jtopo.Element);\r\n    DisplayElement.prototype.paint = function (a) {\r\n        a.beginPath();\r\n        a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n        a.rect(-this.width / 2, -this.height / 2, this.width, this.height);\r\n        a.fill();\r\n        a.stroke();\r\n        a.closePath();\r\n    };\r\n    DisplayElement.prototype.getLocation = function () {\r\n        return {\r\n            x: this.x,\r\n            y: this.y\r\n        }\r\n    };\r\n    DisplayElement.prototype.setLocation = function (a, b) {\r\n        if (this.qtopo && this.qtopo.attr && this.qtopo.attr.position) {\r\n            this.qtopo.attr.position[0] = a;\r\n            this.qtopo.attr.position[1] = b;\r\n        }\r\n        return this.x = a, this.y = b, this\r\n    };\r\n    DisplayElement.prototype.getCenterLocation = function () {\r\n        return {\r\n            x: this.x + this.width / 2,\r\n            y: this.y + this.height / 2\r\n        }\r\n    };\r\n    DisplayElement.prototype.setCenterLocation = function (a, b) {\r\n        this.x = a - this.width / 2;\r\n        this.y = b - this.height / 2;\r\n        return this;\r\n    };\r\n    DisplayElement.prototype.getSize = function () {\r\n        return {\r\n            width: this.width,\r\n            height: this.heith\r\n        }\r\n    };\r\n    DisplayElement.prototype.setSize = function (a, b) {\r\n        this.width = a;\r\n        this.height = b;\r\n        return this;\r\n    };\r\n    DisplayElement.prototype.getBound = function () {\r\n        return {\r\n            left: this.x,\r\n            top: this.y,\r\n            right: this.x + this.width,\r\n            bottom: this.y + this.height,\r\n            width: this.width,\r\n            height: this.height\r\n        }\r\n    };\r\n    DisplayElement.prototype.setBound = function (a, b, c, d) {\r\n        this.setLocation(a, b);\r\n        this.setSize(c, d);\r\n        return this;\r\n    };\r\n    DisplayElement.prototype.getDisplayBound = function () {\r\n        return {\r\n            left: this.x,\r\n            top: this.y,\r\n            right: this.x + this.width * this.scaleX,\r\n            bottom: this.y + this.height * this.scaleY\r\n        }\r\n    };\r\n    DisplayElement.prototype.getDisplaySize = function () {\r\n        return {\r\n            width: this.width * this.scaleX,\r\n            height: this.height * this.scaleY\r\n        }\r\n    };\r\n    DisplayElement.prototype.getPosition = function (a) {\r\n        var position,\r\n            c = this.getBound();\r\n        switch (a) {\r\n            case "Top_Left":\r\n                position = {x: c.left, y: c.top};\r\n                break;\r\n            case "Top_Center":\r\n                position = {x: this.cx, y: c.top};\r\n                break;\r\n            case "Top_Right":\r\n                position = {x: c.right, y: c.top};\r\n                break;\r\n            case "Middle_Left":\r\n                position = {x: c.left, y: this.cy};\r\n                break;\r\n            case "Middle_Center":\r\n                position = {x: this.cx, y: this.cy};\r\n                break;\r\n            case "Middle_Right":\r\n                position = {x: c.right, y: this.cy};\r\n                break;\r\n            case "Bottom_Left":\r\n                position = {x: c.left, y: c.bottom};\r\n                break;\r\n            case "Bottom_Center":\r\n                position = {x: this.cx, y: c.bottom};\r\n                break;\r\n            case  "Bottom_Right":\r\n                position = {x: c.right, y: c.bottom};\r\n                break;\r\n            default:\r\n                position = {x: c.left, y: c.top};\r\n        }\r\n        return position;\r\n    };\r\n    Object.defineProperties(DisplayElement.prototype, {\r\n        cx: {\r\n            get: function () {\r\n                return this.x + this.width / 2\r\n            }, set: function (a) {\r\n                this.x = a - this.width / 2\r\n            }\r\n        },\r\n        cy: {\r\n            get: function () {\r\n                return this.y + this.height / 2\r\n            }, set: function (a) {\r\n                this.y = a - this.height / 2\r\n            }\r\n        }\r\n    });\r\n};\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vYmFzZS9kaXNwbGF5RWxlbWVudC5qcz9iZGRmIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wiLCJmaWxlIjoiNS5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzPWZ1bmN0aW9uKGp0b3BvKXtcclxuICAgIGp0b3BvLkRpc3BsYXlFbGVtZW50ID0gRGlzcGxheUVsZW1lbnQ7XHJcbiAgICBmdW5jdGlvbiBEaXNwbGF5RWxlbWVudCgpIHtcclxuICAgICAgICBqdG9wby5FbGVtZW50LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnRUeXBlID0gXCJkaXNwbGF5RWxlbWVudFwiO1xyXG4gICAgICAgIHRoaXMueCA9IDA7XHJcbiAgICAgICAgdGhpcy55ID0gMDtcclxuICAgICAgICB0aGlzLndpZHRoID0gMzI7XHJcbiAgICAgICAgdGhpcy5oZWlnaHQgPSAzMjtcclxuICAgICAgICB0aGlzLnZpc2libGUgPSAhMDtcclxuICAgICAgICB0aGlzLmFscGhhID0gMTtcclxuICAgICAgICB0aGlzLnJvdGF0ZSA9IDA7XHJcbiAgICAgICAgdGhpcy5zY2FsZVggPSAxO1xyXG4gICAgICAgIHRoaXMuc2NhbGVZID0gMTtcclxuICAgICAgICB0aGlzLnN0cm9rZUNvbG9yID0gXCIyMiwxMjQsMjU1XCI7XHJcbiAgICAgICAgdGhpcy5ib3JkZXJDb2xvciA9IFwiMjIsMTI0LDI1NVwiO1xyXG4gICAgICAgIHRoaXMuZmlsbENvbG9yID0gXCIyMiwxMjQsMjU1XCI7XHJcbiAgICAgICAgdGhpcy5zaGFkb3cgPSAhMTtcclxuICAgICAgICB0aGlzLnNoYWRvd0JsdXIgPSA1O1xyXG4gICAgICAgIHRoaXMuc2hhZG93Q29sb3IgPSBcInJnYmEoMCwwLDAsMC41KVwiO1xyXG4gICAgICAgIHRoaXMuc2hhZG93T2Zmc2V0WCA9IDM7XHJcbiAgICAgICAgdGhpcy5zaGFkb3dPZmZzZXRZID0gNjtcclxuICAgICAgICB0aGlzLnRyYW5zZm9ybUFibGUgPSAhMTtcclxuICAgICAgICB0aGlzLnpJbmRleCA9IDA7XHJcbiAgICAgICAgdmFyIGEgPSBcIngseSx3aWR0aCxoZWlnaHQsdmlzaWJsZSxhbHBoYSxyb3RhdGUsc2NhbGVYLHNjYWxlWSxzdHJva2VDb2xvcixmaWxsQ29sb3Isc2hhZG93LHNoYWRvd0NvbG9yLHNoYWRvd09mZnNldFgsc2hhZG93T2Zmc2V0WSx0cmFuc2Zvcm1BYmxlLHpJbmRleFwiLnNwbGl0KFwiLFwiKTtcclxuICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzID0gdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5jb25jYXQoYSk7XHJcbiAgICB9XHJcbiAgICBqdG9wby51dGlsLmluaGVyaXRzKERpc3BsYXlFbGVtZW50LGp0b3BvLkVsZW1lbnQpO1xyXG4gICAgRGlzcGxheUVsZW1lbnQucHJvdG90eXBlLnBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICBhLmJlZ2luUGF0aCgpO1xyXG4gICAgICAgIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5maWxsQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICBhLnJlY3QoLXRoaXMud2lkdGggLyAyLCAtdGhpcy5oZWlnaHQgLyAyLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgYS5maWxsKCk7XHJcbiAgICAgICAgYS5zdHJva2UoKTtcclxuICAgICAgICBhLmNsb3NlUGF0aCgpO1xyXG4gICAgfTtcclxuICAgIERpc3BsYXlFbGVtZW50LnByb3RvdHlwZS5nZXRMb2NhdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB4OiB0aGlzLngsXHJcbiAgICAgICAgICAgIHk6IHRoaXMueVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBEaXNwbGF5RWxlbWVudC5wcm90b3R5cGUuc2V0TG9jYXRpb24gPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgIGlmICh0aGlzLnF0b3BvICYmIHRoaXMucXRvcG8uYXR0ciAmJiB0aGlzLnF0b3BvLmF0dHIucG9zaXRpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5xdG9wby5hdHRyLnBvc2l0aW9uWzBdID0gYTtcclxuICAgICAgICAgICAgdGhpcy5xdG9wby5hdHRyLnBvc2l0aW9uWzFdID0gYjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMueCA9IGEsIHRoaXMueSA9IGIsIHRoaXNcclxuICAgIH07XHJcbiAgICBEaXNwbGF5RWxlbWVudC5wcm90b3R5cGUuZ2V0Q2VudGVyTG9jYXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgeDogdGhpcy54ICsgdGhpcy53aWR0aCAvIDIsXHJcbiAgICAgICAgICAgIHk6IHRoaXMueSArIHRoaXMuaGVpZ2h0IC8gMlxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBEaXNwbGF5RWxlbWVudC5wcm90b3R5cGUuc2V0Q2VudGVyTG9jYXRpb24gPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgIHRoaXMueCA9IGEgLSB0aGlzLndpZHRoIC8gMjtcclxuICAgICAgICB0aGlzLnkgPSBiIC0gdGhpcy5oZWlnaHQgLyAyO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIERpc3BsYXlFbGVtZW50LnByb3RvdHlwZS5nZXRTaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHdpZHRoOiB0aGlzLndpZHRoLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVpdGhcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRGlzcGxheUVsZW1lbnQucHJvdG90eXBlLnNldFNpemUgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgIHRoaXMud2lkdGggPSBhO1xyXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gYjtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBEaXNwbGF5RWxlbWVudC5wcm90b3R5cGUuZ2V0Qm91bmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbGVmdDogdGhpcy54LFxyXG4gICAgICAgICAgICB0b3A6IHRoaXMueSxcclxuICAgICAgICAgICAgcmlnaHQ6IHRoaXMueCArIHRoaXMud2lkdGgsXHJcbiAgICAgICAgICAgIGJvdHRvbTogdGhpcy55ICsgdGhpcy5oZWlnaHQsXHJcbiAgICAgICAgICAgIHdpZHRoOiB0aGlzLndpZHRoLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVpZ2h0XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIERpc3BsYXlFbGVtZW50LnByb3RvdHlwZS5zZXRCb3VuZCA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7XHJcbiAgICAgICAgdGhpcy5zZXRMb2NhdGlvbihhLCBiKTtcclxuICAgICAgICB0aGlzLnNldFNpemUoYywgZCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgRGlzcGxheUVsZW1lbnQucHJvdG90eXBlLmdldERpc3BsYXlCb3VuZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBsZWZ0OiB0aGlzLngsXHJcbiAgICAgICAgICAgIHRvcDogdGhpcy55LFxyXG4gICAgICAgICAgICByaWdodDogdGhpcy54ICsgdGhpcy53aWR0aCAqIHRoaXMuc2NhbGVYLFxyXG4gICAgICAgICAgICBib3R0b206IHRoaXMueSArIHRoaXMuaGVpZ2h0ICogdGhpcy5zY2FsZVlcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRGlzcGxheUVsZW1lbnQucHJvdG90eXBlLmdldERpc3BsYXlTaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHdpZHRoOiB0aGlzLndpZHRoICogdGhpcy5zY2FsZVgsXHJcbiAgICAgICAgICAgIGhlaWdodDogdGhpcy5oZWlnaHQgKiB0aGlzLnNjYWxlWVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBEaXNwbGF5RWxlbWVudC5wcm90b3R5cGUuZ2V0UG9zaXRpb24gPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgIHZhciBwb3NpdGlvbixcclxuICAgICAgICAgICAgYyA9IHRoaXMuZ2V0Qm91bmQoKTtcclxuICAgICAgICBzd2l0Y2ggKGEpIHtcclxuICAgICAgICAgICAgY2FzZSBcIlRvcF9MZWZ0XCI6XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHt4OiBjLmxlZnQsIHk6IGMudG9wfTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiVG9wX0NlbnRlclwiOlxyXG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7eDogdGhpcy5jeCwgeTogYy50b3B9O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJUb3BfUmlnaHRcIjpcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0ge3g6IGMucmlnaHQsIHk6IGMudG9wfTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiTWlkZGxlX0xlZnRcIjpcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0ge3g6IGMubGVmdCwgeTogdGhpcy5jeX07XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcIk1pZGRsZV9DZW50ZXJcIjpcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0ge3g6IHRoaXMuY3gsIHk6IHRoaXMuY3l9O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJNaWRkbGVfUmlnaHRcIjpcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0ge3g6IGMucmlnaHQsIHk6IHRoaXMuY3l9O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJCb3R0b21fTGVmdFwiOlxyXG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7eDogYy5sZWZ0LCB5OiBjLmJvdHRvbX07XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcIkJvdHRvbV9DZW50ZXJcIjpcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0ge3g6IHRoaXMuY3gsIHk6IGMuYm90dG9tfTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICBcIkJvdHRvbV9SaWdodFwiOlxyXG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7eDogYy5yaWdodCwgeTogYy5ib3R0b219O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHt4OiBjLmxlZnQsIHk6IGMudG9wfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHBvc2l0aW9uO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKERpc3BsYXlFbGVtZW50LnByb3RvdHlwZSwge1xyXG4gICAgICAgIGN4OiB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMueCArIHRoaXMud2lkdGggLyAyXHJcbiAgICAgICAgICAgIH0sIHNldDogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMueCA9IGEgLSB0aGlzLndpZHRoIC8gMlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjeToge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnkgKyB0aGlzLmhlaWdodCAvIDJcclxuICAgICAgICAgICAgfSwgc2V0OiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy55ID0gYSAtIHRoaXMuaGVpZ2h0IC8gMlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL2Jhc2UvZGlzcGxheUVsZW1lbnQuanNcbi8vIG1vZHVsZSBpZCA9IDVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIDIiXSwic291cmNlUm9vdCI6IiJ9');
},function(module,exports){eval('module.exports = function (jtopo) {\r\n    jtopo.EditableElement = EditableElement;\r\n    var TEMP=jtopo.InteractiveElement.prototype;\r\n\r\n    function EditableElement() {\r\n        jtopo.InteractiveElement.apply(this, arguments);\r\n        this.editAble = !1;\r\n        this.selectedPoint = null;\r\n    }\r\n    jtopo.util.inherits(EditableElement,jtopo.InteractiveElement);\r\n    EditableElement.prototype.getCtrlPosition = function (a) {\r\n        var b = 5;\r\n        var c = 5;\r\n        var d = this.getPosition(a);\r\n        return {\r\n            left: d.x - b,\r\n            top: d.y - c,\r\n            right: d.x + b,\r\n            bottom: d.y + c\r\n        }\r\n    };\r\n    EditableElement.prototype.selectedHandler = function (event) {\r\n        TEMP.selectedHandler.apply(this, arguments);\r\n        this.selectedSize = {\r\n            width: this.width,\r\n            height: this.height\r\n        };\r\n        if (event.scene.mode == jtopo.SceneMode.edit) {\r\n            this.editAble = !0\r\n        }\r\n    };\r\n    EditableElement.prototype.unselectedHandler = function () {\r\n        TEMP.unselectedHandler.apply(this, arguments);\r\n        this.selectedSize = null;\r\n        this.editAble = !1;\r\n    };\r\n    var b = ["Top_Left", "Top_Center", "Top_Right", "Middle_Left", "Middle_Right", "Bottom_Left", "Bottom_Center", "Bottom_Right"];\r\n    EditableElement.prototype.paintCtrl = function (cx) {\r\n        if (0 != this.editAble) {\r\n            cx.save();\r\n            for (var c = 0; c < b.length; c++) {\r\n                var d = this.getCtrlPosition(b[c]);\r\n                d.left -= this.cx;\r\n                d.right -= this.cx;\r\n                d.top -= this.cy;\r\n                d.bottom -= this.cy;\r\n                var e = d.right - d.left;\r\n                var f = d.bottom - d.top;\r\n                cx.beginPath();\r\n                cx.strokeStyle = "rgba(0,0,0,0.8)";\r\n                cx.rect(d.left, d.top, e, f);\r\n                cx.stroke();\r\n                cx.closePath();\r\n                cx.beginPath();\r\n                cx.strokeStyle = "rgba(255,255,255,0.3)";\r\n                cx.rect(d.left + 1, d.top + 1, e - 2, f - 2);\r\n                cx.stroke();\r\n                cx.closePath();\r\n            }\r\n            cx.restore();\r\n        }\r\n    };\r\n    EditableElement.prototype.isInBound = function (a, c) {\r\n        if (this.selectedPoint = null, 1 == this.editAble)for (var e = 0; e < b.length; e++) {\r\n            var f = this.getCtrlPosition(b[e]);\r\n            if (a > f.left && a < f.right && c > f.top && c < f.bottom)return this.selectedPoint = b[e], !0\r\n        }\r\n        return TEMP.isInBound.apply(this, arguments);\r\n    };\r\n    EditableElement.prototype.mousedragHandler = function (a) {\r\n        if (null == this.selectedPoint) {\r\n            var b = this.selectedLocation.x + a.dx, c = this.selectedLocation.y + a.dy;\r\n            this.setLocation(b, c), this.dispatchEvent("mousedrag", a)\r\n        } else {\r\n            if ("Top_Left" == this.selectedPoint) {\r\n                var d = this.selectedSize.width - a.dx, e = this.selectedSize.height - a.dy, b = this.selectedLocation.x + a.dx, c = this.selectedLocation.y + a.dy;\r\n                b < this.x + this.width && (this.x = b, this.width = d), c < this.y + this.height && (this.y = c, this.height = e)\r\n            } else if ("Top_Center" == this.selectedPoint) {\r\n                var e = this.selectedSize.height - a.dy, c = this.selectedLocation.y + a.dy;\r\n                c < this.y + this.height && (this.y = c, this.height = e)\r\n            } else if ("Top_Right" == this.selectedPoint) {\r\n                var d = this.selectedSize.width + a.dx, c = this.selectedLocation.y + a.dy;\r\n                c < this.y + this.height && (this.y = c, this.height = this.selectedSize.height - a.dy), d > 1 && (this.width = d)\r\n            } else if ("Middle_Left" == this.selectedPoint) {\r\n                var d = this.selectedSize.width - a.dx, b = this.selectedLocation.x + a.dx;\r\n                b < this.x + this.width && (this.x = b), d > 1 && (this.width = d)\r\n            } else if ("Middle_Right" == this.selectedPoint) {\r\n                var d = this.selectedSize.width + a.dx;\r\n                d > 1 && (this.width = d)\r\n            } else if ("Bottom_Left" == this.selectedPoint) {\r\n                var d = this.selectedSize.width - a.dx, b = this.selectedLocation.x + a.dx;\r\n                d > 1 && (this.x = b, this.width = d);\r\n                var e = this.selectedSize.height + a.dy;\r\n                e > 1 && (this.height = e)\r\n            } else if ("Bottom_Center" == this.selectedPoint) {\r\n                var e = this.selectedSize.height + a.dy;\r\n                e > 1 && (this.height = e)\r\n            } else if ("Bottom_Right" == this.selectedPoint) {\r\n                var d = this.selectedSize.width + a.dx;\r\n                d > 1 && (this.width = d);\r\n                var e = this.selectedSize.height + a.dy;\r\n                e > 1 && (this.height = e)\r\n            }\r\n            this.dispatchEvent("resize", a)\r\n        }\r\n    };\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vYmFzZS9lZGl0YWJsZUVsZW1lbnQuanM/OThlMyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGNBQWM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5RUFBeUUsY0FBYztBQUN2RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiNi5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICBqdG9wby5FZGl0YWJsZUVsZW1lbnQgPSBFZGl0YWJsZUVsZW1lbnQ7XHJcbiAgICB2YXIgVEVNUD1qdG9wby5JbnRlcmFjdGl2ZUVsZW1lbnQucHJvdG90eXBlO1xyXG5cclxuICAgIGZ1bmN0aW9uIEVkaXRhYmxlRWxlbWVudCgpIHtcclxuICAgICAgICBqdG9wby5JbnRlcmFjdGl2ZUVsZW1lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICB0aGlzLmVkaXRBYmxlID0gITE7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZFBvaW50ID0gbnVsbDtcclxuICAgIH1cclxuICAgIGp0b3BvLnV0aWwuaW5oZXJpdHMoRWRpdGFibGVFbGVtZW50LGp0b3BvLkludGVyYWN0aXZlRWxlbWVudCk7XHJcbiAgICBFZGl0YWJsZUVsZW1lbnQucHJvdG90eXBlLmdldEN0cmxQb3NpdGlvbiA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgdmFyIGIgPSA1O1xyXG4gICAgICAgIHZhciBjID0gNTtcclxuICAgICAgICB2YXIgZCA9IHRoaXMuZ2V0UG9zaXRpb24oYSk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbGVmdDogZC54IC0gYixcclxuICAgICAgICAgICAgdG9wOiBkLnkgLSBjLFxyXG4gICAgICAgICAgICByaWdodDogZC54ICsgYixcclxuICAgICAgICAgICAgYm90dG9tOiBkLnkgKyBjXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEVkaXRhYmxlRWxlbWVudC5wcm90b3R5cGUuc2VsZWN0ZWRIYW5kbGVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgVEVNUC5zZWxlY3RlZEhhbmRsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkU2l6ZSA9IHtcclxuICAgICAgICAgICAgd2lkdGg6IHRoaXMud2lkdGgsXHJcbiAgICAgICAgICAgIGhlaWdodDogdGhpcy5oZWlnaHRcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChldmVudC5zY2VuZS5tb2RlID09IGp0b3BvLlNjZW5lTW9kZS5lZGl0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWRpdEFibGUgPSAhMFxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBFZGl0YWJsZUVsZW1lbnQucHJvdG90eXBlLnVuc2VsZWN0ZWRIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIFRFTVAudW5zZWxlY3RlZEhhbmRsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkU2l6ZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5lZGl0QWJsZSA9ICExO1xyXG4gICAgfTtcclxuICAgIHZhciBiID0gW1wiVG9wX0xlZnRcIiwgXCJUb3BfQ2VudGVyXCIsIFwiVG9wX1JpZ2h0XCIsIFwiTWlkZGxlX0xlZnRcIiwgXCJNaWRkbGVfUmlnaHRcIiwgXCJCb3R0b21fTGVmdFwiLCBcIkJvdHRvbV9DZW50ZXJcIiwgXCJCb3R0b21fUmlnaHRcIl07XHJcbiAgICBFZGl0YWJsZUVsZW1lbnQucHJvdG90eXBlLnBhaW50Q3RybCA9IGZ1bmN0aW9uIChjeCkge1xyXG4gICAgICAgIGlmICgwICE9IHRoaXMuZWRpdEFibGUpIHtcclxuICAgICAgICAgICAgY3guc2F2ZSgpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IGIubGVuZ3RoOyBjKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5nZXRDdHJsUG9zaXRpb24oYltjXSk7XHJcbiAgICAgICAgICAgICAgICBkLmxlZnQgLT0gdGhpcy5jeDtcclxuICAgICAgICAgICAgICAgIGQucmlnaHQgLT0gdGhpcy5jeDtcclxuICAgICAgICAgICAgICAgIGQudG9wIC09IHRoaXMuY3k7XHJcbiAgICAgICAgICAgICAgICBkLmJvdHRvbSAtPSB0aGlzLmN5O1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSBkLnJpZ2h0IC0gZC5sZWZ0O1xyXG4gICAgICAgICAgICAgICAgdmFyIGYgPSBkLmJvdHRvbSAtIGQudG9wO1xyXG4gICAgICAgICAgICAgICAgY3guYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjeC5zdHJva2VTdHlsZSA9IFwicmdiYSgwLDAsMCwwLjgpXCI7XHJcbiAgICAgICAgICAgICAgICBjeC5yZWN0KGQubGVmdCwgZC50b3AsIGUsIGYpO1xyXG4gICAgICAgICAgICAgICAgY3guc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgICAgICBjeC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGN4LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgY3guc3Ryb2tlU3R5bGUgPSBcInJnYmEoMjU1LDI1NSwyNTUsMC4zKVwiO1xyXG4gICAgICAgICAgICAgICAgY3gucmVjdChkLmxlZnQgKyAxLCBkLnRvcCArIDEsIGUgLSAyLCBmIC0gMik7XHJcbiAgICAgICAgICAgICAgICBjeC5zdHJva2UoKTtcclxuICAgICAgICAgICAgICAgIGN4LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGN4LnJlc3RvcmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRWRpdGFibGVFbGVtZW50LnByb3RvdHlwZS5pc0luQm91bmQgPSBmdW5jdGlvbiAoYSwgYykge1xyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkUG9pbnQgPSBudWxsLCAxID09IHRoaXMuZWRpdEFibGUpZm9yICh2YXIgZSA9IDA7IGUgPCBiLmxlbmd0aDsgZSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBmID0gdGhpcy5nZXRDdHJsUG9zaXRpb24oYltlXSk7XHJcbiAgICAgICAgICAgIGlmIChhID4gZi5sZWZ0ICYmIGEgPCBmLnJpZ2h0ICYmIGMgPiBmLnRvcCAmJiBjIDwgZi5ib3R0b20pcmV0dXJuIHRoaXMuc2VsZWN0ZWRQb2ludCA9IGJbZV0sICEwXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBURU1QLmlzSW5Cb3VuZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgfTtcclxuICAgIEVkaXRhYmxlRWxlbWVudC5wcm90b3R5cGUubW91c2VkcmFnSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgaWYgKG51bGwgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnggKyBhLmR4LCBjID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnkgKyBhLmR5O1xyXG4gICAgICAgICAgICB0aGlzLnNldExvY2F0aW9uKGIsIGMpLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZWRyYWdcIiwgYSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoXCJUb3BfTGVmdFwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLnNlbGVjdGVkU2l6ZS53aWR0aCAtIGEuZHgsIGUgPSB0aGlzLnNlbGVjdGVkU2l6ZS5oZWlnaHQgLSBhLmR5LCBiID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnggKyBhLmR4LCBjID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnkgKyBhLmR5O1xyXG4gICAgICAgICAgICAgICAgYiA8IHRoaXMueCArIHRoaXMud2lkdGggJiYgKHRoaXMueCA9IGIsIHRoaXMud2lkdGggPSBkKSwgYyA8IHRoaXMueSArIHRoaXMuaGVpZ2h0ICYmICh0aGlzLnkgPSBjLCB0aGlzLmhlaWdodCA9IGUpXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJUb3BfQ2VudGVyXCIgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuc2VsZWN0ZWRTaXplLmhlaWdodCAtIGEuZHksIGMgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueSArIGEuZHk7XHJcbiAgICAgICAgICAgICAgICBjIDwgdGhpcy55ICsgdGhpcy5oZWlnaHQgJiYgKHRoaXMueSA9IGMsIHRoaXMuaGVpZ2h0ID0gZSlcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChcIlRvcF9SaWdodFwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLnNlbGVjdGVkU2l6ZS53aWR0aCArIGEuZHgsIGMgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueSArIGEuZHk7XHJcbiAgICAgICAgICAgICAgICBjIDwgdGhpcy55ICsgdGhpcy5oZWlnaHQgJiYgKHRoaXMueSA9IGMsIHRoaXMuaGVpZ2h0ID0gdGhpcy5zZWxlY3RlZFNpemUuaGVpZ2h0IC0gYS5keSksIGQgPiAxICYmICh0aGlzLndpZHRoID0gZClcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChcIk1pZGRsZV9MZWZ0XCIgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuc2VsZWN0ZWRTaXplLndpZHRoIC0gYS5keCwgYiA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi54ICsgYS5keDtcclxuICAgICAgICAgICAgICAgIGIgPCB0aGlzLnggKyB0aGlzLndpZHRoICYmICh0aGlzLnggPSBiKSwgZCA+IDEgJiYgKHRoaXMud2lkdGggPSBkKVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKFwiTWlkZGxlX1JpZ2h0XCIgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuc2VsZWN0ZWRTaXplLndpZHRoICsgYS5keDtcclxuICAgICAgICAgICAgICAgIGQgPiAxICYmICh0aGlzLndpZHRoID0gZClcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChcIkJvdHRvbV9MZWZ0XCIgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuc2VsZWN0ZWRTaXplLndpZHRoIC0gYS5keCwgYiA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi54ICsgYS5keDtcclxuICAgICAgICAgICAgICAgIGQgPiAxICYmICh0aGlzLnggPSBiLCB0aGlzLndpZHRoID0gZCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuc2VsZWN0ZWRTaXplLmhlaWdodCArIGEuZHk7XHJcbiAgICAgICAgICAgICAgICBlID4gMSAmJiAodGhpcy5oZWlnaHQgPSBlKVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKFwiQm90dG9tX0NlbnRlclwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLnNlbGVjdGVkU2l6ZS5oZWlnaHQgKyBhLmR5O1xyXG4gICAgICAgICAgICAgICAgZSA+IDEgJiYgKHRoaXMuaGVpZ2h0ID0gZSlcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChcIkJvdHRvbV9SaWdodFwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLnNlbGVjdGVkU2l6ZS53aWR0aCArIGEuZHg7XHJcbiAgICAgICAgICAgICAgICBkID4gMSAmJiAodGhpcy53aWR0aCA9IGQpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLnNlbGVjdGVkU2l6ZS5oZWlnaHQgKyBhLmR5O1xyXG4gICAgICAgICAgICAgICAgZSA+IDEgJiYgKHRoaXMuaGVpZ2h0ID0gZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJyZXNpemVcIiwgYSlcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL2Jhc2UvZWRpdGFibGVFbGVtZW50LmpzXG4vLyBtb2R1bGUgaWQgPSA2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports){eval('module.exports=function(jtopo){\r\n    jtopo.InteractiveElement = InteractiveElement;\r\n    \r\n    function InteractiveElement() {\r\n        jtopo.DisplayElement.apply(this,arguments);\r\n        this.elementType = "interactiveElement";\r\n        this.draggable = !1;\r\n        this.selected = !1;\r\n        this.showSelected = !0;\r\n        this.selectedLocation = null;\r\n        this.isMouseOver = !1;\r\n        var a = "draggable,selected,showSelected,isMouseOver".split(",");\r\n        this.serializedProperties = this.serializedProperties.concat(a);\r\n    }\r\n\r\n    jtopo.util.inherits(InteractiveElement,jtopo.DisplayElement);\r\n\r\n    ["click","dbclick","mousedown","mouseup","mouseover","mouseout","mousemove","mousedrag","touchstart","touchmove","touchend"]\r\n        .forEach(function (eventName) {\r\n            InteractiveElement.prototype[eventName] = function (e) {\r\n                if (null != e) {\r\n                    this.addEventListener(eventName, e);\r\n                } else {\r\n                    this.dispatchEvent(eventName);\r\n                }\r\n            }\r\n        });\r\n    InteractiveElement.prototype.paintSelected = function (a) {\r\n        a.save();\r\n        a.beginPath();\r\n        a.strokeStyle = "rgba(168,202,255, 0.9)";\r\n        a.fillStyle = "rgba(168,202,236,0.7)";\r\n        a.rect(-this.width / 2 - 3, -this.height / 2 - 3, this.width + 6, this.height + 6);\r\n        a.fill();\r\n        a.stroke();\r\n        a.closePath();\r\n        a.restore();\r\n        return this;\r\n    };\r\n    InteractiveElement.prototype.paintMouseover = function (a) {\r\n        return this.paintSelected(a);\r\n    };\r\n    InteractiveElement.prototype.isInBound = function (pointX, pointY) {\r\n        return pointX > this.x && pointX < this.x + this.width * Math.abs(this.scaleX) && pointY > this.y && pointY < this.y + this.height * Math.abs(this.scaleY)\r\n    };\r\n    InteractiveElement.prototype.selectedHandler = function () {\r\n        this.selected = !0;\r\n        this.selectedLocation = {\r\n            x: this.x,\r\n            y: this.y\r\n        };\r\n        return this;\r\n    };\r\n    InteractiveElement.prototype.unselectedHandler = function () {\r\n        this.selected = !1;\r\n        this.selectedLocation = null;\r\n        return this;\r\n    };\r\n    InteractiveElement.prototype.dbclickHandler = function (a) {\r\n        this.dispatchEvent("dbclick", a);\r\n        return this;\r\n    };\r\n    InteractiveElement.prototype.clickHandler = function (a) {\r\n        this.dispatchEvent("click", a);\r\n        return this;\r\n    };\r\n    InteractiveElement.prototype.mousedownHander = function (a) {\r\n        this.dispatchEvent("mousedown", a);\r\n        return this;\r\n    };\r\n    InteractiveElement.prototype.mouseupHandler = function (a) {\r\n        this.dispatchEvent("mouseup", a);\r\n        return this;\r\n    };\r\n    InteractiveElement.prototype.mouseoverHandler = function (a) {\r\n        this.isMouseOver = !0;\r\n        this.dispatchEvent("mouseover", a);\r\n        return this;\r\n    };\r\n    InteractiveElement.prototype.mousemoveHandler = function (a) {\r\n        this.dispatchEvent("mousemove", a);\r\n        return this;\r\n    };\r\n    InteractiveElement.prototype.mouseoutHandler = function (a) {\r\n        this.isMouseOver = !1;\r\n        this.dispatchEvent("mouseout", a);\r\n        return this;\r\n    };\r\n    InteractiveElement.prototype.mousedragHandler = function (a) {\r\n        var b = this.selectedLocation.x + a.dx;\r\n        var c = this.selectedLocation.y + a.dy;\r\n        this.setLocation(b, c);\r\n        this.dispatchEvent("mousedrag", a);\r\n        return this;\r\n    };\r\n    InteractiveElement.prototype.addEventListener = function (event, fn) {\r\n        if (!this.messageBus) {\r\n            this.messageBus = new jtopo.util.MessageBus;\r\n        }\r\n        this.messageBus.subscribe(event, fn);\r\n        return this;\r\n    };\r\n    InteractiveElement.prototype.dispatchEvent = function (event, e) {\r\n        if (this.messageBus) {\r\n            this.messageBus.publish(event, e);\r\n            return this;\r\n        }\r\n    };\r\n    InteractiveElement.prototype.removeEventListener = function (event, fn) {\r\n        this.messageBus.unsubscribe(event, fn);\r\n    };\r\n    InteractiveElement.prototype.removeAllEventListener = function () {\r\n        this.messageBus = new jtopo.util.MessageBus\r\n    };\r\n    \r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vYmFzZS9pbnRlcmFjdGl2ZUVsZW1lbnQuanM/YzIxOSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBIiwiZmlsZSI6IjcuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cz1mdW5jdGlvbihqdG9wbyl7XHJcbiAgICBqdG9wby5JbnRlcmFjdGl2ZUVsZW1lbnQgPSBJbnRlcmFjdGl2ZUVsZW1lbnQ7XHJcbiAgICBcclxuICAgIGZ1bmN0aW9uIEludGVyYWN0aXZlRWxlbWVudCgpIHtcclxuICAgICAgICBqdG9wby5EaXNwbGF5RWxlbWVudC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50VHlwZSA9IFwiaW50ZXJhY3RpdmVFbGVtZW50XCI7XHJcbiAgICAgICAgdGhpcy5kcmFnZ2FibGUgPSAhMTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkID0gITE7XHJcbiAgICAgICAgdGhpcy5zaG93U2VsZWN0ZWQgPSAhMDtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTG9jYXRpb24gPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNNb3VzZU92ZXIgPSAhMTtcclxuICAgICAgICB2YXIgYSA9IFwiZHJhZ2dhYmxlLHNlbGVjdGVkLHNob3dTZWxlY3RlZCxpc01vdXNlT3ZlclwiLnNwbGl0KFwiLFwiKTtcclxuICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzID0gdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5jb25jYXQoYSk7XHJcbiAgICB9XHJcblxyXG4gICAganRvcG8udXRpbC5pbmhlcml0cyhJbnRlcmFjdGl2ZUVsZW1lbnQsanRvcG8uRGlzcGxheUVsZW1lbnQpO1xyXG5cclxuICAgIFtcImNsaWNrXCIsXCJkYmNsaWNrXCIsXCJtb3VzZWRvd25cIixcIm1vdXNldXBcIixcIm1vdXNlb3ZlclwiLFwibW91c2VvdXRcIixcIm1vdXNlbW92ZVwiLFwibW91c2VkcmFnXCIsXCJ0b3VjaHN0YXJ0XCIsXCJ0b3VjaG1vdmVcIixcInRvdWNoZW5kXCJdXHJcbiAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50TmFtZSkge1xyXG4gICAgICAgICAgICBJbnRlcmFjdGl2ZUVsZW1lbnQucHJvdG90eXBlW2V2ZW50TmFtZV0gPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGUpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnROYW1lKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgSW50ZXJhY3RpdmVFbGVtZW50LnByb3RvdHlwZS5wYWludFNlbGVjdGVkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICBhLnNhdmUoKTtcclxuICAgICAgICBhLmJlZ2luUGF0aCgpO1xyXG4gICAgICAgIGEuc3Ryb2tlU3R5bGUgPSBcInJnYmEoMTY4LDIwMiwyNTUsIDAuOSlcIjtcclxuICAgICAgICBhLmZpbGxTdHlsZSA9IFwicmdiYSgxNjgsMjAyLDIzNiwwLjcpXCI7XHJcbiAgICAgICAgYS5yZWN0KC10aGlzLndpZHRoIC8gMiAtIDMsIC10aGlzLmhlaWdodCAvIDIgLSAzLCB0aGlzLndpZHRoICsgNiwgdGhpcy5oZWlnaHQgKyA2KTtcclxuICAgICAgICBhLmZpbGwoKTtcclxuICAgICAgICBhLnN0cm9rZSgpO1xyXG4gICAgICAgIGEuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgYS5yZXN0b3JlKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgSW50ZXJhY3RpdmVFbGVtZW50LnByb3RvdHlwZS5wYWludE1vdXNlb3ZlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGFpbnRTZWxlY3RlZChhKTtcclxuICAgIH07XHJcbiAgICBJbnRlcmFjdGl2ZUVsZW1lbnQucHJvdG90eXBlLmlzSW5Cb3VuZCA9IGZ1bmN0aW9uIChwb2ludFgsIHBvaW50WSkge1xyXG4gICAgICAgIHJldHVybiBwb2ludFggPiB0aGlzLnggJiYgcG9pbnRYIDwgdGhpcy54ICsgdGhpcy53aWR0aCAqIE1hdGguYWJzKHRoaXMuc2NhbGVYKSAmJiBwb2ludFkgPiB0aGlzLnkgJiYgcG9pbnRZIDwgdGhpcy55ICsgdGhpcy5oZWlnaHQgKiBNYXRoLmFicyh0aGlzLnNjYWxlWSlcclxuICAgIH07XHJcbiAgICBJbnRlcmFjdGl2ZUVsZW1lbnQucHJvdG90eXBlLnNlbGVjdGVkSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkID0gITA7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZExvY2F0aW9uID0ge1xyXG4gICAgICAgICAgICB4OiB0aGlzLngsXHJcbiAgICAgICAgICAgIHk6IHRoaXMueVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgSW50ZXJhY3RpdmVFbGVtZW50LnByb3RvdHlwZS51bnNlbGVjdGVkSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkID0gITE7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZExvY2F0aW9uID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBJbnRlcmFjdGl2ZUVsZW1lbnQucHJvdG90eXBlLmRiY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJkYmNsaWNrXCIsIGEpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIEludGVyYWN0aXZlRWxlbWVudC5wcm90b3R5cGUuY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJjbGlja1wiLCBhKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBJbnRlcmFjdGl2ZUVsZW1lbnQucHJvdG90eXBlLm1vdXNlZG93bkhhbmRlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2Vkb3duXCIsIGEpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIEludGVyYWN0aXZlRWxlbWVudC5wcm90b3R5cGUubW91c2V1cEhhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNldXBcIiwgYSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgSW50ZXJhY3RpdmVFbGVtZW50LnByb3RvdHlwZS5tb3VzZW92ZXJIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICB0aGlzLmlzTW91c2VPdmVyID0gITA7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VvdmVyXCIsIGEpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIEludGVyYWN0aXZlRWxlbWVudC5wcm90b3R5cGUubW91c2Vtb3ZlSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2Vtb3ZlXCIsIGEpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIEludGVyYWN0aXZlRWxlbWVudC5wcm90b3R5cGUubW91c2VvdXRIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICB0aGlzLmlzTW91c2VPdmVyID0gITE7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VvdXRcIiwgYSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgSW50ZXJhY3RpdmVFbGVtZW50LnByb3RvdHlwZS5tb3VzZWRyYWdIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICB2YXIgYiA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi54ICsgYS5keDtcclxuICAgICAgICB2YXIgYyA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi55ICsgYS5keTtcclxuICAgICAgICB0aGlzLnNldExvY2F0aW9uKGIsIGMpO1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlZHJhZ1wiLCBhKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBJbnRlcmFjdGl2ZUVsZW1lbnQucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnQsIGZuKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLm1lc3NhZ2VCdXMpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzID0gbmV3IGp0b3BvLnV0aWwuTWVzc2FnZUJ1cztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlQnVzLnN1YnNjcmliZShldmVudCwgZm4pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIEludGVyYWN0aXZlRWxlbWVudC5wcm90b3R5cGUuZGlzcGF0Y2hFdmVudCA9IGZ1bmN0aW9uIChldmVudCwgZSkge1xyXG4gICAgICAgIGlmICh0aGlzLm1lc3NhZ2VCdXMpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzLnB1Ymxpc2goZXZlbnQsIGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSW50ZXJhY3RpdmVFbGVtZW50LnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50LCBmbikge1xyXG4gICAgICAgIHRoaXMubWVzc2FnZUJ1cy51bnN1YnNjcmliZShldmVudCwgZm4pO1xyXG4gICAgfTtcclxuICAgIEludGVyYWN0aXZlRWxlbWVudC5wcm90b3R5cGUucmVtb3ZlQWxsRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VCdXMgPSBuZXcganRvcG8udXRpbC5NZXNzYWdlQnVzXHJcbiAgICB9O1xyXG4gICAgXHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vYmFzZS9pbnRlcmFjdGl2ZUVsZW1lbnQuanNcbi8vIG1vZHVsZSBpZCA9IDdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIDIiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports){eval('module.exports = function (jtopo) {\r\n    jtopo.Container = Container;\r\n    function Container(c) {\r\n        jtopo.InteractiveElement.call(this);\r\n        this.elementType = "container";\r\n        this.zIndex = jtopo.zIndex_Container;\r\n        this.expand=true;\r\n        this.width = 100;\r\n        this.height = 100;\r\n        this.childs = [];\r\n        this.alpha = .5;\r\n        this.draggable = !0;\r\n        this.childDraggable = !0;\r\n        this.visible = !0;\r\n        this.fillColor = "10,100,80";\r\n        this.borderWidth = 0;\r\n        this.borderColor = "255,255,255";\r\n        this.borderRadius = null;\r\n        this.font = "12px Consolas";\r\n        this.fontColor = "255,255,255";\r\n        this.text = c;\r\n        this.textPosition = "Bottom_Center";\r\n        this.textOffsetX = 0;\r\n        this.textOffsetY = 0;\r\n        this.layout = jtopo.layout.AutoBoundLayout();\r\n    }\r\n    jtopo.util.inherits(Container,jtopo.InteractiveElement);\r\n    function toggle(arr,str){\r\n        if(arr instanceof Array){\r\n            arr.forEach(function(link){\r\n                link[str]();\r\n            });\r\n        }\r\n    }\r\n    Container.prototype.hide = function () {\r\n        this.visible = false;\r\n        this.childs.forEach(function(node){\r\n            node.hide();\r\n        });\r\n        toggle(this.inLinks,"hide");\r\n        toggle(this.outLinks,"hide");\r\n    };\r\n    Container.prototype.show = function () {\r\n        this.visible = true;\r\n        this.childs.forEach(function(node){\r\n            node.show();\r\n        });\r\n        toggle(this.inLinks,"show");\r\n        toggle(this.outLinks,"show");\r\n    };\r\n    Container.prototype.add = function (element) {\r\n        this.childs.push(element);\r\n        element.draggable = this.childDraggable;\r\n    };\r\n    Container.prototype.remove = function (element) {\r\n        element.parentContainer = null;\r\n        this.childs = this.childs.del(element);\r\n        element.lastParentContainer = this;\r\n    };\r\n    Container.prototype.removeAll = function () {\r\n        this.childs = []\r\n    };\r\n    Container.prototype.setLocation = function (setX, setY) {\r\n        var oX = setX - this.x;\r\n        var oY = setY - this.y;\r\n        this.x = setX;\r\n        this.y = setY;\r\n        if (this.qtopo && this.qtopo.attr && this.qtopo.attr.position) {\r\n            this.qtopo.attr.position[0] = setX;\r\n            this.qtopo.attr.position[1] = setY;\r\n        }\r\n        this.childs.forEach(function(element){\r\n            element.setLocation(element.x + oX, element.y + oY);\r\n        });\r\n    };\r\n    Container.prototype.doLayout = function (layout) {\r\n        if(layout &&typeof layout ==\'function\'){\r\n            layout(this, this.childs)\r\n        }\r\n    };\r\n    Container.prototype.paint = function (context) {\r\n        if (this.visible) {\r\n            if(this.expand){\r\n                this.doLayout(this.layout);\r\n                if (null == this.borderRadius || 0 == this.borderRadius) {\r\n                    context.beginPath();\r\n                    context.rect(this.x, this.y, this.width, this.height);\r\n                    context.closePath();\r\n                } else {\r\n                    context._roundRect(this.x, this.y, this.width, this.height, this.borderRadius);\r\n                }\r\n                context.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n                context.fill();\r\n                this.paintBorder(context);\r\n                this.paintText(context);\r\n            }\r\n        }\r\n    };\r\n    Container.prototype.paintBorder = function (context) {\r\n        if (0 != this.borderWidth) {\r\n            context.beginPath();\r\n            context.lineWidth = this.borderWidth;\r\n            context.strokeStyle = "rgba(" + this.borderColor + "," + this.alpha + ")";\r\n            var b = this.borderWidth / 2;\r\n            if(null == this.borderRadius || 0 == this.borderRadius){\r\n                context.rect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth)\r\n            }else{\r\n                context._roundRect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius);\r\n            }\r\n            context.stroke();\r\n            context.closePath();\r\n        }\r\n    };\r\n    Container.prototype.paintText = function (context) {\r\n        var text = this.text;\r\n        if (null != text && "" != text) {\r\n            context.beginPath();\r\n            context.font = this.font;\r\n            var fontWidth = context.measureText("田").width;\r\n            var maxWidth = fontWidth;\r\n            context.fillStyle = "rgba(" + this.fontColor + ",1)"; //", " + this.alpha + ")";名称永远不透明\r\n            //换行检测\r\n            var textlines = text.split("\\n");\r\n            for (var i = 0; i < textlines.length; i++) {\r\n                var width = context.measureText(textlines[i]).width;\r\n                if (width > maxWidth) {\r\n                    maxWidth = width;\r\n                }\r\n            }\r\n            var e = this.getTextPostion(this.textPosition, maxWidth, fontWidth, textlines.length);\r\n            for (var j = 0; j < textlines.length; j++) {\r\n                var textWidth = context.measureText(textlines[j]).width;\r\n                context.fillText(textlines[j], e.x + (maxWidth - textWidth) / 2, e.y + j * fontWidth);\r\n            }\r\n\r\n            context.closePath();\r\n        }\r\n    };\r\n    Container.prototype.getTextPostion = function (textPosition, maxWidth, fontWidth, textLines) {\r\n        var position = null;\r\n        switch (textPosition) {\r\n            case\'Top_Center\':\r\n                position = {\r\n                    x: this.x + this.width / 2 - maxWidth / 2,\r\n                    y: this.y - fontWidth / 2 - fontWidth * (textLines - 1)\r\n                };\r\n                break;\r\n            case\'Top_Right\':\r\n                position = {x: this.x + this.width - maxWidth, y: this.y - fontWidth / 2};\r\n                break;\r\n            case\'Top_Left\':\r\n                position = {\r\n                    x: this.x,\r\n                    y: this.y - fontWidth / 2\r\n                };\r\n                break;\r\n            case\'Bottom_Right\':\r\n                position = {\r\n                    x: this.x + this.width - maxWidth,\r\n                    y: this.y + this.height + fontWidth\r\n                };\r\n                break;\r\n            case\'Bottom_Left\':\r\n                position = {x: this.x, y: this.y + this.height + fontWidth};\r\n                break;\r\n            case\'Middle_Center\':\r\n                position = {\r\n                    x: this.x + this.width / 2 - maxWidth / 2,\r\n                    y: this.y + this.height / 2 + fontWidth / 2\r\n                };\r\n                break;\r\n            case\'Middle_Right\':\r\n                position = {\r\n                    x: this.x + this.width,\r\n                    y: this.y + this.height / 2 + fontWidth / 2\r\n                };\r\n                break;\r\n            case\'Middle_Left\':\r\n                position = {\r\n                    x: this.x-maxWidth,\r\n                    y: this.y + this.height / 2 + fontWidth / 2\r\n                };\r\n                break;\r\n            default://\'Bottom_Center\'\r\n                position = {\r\n                    x: this.x + this.width / 2 - maxWidth / 2,\r\n                    y: this.y + this.height + fontWidth\r\n                };\r\n        }\r\n        if (null != this.textOffsetX) {\r\n            position.x += this.textOffsetX;\r\n        }\r\n        if (null != this.textOffsetY) {\r\n            position.y += this.textOffsetY;\r\n        }\r\n        return position\r\n    };\r\n    Container.prototype.paintMouseover = function () {\r\n    };\r\n    Container.prototype.paintSelected = function (a) {\r\n        a.shadowBlur = 10;\r\n        a.shadowColor = "rgba(0,0,0,1)";\r\n        a.shadowOffsetX = 0;\r\n        a.shadowOffsetY = 0;\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vY29udGFpbmVyL2NvbnRhaW5lci5qcz82N2RjIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSwyQkFBMkI7QUFDNUY7QUFDQTtBQUNBLDJCQUEyQixzQkFBc0I7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHNCQUFzQjtBQUNqRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiOC5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICBqdG9wby5Db250YWluZXIgPSBDb250YWluZXI7XHJcbiAgICBmdW5jdGlvbiBDb250YWluZXIoYykge1xyXG4gICAgICAgIGp0b3BvLkludGVyYWN0aXZlRWxlbWVudC5jYWxsKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudFR5cGUgPSBcImNvbnRhaW5lclwiO1xyXG4gICAgICAgIHRoaXMuekluZGV4ID0ganRvcG8uekluZGV4X0NvbnRhaW5lcjtcclxuICAgICAgICB0aGlzLmV4cGFuZD10cnVlO1xyXG4gICAgICAgIHRoaXMud2lkdGggPSAxMDA7XHJcbiAgICAgICAgdGhpcy5oZWlnaHQgPSAxMDA7XHJcbiAgICAgICAgdGhpcy5jaGlsZHMgPSBbXTtcclxuICAgICAgICB0aGlzLmFscGhhID0gLjU7XHJcbiAgICAgICAgdGhpcy5kcmFnZ2FibGUgPSAhMDtcclxuICAgICAgICB0aGlzLmNoaWxkRHJhZ2dhYmxlID0gITA7XHJcbiAgICAgICAgdGhpcy52aXNpYmxlID0gITA7XHJcbiAgICAgICAgdGhpcy5maWxsQ29sb3IgPSBcIjEwLDEwMCw4MFwiO1xyXG4gICAgICAgIHRoaXMuYm9yZGVyV2lkdGggPSAwO1xyXG4gICAgICAgIHRoaXMuYm9yZGVyQ29sb3IgPSBcIjI1NSwyNTUsMjU1XCI7XHJcbiAgICAgICAgdGhpcy5ib3JkZXJSYWRpdXMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZm9udCA9IFwiMTJweCBDb25zb2xhc1wiO1xyXG4gICAgICAgIHRoaXMuZm9udENvbG9yID0gXCIyNTUsMjU1LDI1NVwiO1xyXG4gICAgICAgIHRoaXMudGV4dCA9IGM7XHJcbiAgICAgICAgdGhpcy50ZXh0UG9zaXRpb24gPSBcIkJvdHRvbV9DZW50ZXJcIjtcclxuICAgICAgICB0aGlzLnRleHRPZmZzZXRYID0gMDtcclxuICAgICAgICB0aGlzLnRleHRPZmZzZXRZID0gMDtcclxuICAgICAgICB0aGlzLmxheW91dCA9IGp0b3BvLmxheW91dC5BdXRvQm91bmRMYXlvdXQoKTtcclxuICAgIH1cclxuICAgIGp0b3BvLnV0aWwuaW5oZXJpdHMoQ29udGFpbmVyLGp0b3BvLkludGVyYWN0aXZlRWxlbWVudCk7XHJcbiAgICBmdW5jdGlvbiB0b2dnbGUoYXJyLHN0cil7XHJcbiAgICAgICAgaWYoYXJyIGluc3RhbmNlb2YgQXJyYXkpe1xyXG4gICAgICAgICAgICBhcnIuZm9yRWFjaChmdW5jdGlvbihsaW5rKXtcclxuICAgICAgICAgICAgICAgIGxpbmtbc3RyXSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBDb250YWluZXIucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbihub2RlKXtcclxuICAgICAgICAgICAgbm9kZS5oaWRlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdG9nZ2xlKHRoaXMuaW5MaW5rcyxcImhpZGVcIik7XHJcbiAgICAgICAgdG9nZ2xlKHRoaXMub3V0TGlua3MsXCJoaWRlXCIpO1xyXG4gICAgfTtcclxuICAgIENvbnRhaW5lci5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24obm9kZSl7XHJcbiAgICAgICAgICAgIG5vZGUuc2hvdygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRvZ2dsZSh0aGlzLmluTGlua3MsXCJzaG93XCIpO1xyXG4gICAgICAgIHRvZ2dsZSh0aGlzLm91dExpbmtzLFwic2hvd1wiKTtcclxuICAgIH07XHJcbiAgICBDb250YWluZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5jaGlsZHMucHVzaChlbGVtZW50KTtcclxuICAgICAgICBlbGVtZW50LmRyYWdnYWJsZSA9IHRoaXMuY2hpbGREcmFnZ2FibGU7XHJcbiAgICB9O1xyXG4gICAgQ29udGFpbmVyLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIGVsZW1lbnQucGFyZW50Q29udGFpbmVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNoaWxkcyA9IHRoaXMuY2hpbGRzLmRlbChlbGVtZW50KTtcclxuICAgICAgICBlbGVtZW50Lmxhc3RQYXJlbnRDb250YWluZXIgPSB0aGlzO1xyXG4gICAgfTtcclxuICAgIENvbnRhaW5lci5wcm90b3R5cGUucmVtb3ZlQWxsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY2hpbGRzID0gW11cclxuICAgIH07XHJcbiAgICBDb250YWluZXIucHJvdG90eXBlLnNldExvY2F0aW9uID0gZnVuY3Rpb24gKHNldFgsIHNldFkpIHtcclxuICAgICAgICB2YXIgb1ggPSBzZXRYIC0gdGhpcy54O1xyXG4gICAgICAgIHZhciBvWSA9IHNldFkgLSB0aGlzLnk7XHJcbiAgICAgICAgdGhpcy54ID0gc2V0WDtcclxuICAgICAgICB0aGlzLnkgPSBzZXRZO1xyXG4gICAgICAgIGlmICh0aGlzLnF0b3BvICYmIHRoaXMucXRvcG8uYXR0ciAmJiB0aGlzLnF0b3BvLmF0dHIucG9zaXRpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5xdG9wby5hdHRyLnBvc2l0aW9uWzBdID0gc2V0WDtcclxuICAgICAgICAgICAgdGhpcy5xdG9wby5hdHRyLnBvc2l0aW9uWzFdID0gc2V0WTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KXtcclxuICAgICAgICAgICAgZWxlbWVudC5zZXRMb2NhdGlvbihlbGVtZW50LnggKyBvWCwgZWxlbWVudC55ICsgb1kpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIENvbnRhaW5lci5wcm90b3R5cGUuZG9MYXlvdXQgPSBmdW5jdGlvbiAobGF5b3V0KSB7XHJcbiAgICAgICAgaWYobGF5b3V0ICYmdHlwZW9mIGxheW91dCA9PSdmdW5jdGlvbicpe1xyXG4gICAgICAgICAgICBsYXlvdXQodGhpcywgdGhpcy5jaGlsZHMpXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIENvbnRhaW5lci5wcm90b3R5cGUucGFpbnQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgIGlmICh0aGlzLnZpc2libGUpIHtcclxuICAgICAgICAgICAgaWYodGhpcy5leHBhbmQpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb0xheW91dCh0aGlzLmxheW91dCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSB0aGlzLmJvcmRlclJhZGl1cyB8fCAwID09IHRoaXMuYm9yZGVyUmFkaXVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnJlY3QodGhpcy54LCB0aGlzLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0Ll9yb3VuZFJlY3QodGhpcy54LCB0aGlzLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLmJvcmRlclJhZGl1cyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZmlsbENvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRCb3JkZXIoY29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50VGV4dChjb250ZXh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBDb250YWluZXIucHJvdG90eXBlLnBhaW50Qm9yZGVyID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcclxuICAgICAgICBpZiAoMCAhPSB0aGlzLmJvcmRlcldpZHRoKSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQubGluZVdpZHRoID0gdGhpcy5ib3JkZXJXaWR0aDtcclxuICAgICAgICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuYm9yZGVyQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLmJvcmRlcldpZHRoIC8gMjtcclxuICAgICAgICAgICAgaWYobnVsbCA9PSB0aGlzLmJvcmRlclJhZGl1cyB8fCAwID09IHRoaXMuYm9yZGVyUmFkaXVzKXtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQucmVjdCh0aGlzLnggLSBiLCB0aGlzLnkgLSBiLCB0aGlzLndpZHRoICsgdGhpcy5ib3JkZXJXaWR0aCwgdGhpcy5oZWlnaHQgKyB0aGlzLmJvcmRlcldpZHRoKVxyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuX3JvdW5kUmVjdCh0aGlzLnggLSBiLCB0aGlzLnkgLSBiLCB0aGlzLndpZHRoICsgdGhpcy5ib3JkZXJXaWR0aCwgdGhpcy5oZWlnaHQgKyB0aGlzLmJvcmRlcldpZHRoLCB0aGlzLmJvcmRlclJhZGl1cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29udGV4dC5zdHJva2UoKTtcclxuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQ29udGFpbmVyLnByb3RvdHlwZS5wYWludFRleHQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgIHZhciB0ZXh0ID0gdGhpcy50ZXh0O1xyXG4gICAgICAgIGlmIChudWxsICE9IHRleHQgJiYgXCJcIiAhPSB0ZXh0KSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZm9udCA9IHRoaXMuZm9udDtcclxuICAgICAgICAgICAgdmFyIGZvbnRXaWR0aCA9IGNvbnRleHQubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgIHZhciBtYXhXaWR0aCA9IGZvbnRXaWR0aDtcclxuICAgICAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLDEpXCI7IC8vXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO+WQjeensOawuOi/nOS4jemAj+aYjlxyXG4gICAgICAgICAgICAvL+aNouihjOajgOa1i1xyXG4gICAgICAgICAgICB2YXIgdGV4dGxpbmVzID0gdGV4dC5zcGxpdChcIlxcblwiKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZXh0bGluZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGNvbnRleHQubWVhc3VyZVRleHQodGV4dGxpbmVzW2ldKS53aWR0aDtcclxuICAgICAgICAgICAgICAgIGlmICh3aWR0aCA+IG1heFdpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF4V2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZSA9IHRoaXMuZ2V0VGV4dFBvc3Rpb24odGhpcy50ZXh0UG9zaXRpb24sIG1heFdpZHRoLCBmb250V2lkdGgsIHRleHRsaW5lcy5sZW5ndGgpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRleHRsaW5lcy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRleHRXaWR0aCA9IGNvbnRleHQubWVhc3VyZVRleHQodGV4dGxpbmVzW2pdKS53aWR0aDtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFRleHQodGV4dGxpbmVzW2pdLCBlLnggKyAobWF4V2lkdGggLSB0ZXh0V2lkdGgpIC8gMiwgZS55ICsgaiAqIGZvbnRXaWR0aCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIENvbnRhaW5lci5wcm90b3R5cGUuZ2V0VGV4dFBvc3Rpb24gPSBmdW5jdGlvbiAodGV4dFBvc2l0aW9uLCBtYXhXaWR0aCwgZm9udFdpZHRoLCB0ZXh0TGluZXMpIHtcclxuICAgICAgICB2YXIgcG9zaXRpb24gPSBudWxsO1xyXG4gICAgICAgIHN3aXRjaCAodGV4dFBvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIGNhc2UnVG9wX0NlbnRlcic6XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICB4OiB0aGlzLnggKyB0aGlzLndpZHRoIC8gMiAtIG1heFdpZHRoIC8gMixcclxuICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLnkgLSBmb250V2lkdGggLyAyIC0gZm9udFdpZHRoICogKHRleHRMaW5lcyAtIDEpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UnVG9wX1JpZ2h0JzpcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0ge3g6IHRoaXMueCArIHRoaXMud2lkdGggLSBtYXhXaWR0aCwgeTogdGhpcy55IC0gZm9udFdpZHRoIC8gMn07XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSdUb3BfTGVmdCc6XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICB4OiB0aGlzLngsXHJcbiAgICAgICAgICAgICAgICAgICAgeTogdGhpcy55IC0gZm9udFdpZHRoIC8gMlxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlJ0JvdHRvbV9SaWdodCc6XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICB4OiB0aGlzLnggKyB0aGlzLndpZHRoIC0gbWF4V2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgKyBmb250V2lkdGhcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSdCb3R0b21fTGVmdCc6XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHt4OiB0aGlzLngsIHk6IHRoaXMueSArIHRoaXMuaGVpZ2h0ICsgZm9udFdpZHRofTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlJ01pZGRsZV9DZW50ZXInOlxyXG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogdGhpcy54ICsgdGhpcy53aWR0aCAvIDIgLSBtYXhXaWR0aCAvIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgLyAyICsgZm9udFdpZHRoIC8gMlxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlJ01pZGRsZV9SaWdodCc6XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICB4OiB0aGlzLnggKyB0aGlzLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IHRoaXMueSArIHRoaXMuaGVpZ2h0IC8gMiArIGZvbnRXaWR0aCAvIDJcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSdNaWRkbGVfTGVmdCc6XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICB4OiB0aGlzLngtbWF4V2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgLyAyICsgZm9udFdpZHRoIC8gMlxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0Oi8vJ0JvdHRvbV9DZW50ZXInXHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICB4OiB0aGlzLnggKyB0aGlzLndpZHRoIC8gMiAtIG1heFdpZHRoIC8gMixcclxuICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCArIGZvbnRXaWR0aFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG51bGwgIT0gdGhpcy50ZXh0T2Zmc2V0WCkge1xyXG4gICAgICAgICAgICBwb3NpdGlvbi54ICs9IHRoaXMudGV4dE9mZnNldFg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChudWxsICE9IHRoaXMudGV4dE9mZnNldFkpIHtcclxuICAgICAgICAgICAgcG9zaXRpb24ueSArPSB0aGlzLnRleHRPZmZzZXRZO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcG9zaXRpb25cclxuICAgIH07XHJcbiAgICBDb250YWluZXIucHJvdG90eXBlLnBhaW50TW91c2VvdmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgfTtcclxuICAgIENvbnRhaW5lci5wcm90b3R5cGUucGFpbnRTZWxlY3RlZCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgYS5zaGFkb3dCbHVyID0gMTA7XHJcbiAgICAgICAgYS5zaGFkb3dDb2xvciA9IFwicmdiYSgwLDAsMCwxKVwiO1xyXG4gICAgICAgIGEuc2hhZG93T2Zmc2V0WCA9IDA7XHJcbiAgICAgICAgYS5zaGFkb3dPZmZzZXRZID0gMDtcclxuICAgIH1cclxufTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9qdG9wby9jb250YWluZXIvY29udGFpbmVyLmpzXG4vLyBtb2R1bGUgaWQgPSA4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==');
},function(module,exports,__webpack_require__){eval('var util = __webpack_require__(1);\r\nmodule.exports = function (jtopo) {\r\n    jtopo.CurveLink = CurveLink;\r\n    function CurveLink(start, end, text) {\r\n        jtopo.Link.apply(this, arguments);\r\n    }\r\n    jtopo.util.inherits(CurveLink,jtopo.Link);\r\n    CurveLink.prototype.paintPath = function (context, path) {\r\n        if (this.nodeA === this.nodeZ)return void this.paintLoop(context);\r\n        var start = path[0];\r\n        var end = path[path.length - 1];\r\n        var middle = path.middle;\r\n        if (start && end && middle) {\r\n            context.beginPath();\r\n            if (this.dashedPattern instanceof Array && this.dashedPattern.length == 2) {\r\n                if (this.dashedPattern[0] > 0 && this.dashedPattern[1] > 0) {\r\n                    context.setLineDash(this.dashedPattern);\r\n                }\r\n            }\r\n            context.moveTo(start.x, start.y);\r\n            context.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")";\r\n            context.lineWidth = this.lineWidth;\r\n            context.moveTo(start.x, start.y);\r\n            context.quadraticCurveTo(middle.x, middle.y, end.x, end.y);\r\n            context.stroke();\r\n            context.closePath();\r\n            if (null != this.arrowsRadius) {\r\n                if (this.qtopo.attr.arrow.end) {\r\n                    this.paintArrow(context, start, end);\r\n                }\r\n                if (this.qtopo.attr.arrow.start) {\r\n                    this.paintArrow(context, end, start);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    CurveLink.prototype.getPath = function () {\r\n        var path = [];\r\n        var start = this.getStartPosition();\r\n        var end = this.getEndPosition();\r\n        if (start && end) {\r\n            if (this.nodeA === this.nodeZ) {\r\n                path.push(start);\r\n                path.push(end);\r\n            } else {\r\n                var angle = Math.atan(Math.abs(end.y - start.y) / Math.abs(end.x - start.x));\r\n                path.middle = {\r\n                    x: (start.x + end.x) / 2 + this.offset * Math.cos(angle - Math.PI / 2),\r\n                    y: (start.y + end.y) / 2 + this.offset * Math.sin(angle - Math.PI / 2)\r\n                };\r\n                path.text = util.makeQuadraticPoint(start, path.middle, end, 1 / 2);\r\n                path.angle = angle;\r\n                path.push(start);\r\n                for (var i = 1; i <= 5; i++) {\r\n                    path.push(util.makeQuadraticPoint(start, path.middle, end, i / 5));//取样份与选取难度相关\r\n                }\r\n                path.push(end);\r\n            }\r\n        }\r\n        return path\r\n    };\r\n    CurveLink.prototype.paintText = function (cx, path) {\r\n        if (this.text && this.text.length > 0) {\r\n            var textX = path.text.x + this.textOffsetX;\r\n            var textY = path.text.y + this.textOffsetY;\r\n            cx.save();\r\n            cx.beginPath();\r\n            cx.font = this.font;\r\n            var totalWidth = cx.measureText(this.text).width;\r\n            var fontWidth = cx.measureText("田").width;\r\n            cx.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n            cx.fillText(this.text, textX - totalWidth / 2, textY - fontWidth / 2);\r\n            cx.stroke();\r\n            cx.closePath();\r\n            cx.restore();\r\n        }\r\n    };\r\n\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vbGluay9DdXJ2ZUxpbmsuanM/M2Q5MSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsUUFBUTtBQUN2Qyx1RkFBdUY7QUFDdkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEiLCJmaWxlIjoiOS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciB1dGlsID0gcmVxdWlyZSgnLi91dGlsLmpzJyk7XHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICBqdG9wby5DdXJ2ZUxpbmsgPSBDdXJ2ZUxpbms7XHJcbiAgICBmdW5jdGlvbiBDdXJ2ZUxpbmsoc3RhcnQsIGVuZCwgdGV4dCkge1xyXG4gICAgICAgIGp0b3BvLkxpbmsuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgIH1cclxuICAgIGp0b3BvLnV0aWwuaW5oZXJpdHMoQ3VydmVMaW5rLGp0b3BvLkxpbmspO1xyXG4gICAgQ3VydmVMaW5rLnByb3RvdHlwZS5wYWludFBhdGggPSBmdW5jdGlvbiAoY29udGV4dCwgcGF0aCkge1xyXG4gICAgICAgIGlmICh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKXJldHVybiB2b2lkIHRoaXMucGFpbnRMb29wKGNvbnRleHQpO1xyXG4gICAgICAgIHZhciBzdGFydCA9IHBhdGhbMF07XHJcbiAgICAgICAgdmFyIGVuZCA9IHBhdGhbcGF0aC5sZW5ndGggLSAxXTtcclxuICAgICAgICB2YXIgbWlkZGxlID0gcGF0aC5taWRkbGU7XHJcbiAgICAgICAgaWYgKHN0YXJ0ICYmIGVuZCAmJiBtaWRkbGUpIHtcclxuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGFzaGVkUGF0dGVybiBpbnN0YW5jZW9mIEFycmF5ICYmIHRoaXMuZGFzaGVkUGF0dGVybi5sZW5ndGggPT0gMikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGFzaGVkUGF0dGVyblswXSA+IDAgJiYgdGhpcy5kYXNoZWRQYXR0ZXJuWzFdID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2V0TGluZURhc2godGhpcy5kYXNoZWRQYXR0ZXJuKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb250ZXh0Lm1vdmVUbyhzdGFydC54LCBzdGFydC55KTtcclxuICAgICAgICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuc3Ryb2tlQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgY29udGV4dC5saW5lV2lkdGggPSB0aGlzLmxpbmVXaWR0aDtcclxuICAgICAgICAgICAgY29udGV4dC5tb3ZlVG8oc3RhcnQueCwgc3RhcnQueSk7XHJcbiAgICAgICAgICAgIGNvbnRleHQucXVhZHJhdGljQ3VydmVUbyhtaWRkbGUueCwgbWlkZGxlLnksIGVuZC54LCBlbmQueSk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IHRoaXMuYXJyb3dzUmFkaXVzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5xdG9wby5hdHRyLmFycm93LmVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFpbnRBcnJvdyhjb250ZXh0LCBzdGFydCwgZW5kKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnF0b3BvLmF0dHIuYXJyb3cuc3RhcnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coY29udGV4dCwgZW5kLCBzdGFydCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQ3VydmVMaW5rLnByb3RvdHlwZS5nZXRQYXRoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBwYXRoID0gW107XHJcbiAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5nZXRTdGFydFBvc2l0aW9uKCk7XHJcbiAgICAgICAgdmFyIGVuZCA9IHRoaXMuZ2V0RW5kUG9zaXRpb24oKTtcclxuICAgICAgICBpZiAoc3RhcnQgJiYgZW5kKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoLnB1c2goc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgcGF0aC5wdXNoKGVuZCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYW5nbGUgPSBNYXRoLmF0YW4oTWF0aC5hYnMoZW5kLnkgLSBzdGFydC55KSAvIE1hdGguYWJzKGVuZC54IC0gc3RhcnQueCkpO1xyXG4gICAgICAgICAgICAgICAgcGF0aC5taWRkbGUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogKHN0YXJ0LnggKyBlbmQueCkgLyAyICsgdGhpcy5vZmZzZXQgKiBNYXRoLmNvcyhhbmdsZSAtIE1hdGguUEkgLyAyKSxcclxuICAgICAgICAgICAgICAgICAgICB5OiAoc3RhcnQueSArIGVuZC55KSAvIDIgKyB0aGlzLm9mZnNldCAqIE1hdGguc2luKGFuZ2xlIC0gTWF0aC5QSSAvIDIpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgcGF0aC50ZXh0ID0gdXRpbC5tYWtlUXVhZHJhdGljUG9pbnQoc3RhcnQsIHBhdGgubWlkZGxlLCBlbmQsIDEgLyAyKTtcclxuICAgICAgICAgICAgICAgIHBhdGguYW5nbGUgPSBhbmdsZTtcclxuICAgICAgICAgICAgICAgIHBhdGgucHVzaChzdGFydCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSA1OyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXRoLnB1c2godXRpbC5tYWtlUXVhZHJhdGljUG9pbnQoc3RhcnQsIHBhdGgubWlkZGxlLCBlbmQsIGkgLyA1KSk7Ly/lj5bmoLfku73kuI7pgInlj5bpmr7luqbnm7jlhbNcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHBhdGgucHVzaChlbmQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXRoXHJcbiAgICB9O1xyXG4gICAgQ3VydmVMaW5rLnByb3RvdHlwZS5wYWludFRleHQgPSBmdW5jdGlvbiAoY3gsIHBhdGgpIHtcclxuICAgICAgICBpZiAodGhpcy50ZXh0ICYmIHRoaXMudGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciB0ZXh0WCA9IHBhdGgudGV4dC54ICsgdGhpcy50ZXh0T2Zmc2V0WDtcclxuICAgICAgICAgICAgdmFyIHRleHRZID0gcGF0aC50ZXh0LnkgKyB0aGlzLnRleHRPZmZzZXRZO1xyXG4gICAgICAgICAgICBjeC5zYXZlKCk7XHJcbiAgICAgICAgICAgIGN4LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICBjeC5mb250ID0gdGhpcy5mb250O1xyXG4gICAgICAgICAgICB2YXIgdG90YWxXaWR0aCA9IGN4Lm1lYXN1cmVUZXh0KHRoaXMudGV4dCkud2lkdGg7XHJcbiAgICAgICAgICAgIHZhciBmb250V2lkdGggPSBjeC5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aDtcclxuICAgICAgICAgICAgY3guZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5mb250Q29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgIGN4LmZpbGxUZXh0KHRoaXMudGV4dCwgdGV4dFggLSB0b3RhbFdpZHRoIC8gMiwgdGV4dFkgLSBmb250V2lkdGggLyAyKTtcclxuICAgICAgICAgICAgY3guc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgIGN4LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICBjeC5yZXN0b3JlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vbGluay9DdXJ2ZUxpbmsuanNcbi8vIG1vZHVsZSBpZCA9IDlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIDIiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports,__webpack_require__){eval('var util = __webpack_require__(1);\r\nmodule.exports = function (jtopo) {\r\n    jtopo.FlexionalLink = FlexionalLink;\r\n    function FlexionalLink(start, end, text) {\r\n        jtopo.Link.apply(this, arguments);\r\n        this.direction = "vertical";\r\n        this.offset = 44;\r\n    }\r\n    jtopo.util.inherits(FlexionalLink, jtopo.Link);\r\n    FlexionalLink.prototype.getStartPosition = function () {\r\n        if(!util.isOverlay(this.nodeA,this.nodeZ)){\r\n            var position = {\r\n                x: this.nodeA.cx,\r\n                y: this.nodeA.cy\r\n            };\r\n            if ("horizontal" == this.direction) {\r\n                if (this.nodeZ.cx < position.x) {\r\n                    position.x = this.nodeA.x;\r\n                } else {\r\n                    position.x = this.nodeA.x + this.nodeA.width\r\n                }\r\n            } else {\r\n                if (this.nodeZ.cy < position.y) {\r\n                    position.y = this.nodeA.y;\r\n                } else {\r\n                    position.y = this.nodeA.y + this.nodeA.height;\r\n                }\r\n            }\r\n            return position;\r\n        }\r\n    };\r\n    FlexionalLink.prototype.getEndPosition = function () {\r\n        var position = {\r\n            x: this.nodeZ.cx,\r\n            y: this.nodeZ.cy\r\n        };\r\n        if ("horizontal" == this.direction) {\r\n            if (this.nodeA.cx < position.x) {\r\n                position.x = this.nodeZ.x;\r\n            } else {\r\n                position.x = this.nodeZ.x + this.nodeZ.width;\r\n            }\r\n        } else {\r\n            if (this.nodeA.cy < position.y) {\r\n                position.y = this.nodeZ.y;\r\n            } else {\r\n                position.y = this.nodeZ.y + this.nodeZ.height;\r\n            }\r\n        }\r\n        return position;\r\n    };\r\n    FlexionalLink.prototype.getPath = function (total) {\r\n        var path = [];\r\n        var start = this.getStartPosition();\r\n        var end = this.getEndPosition();\r\n        if (start && end) {\r\n            if (this.nodeA === this.nodeZ) {\r\n                path.push(start);\r\n                path.push(end);\r\n            }else{\r\n                var totalGap = (total - 1) * this.gap;\r\n                var gap = this.gap * this.nodeIndex - totalGap / 2;\r\n                var linkOffset = this.offset;\r\n                if ("horizontal" == this.direction) {\r\n                    if (this.nodeA.cx > this.nodeZ.cx) {\r\n                        linkOffset = -linkOffset\r\n                    }\r\n                    path.push({x: start.x, y: start.y + gap});\r\n                    path.push({x: start.x + linkOffset, y: start.y + gap});\r\n                    path.push({x: end.x - linkOffset, y: end.y + gap});\r\n                    path.push({x: end.x, y: end.y + gap})\r\n                } else {\r\n                    if (this.nodeA.cy > this.nodeZ.cy) {\r\n                        linkOffset = -linkOffset\r\n                    }\r\n                    path.push({x: start.x + gap, y: start.y});\r\n                    path.push({x: start.x + gap, y: start.y + linkOffset});\r\n                    path.push({x: end.x + gap, y: end.y - linkOffset});\r\n                    path.push({x: end.x + gap, y: end.y});\r\n                }\r\n            }\r\n        }\r\n        return path;\r\n    };\r\n\r\n    function getfixedRight(start, end) {\r\n        //重写线的绘制路径\r\n        var littleSize = 50;\r\n        var startRight = {\r\n            x: start.x + start.width,\r\n            y: start.y + start.height / 2\r\n        };\r\n        var endRight = {\r\n            x: end.x + end.width,\r\n            y: end.y + end.height / 2\r\n        };\r\n        var middleA = {};\r\n        var middleB = {};\r\n        if (startRight.x > endRight.x) {\r\n            middleA.x = startRight.x + littleSize;\r\n            middleA.y = startRight.y;\r\n            middleB.x = startRight.x + littleSize;\r\n            middleB.y = endRight.y;\r\n        } else {\r\n            middleA.x = endRight.x + littleSize;\r\n            middleA.y = startRight.y;\r\n            middleB.x = endRight.x + littleSize;\r\n            middleB.y = endRight.y;\r\n        }\r\n        return [startRight, middleA, middleB, endRight];\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vbGluay9GbGV4aW9uYWxMaW5rLmpzPzgwN2QiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw2QkFBNkI7QUFDNUQsK0JBQStCLDBDQUEwQztBQUN6RSwrQkFBK0Isc0NBQXNDO0FBQ3JFLCtCQUErQix5QkFBeUI7QUFDeEQsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw2QkFBNkI7QUFDNUQsK0JBQStCLDBDQUEwQztBQUN6RSwrQkFBK0Isc0NBQXNDO0FBQ3JFLCtCQUErQix5QkFBeUI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIxMC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciB1dGlsID0gcmVxdWlyZSgnLi91dGlsLmpzJyk7XHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICBqdG9wby5GbGV4aW9uYWxMaW5rID0gRmxleGlvbmFsTGluaztcclxuICAgIGZ1bmN0aW9uIEZsZXhpb25hbExpbmsoc3RhcnQsIGVuZCwgdGV4dCkge1xyXG4gICAgICAgIGp0b3BvLkxpbmsuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IFwidmVydGljYWxcIjtcclxuICAgICAgICB0aGlzLm9mZnNldCA9IDQ0O1xyXG4gICAgfVxyXG4gICAganRvcG8udXRpbC5pbmhlcml0cyhGbGV4aW9uYWxMaW5rLCBqdG9wby5MaW5rKTtcclxuICAgIEZsZXhpb25hbExpbmsucHJvdG90eXBlLmdldFN0YXJ0UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYoIXV0aWwuaXNPdmVybGF5KHRoaXMubm9kZUEsdGhpcy5ub2RlWikpe1xyXG4gICAgICAgICAgICB2YXIgcG9zaXRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICB4OiB0aGlzLm5vZGVBLmN4LFxyXG4gICAgICAgICAgICAgICAgeTogdGhpcy5ub2RlQS5jeVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAoXCJob3Jpem9udGFsXCIgPT0gdGhpcy5kaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vZGVaLmN4IDwgcG9zaXRpb24ueCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLnggPSB0aGlzLm5vZGVBLng7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLnggPSB0aGlzLm5vZGVBLnggKyB0aGlzLm5vZGVBLndpZHRoXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ub2RlWi5jeSA8IHBvc2l0aW9uLnkpIHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi55ID0gdGhpcy5ub2RlQS55O1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi55ID0gdGhpcy5ub2RlQS55ICsgdGhpcy5ub2RlQS5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHBvc2l0aW9uO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBGbGV4aW9uYWxMaW5rLnByb3RvdHlwZS5nZXRFbmRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgcG9zaXRpb24gPSB7XHJcbiAgICAgICAgICAgIHg6IHRoaXMubm9kZVouY3gsXHJcbiAgICAgICAgICAgIHk6IHRoaXMubm9kZVouY3lcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChcImhvcml6b250YWxcIiA9PSB0aGlzLmRpcmVjdGlvbikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5ub2RlQS5jeCA8IHBvc2l0aW9uLngpIHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uLnggPSB0aGlzLm5vZGVaLng7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbi54ID0gdGhpcy5ub2RlWi54ICsgdGhpcy5ub2RlWi53aWR0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBLmN5IDwgcG9zaXRpb24ueSkge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb24ueSA9IHRoaXMubm9kZVoueTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uLnkgPSB0aGlzLm5vZGVaLnkgKyB0aGlzLm5vZGVaLmhlaWdodDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcG9zaXRpb247XHJcbiAgICB9O1xyXG4gICAgRmxleGlvbmFsTGluay5wcm90b3R5cGUuZ2V0UGF0aCA9IGZ1bmN0aW9uICh0b3RhbCkge1xyXG4gICAgICAgIHZhciBwYXRoID0gW107XHJcbiAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5nZXRTdGFydFBvc2l0aW9uKCk7XHJcbiAgICAgICAgdmFyIGVuZCA9IHRoaXMuZ2V0RW5kUG9zaXRpb24oKTtcclxuICAgICAgICBpZiAoc3RhcnQgJiYgZW5kKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoLnB1c2goc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgcGF0aC5wdXNoKGVuZCk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgdmFyIHRvdGFsR2FwID0gKHRvdGFsIC0gMSkgKiB0aGlzLmdhcDtcclxuICAgICAgICAgICAgICAgIHZhciBnYXAgPSB0aGlzLmdhcCAqIHRoaXMubm9kZUluZGV4IC0gdG90YWxHYXAgLyAyO1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpbmtPZmZzZXQgPSB0aGlzLm9mZnNldDtcclxuICAgICAgICAgICAgICAgIGlmIChcImhvcml6b250YWxcIiA9PSB0aGlzLmRpcmVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBLmN4ID4gdGhpcy5ub2RlWi5jeCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5rT2Zmc2V0ID0gLWxpbmtPZmZzZXRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoKHt4OiBzdGFydC54LCB5OiBzdGFydC55ICsgZ2FwfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoKHt4OiBzdGFydC54ICsgbGlua09mZnNldCwgeTogc3RhcnQueSArIGdhcH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaCh7eDogZW5kLnggLSBsaW5rT2Zmc2V0LCB5OiBlbmQueSArIGdhcH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaCh7eDogZW5kLngsIHk6IGVuZC55ICsgZ2FwfSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEuY3kgPiB0aGlzLm5vZGVaLmN5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtPZmZzZXQgPSAtbGlua09mZnNldFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYXRoLnB1c2goe3g6IHN0YXJ0LnggKyBnYXAsIHk6IHN0YXJ0Lnl9KTtcclxuICAgICAgICAgICAgICAgICAgICBwYXRoLnB1c2goe3g6IHN0YXJ0LnggKyBnYXAsIHk6IHN0YXJ0LnkgKyBsaW5rT2Zmc2V0fSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoKHt4OiBlbmQueCArIGdhcCwgeTogZW5kLnkgLSBsaW5rT2Zmc2V0fSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoKHt4OiBlbmQueCArIGdhcCwgeTogZW5kLnl9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcGF0aDtcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0Zml4ZWRSaWdodChzdGFydCwgZW5kKSB7XHJcbiAgICAgICAgLy/ph43lhpnnur/nmoTnu5jliLbot6/lvoRcclxuICAgICAgICB2YXIgbGl0dGxlU2l6ZSA9IDUwO1xyXG4gICAgICAgIHZhciBzdGFydFJpZ2h0ID0ge1xyXG4gICAgICAgICAgICB4OiBzdGFydC54ICsgc3RhcnQud2lkdGgsXHJcbiAgICAgICAgICAgIHk6IHN0YXJ0LnkgKyBzdGFydC5oZWlnaHQgLyAyXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZW5kUmlnaHQgPSB7XHJcbiAgICAgICAgICAgIHg6IGVuZC54ICsgZW5kLndpZHRoLFxyXG4gICAgICAgICAgICB5OiBlbmQueSArIGVuZC5oZWlnaHQgLyAyXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgbWlkZGxlQSA9IHt9O1xyXG4gICAgICAgIHZhciBtaWRkbGVCID0ge307XHJcbiAgICAgICAgaWYgKHN0YXJ0UmlnaHQueCA+IGVuZFJpZ2h0LngpIHtcclxuICAgICAgICAgICAgbWlkZGxlQS54ID0gc3RhcnRSaWdodC54ICsgbGl0dGxlU2l6ZTtcclxuICAgICAgICAgICAgbWlkZGxlQS55ID0gc3RhcnRSaWdodC55O1xyXG4gICAgICAgICAgICBtaWRkbGVCLnggPSBzdGFydFJpZ2h0LnggKyBsaXR0bGVTaXplO1xyXG4gICAgICAgICAgICBtaWRkbGVCLnkgPSBlbmRSaWdodC55O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG1pZGRsZUEueCA9IGVuZFJpZ2h0LnggKyBsaXR0bGVTaXplO1xyXG4gICAgICAgICAgICBtaWRkbGVBLnkgPSBzdGFydFJpZ2h0Lnk7XHJcbiAgICAgICAgICAgIG1pZGRsZUIueCA9IGVuZFJpZ2h0LnggKyBsaXR0bGVTaXplO1xyXG4gICAgICAgICAgICBtaWRkbGVCLnkgPSBlbmRSaWdodC55O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gW3N0YXJ0UmlnaHQsIG1pZGRsZUEsIG1pZGRsZUIsIGVuZFJpZ2h0XTtcclxuICAgIH1cclxufTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9qdG9wby9saW5rL0ZsZXhpb25hbExpbmsuanNcbi8vIG1vZHVsZSBpZCA9IDEwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports,__webpack_require__){eval('var util=__webpack_require__(1);\r\nmodule.exports=function(jtopo){\r\n    jtopo.FoldLink = FoldLink;\r\n    function FoldLink(start, end, text) {\r\n        jtopo.Link.apply(this, arguments);\r\n        this.direction = "horizontal";\r\n    }\r\n    jtopo.util.inherits(FoldLink,jtopo.Link);\r\n    FoldLink.prototype.getStartPosition = function () {\r\n        var position = {\r\n            x: this.nodeA.cx,\r\n            y: this.nodeA.cy\r\n        };\r\n        if ("horizontal" == this.direction) {\r\n            if (this.nodeZ.cx > position.x) {\r\n                position.x += this.nodeA.width / 2;\r\n            } else {\r\n                position.x -= this.nodeA.width / 2;\r\n            }\r\n        } else {\r\n            if (this.nodeZ.cy > position.y) {\r\n                position.y += this.nodeA.height / 2;\r\n            } else {\r\n                position.y -= this.nodeA.height / 2;\r\n            }\r\n        }\r\n        return position;\r\n    };\r\n    FoldLink.prototype.getEndPosition = function () {\r\n        var position = {\r\n            x: this.nodeZ.cx,\r\n            y: this.nodeZ.cy\r\n        };\r\n        if ("horizontal" == this.direction) {\r\n            if (this.nodeA.cy < position.y) {\r\n                position.y -= this.nodeZ.height / 2\r\n            } else {\r\n                position.y += this.nodeZ.height / 2;\r\n            }\r\n        } else {\r\n            if (this.nodeA.cx < position.x) {\r\n                position.x = this.nodeZ.x;\r\n            } else {\r\n                position.x = this.nodeZ.x + this.nodeZ.width;\r\n            }\r\n        }\r\n        return position;\r\n    };\r\n    FoldLink.prototype.getPath = function (total) {\r\n        var start = this.getStartPosition();\r\n        var end = this.getEndPosition();\r\n        if (this.nodeA === this.nodeZ) {\r\n            return [start, end];\r\n        }\r\n        var path = [];\r\n        var middleX;\r\n        var middleY;\r\n        var benginGap = (total - 1) * this.gap;\r\n        var totalGap = this.gap * this.nodeIndex - benginGap / 2;\r\n        if ("horizontal" == this.direction) {\r\n            middleX = end.x + totalGap;\r\n            middleY = start.y - totalGap;\r\n            path.push({x: start.x, y: middleY});\r\n            path.push({x: middleX, y: middleY});\r\n            path.push({x: middleX, y: end.y});\r\n        } else {\r\n            middleX = start.x + totalGap;\r\n            middleY = end.y - totalGap;\r\n            path.push({x: middleX, y: start.y});\r\n            path.push({x: middleX, y: middleY});\r\n            path.push({x: end.x, y: middleY});\r\n        }\r\n        return path\r\n    };\r\n    FoldLink.prototype.paintText = function (context, path) {\r\n        if (this.text && this.text.length > 0) {\r\n            var textStart = path[1];\r\n            var textX = textStart.x + this.textOffsetX;\r\n            var textY = textStart.y + this.textOffsetY;\r\n            context.save();\r\n            context.beginPath();\r\n            context.font = this.font;\r\n            var totalWidth = context.measureText(this.text).width;\r\n            var fontWidth = context.measureText("田").width;\r\n            context.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n            context.fillText(this.text, textX - totalWidth / 2, textY - fontWidth / 2);\r\n            context.stroke();\r\n            context.closePath();\r\n            context.restore();\r\n        }\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vbGluay9Gb2xkTGluay5qcz9kYmNkIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsdUJBQXVCO0FBQzlDLHVCQUF1Qix1QkFBdUI7QUFDOUMsdUJBQXVCLHFCQUFxQjtBQUM1QyxTQUFTO0FBQ1Q7QUFDQTtBQUNBLHVCQUF1Qix1QkFBdUI7QUFDOUMsdUJBQXVCLHVCQUF1QjtBQUM5Qyx1QkFBdUIscUJBQXFCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIxMS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciB1dGlsPXJlcXVpcmUoJy4vdXRpbC5qcycpO1xyXG5tb2R1bGUuZXhwb3J0cz1mdW5jdGlvbihqdG9wbyl7XHJcbiAgICBqdG9wby5Gb2xkTGluayA9IEZvbGRMaW5rO1xyXG4gICAgZnVuY3Rpb24gRm9sZExpbmsoc3RhcnQsIGVuZCwgdGV4dCkge1xyXG4gICAgICAgIGp0b3BvLkxpbmsuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IFwiaG9yaXpvbnRhbFwiO1xyXG4gICAgfVxyXG4gICAganRvcG8udXRpbC5pbmhlcml0cyhGb2xkTGluayxqdG9wby5MaW5rKTtcclxuICAgIEZvbGRMaW5rLnByb3RvdHlwZS5nZXRTdGFydFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBwb3NpdGlvbiA9IHtcclxuICAgICAgICAgICAgeDogdGhpcy5ub2RlQS5jeCxcclxuICAgICAgICAgICAgeTogdGhpcy5ub2RlQS5jeVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKFwiaG9yaXpvbnRhbFwiID09IHRoaXMuZGlyZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGVaLmN4ID4gcG9zaXRpb24ueCkge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb24ueCArPSB0aGlzLm5vZGVBLndpZHRoIC8gMjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uLnggLT0gdGhpcy5ub2RlQS53aWR0aCAvIDI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5ub2RlWi5jeSA+IHBvc2l0aW9uLnkpIHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uLnkgKz0gdGhpcy5ub2RlQS5oZWlnaHQgLyAyO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb24ueSAtPSB0aGlzLm5vZGVBLmhlaWdodCAvIDI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHBvc2l0aW9uO1xyXG4gICAgfTtcclxuICAgIEZvbGRMaW5rLnByb3RvdHlwZS5nZXRFbmRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgcG9zaXRpb24gPSB7XHJcbiAgICAgICAgICAgIHg6IHRoaXMubm9kZVouY3gsXHJcbiAgICAgICAgICAgIHk6IHRoaXMubm9kZVouY3lcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChcImhvcml6b250YWxcIiA9PSB0aGlzLmRpcmVjdGlvbikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5ub2RlQS5jeSA8IHBvc2l0aW9uLnkpIHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uLnkgLT0gdGhpcy5ub2RlWi5oZWlnaHQgLyAyXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbi55ICs9IHRoaXMubm9kZVouaGVpZ2h0IC8gMjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBLmN4IDwgcG9zaXRpb24ueCkge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb24ueCA9IHRoaXMubm9kZVoueDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uLnggPSB0aGlzLm5vZGVaLnggKyB0aGlzLm5vZGVaLndpZHRoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwb3NpdGlvbjtcclxuICAgIH07XHJcbiAgICBGb2xkTGluay5wcm90b3R5cGUuZ2V0UGF0aCA9IGZ1bmN0aW9uICh0b3RhbCkge1xyXG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuZ2V0U3RhcnRQb3NpdGlvbigpO1xyXG4gICAgICAgIHZhciBlbmQgPSB0aGlzLmdldEVuZFBvc2l0aW9uKCk7XHJcbiAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtzdGFydCwgZW5kXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHBhdGggPSBbXTtcclxuICAgICAgICB2YXIgbWlkZGxlWDtcclxuICAgICAgICB2YXIgbWlkZGxlWTtcclxuICAgICAgICB2YXIgYmVuZ2luR2FwID0gKHRvdGFsIC0gMSkgKiB0aGlzLmdhcDtcclxuICAgICAgICB2YXIgdG90YWxHYXAgPSB0aGlzLmdhcCAqIHRoaXMubm9kZUluZGV4IC0gYmVuZ2luR2FwIC8gMjtcclxuICAgICAgICBpZiAoXCJob3Jpem9udGFsXCIgPT0gdGhpcy5kaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgbWlkZGxlWCA9IGVuZC54ICsgdG90YWxHYXA7XHJcbiAgICAgICAgICAgIG1pZGRsZVkgPSBzdGFydC55IC0gdG90YWxHYXA7XHJcbiAgICAgICAgICAgIHBhdGgucHVzaCh7eDogc3RhcnQueCwgeTogbWlkZGxlWX0pO1xyXG4gICAgICAgICAgICBwYXRoLnB1c2goe3g6IG1pZGRsZVgsIHk6IG1pZGRsZVl9KTtcclxuICAgICAgICAgICAgcGF0aC5wdXNoKHt4OiBtaWRkbGVYLCB5OiBlbmQueX0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG1pZGRsZVggPSBzdGFydC54ICsgdG90YWxHYXA7XHJcbiAgICAgICAgICAgIG1pZGRsZVkgPSBlbmQueSAtIHRvdGFsR2FwO1xyXG4gICAgICAgICAgICBwYXRoLnB1c2goe3g6IG1pZGRsZVgsIHk6IHN0YXJ0Lnl9KTtcclxuICAgICAgICAgICAgcGF0aC5wdXNoKHt4OiBtaWRkbGVYLCB5OiBtaWRkbGVZfSk7XHJcbiAgICAgICAgICAgIHBhdGgucHVzaCh7eDogZW5kLngsIHk6IG1pZGRsZVl9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHBhdGhcclxuICAgIH07XHJcbiAgICBGb2xkTGluay5wcm90b3R5cGUucGFpbnRUZXh0ID0gZnVuY3Rpb24gKGNvbnRleHQsIHBhdGgpIHtcclxuICAgICAgICBpZiAodGhpcy50ZXh0ICYmIHRoaXMudGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciB0ZXh0U3RhcnQgPSBwYXRoWzFdO1xyXG4gICAgICAgICAgICB2YXIgdGV4dFggPSB0ZXh0U3RhcnQueCArIHRoaXMudGV4dE9mZnNldFg7XHJcbiAgICAgICAgICAgIHZhciB0ZXh0WSA9IHRleHRTdGFydC55ICsgdGhpcy50ZXh0T2Zmc2V0WTtcclxuICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZm9udCA9IHRoaXMuZm9udDtcclxuICAgICAgICAgICAgdmFyIHRvdGFsV2lkdGggPSBjb250ZXh0Lm1lYXN1cmVUZXh0KHRoaXMudGV4dCkud2lkdGg7XHJcbiAgICAgICAgICAgIHZhciBmb250V2lkdGggPSBjb250ZXh0Lm1lYXN1cmVUZXh0KFwi55SwXCIpLndpZHRoO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxUZXh0KHRoaXMudGV4dCwgdGV4dFggLSB0b3RhbFdpZHRoIC8gMiwgdGV4dFkgLSBmb250V2lkdGggLyAyKTtcclxuICAgICAgICAgICAgY29udGV4dC5zdHJva2UoKTtcclxuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL2xpbmsvRm9sZExpbmsuanNcbi8vIG1vZHVsZSBpZCA9IDExXG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports,__webpack_require__){eval('var util = __webpack_require__(1);\r\nmodule.exports = function (jtopo) {\r\n    jtopo.Link = Link;\r\n    function Link(start, end, text) {\r\n        jtopo.InteractiveElement.call(this);\r\n        this.elementType = "link";\r\n        this.zIndex = jtopo.zIndex_Link;\r\n        this.text = text;\r\n        this.nodeA = start;\r\n        this.nodeZ = end;\r\n        this.expand = false;\r\n        this.childs = 1;\r\n        this.radius = 0;\r\n        this.nodeA && null == this.nodeA.outLinks && (this.nodeA.outLinks = []);\r\n        this.nodeA && null == this.nodeA.inLinks && (this.nodeA.inLinks = []);\r\n        this.nodeZ && null == this.nodeZ.inLinks && (this.nodeZ.inLinks = []);\r\n        this.nodeZ && null == this.nodeZ.outLinks && (this.nodeZ.outLinks = []);\r\n        null != this.nodeA && this.nodeA.outLinks.push(this);\r\n        null != this.nodeZ && this.nodeZ.inLinks.push(this);\r\n        this.caculateIndex();\r\n        this.font = "12px Consolas";\r\n        this.fontColor = "255,255,255";\r\n        this.lineWidth = 2;\r\n        this.lineJoin = "miter";\r\n        this.transformAble = !1;\r\n        this.offset = 20;\r\n        this.gap = 12;\r\n        this.textOffsetX = 0;\r\n        this.textOffsetY = 0;\r\n        this.arrowsRadius = null;\r\n        this.arrowsOffset = 0;\r\n        this.arrowsType = "close";\r\n        this.dashedPattern = [];\r\n        this.path = [];\r\n        var e = "text,font,fontColor,lineWidth,lineJoin".split(",");\r\n        this.serializedProperties = this.serializedProperties.concat(e);\r\n    }\r\n\r\n    jtopo.util.inherits(Link, jtopo.InteractiveElement);\r\n    Link.prototype.hide = function () {\r\n        this.visible = false;\r\n    };\r\n    Link.prototype.show = function () {\r\n        if (this.nodeA.visible && this.nodeZ.visible) {\r\n            this.visible = true;\r\n        }\r\n    };\r\n    Link.prototype.caculateIndex = function () {\r\n        var a = util.getNums(this.nodeA, this.nodeZ);\r\n        if (a > 0) {\r\n            this.nodeIndex = a - 1;\r\n        }\r\n    };\r\n    Link.prototype.removeHandler = function () {\r\n        var a = this;\r\n        this.nodeA && this.nodeA.outLinks && (this.nodeA.outLinks = this.nodeA.outLinks.filter(function (b) {\r\n            return b !== a\r\n        }));\r\n        this.nodeZ && this.nodeZ.inLinks && (this.nodeZ.inLinks = this.nodeZ.inLinks.filter(function (b) {\r\n            return b !== a\r\n        }));\r\n        var b = util.getLinkNotThis(this);\r\n        b.forEach(function (a, b) {\r\n            a.nodeIndex = b\r\n        })\r\n    };\r\n    Link.prototype.getStartPosition = function () {\r\n        return util.getBorderPoint(this.nodeA, this.nodeZ);\r\n    };\r\n    Link.prototype.getEndPosition = function () {\r\n        return util.getBorderPoint(this.nodeZ, this.nodeA);\r\n    };\r\n    Link.prototype.getPath = function (total) {\r\n        var path = [];\r\n        var start = this.getStartPosition();\r\n        var end = this.getEndPosition();\r\n        if (start && end) {\r\n            if ((this.nodeA === this.nodeZ) || 1 == total) {\r\n                path.push(start);\r\n                path.push(end);\r\n            } else {\r\n                path = getPathWidthGap(start, end, this.offset, this.gap, total, this.nodeIndex);\r\n            }\r\n        }\r\n        return path;\r\n    };\r\n    Link.prototype.paintPath = function (context, path) {\r\n        if (path && path.length > 0) {\r\n            var attr = this.qtopo.attr;\r\n            if (this.nodeA === this.nodeZ) {\r\n                return void this.paintLoop(context);\r\n            }\r\n            context.beginPath();\r\n            context.moveTo(path[0].x, path[0].y);\r\n            if (this.dashedPattern instanceof Array && this.dashedPattern.length == 2) {\r\n                if (this.dashedPattern[0] > 0 && this.dashedPattern[1] > 0) {\r\n                    context.setLineDash(this.dashedPattern);\r\n                }\r\n            }\r\n            for (var i = 1; i < path.length; i++) {\r\n                if (this.radius > 0) {\r\n                    if (i < path.length - 1) {\r\n                        context.arcTo(path[i].x, path[i].y, path[i + 1].x, path[i + 1].y, this.radius);//增加折线弧度\r\n                    } else {\r\n                        context.lineTo(path[i].x, path[i].y);\r\n                    }\r\n                } else {\r\n                    context.lineTo(path[i].x, path[i].y);\r\n                }\r\n            }\r\n            context.stroke();\r\n            context.closePath();\r\n            if (null != this.arrowsRadius) {\r\n                if (attr.arrow.end) {//终点箭头\r\n                    this.paintArrow(context, path[path.length - 2], path[path.length - 1]);\r\n                }\r\n                if (attr.arrow.start) {//起点箭头\r\n                    this.paintArrow(context, path[1], path[0]);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Link.prototype.getExpandPath = function () {\r\n        var path = [];\r\n        var start = this.getStartPosition();\r\n        var end = this.getEndPosition();\r\n        if (start && end) {\r\n            for (var i = 0; i < this.childs; i++) {\r\n                path.push(getPathWidthGap(start, end, this.offset, this.gap, this.childs, i));\r\n            }\r\n        }\r\n        return path;\r\n    };\r\n    Link.prototype.paintLoop = function (a) {\r\n        a.beginPath();\r\n        var radius = this.gap * (this.nodeIndex + 1) / 2;\r\n        a.arc(this.nodeA.x, this.nodeA.y, radius, Math.PI / 2, 2 * Math.PI);\r\n        a.stroke();\r\n        a.closePath();\r\n    };\r\n    Link.prototype.paintArrow = function (context, startPoint, endPoint) {\r\n        context.save();\r\n        context.beginPath();\r\n        context.fillStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")";\r\n        switch (this.arrowsType) {\r\n            case\'close\':\r\n                util.linkArrow(context, startPoint, endPoint, this.arrowsRadius, this.arrowsOffset, true);\r\n                break;\r\n            default:\r\n                util.linkArrow(context, startPoint, endPoint, this.arrowsRadius, this.arrowsOffset, false);\r\n                this.arrowsType = \'open\';\r\n        }\r\n        context.closePath();\r\n        context.restore();\r\n    };\r\n    Link.prototype.paint = function (context) {\r\n        var self = this;\r\n        if (null != this.nodeA && null != !this.nodeZ) {\r\n            context.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")";\r\n            context.lineWidth = this.lineWidth;\r\n            var total = util.getNums(this.nodeA, this.nodeZ);\r\n            var linkPath = this.getPath(total);\r\n            if (this.expand) {\r\n                if (total == 1 && this.childs > 1) {\r\n                    this.path = this.getExpandPath();\r\n                    this.path.forEach(function (path) {\r\n                        self.paintPath(context, path);\r\n                    });\r\n                } else {\r\n                    this.expand = false;\r\n                }\r\n            } else {\r\n                this.path = linkPath;\r\n                this.paintPath(context, this.path);\r\n            }\r\n            this.paintText(context, linkPath);\r\n        }\r\n    };\r\n    Link.prototype.paintText = function (context, path) {\r\n        if (path && path.length > 0) {\r\n            var textStart = path[0];\r\n            var textEnd = path[path.length - 1];\r\n            if (4 == path.length) {\r\n                textStart = path[1];\r\n                textEnd = path[2];\r\n            }\r\n            if (this.text && this.text.length > 0) {\r\n                var textX = (textEnd.x + textStart.x) / 2 + this.textOffsetX;\r\n                var textY = (textEnd.y + textStart.y) / 2 + this.textOffsetY;\r\n                context.save();\r\n                context.beginPath();\r\n                context.font = this.font;\r\n                var totalWidth = context.measureText(this.text).width;\r\n                var fontWidth = context.measureText("田").width;\r\n                context.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n                if (this.nodeA === this.nodeZ) {\r\n                    var GAP = this.gap * (this.nodeIndex + 1) / 2;\r\n                    textX = this.nodeA.x + GAP * Math.cos(-(Math.PI / 2 + Math.PI / 4));\r\n                    textY = this.nodeA.y + GAP * Math.sin(-(Math.PI / 2 + Math.PI / 4));\r\n                    context.fillText(this.text, textX, textY);\r\n                } else {\r\n                    context.fillText(this.text, textX - totalWidth / 2, textY - fontWidth / 2);\r\n                }\r\n                context.stroke();\r\n                context.closePath();\r\n                context.restore();\r\n            }\r\n        }\r\n    };\r\n    Link.prototype.paintSelected = function (context) {\r\n        context.shadowBlur = 10;\r\n        context.shadowColor = "rgba(255,255,255,1)";\r\n        context.shadowOffsetX = 0;\r\n        context.shadowOffsetY = 0;\r\n    };\r\n    Link.prototype.isInBound = function (mouseX, mouseY) {\r\n        if (this.nodeA === this.nodeZ) {\r\n            var d = this.gap * (this.nodeIndex + 1) / 2;\r\n            var e = jtopo.util.getDistance(this.nodeA, {\r\n                    x: mouseX,\r\n                    y: mouseY\r\n                }) - d;\r\n            return Math.abs(e) <= 3;\r\n        }\r\n        var inBound = !1;\r\n        if (this.expand && this.childs > 1) {\r\n            inBound = this.path.some(function (path) {\r\n                return pathInBound(path, mouseX, mouseY);\r\n            });\r\n        } else {\r\n            inBound = pathInBound(this.path, mouseX, mouseY);\r\n        }\r\n        return inBound;\r\n    };\r\n    function pathInBound(path, mouseX, mouseY) {\r\n        var inBound = !1;\r\n        for (var i = 1; i < path.length; i++) {\r\n            var start = path[i - 1];\r\n            var end = path[i];\r\n            if (1 == jtopo.util.isPointInLine({x: mouseX, y: mouseY}, start, end)) {\r\n                inBound = !0;\r\n                break;\r\n            }\r\n        }\r\n        return inBound;\r\n    }\r\n\r\n    function getPathWidthGap(start, end, offset, linkGap, total, index) {\r\n        var path = [];\r\n        var tanAngle = Math.atan2(end.y - start.y, end.x - start.x);\r\n        var offsetStart = {\r\n            x: start.x + offset * Math.cos(tanAngle),\r\n            y: start.y + offset * Math.sin(tanAngle)\r\n        };\r\n        var offsetEnd = {\r\n            x: end.x + offset * Math.cos(tanAngle - Math.PI),\r\n            y: end.y + offset * Math.sin(tanAngle - Math.PI)\r\n        };\r\n        var i = tanAngle - Math.PI / 2;\r\n        var j = tanAngle - Math.PI / 2;\r\n        var gap = total * linkGap / 2 - linkGap / 2;\r\n        var beginGap = linkGap * index;\r\n        var firstMiddle = {\r\n            x: offsetStart.x + beginGap * Math.cos(i),\r\n            y: offsetStart.y + beginGap * Math.sin(i)\r\n        };\r\n        var secondMiddle = {\r\n            x: offsetEnd.x + beginGap * Math.cos(j),\r\n            y: offsetEnd.y + beginGap * Math.sin(j)\r\n        };\r\n        firstMiddle = {\r\n            x: firstMiddle.x + gap * Math.cos(i - Math.PI),\r\n            y: firstMiddle.y + gap * Math.sin(i - Math.PI)\r\n        };\r\n        secondMiddle = {\r\n            x: secondMiddle.x + gap * Math.cos(j - Math.PI),\r\n            y: secondMiddle.y + gap * Math.sin(j - Math.PI)\r\n        };\r\n        path.push({\r\n            x: start.x,\r\n            y: start.y\r\n        });\r\n        path.push({\r\n            x: firstMiddle.x,\r\n            y: firstMiddle.y\r\n        });\r\n        path.push({\r\n            x: secondMiddle.x,\r\n            y: secondMiddle.y\r\n        });\r\n        path.push({\r\n            x: end.x,\r\n            y: end.y\r\n        });\r\n        return path;\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vbGluay9MaW5rLmpzP2NhNWYiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixpQkFBaUI7QUFDNUM7QUFDQTtBQUNBLHVHQUF1RztBQUN2RyxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBLHVDQUF1QztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixpQkFBaUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsaUJBQWlCO0FBQ3hDO0FBQ0E7QUFDQSwrQ0FBK0MscUJBQXFCO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EiLCJmaWxlIjoiMTIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdXRpbCA9IHJlcXVpcmUoJy4vdXRpbC5qcycpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChqdG9wbykge1xyXG4gICAganRvcG8uTGluayA9IExpbms7XHJcbiAgICBmdW5jdGlvbiBMaW5rKHN0YXJ0LCBlbmQsIHRleHQpIHtcclxuICAgICAgICBqdG9wby5JbnRlcmFjdGl2ZUVsZW1lbnQuY2FsbCh0aGlzKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnRUeXBlID0gXCJsaW5rXCI7XHJcbiAgICAgICAgdGhpcy56SW5kZXggPSBqdG9wby56SW5kZXhfTGluaztcclxuICAgICAgICB0aGlzLnRleHQgPSB0ZXh0O1xyXG4gICAgICAgIHRoaXMubm9kZUEgPSBzdGFydDtcclxuICAgICAgICB0aGlzLm5vZGVaID0gZW5kO1xyXG4gICAgICAgIHRoaXMuZXhwYW5kID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jaGlsZHMgPSAxO1xyXG4gICAgICAgIHRoaXMucmFkaXVzID0gMDtcclxuICAgICAgICB0aGlzLm5vZGVBICYmIG51bGwgPT0gdGhpcy5ub2RlQS5vdXRMaW5rcyAmJiAodGhpcy5ub2RlQS5vdXRMaW5rcyA9IFtdKTtcclxuICAgICAgICB0aGlzLm5vZGVBICYmIG51bGwgPT0gdGhpcy5ub2RlQS5pbkxpbmtzICYmICh0aGlzLm5vZGVBLmluTGlua3MgPSBbXSk7XHJcbiAgICAgICAgdGhpcy5ub2RlWiAmJiBudWxsID09IHRoaXMubm9kZVouaW5MaW5rcyAmJiAodGhpcy5ub2RlWi5pbkxpbmtzID0gW10pO1xyXG4gICAgICAgIHRoaXMubm9kZVogJiYgbnVsbCA9PSB0aGlzLm5vZGVaLm91dExpbmtzICYmICh0aGlzLm5vZGVaLm91dExpbmtzID0gW10pO1xyXG4gICAgICAgIG51bGwgIT0gdGhpcy5ub2RlQSAmJiB0aGlzLm5vZGVBLm91dExpbmtzLnB1c2godGhpcyk7XHJcbiAgICAgICAgbnVsbCAhPSB0aGlzLm5vZGVaICYmIHRoaXMubm9kZVouaW5MaW5rcy5wdXNoKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuY2FjdWxhdGVJbmRleCgpO1xyXG4gICAgICAgIHRoaXMuZm9udCA9IFwiMTJweCBDb25zb2xhc1wiO1xyXG4gICAgICAgIHRoaXMuZm9udENvbG9yID0gXCIyNTUsMjU1LDI1NVwiO1xyXG4gICAgICAgIHRoaXMubGluZVdpZHRoID0gMjtcclxuICAgICAgICB0aGlzLmxpbmVKb2luID0gXCJtaXRlclwiO1xyXG4gICAgICAgIHRoaXMudHJhbnNmb3JtQWJsZSA9ICExO1xyXG4gICAgICAgIHRoaXMub2Zmc2V0ID0gMjA7XHJcbiAgICAgICAgdGhpcy5nYXAgPSAxMjtcclxuICAgICAgICB0aGlzLnRleHRPZmZzZXRYID0gMDtcclxuICAgICAgICB0aGlzLnRleHRPZmZzZXRZID0gMDtcclxuICAgICAgICB0aGlzLmFycm93c1JhZGl1cyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5hcnJvd3NPZmZzZXQgPSAwO1xyXG4gICAgICAgIHRoaXMuYXJyb3dzVHlwZSA9IFwiY2xvc2VcIjtcclxuICAgICAgICB0aGlzLmRhc2hlZFBhdHRlcm4gPSBbXTtcclxuICAgICAgICB0aGlzLnBhdGggPSBbXTtcclxuICAgICAgICB2YXIgZSA9IFwidGV4dCxmb250LGZvbnRDb2xvcixsaW5lV2lkdGgsbGluZUpvaW5cIi5zcGxpdChcIixcIik7XHJcbiAgICAgICAgdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcyA9IHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuY29uY2F0KGUpO1xyXG4gICAgfVxyXG5cclxuICAgIGp0b3BvLnV0aWwuaW5oZXJpdHMoTGluaywganRvcG8uSW50ZXJhY3RpdmVFbGVtZW50KTtcclxuICAgIExpbmsucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgTGluay5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5ub2RlQS52aXNpYmxlICYmIHRoaXMubm9kZVoudmlzaWJsZSkge1xyXG4gICAgICAgICAgICB0aGlzLnZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBMaW5rLnByb3RvdHlwZS5jYWN1bGF0ZUluZGV4ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhID0gdXRpbC5nZXROdW1zKHRoaXMubm9kZUEsIHRoaXMubm9kZVopO1xyXG4gICAgICAgIGlmIChhID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLm5vZGVJbmRleCA9IGEgLSAxO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBMaW5rLnByb3RvdHlwZS5yZW1vdmVIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhID0gdGhpcztcclxuICAgICAgICB0aGlzLm5vZGVBICYmIHRoaXMubm9kZUEub3V0TGlua3MgJiYgKHRoaXMubm9kZUEub3V0TGlua3MgPSB0aGlzLm5vZGVBLm91dExpbmtzLmZpbHRlcihmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICByZXR1cm4gYiAhPT0gYVxyXG4gICAgICAgIH0pKTtcclxuICAgICAgICB0aGlzLm5vZGVaICYmIHRoaXMubm9kZVouaW5MaW5rcyAmJiAodGhpcy5ub2RlWi5pbkxpbmtzID0gdGhpcy5ub2RlWi5pbkxpbmtzLmZpbHRlcihmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICByZXR1cm4gYiAhPT0gYVxyXG4gICAgICAgIH0pKTtcclxuICAgICAgICB2YXIgYiA9IHV0aWwuZ2V0TGlua05vdFRoaXModGhpcyk7XHJcbiAgICAgICAgYi5mb3JFYWNoKGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIGEubm9kZUluZGV4ID0gYlxyXG4gICAgICAgIH0pXHJcbiAgICB9O1xyXG4gICAgTGluay5wcm90b3R5cGUuZ2V0U3RhcnRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdXRpbC5nZXRCb3JkZXJQb2ludCh0aGlzLm5vZGVBLCB0aGlzLm5vZGVaKTtcclxuICAgIH07XHJcbiAgICBMaW5rLnByb3RvdHlwZS5nZXRFbmRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdXRpbC5nZXRCb3JkZXJQb2ludCh0aGlzLm5vZGVaLCB0aGlzLm5vZGVBKTtcclxuICAgIH07XHJcbiAgICBMaW5rLnByb3RvdHlwZS5nZXRQYXRoID0gZnVuY3Rpb24gKHRvdGFsKSB7XHJcbiAgICAgICAgdmFyIHBhdGggPSBbXTtcclxuICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLmdldFN0YXJ0UG9zaXRpb24oKTtcclxuICAgICAgICB2YXIgZW5kID0gdGhpcy5nZXRFbmRQb3NpdGlvbigpO1xyXG4gICAgICAgIGlmIChzdGFydCAmJiBlbmQpIHtcclxuICAgICAgICAgICAgaWYgKCh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKSB8fCAxID09IHRvdGFsKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoLnB1c2goc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgcGF0aC5wdXNoKGVuZCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoID0gZ2V0UGF0aFdpZHRoR2FwKHN0YXJ0LCBlbmQsIHRoaXMub2Zmc2V0LCB0aGlzLmdhcCwgdG90YWwsIHRoaXMubm9kZUluZGV4KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcGF0aDtcclxuICAgIH07XHJcbiAgICBMaW5rLnByb3RvdHlwZS5wYWludFBhdGggPSBmdW5jdGlvbiAoY29udGV4dCwgcGF0aCkge1xyXG4gICAgICAgIGlmIChwYXRoICYmIHBhdGgubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB2YXIgYXR0ciA9IHRoaXMucXRvcG8uYXR0cjtcclxuICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2b2lkIHRoaXMucGFpbnRMb29wKGNvbnRleHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQubW92ZVRvKHBhdGhbMF0ueCwgcGF0aFswXS55KTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGFzaGVkUGF0dGVybiBpbnN0YW5jZW9mIEFycmF5ICYmIHRoaXMuZGFzaGVkUGF0dGVybi5sZW5ndGggPT0gMikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGFzaGVkUGF0dGVyblswXSA+IDAgJiYgdGhpcy5kYXNoZWRQYXR0ZXJuWzFdID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2V0TGluZURhc2godGhpcy5kYXNoZWRQYXR0ZXJuKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHBhdGgubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJhZGl1cyA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHBhdGgubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmFyY1RvKHBhdGhbaV0ueCwgcGF0aFtpXS55LCBwYXRoW2kgKyAxXS54LCBwYXRoW2kgKyAxXS55LCB0aGlzLnJhZGl1cyk7Ly/lop7liqDmipjnur/lvKfluqZcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbyhwYXRoW2ldLngsIHBhdGhbaV0ueSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbyhwYXRoW2ldLngsIHBhdGhbaV0ueSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29udGV4dC5zdHJva2UoKTtcclxuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5hcnJvd3NSYWRpdXMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChhdHRyLmFycm93LmVuZCkgey8v57uI54K5566t5aS0XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWludEFycm93KGNvbnRleHQsIHBhdGhbcGF0aC5sZW5ndGggLSAyXSwgcGF0aFtwYXRoLmxlbmd0aCAtIDFdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChhdHRyLmFycm93LnN0YXJ0KSB7Ly/otbfngrnnrq3lpLRcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coY29udGV4dCwgcGF0aFsxXSwgcGF0aFswXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgTGluay5wcm90b3R5cGUuZ2V0RXhwYW5kUGF0aCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgcGF0aCA9IFtdO1xyXG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuZ2V0U3RhcnRQb3NpdGlvbigpO1xyXG4gICAgICAgIHZhciBlbmQgPSB0aGlzLmdldEVuZFBvc2l0aW9uKCk7XHJcbiAgICAgICAgaWYgKHN0YXJ0ICYmIGVuZCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY2hpbGRzOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHBhdGgucHVzaChnZXRQYXRoV2lkdGhHYXAoc3RhcnQsIGVuZCwgdGhpcy5vZmZzZXQsIHRoaXMuZ2FwLCB0aGlzLmNoaWxkcywgaSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXRoO1xyXG4gICAgfTtcclxuICAgIExpbmsucHJvdG90eXBlLnBhaW50TG9vcCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgYS5iZWdpblBhdGgoKTtcclxuICAgICAgICB2YXIgcmFkaXVzID0gdGhpcy5nYXAgKiAodGhpcy5ub2RlSW5kZXggKyAxKSAvIDI7XHJcbiAgICAgICAgYS5hcmModGhpcy5ub2RlQS54LCB0aGlzLm5vZGVBLnksIHJhZGl1cywgTWF0aC5QSSAvIDIsIDIgKiBNYXRoLlBJKTtcclxuICAgICAgICBhLnN0cm9rZSgpO1xyXG4gICAgICAgIGEuY2xvc2VQYXRoKCk7XHJcbiAgICB9O1xyXG4gICAgTGluay5wcm90b3R5cGUucGFpbnRBcnJvdyA9IGZ1bmN0aW9uIChjb250ZXh0LCBzdGFydFBvaW50LCBlbmRQb2ludCkge1xyXG4gICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLnN0cm9rZUNvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgc3dpdGNoICh0aGlzLmFycm93c1R5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSdjbG9zZSc6XHJcbiAgICAgICAgICAgICAgICB1dGlsLmxpbmtBcnJvdyhjb250ZXh0LCBzdGFydFBvaW50LCBlbmRQb2ludCwgdGhpcy5hcnJvd3NSYWRpdXMsIHRoaXMuYXJyb3dzT2Zmc2V0LCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgdXRpbC5saW5rQXJyb3coY29udGV4dCwgc3RhcnRQb2ludCwgZW5kUG9pbnQsIHRoaXMuYXJyb3dzUmFkaXVzLCB0aGlzLmFycm93c09mZnNldCwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hcnJvd3NUeXBlID0gJ29wZW4nO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xyXG4gICAgfTtcclxuICAgIExpbmsucHJvdG90eXBlLnBhaW50ID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5ub2RlQSAmJiBudWxsICE9ICF0aGlzLm5vZGVaKSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLnN0cm9rZUNvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgIGNvbnRleHQubGluZVdpZHRoID0gdGhpcy5saW5lV2lkdGg7XHJcbiAgICAgICAgICAgIHZhciB0b3RhbCA9IHV0aWwuZ2V0TnVtcyh0aGlzLm5vZGVBLCB0aGlzLm5vZGVaKTtcclxuICAgICAgICAgICAgdmFyIGxpbmtQYXRoID0gdGhpcy5nZXRQYXRoKHRvdGFsKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZXhwYW5kKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodG90YWwgPT0gMSAmJiB0aGlzLmNoaWxkcyA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhdGggPSB0aGlzLmdldEV4cGFuZFBhdGgoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhdGguZm9yRWFjaChmdW5jdGlvbiAocGF0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnBhaW50UGF0aChjb250ZXh0LCBwYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5leHBhbmQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGF0aCA9IGxpbmtQYXRoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludFBhdGgoY29udGV4dCwgdGhpcy5wYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnBhaW50VGV4dChjb250ZXh0LCBsaW5rUGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIExpbmsucHJvdG90eXBlLnBhaW50VGV4dCA9IGZ1bmN0aW9uIChjb250ZXh0LCBwYXRoKSB7XHJcbiAgICAgICAgaWYgKHBhdGggJiYgcGF0aC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciB0ZXh0U3RhcnQgPSBwYXRoWzBdO1xyXG4gICAgICAgICAgICB2YXIgdGV4dEVuZCA9IHBhdGhbcGF0aC5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgaWYgKDQgPT0gcGF0aC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRleHRTdGFydCA9IHBhdGhbMV07XHJcbiAgICAgICAgICAgICAgICB0ZXh0RW5kID0gcGF0aFsyXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy50ZXh0ICYmIHRoaXMudGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGV4dFggPSAodGV4dEVuZC54ICsgdGV4dFN0YXJ0LngpIC8gMiArIHRoaXMudGV4dE9mZnNldFg7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGV4dFkgPSAodGV4dEVuZC55ICsgdGV4dFN0YXJ0LnkpIC8gMiArIHRoaXMudGV4dE9mZnNldFk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZvbnQgPSB0aGlzLmZvbnQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgdG90YWxXaWR0aCA9IGNvbnRleHQubWVhc3VyZVRleHQodGhpcy50ZXh0KS53aWR0aDtcclxuICAgICAgICAgICAgICAgIHZhciBmb250V2lkdGggPSBjb250ZXh0Lm1lYXN1cmVUZXh0KFwi55SwXCIpLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIEdBUCA9IHRoaXMuZ2FwICogKHRoaXMubm9kZUluZGV4ICsgMSkgLyAyO1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHRYID0gdGhpcy5ub2RlQS54ICsgR0FQICogTWF0aC5jb3MoLShNYXRoLlBJIC8gMiArIE1hdGguUEkgLyA0KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dFkgPSB0aGlzLm5vZGVBLnkgKyBHQVAgKiBNYXRoLnNpbigtKE1hdGguUEkgLyAyICsgTWF0aC5QSSAvIDQpKTtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxUZXh0KHRoaXMudGV4dCwgdGV4dFgsIHRleHRZKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5maWxsVGV4dCh0aGlzLnRleHQsIHRleHRYIC0gdG90YWxXaWR0aCAvIDIsIHRleHRZIC0gZm9udFdpZHRoIC8gMik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIExpbmsucHJvdG90eXBlLnBhaW50U2VsZWN0ZWQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgIGNvbnRleHQuc2hhZG93Qmx1ciA9IDEwO1xyXG4gICAgICAgIGNvbnRleHQuc2hhZG93Q29sb3IgPSBcInJnYmEoMjU1LDI1NSwyNTUsMSlcIjtcclxuICAgICAgICBjb250ZXh0LnNoYWRvd09mZnNldFggPSAwO1xyXG4gICAgICAgIGNvbnRleHQuc2hhZG93T2Zmc2V0WSA9IDA7XHJcbiAgICB9O1xyXG4gICAgTGluay5wcm90b3R5cGUuaXNJbkJvdW5kID0gZnVuY3Rpb24gKG1vdXNlWCwgbW91c2VZKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopIHtcclxuICAgICAgICAgICAgdmFyIGQgPSB0aGlzLmdhcCAqICh0aGlzLm5vZGVJbmRleCArIDEpIC8gMjtcclxuICAgICAgICAgICAgdmFyIGUgPSBqdG9wby51dGlsLmdldERpc3RhbmNlKHRoaXMubm9kZUEsIHtcclxuICAgICAgICAgICAgICAgICAgICB4OiBtb3VzZVgsXHJcbiAgICAgICAgICAgICAgICAgICAgeTogbW91c2VZXHJcbiAgICAgICAgICAgICAgICB9KSAtIGQ7XHJcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmFicyhlKSA8PSAzO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaW5Cb3VuZCA9ICExO1xyXG4gICAgICAgIGlmICh0aGlzLmV4cGFuZCAmJiB0aGlzLmNoaWxkcyA+IDEpIHtcclxuICAgICAgICAgICAgaW5Cb3VuZCA9IHRoaXMucGF0aC5zb21lKGZ1bmN0aW9uIChwYXRoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGF0aEluQm91bmQocGF0aCwgbW91c2VYLCBtb3VzZVkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpbkJvdW5kID0gcGF0aEluQm91bmQodGhpcy5wYXRoLCBtb3VzZVgsIG1vdXNlWSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpbkJvdW5kO1xyXG4gICAgfTtcclxuICAgIGZ1bmN0aW9uIHBhdGhJbkJvdW5kKHBhdGgsIG1vdXNlWCwgbW91c2VZKSB7XHJcbiAgICAgICAgdmFyIGluQm91bmQgPSAhMTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHBhdGgubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gcGF0aFtpIC0gMV07XHJcbiAgICAgICAgICAgIHZhciBlbmQgPSBwYXRoW2ldO1xyXG4gICAgICAgICAgICBpZiAoMSA9PSBqdG9wby51dGlsLmlzUG9pbnRJbkxpbmUoe3g6IG1vdXNlWCwgeTogbW91c2VZfSwgc3RhcnQsIGVuZCkpIHtcclxuICAgICAgICAgICAgICAgIGluQm91bmQgPSAhMDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpbkJvdW5kO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFBhdGhXaWR0aEdhcChzdGFydCwgZW5kLCBvZmZzZXQsIGxpbmtHYXAsIHRvdGFsLCBpbmRleCkge1xyXG4gICAgICAgIHZhciBwYXRoID0gW107XHJcbiAgICAgICAgdmFyIHRhbkFuZ2xlID0gTWF0aC5hdGFuMihlbmQueSAtIHN0YXJ0LnksIGVuZC54IC0gc3RhcnQueCk7XHJcbiAgICAgICAgdmFyIG9mZnNldFN0YXJ0ID0ge1xyXG4gICAgICAgICAgICB4OiBzdGFydC54ICsgb2Zmc2V0ICogTWF0aC5jb3ModGFuQW5nbGUpLFxyXG4gICAgICAgICAgICB5OiBzdGFydC55ICsgb2Zmc2V0ICogTWF0aC5zaW4odGFuQW5nbGUpXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgb2Zmc2V0RW5kID0ge1xyXG4gICAgICAgICAgICB4OiBlbmQueCArIG9mZnNldCAqIE1hdGguY29zKHRhbkFuZ2xlIC0gTWF0aC5QSSksXHJcbiAgICAgICAgICAgIHk6IGVuZC55ICsgb2Zmc2V0ICogTWF0aC5zaW4odGFuQW5nbGUgLSBNYXRoLlBJKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGkgPSB0YW5BbmdsZSAtIE1hdGguUEkgLyAyO1xyXG4gICAgICAgIHZhciBqID0gdGFuQW5nbGUgLSBNYXRoLlBJIC8gMjtcclxuICAgICAgICB2YXIgZ2FwID0gdG90YWwgKiBsaW5rR2FwIC8gMiAtIGxpbmtHYXAgLyAyO1xyXG4gICAgICAgIHZhciBiZWdpbkdhcCA9IGxpbmtHYXAgKiBpbmRleDtcclxuICAgICAgICB2YXIgZmlyc3RNaWRkbGUgPSB7XHJcbiAgICAgICAgICAgIHg6IG9mZnNldFN0YXJ0LnggKyBiZWdpbkdhcCAqIE1hdGguY29zKGkpLFxyXG4gICAgICAgICAgICB5OiBvZmZzZXRTdGFydC55ICsgYmVnaW5HYXAgKiBNYXRoLnNpbihpKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHNlY29uZE1pZGRsZSA9IHtcclxuICAgICAgICAgICAgeDogb2Zmc2V0RW5kLnggKyBiZWdpbkdhcCAqIE1hdGguY29zKGopLFxyXG4gICAgICAgICAgICB5OiBvZmZzZXRFbmQueSArIGJlZ2luR2FwICogTWF0aC5zaW4oailcclxuICAgICAgICB9O1xyXG4gICAgICAgIGZpcnN0TWlkZGxlID0ge1xyXG4gICAgICAgICAgICB4OiBmaXJzdE1pZGRsZS54ICsgZ2FwICogTWF0aC5jb3MoaSAtIE1hdGguUEkpLFxyXG4gICAgICAgICAgICB5OiBmaXJzdE1pZGRsZS55ICsgZ2FwICogTWF0aC5zaW4oaSAtIE1hdGguUEkpXHJcbiAgICAgICAgfTtcclxuICAgICAgICBzZWNvbmRNaWRkbGUgPSB7XHJcbiAgICAgICAgICAgIHg6IHNlY29uZE1pZGRsZS54ICsgZ2FwICogTWF0aC5jb3MoaiAtIE1hdGguUEkpLFxyXG4gICAgICAgICAgICB5OiBzZWNvbmRNaWRkbGUueSArIGdhcCAqIE1hdGguc2luKGogLSBNYXRoLlBJKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcGF0aC5wdXNoKHtcclxuICAgICAgICAgICAgeDogc3RhcnQueCxcclxuICAgICAgICAgICAgeTogc3RhcnQueVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHBhdGgucHVzaCh7XHJcbiAgICAgICAgICAgIHg6IGZpcnN0TWlkZGxlLngsXHJcbiAgICAgICAgICAgIHk6IGZpcnN0TWlkZGxlLnlcclxuICAgICAgICB9KTtcclxuICAgICAgICBwYXRoLnB1c2goe1xyXG4gICAgICAgICAgICB4OiBzZWNvbmRNaWRkbGUueCxcclxuICAgICAgICAgICAgeTogc2Vjb25kTWlkZGxlLnlcclxuICAgICAgICB9KTtcclxuICAgICAgICBwYXRoLnB1c2goe1xyXG4gICAgICAgICAgICB4OiBlbmQueCxcclxuICAgICAgICAgICAgeTogZW5kLnlcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcGF0aDtcclxuICAgIH1cclxufTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9qdG9wby9saW5rL0xpbmsuanNcbi8vIG1vZHVsZSBpZCA9IDEyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==');
},function(module,exports){eval('/**\r\n * Created by qiyc on 2017/4/12.\r\n */\r\n\r\nvar JTopo = {\r\n    version: "0.4.8_01",\r\n    zIndex_Container: 1,\r\n    zIndex_Link: 2,\r\n    zIndex_Node: 3,\r\n    SceneMode: {normal: "normal", drag: "drag", edit: "edit", select: "select"}\r\n};\r\nmodule.exports = JTopo;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vbWFpbi5qcz83NjBlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0EiLCJmaWxlIjoiMTMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBxaXljIG9uIDIwMTcvNC8xMi5cclxuICovXHJcblxyXG52YXIgSlRvcG8gPSB7XHJcbiAgICB2ZXJzaW9uOiBcIjAuNC44XzAxXCIsXHJcbiAgICB6SW5kZXhfQ29udGFpbmVyOiAxLFxyXG4gICAgekluZGV4X0xpbms6IDIsXHJcbiAgICB6SW5kZXhfTm9kZTogMyxcclxuICAgIFNjZW5lTW9kZToge25vcm1hbDogXCJub3JtYWxcIiwgZHJhZzogXCJkcmFnXCIsIGVkaXQ6IFwiZWRpdFwiLCBzZWxlY3Q6IFwic2VsZWN0XCJ9XHJcbn07XHJcbm1vZHVsZS5leHBvcnRzID0gSlRvcG87XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vbWFpbi5qc1xuLy8gbW9kdWxlIGlkID0gMTNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIDIiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports){eval('module.exports=function(jtopo){\r\n    jtopo.AnimateNode = AnimateNode;\r\n    function AnimateNode() {\r\n        var node = null;\r\n        if (arguments.length <= 3) {\r\n            node = new ImagesNode(arguments[0], arguments[1], arguments[2]);\r\n        } else {\r\n            node = new OneImageGif(arguments[0], arguments[1], arguments[2], arguments[3], arguments[4], arguments[5]);\r\n        }\r\n        node.stop = function () {\r\n            node.isStop = !0\r\n        };\r\n        node.play = function () {\r\n            node.isStop = !1;\r\n            node.frameIndex = 0;\r\n            node.nextFrame();\r\n        };\r\n        return node\r\n    }\r\n    function ImagesNode(frameImages, times, asImageSize) {\r\n        jtopo.Node.apply(this);\r\n        this.frameImages = frameImages || [];\r\n        this.frameIndex = 0;\r\n        this.isStop = !0;\r\n        this.times=times || 1e3;\r\n        this.repeatPlay = !1;\r\n        this.asImageSize=asImageSize;\r\n    }\r\n    jtopo.util.inherits(ImagesNode,jtopo.Node);\r\n    ImagesNode.prototype.nextFrame = function () {\r\n        var self = this;\r\n        if (!this.isStop && null != this.frameImages.length) {\r\n            this.frameIndex++;\r\n            if (this.frameIndex >= this.frameImages.length) {\r\n                if (!this.repeatPlay){\r\n                    return;\r\n                }\r\n                this.frameIndex = 0;\r\n            }\r\n            this.setImage(this.frameImages[this.frameIndex], this.asImageSize);\r\n            setTimeout(function () {\r\n                self.nextFrame();\r\n            }, self.times /self.frameImages.length);\r\n        }\r\n    };\r\n\r\n    // 1行4列，1000毫秒播放一轮，行偏移量\r\n    function OneImageGif(image, rows, columns, times, rowOffset) {\r\n        jtopo.Node.apply(this,arguments);\r\n        this.setImage(image);\r\n        this.frameIndex = 0;\r\n        this.isPause = !0;\r\n        this.repeatPlay = !1;\r\n        this.times = times || 1e3;\r\n        this.rowOffset = rowOffset || 0;\r\n        this.rows=rows;\r\n        this.columns=columns;\r\n    }\r\n    jtopo.util.inherits(OneImageGif,jtopo.Node);\r\n    OneImageGif.prototype.paint = function (context) {\r\n        if (this.image) {\r\n            var width = this.width;\r\n            var height = this.height;\r\n            context.save();\r\n            context.beginPath();\r\n            context.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n            var y = (Math.floor(this.frameIndex / this.columns) + this.rowOffset) * height;\r\n            var x = Math.floor(this.frameIndex % this.columns) * width;\r\n            context.drawImage(this.image, x, y, width, height, -width / 2, -height / 2, width, height);\r\n            context.fill();\r\n            context.closePath();\r\n            context.restore();\r\n            this.paintText(context);\r\n            this.paintBorder(context);\r\n            this.paintCtrl(context);\r\n            this.paintAlarmText(context);\r\n        }\r\n    };\r\n    OneImageGif.prototype.nextFrame = function () {\r\n        var self = this;\r\n        if (!this.isStop) {\r\n            this.frameIndex++;\r\n            if (this.frameIndex >= this.rows * this.columns) {\r\n                if (!this.repeatPlay){\r\n                    return;\r\n                }\r\n                this.frameIndex = 0\r\n            }\r\n            setTimeout(function () {\r\n                if(!self.isStop){\r\n                    self.nextFrame();\r\n                }\r\n            }, self.times / (self.rows * self.columns))\r\n        }\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vbm9kZS9BbmltYXRlTm9kZS5qcz83M2QyIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBIiwiZmlsZSI6IjE0LmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHM9ZnVuY3Rpb24oanRvcG8pe1xyXG4gICAganRvcG8uQW5pbWF0ZU5vZGUgPSBBbmltYXRlTm9kZTtcclxuICAgIGZ1bmN0aW9uIEFuaW1hdGVOb2RlKCkge1xyXG4gICAgICAgIHZhciBub2RlID0gbnVsbDtcclxuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8PSAzKSB7XHJcbiAgICAgICAgICAgIG5vZGUgPSBuZXcgSW1hZ2VzTm9kZShhcmd1bWVudHNbMF0sIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBub2RlID0gbmV3IE9uZUltYWdlR2lmKGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0sIGFyZ3VtZW50c1szXSwgYXJndW1lbnRzWzRdLCBhcmd1bWVudHNbNV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBub2RlLnN0b3AgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIG5vZGUuaXNTdG9wID0gITBcclxuICAgICAgICB9O1xyXG4gICAgICAgIG5vZGUucGxheSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbm9kZS5pc1N0b3AgPSAhMTtcclxuICAgICAgICAgICAgbm9kZS5mcmFtZUluZGV4ID0gMDtcclxuICAgICAgICAgICAgbm9kZS5uZXh0RnJhbWUoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBub2RlXHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBJbWFnZXNOb2RlKGZyYW1lSW1hZ2VzLCB0aW1lcywgYXNJbWFnZVNpemUpIHtcclxuICAgICAgICBqdG9wby5Ob2RlLmFwcGx5KHRoaXMpO1xyXG4gICAgICAgIHRoaXMuZnJhbWVJbWFnZXMgPSBmcmFtZUltYWdlcyB8fCBbXTtcclxuICAgICAgICB0aGlzLmZyYW1lSW5kZXggPSAwO1xyXG4gICAgICAgIHRoaXMuaXNTdG9wID0gITA7XHJcbiAgICAgICAgdGhpcy50aW1lcz10aW1lcyB8fCAxZTM7XHJcbiAgICAgICAgdGhpcy5yZXBlYXRQbGF5ID0gITE7XHJcbiAgICAgICAgdGhpcy5hc0ltYWdlU2l6ZT1hc0ltYWdlU2l6ZTtcclxuICAgIH1cclxuICAgIGp0b3BvLnV0aWwuaW5oZXJpdHMoSW1hZ2VzTm9kZSxqdG9wby5Ob2RlKTtcclxuICAgIEltYWdlc05vZGUucHJvdG90eXBlLm5leHRGcmFtZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcCAmJiBudWxsICE9IHRoaXMuZnJhbWVJbWFnZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZnJhbWVJbmRleCsrO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5mcmFtZUluZGV4ID49IHRoaXMuZnJhbWVJbWFnZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucmVwZWF0UGxheSl7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5mcmFtZUluZGV4ID0gMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNldEltYWdlKHRoaXMuZnJhbWVJbWFnZXNbdGhpcy5mcmFtZUluZGV4XSwgdGhpcy5hc0ltYWdlU2l6ZSk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5uZXh0RnJhbWUoKTtcclxuICAgICAgICAgICAgfSwgc2VsZi50aW1lcyAvc2VsZi5mcmFtZUltYWdlcy5sZW5ndGgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gMeihjDTliJfvvIwxMDAw5q+r56eS5pKt5pS+5LiA6L2u77yM6KGM5YGP56e76YePXHJcbiAgICBmdW5jdGlvbiBPbmVJbWFnZUdpZihpbWFnZSwgcm93cywgY29sdW1ucywgdGltZXMsIHJvd09mZnNldCkge1xyXG4gICAgICAgIGp0b3BvLk5vZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO1xyXG4gICAgICAgIHRoaXMuc2V0SW1hZ2UoaW1hZ2UpO1xyXG4gICAgICAgIHRoaXMuZnJhbWVJbmRleCA9IDA7XHJcbiAgICAgICAgdGhpcy5pc1BhdXNlID0gITA7XHJcbiAgICAgICAgdGhpcy5yZXBlYXRQbGF5ID0gITE7XHJcbiAgICAgICAgdGhpcy50aW1lcyA9IHRpbWVzIHx8IDFlMztcclxuICAgICAgICB0aGlzLnJvd09mZnNldCA9IHJvd09mZnNldCB8fCAwO1xyXG4gICAgICAgIHRoaXMucm93cz1yb3dzO1xyXG4gICAgICAgIHRoaXMuY29sdW1ucz1jb2x1bW5zO1xyXG4gICAgfVxyXG4gICAganRvcG8udXRpbC5pbmhlcml0cyhPbmVJbWFnZUdpZixqdG9wby5Ob2RlKTtcclxuICAgIE9uZUltYWdlR2lmLnByb3RvdHlwZS5wYWludCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaW1hZ2UpIHtcclxuICAgICAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDtcclxuICAgICAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaGVpZ2h0O1xyXG4gICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcclxuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZpbGxDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICB2YXIgeSA9IChNYXRoLmZsb29yKHRoaXMuZnJhbWVJbmRleCAvIHRoaXMuY29sdW1ucykgKyB0aGlzLnJvd09mZnNldCkgKiBoZWlnaHQ7XHJcbiAgICAgICAgICAgIHZhciB4ID0gTWF0aC5mbG9vcih0aGlzLmZyYW1lSW5kZXggJSB0aGlzLmNvbHVtbnMpICogd2lkdGg7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKHRoaXMuaW1hZ2UsIHgsIHksIHdpZHRoLCBoZWlnaHQsIC13aWR0aCAvIDIsIC1oZWlnaHQgLyAyLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAgICAgY29udGV4dC5maWxsKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50VGV4dChjb250ZXh0KTtcclxuICAgICAgICAgICAgdGhpcy5wYWludEJvcmRlcihjb250ZXh0KTtcclxuICAgICAgICAgICAgdGhpcy5wYWludEN0cmwoY29udGV4dCk7XHJcbiAgICAgICAgICAgIHRoaXMucGFpbnRBbGFybVRleHQoY29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE9uZUltYWdlR2lmLnByb3RvdHlwZS5uZXh0RnJhbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGlmICghdGhpcy5pc1N0b3ApIHtcclxuICAgICAgICAgICAgdGhpcy5mcmFtZUluZGV4Kys7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmZyYW1lSW5kZXggPj0gdGhpcy5yb3dzICogdGhpcy5jb2x1bW5zKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucmVwZWF0UGxheSl7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5mcmFtZUluZGV4ID0gMFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYoIXNlbGYuaXNTdG9wKXtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLm5leHRGcmFtZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBzZWxmLnRpbWVzIC8gKHNlbGYucm93cyAqIHNlbGYuY29sdW1ucykpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL25vZGUvQW5pbWF0ZU5vZGUuanNcbi8vIG1vZHVsZSBpZCA9IDE0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports){eval('module.exports = function (jtopo) {\r\n    jtopo.CircleNode = CircleNode;\r\n    function CircleNode(text) {\r\n        jtopo.Node.apply(this, arguments);\r\n        this._radius = 20;\r\n        this.beginDegree = 0;\r\n        this.endDegree = 2 * Math.PI;\r\n        this.text = text;\r\n    }\r\n    jtopo.util.inherits(CircleNode, jtopo.Node);\r\n    Object.defineProperties(\r\n        CircleNode.prototype,\r\n        {\r\n            radius: {\r\n                get: function () {\r\n                    return this._radius\r\n                },\r\n                set: function (a) {\r\n                    this._radius = a;\r\n                    var b = 2 * this.radius;\r\n                    var c = 2 * this.radius;\r\n                    this.width = b;\r\n                    this.height = c;\r\n                }\r\n            },\r\n            width: {\r\n                get: function () {\r\n                    return this._width\r\n                },\r\n                set: function (a) {\r\n                    this._radius = a / 2;\r\n                    this._width = a;\r\n                }\r\n            },\r\n            height: {\r\n                get: function () {\r\n                    return this._height;\r\n                },\r\n                set: function (a) {\r\n                    this._radius = a / 2;\r\n                    this._height = a;\r\n                }\r\n            }\r\n        }\r\n    );\r\n    CircleNode.prototype.paint = function (context) {\r\n        context.save();\r\n        context.beginPath();\r\n        context.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n        context.arc(0, 0, this.radius, this.beginDegree, this.endDegree, !0);\r\n        context.fill();\r\n        context.closePath();\r\n        context.restore();\r\n        this.paintText(context);\r\n        this.paintBorder(context);\r\n        this.paintCtrl(context);\r\n        this.paintAlarmText(context);\r\n    };\r\n    CircleNode.prototype.paintSelected = function (context) {\r\n        context.save();\r\n        context.beginPath();\r\n        context.strokeStyle = "rgba(168,202,255, 0.9)";\r\n        context.fillStyle = "rgba(168,202,236,0.7)";\r\n        context.arc(0, 0, this.radius + 3, this.beginDegree, this.endDegree, !0);\r\n        context.fill();\r\n        context.stroke();\r\n        context.closePath();\r\n        context.restore();\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vbm9kZS9DaXJjbGVOb2RlLmpzP2ExZDAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjE1LmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoanRvcG8pIHtcclxuICAgIGp0b3BvLkNpcmNsZU5vZGUgPSBDaXJjbGVOb2RlO1xyXG4gICAgZnVuY3Rpb24gQ2lyY2xlTm9kZSh0ZXh0KSB7XHJcbiAgICAgICAganRvcG8uTm9kZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgIHRoaXMuX3JhZGl1cyA9IDIwO1xyXG4gICAgICAgIHRoaXMuYmVnaW5EZWdyZWUgPSAwO1xyXG4gICAgICAgIHRoaXMuZW5kRGVncmVlID0gMiAqIE1hdGguUEk7XHJcbiAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDtcclxuICAgIH1cclxuICAgIGp0b3BvLnV0aWwuaW5oZXJpdHMoQ2lyY2xlTm9kZSwganRvcG8uTm9kZSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhcclxuICAgICAgICBDaXJjbGVOb2RlLnByb3RvdHlwZSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJhZGl1czoge1xyXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JhZGl1c1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yYWRpdXMgPSBhO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBiID0gMiAqIHRoaXMucmFkaXVzO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0gMiAqIHRoaXMucmFkaXVzO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSBiO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gYztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgd2lkdGg6IHtcclxuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl93aWR0aFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yYWRpdXMgPSBhIC8gMjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl93aWR0aCA9IGE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGhlaWdodDoge1xyXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2hlaWdodDtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmFkaXVzID0gYSAvIDI7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGVpZ2h0ID0gYTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICk7XHJcbiAgICBDaXJjbGVOb2RlLnByb3RvdHlwZS5wYWludCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgY29udGV4dC5zYXZlKCk7XHJcbiAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZmlsbENvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgY29udGV4dC5hcmMoMCwgMCwgdGhpcy5yYWRpdXMsIHRoaXMuYmVnaW5EZWdyZWUsIHRoaXMuZW5kRGVncmVlLCAhMCk7XHJcbiAgICAgICAgY29udGV4dC5maWxsKCk7XHJcbiAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcclxuICAgICAgICB0aGlzLnBhaW50VGV4dChjb250ZXh0KTtcclxuICAgICAgICB0aGlzLnBhaW50Qm9yZGVyKGNvbnRleHQpO1xyXG4gICAgICAgIHRoaXMucGFpbnRDdHJsKGNvbnRleHQpO1xyXG4gICAgICAgIHRoaXMucGFpbnRBbGFybVRleHQoY29udGV4dCk7XHJcbiAgICB9O1xyXG4gICAgQ2lyY2xlTm9kZS5wcm90b3R5cGUucGFpbnRTZWxlY3RlZCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgY29udGV4dC5zYXZlKCk7XHJcbiAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gXCJyZ2JhKDE2OCwyMDIsMjU1LCAwLjkpXCI7XHJcbiAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBcInJnYmEoMTY4LDIwMiwyMzYsMC43KVwiO1xyXG4gICAgICAgIGNvbnRleHQuYXJjKDAsIDAsIHRoaXMucmFkaXVzICsgMywgdGhpcy5iZWdpbkRlZ3JlZSwgdGhpcy5lbmREZWdyZWUsICEwKTtcclxuICAgICAgICBjb250ZXh0LmZpbGwoKTtcclxuICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XHJcbiAgICB9XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vbm9kZS9DaXJjbGVOb2RlLmpzXG4vLyBtb2R1bGUgaWQgPSAxNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAgMiJdLCJzb3VyY2VSb290IjoiIn0=')},function(module,exports){eval('module.exports=function(jtopo){\r\n    jtopo.LinkNode = LinkNode;\r\n    function LinkNode(text, href, target) {\r\n        jtopo.TextNode.apply(this,arguments);\r\n        this.text = text;\r\n        this.href = href;\r\n        this.target = target;\r\n        this.elementType = "LinkNode";\r\n        this.isVisited = !1;\r\n        this.visitedColor = null;\r\n        this.click(function () {\r\n            "_blank" == this.target ? window.open(this.href) : location = this.href;\r\n            this.isVisited = !0;\r\n        });\r\n    }\r\n    jtopo.util.inherits(LinkNode,jtopo.TextNode);\r\n    LinkNode.prototype.paint = function (context) {\r\n        context.beginPath();\r\n        context.font = this.font;\r\n        this.width = context.measureText(this.text).width;\r\n        this.height = context.measureText("田").width;\r\n        if (this.isVisited && null != this.visitedColor) {\r\n            context.strokeStyle = "rgba(" + this.visitedColor + ", " + this.alpha + ")";\r\n            context.fillStyle = "rgba(" + this.visitedColor + ", " + this.alpha + ")";\r\n        } else {\r\n            context.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n            context.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n        }\r\n        context.fillText(this.text, -this.width / 2, this.height / 2);\r\n        if (this.isMouseOver) {\r\n            context.moveTo(-this.width / 2, this.height);\r\n            context.lineTo(this.width / 2, this.height);\r\n            context.stroke();\r\n        }\r\n        context.closePath();\r\n        this.paintBorder(context);\r\n        this.paintCtrl(context);\r\n        this.paintAlarmText(context);\r\n    };\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vbm9kZS9MaW5rTm9kZS5qcz8xMjFhIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIxNi5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzPWZ1bmN0aW9uKGp0b3BvKXtcclxuICAgIGp0b3BvLkxpbmtOb2RlID0gTGlua05vZGU7XHJcbiAgICBmdW5jdGlvbiBMaW5rTm9kZSh0ZXh0LCBocmVmLCB0YXJnZXQpIHtcclxuICAgICAgICBqdG9wby5UZXh0Tm9kZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7XHJcbiAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDtcclxuICAgICAgICB0aGlzLmhyZWYgPSBocmVmO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgICAgIHRoaXMuZWxlbWVudFR5cGUgPSBcIkxpbmtOb2RlXCI7XHJcbiAgICAgICAgdGhpcy5pc1Zpc2l0ZWQgPSAhMTtcclxuICAgICAgICB0aGlzLnZpc2l0ZWRDb2xvciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIFwiX2JsYW5rXCIgPT0gdGhpcy50YXJnZXQgPyB3aW5kb3cub3Blbih0aGlzLmhyZWYpIDogbG9jYXRpb24gPSB0aGlzLmhyZWY7XHJcbiAgICAgICAgICAgIHRoaXMuaXNWaXNpdGVkID0gITA7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBqdG9wby51dGlsLmluaGVyaXRzKExpbmtOb2RlLGp0b3BvLlRleHROb2RlKTtcclxuICAgIExpbmtOb2RlLnByb3RvdHlwZS5wYWludCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICBjb250ZXh0LmZvbnQgPSB0aGlzLmZvbnQ7XHJcbiAgICAgICAgdGhpcy53aWR0aCA9IGNvbnRleHQubWVhc3VyZVRleHQodGhpcy50ZXh0KS53aWR0aDtcclxuICAgICAgICB0aGlzLmhlaWdodCA9IGNvbnRleHQubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNWaXNpdGVkICYmIG51bGwgIT0gdGhpcy52aXNpdGVkQ29sb3IpIHtcclxuICAgICAgICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMudmlzaXRlZENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMudmlzaXRlZENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29udGV4dC5maWxsVGV4dCh0aGlzLnRleHQsIC10aGlzLndpZHRoIC8gMiwgdGhpcy5oZWlnaHQgLyAyKTtcclxuICAgICAgICBpZiAodGhpcy5pc01vdXNlT3Zlcikge1xyXG4gICAgICAgICAgICBjb250ZXh0Lm1vdmVUbygtdGhpcy53aWR0aCAvIDIsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgY29udGV4dC5saW5lVG8odGhpcy53aWR0aCAvIDIsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgY29udGV4dC5zdHJva2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICB0aGlzLnBhaW50Qm9yZGVyKGNvbnRleHQpO1xyXG4gICAgICAgIHRoaXMucGFpbnRDdHJsKGNvbnRleHQpO1xyXG4gICAgICAgIHRoaXMucGFpbnRBbGFybVRleHQoY29udGV4dCk7XHJcbiAgICB9O1xyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL25vZGUvTGlua05vZGUuanNcbi8vIG1vZHVsZSBpZCA9IDE2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports){eval('module.exports = function (jtopo) {\r\n    jtopo.Node = Node;\r\n    function Node(text) {\r\n        jtopo.EditableElement.call(this);\r\n        this.elementType = "node";\r\n        this.zIndex = jtopo.zIndex_Node;\r\n        this.text = text;\r\n        this.font = "12px Consolas";\r\n        this.fontColor = "255,255,255";\r\n        this.borderWidth = 0;\r\n        this.borderColor = "255,255,255";\r\n        this.borderRadius = null;\r\n        this.draggable = !0;\r\n        this.textPosition = "Bottom_Center";\r\n        this.textOffsetX = 0;\r\n        this.textOffsetY = 0;\r\n        this.transformAble = !0;\r\n        var d = "text,font,fontColor,textPosition,textOffsetX,textOffsetY,borderRadius".split(",");\r\n        this.serializedProperties = this.serializedProperties.concat(d);\r\n    }\r\n\r\n    jtopo.util.inherits(Node, jtopo.EditableElement);\r\n    Object.defineProperties(Node.prototype, {\r\n        alarmColor: {\r\n            get: function () {\r\n                return this._alarmColor;\r\n            },\r\n            set: function (color) {\r\n                this._alarmColor = color;\r\n                if (null != this.image) {\r\n                    var c = jtopo.util.genImageAlarm(this.image, color);\r\n                    if (c) {\r\n                        this.alarmImage = c;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    });\r\n    function toggle(arr,str){\r\n        if(arr instanceof Array){\r\n            arr.forEach(function(link){\r\n                link[str]();\r\n            });\r\n        }\r\n    }\r\n    Node.prototype.hide = function () {\r\n        this.visible = false;\r\n        toggle(this.inLinks,"hide");\r\n        toggle(this.outLinks,"hide");\r\n    };\r\n    Node.prototype.show = function () {\r\n        this.visible = true;\r\n        toggle(this.inLinks,"show");\r\n        toggle(this.outLinks,"show");\r\n    };\r\n    //自定义新增,启用告警后每次绘画执行修改阴影\r\n    Node.prototype.paintAlarmFlash = function (context) {\r\n        if (this.shadow == 1 && this.allowAlarmFlash == 1) {\r\n            if (this.shadowDirection == null) {\r\n                this.shadowDirection = true;\r\n            }\r\n            move(this);\r\n            context.shadowBlur = this.shadowBlur;\r\n            function move(node) {\r\n                if (node.shadowDirection) {\r\n                    node.shadowBlur += 5;\r\n                    if (node.shadowBlur > 100) {\r\n                        node.shadowDirection = false;\r\n                    }\r\n                }\r\n                else {\r\n                    node.shadowBlur -= 5;\r\n                    if (node.shadowBlur <= 10) {\r\n                        node.shadowDirection = true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Node.prototype.paint = function (context) {\r\n        this.paintAlarmFlash(context);\r\n        if (this.image) {\r\n            var gobalAlpha = context.globalAlpha;\r\n            context.globalAlpha = this.alpha;\r\n            if (null != this.alarmImage && null != this.alarm) {\r\n                context.drawImage(this.alarmImage, -this.width / 2, -this.height / 2, this.width, this.height)\r\n            } else {\r\n                context.drawImage(this.image, -this.width / 2, -this.height / 2, this.width, this.height)\r\n            }\r\n            context.globalAlpha = gobalAlpha;\r\n        } else {\r\n            if (null == this.borderRadius || 0 == this.borderRadius) {\r\n                context.beginPath();\r\n                context.rect(-this.width / 2, -this.height / 2, this.width, this.height);\r\n                context.closePath();\r\n            } else {\r\n                context._roundRect(-this.width / 2, -this.height / 2, this.width, this.height, this.borderRadius);\r\n            }\r\n            context.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n            context.fill();\r\n        }\r\n        this.paintBorder(context);\r\n        this.paintText(context);\r\n        this.paintCtrl(context);\r\n        this.paintAlarmText(context);\r\n    };\r\n    Node.prototype.paintBorder = function (context) {\r\n        if (0 != this.borderWidth) {\r\n            context.beginPath();\r\n            context.lineWidth = this.borderWidth;\r\n            context.strokeStyle = "rgba(" + this.borderColor + "," + this.alpha + ")";\r\n            var b = this.borderWidth / 2;\r\n            if (null == this.borderRadius || 0 == this.borderRadius) {\r\n                context.rect(-this.width / 2 - b, -this.height / 2 - b, this.width + this.borderWidth, this.height + this.borderWidth);\r\n            } else {\r\n                context._roundRect(-this.width / 2 - b, -this.height / 2 - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius);\r\n            }\r\n            context.stroke();\r\n            context.closePath();\r\n        }\r\n    };\r\n    Node.prototype.paintAlarmText = function (context) {\r\n        if (null != this.alarm && "" != this.alarm) {\r\n            context.font = this.alarmFont || "12px 微软雅黑";\r\n            var lineWidth = context.measureText(this.alarm).width + 6;\r\n            var fontWidth = context.measureText("田").width + 6;\r\n            var startX = this.width / 2 - lineWidth / 2;\r\n            var startY = -this.height / 2 - fontWidth - 8;\r\n            paintAlarmPanel(\r\n                startX, startY,\r\n                this.alarmColor || "255,0,0",\r\n                this.alarmAlpha || .5,\r\n                lineWidth, fontWidth\r\n            );\r\n            context.beginPath();\r\n            context.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n            context.fillText(this.alarm, startX + 2, startY + fontWidth - 4);\r\n            context.closePath();\r\n        }\r\n        function paintAlarmPanel(x, y, color, alpha, lineWidth, fontWidth) {\r\n            context.beginPath();\r\n            context.strokeStyle = "rgba(" + color + ", " + alpha + ")";\r\n            context.fillStyle = "rgba(" + color + ", " + alpha + ")";\r\n            context.lineCap = "round";\r\n            context.lineWidth = 1;\r\n            context.moveTo(x, y);\r\n            context.lineTo(x + lineWidth, y);\r\n            context.lineTo(x + lineWidth, y + fontWidth);\r\n            context.lineTo(x + lineWidth / 2 + 6, y + fontWidth);\r\n            context.lineTo(x + lineWidth / 2, y + fontWidth + 8);\r\n            context.lineTo(x + lineWidth / 2 - 6, y + fontWidth);\r\n            context.lineTo(x, y + fontWidth);\r\n            context.lineTo(x, y);\r\n            context.fill();\r\n            context.stroke();\r\n            context.closePath();\r\n        }\r\n    };\r\n    Node.prototype.paintText = function (context) {\r\n        var text = this.text;\r\n        if (null != text && "" != text) {\r\n            context.beginPath();\r\n            context.font = this.font;\r\n            var fontWidth = context.measureText("田").width;\r\n            var maxWidth = fontWidth;\r\n            context.fillStyle = "rgba(" + this.fontColor + "," + this.alpha + ")";\r\n            //换行检测\r\n            var textlines = text.split("\\n");\r\n            textlines.forEach(function (line) {\r\n                var width = context.measureText(line).width;\r\n                if (width > maxWidth) {\r\n                    maxWidth = width;\r\n                }\r\n            });\r\n            var textStartPoint = this.getTextPostion(this.textPosition, maxWidth, fontWidth, textlines.length);\r\n            textlines.forEach(function (line, i) {\r\n                context.fillText(line, textStartPoint.x + (maxWidth - context.measureText(line).width) / 2, textStartPoint.y + i * fontWidth);\r\n            });\r\n            context.closePath();\r\n        }\r\n    };\r\n    Node.prototype.getTextPostion = function (position, maxWidth, fontWidth, textLines) {\r\n        switch (position) {\r\n            case "Bottom_Center":\r\n                return getPosition(-this.width / 2 + (this.width - maxWidth) / 2, this.height / 2 + fontWidth);\r\n            case "Top_Center":\r\n                return getPosition(-this.width / 2 + (this.width - maxWidth) / 2, -this.height / 2 - fontWidth / 2 - fontWidth * (textLines - 1));\r\n            case "Top_Right":\r\n                return getPosition(this.width / 2, -this.height / 2 - fontWidth / 2);\r\n            case "Top_Left":\r\n                return getPosition(-this.width / 2 - maxWidth, -this.height / 2 - fontWidth / 2);\r\n            case "Bottom_Right":\r\n                return getPosition(this.width / 2, this.height / 2 + fontWidth);\r\n            case "Bottom_Left":\r\n                return getPosition(-this.width / 2 - maxWidth, this.height / 2 + fontWidth);\r\n            case "Middle_Center":\r\n                return getPosition(-this.width / 2 + (this.width - maxWidth) / 2, fontWidth / 2);\r\n            case "Middle_Right":\r\n                return getPosition(this.width / 2, fontWidth / 2);\r\n            default:\r\n                return getPosition(-this.width / 2 - maxWidth, fontWidth / 2);//"Middle_Left"\r\n        }\r\n        function getPosition(x, y) {\r\n            return {\r\n                x: x + (null != this.textOffsetX ? this.textOffsetX : 0),\r\n                y: y + (null != this.textOffsetY ? this.textOffsetY : 0)\r\n            }\r\n        }\r\n    };\r\n    var imageCache = {};\r\n    Node.prototype.setImage = function (paramImage, asImageSize) {\r\n        if (null == paramImage)throw new Error("Node.setImage(): 参数Image对象为空!");\r\n        var self = this;\r\n        if ("string" == typeof paramImage) {\r\n            var image = imageCache[paramImage];\r\n            if (null == image) {\r\n                image = new Image();\r\n                image.src = paramImage;\r\n                image.onload = function () {\r\n                    imageCache[paramImage] = image;\r\n                    initImage(image);\r\n                }\r\n            } else {\r\n                initImage(image);\r\n            }\r\n        } else {\r\n            initImage(paramImage)\r\n        }\r\n        function initImage(newImage) {\r\n            self.image = newImage;\r\n            self.alarmColor = self.alarmColor || "255,0,0";\r\n            if (asImageSize == 1) {\r\n                self.setSize(newImage.width, newImage.height)\r\n            }\r\n        }\r\n    };\r\n    Node.prototype.removeHandler = function (scene) {\r\n        var self = this;\r\n        if (this.outLinks) {\r\n            this.outLinks.forEach(function (c) {\r\n                if (c.nodeA === self) {\r\n                    scene.remove(c)\r\n                }\r\n            });\r\n            this.outLinks = null;\r\n        }\r\n        if (this.inLinks) {\r\n            this.inLinks.forEach(function (c) {\r\n                c.nodeZ === self && scene.remove(c)\r\n            });\r\n            this.inLinks = null;\r\n        }\r\n    };\r\n};\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vbm9kZS9Ob2RlLmpzPzEzMjMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEVBQThFO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIxNy5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICBqdG9wby5Ob2RlID0gTm9kZTtcclxuICAgIGZ1bmN0aW9uIE5vZGUodGV4dCkge1xyXG4gICAgICAgIGp0b3BvLkVkaXRhYmxlRWxlbWVudC5jYWxsKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudFR5cGUgPSBcIm5vZGVcIjtcclxuICAgICAgICB0aGlzLnpJbmRleCA9IGp0b3BvLnpJbmRleF9Ob2RlO1xyXG4gICAgICAgIHRoaXMudGV4dCA9IHRleHQ7XHJcbiAgICAgICAgdGhpcy5mb250ID0gXCIxMnB4IENvbnNvbGFzXCI7XHJcbiAgICAgICAgdGhpcy5mb250Q29sb3IgPSBcIjI1NSwyNTUsMjU1XCI7XHJcbiAgICAgICAgdGhpcy5ib3JkZXJXaWR0aCA9IDA7XHJcbiAgICAgICAgdGhpcy5ib3JkZXJDb2xvciA9IFwiMjU1LDI1NSwyNTVcIjtcclxuICAgICAgICB0aGlzLmJvcmRlclJhZGl1cyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5kcmFnZ2FibGUgPSAhMDtcclxuICAgICAgICB0aGlzLnRleHRQb3NpdGlvbiA9IFwiQm90dG9tX0NlbnRlclwiO1xyXG4gICAgICAgIHRoaXMudGV4dE9mZnNldFggPSAwO1xyXG4gICAgICAgIHRoaXMudGV4dE9mZnNldFkgPSAwO1xyXG4gICAgICAgIHRoaXMudHJhbnNmb3JtQWJsZSA9ICEwO1xyXG4gICAgICAgIHZhciBkID0gXCJ0ZXh0LGZvbnQsZm9udENvbG9yLHRleHRQb3NpdGlvbix0ZXh0T2Zmc2V0WCx0ZXh0T2Zmc2V0WSxib3JkZXJSYWRpdXNcIi5zcGxpdChcIixcIik7XHJcbiAgICAgICAgdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcyA9IHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuY29uY2F0KGQpO1xyXG4gICAgfVxyXG5cclxuICAgIGp0b3BvLnV0aWwuaW5oZXJpdHMoTm9kZSwganRvcG8uRWRpdGFibGVFbGVtZW50KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKE5vZGUucHJvdG90eXBlLCB7XHJcbiAgICAgICAgYWxhcm1Db2xvcjoge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9hbGFybUNvbG9yO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChjb2xvcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYWxhcm1Db2xvciA9IGNvbG9yO1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5pbWFnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0ganRvcG8udXRpbC5nZW5JbWFnZUFsYXJtKHRoaXMuaW1hZ2UsIGNvbG9yKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFsYXJtSW1hZ2UgPSBjO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgZnVuY3Rpb24gdG9nZ2xlKGFycixzdHIpe1xyXG4gICAgICAgIGlmKGFyciBpbnN0YW5jZW9mIEFycmF5KXtcclxuICAgICAgICAgICAgYXJyLmZvckVhY2goZnVuY3Rpb24obGluayl7XHJcbiAgICAgICAgICAgICAgICBsaW5rW3N0cl0oKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgTm9kZS5wcm90b3R5cGUuaGlkZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICB0b2dnbGUodGhpcy5pbkxpbmtzLFwiaGlkZVwiKTtcclxuICAgICAgICB0b2dnbGUodGhpcy5vdXRMaW5rcyxcImhpZGVcIik7XHJcbiAgICB9O1xyXG4gICAgTm9kZS5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgIHRvZ2dsZSh0aGlzLmluTGlua3MsXCJzaG93XCIpO1xyXG4gICAgICAgIHRvZ2dsZSh0aGlzLm91dExpbmtzLFwic2hvd1wiKTtcclxuICAgIH07XHJcbiAgICAvL+iHquWumuS5ieaWsOWinizlkK/nlKjlkYrorablkI7mr4/mrKHnu5jnlLvmiafooYzkv67mlLnpmLTlvbFcclxuICAgIE5vZGUucHJvdG90eXBlLnBhaW50QWxhcm1GbGFzaCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc2hhZG93ID09IDEgJiYgdGhpcy5hbGxvd0FsYXJtRmxhc2ggPT0gMSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zaGFkb3dEaXJlY3Rpb24gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaGFkb3dEaXJlY3Rpb24gPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG1vdmUodGhpcyk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc2hhZG93Qmx1ciA9IHRoaXMuc2hhZG93Qmx1cjtcclxuICAgICAgICAgICAgZnVuY3Rpb24gbW92ZShub2RlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5zaGFkb3dEaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLnNoYWRvd0JsdXIgKz0gNTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5zaGFkb3dCbHVyID4gMTAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2hhZG93RGlyZWN0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5zaGFkb3dCbHVyIC09IDU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuc2hhZG93Qmx1ciA8PSAxMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnNoYWRvd0RpcmVjdGlvbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE5vZGUucHJvdG90eXBlLnBhaW50ID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcclxuICAgICAgICB0aGlzLnBhaW50QWxhcm1GbGFzaChjb250ZXh0KTtcclxuICAgICAgICBpZiAodGhpcy5pbWFnZSkge1xyXG4gICAgICAgICAgICB2YXIgZ29iYWxBbHBoYSA9IGNvbnRleHQuZ2xvYmFsQWxwaGE7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZ2xvYmFsQWxwaGEgPSB0aGlzLmFscGhhO1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSB0aGlzLmFsYXJtSW1hZ2UgJiYgbnVsbCAhPSB0aGlzLmFsYXJtKSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmRyYXdJbWFnZSh0aGlzLmFsYXJtSW1hZ2UsIC10aGlzLndpZHRoIC8gMiwgLXRoaXMuaGVpZ2h0IC8gMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmRyYXdJbWFnZSh0aGlzLmltYWdlLCAtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnRleHQuZ2xvYmFsQWxwaGEgPSBnb2JhbEFscGhhO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChudWxsID09IHRoaXMuYm9yZGVyUmFkaXVzIHx8IDAgPT0gdGhpcy5ib3JkZXJSYWRpdXMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnJlY3QoLXRoaXMud2lkdGggLyAyLCAtdGhpcy5oZWlnaHQgLyAyLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5fcm91bmRSZWN0KC10aGlzLndpZHRoIC8gMiwgLXRoaXMuaGVpZ2h0IC8gMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIHRoaXMuYm9yZGVyUmFkaXVzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZmlsbENvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZmlsbCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBhaW50Qm9yZGVyKGNvbnRleHQpO1xyXG4gICAgICAgIHRoaXMucGFpbnRUZXh0KGNvbnRleHQpO1xyXG4gICAgICAgIHRoaXMucGFpbnRDdHJsKGNvbnRleHQpO1xyXG4gICAgICAgIHRoaXMucGFpbnRBbGFybVRleHQoY29udGV4dCk7XHJcbiAgICB9O1xyXG4gICAgTm9kZS5wcm90b3R5cGUucGFpbnRCb3JkZXIgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgIGlmICgwICE9IHRoaXMuYm9yZGVyV2lkdGgpIHtcclxuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgY29udGV4dC5saW5lV2lkdGggPSB0aGlzLmJvcmRlcldpZHRoO1xyXG4gICAgICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5ib3JkZXJDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXMuYm9yZGVyV2lkdGggLyAyO1xyXG4gICAgICAgICAgICBpZiAobnVsbCA9PSB0aGlzLmJvcmRlclJhZGl1cyB8fCAwID09IHRoaXMuYm9yZGVyUmFkaXVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnJlY3QoLXRoaXMud2lkdGggLyAyIC0gYiwgLXRoaXMuaGVpZ2h0IC8gMiAtIGIsIHRoaXMud2lkdGggKyB0aGlzLmJvcmRlcldpZHRoLCB0aGlzLmhlaWdodCArIHRoaXMuYm9yZGVyV2lkdGgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5fcm91bmRSZWN0KC10aGlzLndpZHRoIC8gMiAtIGIsIC10aGlzLmhlaWdodCAvIDIgLSBiLCB0aGlzLndpZHRoICsgdGhpcy5ib3JkZXJXaWR0aCwgdGhpcy5oZWlnaHQgKyB0aGlzLmJvcmRlcldpZHRoLCB0aGlzLmJvcmRlclJhZGl1cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29udGV4dC5zdHJva2UoKTtcclxuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgTm9kZS5wcm90b3R5cGUucGFpbnRBbGFybVRleHQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgIGlmIChudWxsICE9IHRoaXMuYWxhcm0gJiYgXCJcIiAhPSB0aGlzLmFsYXJtKSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZm9udCA9IHRoaXMuYWxhcm1Gb250IHx8IFwiMTJweCDlvq7ova/pm4Xpu5FcIjtcclxuICAgICAgICAgICAgdmFyIGxpbmVXaWR0aCA9IGNvbnRleHQubWVhc3VyZVRleHQodGhpcy5hbGFybSkud2lkdGggKyA2O1xyXG4gICAgICAgICAgICB2YXIgZm9udFdpZHRoID0gY29udGV4dC5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aCArIDY7XHJcbiAgICAgICAgICAgIHZhciBzdGFydFggPSB0aGlzLndpZHRoIC8gMiAtIGxpbmVXaWR0aCAvIDI7XHJcbiAgICAgICAgICAgIHZhciBzdGFydFkgPSAtdGhpcy5oZWlnaHQgLyAyIC0gZm9udFdpZHRoIC0gODtcclxuICAgICAgICAgICAgcGFpbnRBbGFybVBhbmVsKFxyXG4gICAgICAgICAgICAgICAgc3RhcnRYLCBzdGFydFksXHJcbiAgICAgICAgICAgICAgICB0aGlzLmFsYXJtQ29sb3IgfHwgXCIyNTUsMCwwXCIsXHJcbiAgICAgICAgICAgICAgICB0aGlzLmFsYXJtQWxwaGEgfHwgLjUsXHJcbiAgICAgICAgICAgICAgICBsaW5lV2lkdGgsIGZvbnRXaWR0aFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxUZXh0KHRoaXMuYWxhcm0sIHN0YXJ0WCArIDIsIHN0YXJ0WSArIGZvbnRXaWR0aCAtIDQpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBwYWludEFsYXJtUGFuZWwoeCwgeSwgY29sb3IsIGFscGhhLCBsaW5lV2lkdGgsIGZvbnRXaWR0aCkge1xyXG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gXCJyZ2JhKFwiICsgY29sb3IgKyBcIiwgXCIgKyBhbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIGNvbG9yICsgXCIsIFwiICsgYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgY29udGV4dC5saW5lQ2FwID0gXCJyb3VuZFwiO1xyXG4gICAgICAgICAgICBjb250ZXh0LmxpbmVXaWR0aCA9IDE7XHJcbiAgICAgICAgICAgIGNvbnRleHQubW92ZVRvKHgsIHkpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmxpbmVUbyh4ICsgbGluZVdpZHRoLCB5KTtcclxuICAgICAgICAgICAgY29udGV4dC5saW5lVG8oeCArIGxpbmVXaWR0aCwgeSArIGZvbnRXaWR0aCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHggKyBsaW5lV2lkdGggLyAyICsgNiwgeSArIGZvbnRXaWR0aCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHggKyBsaW5lV2lkdGggLyAyLCB5ICsgZm9udFdpZHRoICsgOCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHggKyBsaW5lV2lkdGggLyAyIC0gNiwgeSArIGZvbnRXaWR0aCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHgsIHkgKyBmb250V2lkdGgpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmxpbmVUbyh4LCB5KTtcclxuICAgICAgICAgICAgY29udGV4dC5maWxsKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE5vZGUucHJvdG90eXBlLnBhaW50VGV4dCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgdmFyIHRleHQgPSB0aGlzLnRleHQ7XHJcbiAgICAgICAgaWYgKG51bGwgIT0gdGV4dCAmJiBcIlwiICE9IHRleHQpIHtcclxuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgY29udGV4dC5mb250ID0gdGhpcy5mb250O1xyXG4gICAgICAgICAgICB2YXIgZm9udFdpZHRoID0gY29udGV4dC5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aDtcclxuICAgICAgICAgICAgdmFyIG1heFdpZHRoID0gZm9udFdpZHRoO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgIC8v5o2i6KGM5qOA5rWLXHJcbiAgICAgICAgICAgIHZhciB0ZXh0bGluZXMgPSB0ZXh0LnNwbGl0KFwiXFxuXCIpO1xyXG4gICAgICAgICAgICB0ZXh0bGluZXMuZm9yRWFjaChmdW5jdGlvbiAobGluZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gY29udGV4dC5tZWFzdXJlVGV4dChsaW5lKS53aWR0aDtcclxuICAgICAgICAgICAgICAgIGlmICh3aWR0aCA+IG1heFdpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF4V2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHZhciB0ZXh0U3RhcnRQb2ludCA9IHRoaXMuZ2V0VGV4dFBvc3Rpb24odGhpcy50ZXh0UG9zaXRpb24sIG1heFdpZHRoLCBmb250V2lkdGgsIHRleHRsaW5lcy5sZW5ndGgpO1xyXG4gICAgICAgICAgICB0ZXh0bGluZXMuZm9yRWFjaChmdW5jdGlvbiAobGluZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsVGV4dChsaW5lLCB0ZXh0U3RhcnRQb2ludC54ICsgKG1heFdpZHRoIC0gY29udGV4dC5tZWFzdXJlVGV4dChsaW5lKS53aWR0aCkgLyAyLCB0ZXh0U3RhcnRQb2ludC55ICsgaSAqIGZvbnRXaWR0aCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBOb2RlLnByb3RvdHlwZS5nZXRUZXh0UG9zdGlvbiA9IGZ1bmN0aW9uIChwb3NpdGlvbiwgbWF4V2lkdGgsIGZvbnRXaWR0aCwgdGV4dExpbmVzKSB7XHJcbiAgICAgICAgc3dpdGNoIChwb3NpdGlvbikge1xyXG4gICAgICAgICAgICBjYXNlIFwiQm90dG9tX0NlbnRlclwiOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFBvc2l0aW9uKC10aGlzLndpZHRoIC8gMiArICh0aGlzLndpZHRoIC0gbWF4V2lkdGgpIC8gMiwgdGhpcy5oZWlnaHQgLyAyICsgZm9udFdpZHRoKTtcclxuICAgICAgICAgICAgY2FzZSBcIlRvcF9DZW50ZXJcIjpcclxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQb3NpdGlvbigtdGhpcy53aWR0aCAvIDIgKyAodGhpcy53aWR0aCAtIG1heFdpZHRoKSAvIDIsIC10aGlzLmhlaWdodCAvIDIgLSBmb250V2lkdGggLyAyIC0gZm9udFdpZHRoICogKHRleHRMaW5lcyAtIDEpKTtcclxuICAgICAgICAgICAgY2FzZSBcIlRvcF9SaWdodFwiOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFBvc2l0aW9uKHRoaXMud2lkdGggLyAyLCAtdGhpcy5oZWlnaHQgLyAyIC0gZm9udFdpZHRoIC8gMik7XHJcbiAgICAgICAgICAgIGNhc2UgXCJUb3BfTGVmdFwiOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFBvc2l0aW9uKC10aGlzLndpZHRoIC8gMiAtIG1heFdpZHRoLCAtdGhpcy5oZWlnaHQgLyAyIC0gZm9udFdpZHRoIC8gMik7XHJcbiAgICAgICAgICAgIGNhc2UgXCJCb3R0b21fUmlnaHRcIjpcclxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQb3NpdGlvbih0aGlzLndpZHRoIC8gMiwgdGhpcy5oZWlnaHQgLyAyICsgZm9udFdpZHRoKTtcclxuICAgICAgICAgICAgY2FzZSBcIkJvdHRvbV9MZWZ0XCI6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UG9zaXRpb24oLXRoaXMud2lkdGggLyAyIC0gbWF4V2lkdGgsIHRoaXMuaGVpZ2h0IC8gMiArIGZvbnRXaWR0aCk7XHJcbiAgICAgICAgICAgIGNhc2UgXCJNaWRkbGVfQ2VudGVyXCI6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UG9zaXRpb24oLXRoaXMud2lkdGggLyAyICsgKHRoaXMud2lkdGggLSBtYXhXaWR0aCkgLyAyLCBmb250V2lkdGggLyAyKTtcclxuICAgICAgICAgICAgY2FzZSBcIk1pZGRsZV9SaWdodFwiOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFBvc2l0aW9uKHRoaXMud2lkdGggLyAyLCBmb250V2lkdGggLyAyKTtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQb3NpdGlvbigtdGhpcy53aWR0aCAvIDIgLSBtYXhXaWR0aCwgZm9udFdpZHRoIC8gMik7Ly9cIk1pZGRsZV9MZWZ0XCJcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0UG9zaXRpb24oeCwgeSkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgeDogeCArIChudWxsICE9IHRoaXMudGV4dE9mZnNldFggPyB0aGlzLnRleHRPZmZzZXRYIDogMCksXHJcbiAgICAgICAgICAgICAgICB5OiB5ICsgKG51bGwgIT0gdGhpcy50ZXh0T2Zmc2V0WSA/IHRoaXMudGV4dE9mZnNldFkgOiAwKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHZhciBpbWFnZUNhY2hlID0ge307XHJcbiAgICBOb2RlLnByb3RvdHlwZS5zZXRJbWFnZSA9IGZ1bmN0aW9uIChwYXJhbUltYWdlLCBhc0ltYWdlU2l6ZSkge1xyXG4gICAgICAgIGlmIChudWxsID09IHBhcmFtSW1hZ2UpdGhyb3cgbmV3IEVycm9yKFwiTm9kZS5zZXRJbWFnZSgpOiDlj4LmlbBJbWFnZeWvueixoeS4uuepuiFcIik7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBwYXJhbUltYWdlKSB7XHJcbiAgICAgICAgICAgIHZhciBpbWFnZSA9IGltYWdlQ2FjaGVbcGFyYW1JbWFnZV07XHJcbiAgICAgICAgICAgIGlmIChudWxsID09IGltYWdlKSB7XHJcbiAgICAgICAgICAgICAgICBpbWFnZSA9IG5ldyBJbWFnZSgpO1xyXG4gICAgICAgICAgICAgICAgaW1hZ2Uuc3JjID0gcGFyYW1JbWFnZTtcclxuICAgICAgICAgICAgICAgIGltYWdlLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbWFnZUNhY2hlW3BhcmFtSW1hZ2VdID0gaW1hZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5pdEltYWdlKGltYWdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGluaXRJbWFnZShpbWFnZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpbml0SW1hZ2UocGFyYW1JbWFnZSlcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gaW5pdEltYWdlKG5ld0ltYWdlKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW1hZ2UgPSBuZXdJbWFnZTtcclxuICAgICAgICAgICAgc2VsZi5hbGFybUNvbG9yID0gc2VsZi5hbGFybUNvbG9yIHx8IFwiMjU1LDAsMFwiO1xyXG4gICAgICAgICAgICBpZiAoYXNJbWFnZVNpemUgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZXRTaXplKG5ld0ltYWdlLndpZHRoLCBuZXdJbWFnZS5oZWlnaHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgTm9kZS5wcm90b3R5cGUucmVtb3ZlSGFuZGxlciA9IGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5vdXRMaW5rcykge1xyXG4gICAgICAgICAgICB0aGlzLm91dExpbmtzLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjLm5vZGVBID09PSBzZWxmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmUucmVtb3ZlKGMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLm91dExpbmtzID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuaW5MaW5rcykge1xyXG4gICAgICAgICAgICB0aGlzLmluTGlua3MuZm9yRWFjaChmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgYy5ub2RlWiA9PT0gc2VsZiAmJiBzY2VuZS5yZW1vdmUoYylcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5MaW5rcyA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vbm9kZS9Ob2RlLmpzXG4vLyBtb2R1bGUgaWQgPSAxN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAgMiJdLCJzb3VyY2VSb290IjoiIn0=');
},function(module,exports){eval('module.exports=function(jtopo){\r\n    jtopo.TextNode = TextNode;\r\n    function TextNode(text) {\r\n        jtopo.Node.apply(this,arguments);\r\n        this.text = text;\r\n        this.elementType = "TextNode";\r\n    }\r\n    jtopo.util.inherits(TextNode,jtopo.Node);\r\n    TextNode.prototype.paint = function (context) {\r\n        //自动换行\r\n        var self=this;\r\n        var texts = this.text.split("\\n");\r\n        context.beginPath();\r\n        context.font = this.font;\r\n        var fontWidth = context.measureText("田").width;\r\n        this.width = 0;\r\n        texts.forEach(function(text){\r\n            var width = context.measureText(text).width;\r\n            if (width > self.width) {\r\n                self.width = width;\r\n            }\r\n        });\r\n        this.height = texts.length * fontWidth;\r\n        context.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n        if (texts.length > 1) {\r\n            texts.forEach(function(text,i){\r\n                context.fillText(text, -self.width / 2 + 0.15 * fontWidth, self.height / 2 + (i - texts.length + 0.85) * fontWidth);\r\n            });\r\n        } else {\r\n            context.fillText(texts, -this.width / 2 + 0.03 * fontWidth, this.height / 2 - 0.15 * fontWidth);\r\n        }\r\n        context.closePath();\r\n        this.paintBorder(context);\r\n        this.paintCtrl(context);\r\n        this.paintAlarmText(context);\r\n    };\r\n};\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vbm9kZS9UZXh0Tm9kZS5qcz80MmYxIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjE4LmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHM9ZnVuY3Rpb24oanRvcG8pe1xyXG4gICAganRvcG8uVGV4dE5vZGUgPSBUZXh0Tm9kZTtcclxuICAgIGZ1bmN0aW9uIFRleHROb2RlKHRleHQpIHtcclxuICAgICAgICBqdG9wby5Ob2RlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtcclxuICAgICAgICB0aGlzLnRleHQgPSB0ZXh0O1xyXG4gICAgICAgIHRoaXMuZWxlbWVudFR5cGUgPSBcIlRleHROb2RlXCI7XHJcbiAgICB9XHJcbiAgICBqdG9wby51dGlsLmluaGVyaXRzKFRleHROb2RlLGp0b3BvLk5vZGUpO1xyXG4gICAgVGV4dE5vZGUucHJvdG90eXBlLnBhaW50ID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcclxuICAgICAgICAvL+iHquWKqOaNouihjFxyXG4gICAgICAgIHZhciBzZWxmPXRoaXM7XHJcbiAgICAgICAgdmFyIHRleHRzID0gdGhpcy50ZXh0LnNwbGl0KFwiXFxuXCIpO1xyXG4gICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgY29udGV4dC5mb250ID0gdGhpcy5mb250O1xyXG4gICAgICAgIHZhciBmb250V2lkdGggPSBjb250ZXh0Lm1lYXN1cmVUZXh0KFwi55SwXCIpLndpZHRoO1xyXG4gICAgICAgIHRoaXMud2lkdGggPSAwO1xyXG4gICAgICAgIHRleHRzLmZvckVhY2goZnVuY3Rpb24odGV4dCl7XHJcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IGNvbnRleHQubWVhc3VyZVRleHQodGV4dCkud2lkdGg7XHJcbiAgICAgICAgICAgIGlmICh3aWR0aCA+IHNlbGYud2lkdGgpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYud2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gdGV4dHMubGVuZ3RoICogZm9udFdpZHRoO1xyXG4gICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5mb250Q29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgaWYgKHRleHRzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgdGV4dHMuZm9yRWFjaChmdW5jdGlvbih0ZXh0LGkpe1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsVGV4dCh0ZXh0LCAtc2VsZi53aWR0aCAvIDIgKyAwLjE1ICogZm9udFdpZHRoLCBzZWxmLmhlaWdodCAvIDIgKyAoaSAtIHRleHRzLmxlbmd0aCArIDAuODUpICogZm9udFdpZHRoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29udGV4dC5maWxsVGV4dCh0ZXh0cywgLXRoaXMud2lkdGggLyAyICsgMC4wMyAqIGZvbnRXaWR0aCwgdGhpcy5oZWlnaHQgLyAyIC0gMC4xNSAqIGZvbnRXaWR0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgdGhpcy5wYWludEJvcmRlcihjb250ZXh0KTtcclxuICAgICAgICB0aGlzLnBhaW50Q3RybChjb250ZXh0KTtcclxuICAgICAgICB0aGlzLnBhaW50QWxhcm1UZXh0KGNvbnRleHQpO1xyXG4gICAgfTtcclxufTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vbm9kZS9UZXh0Tm9kZS5qc1xuLy8gbW9kdWxlIGlkID0gMThcbi8vIG1vZHVsZSBjaHVua3MgPSAwIDIiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports){eval('module.exports=function (jtopo) {\r\n    function PieChartNode() {\r\n        var CircleNode = new jtopo.CircleNode;\r\n        CircleNode.radius = 150;\r\n        CircleNode.colors = ["#3666B0", "#2CA8E0", "#77D1F6"];\r\n        CircleNode.datas = [.3, .3, .4];\r\n        CircleNode.titles = ["A", "B", "C"];\r\n        CircleNode.paint = function (context) {\r\n            CircleNode.width = 2 * CircleNode.radius;\r\n            CircleNode.height = 2 * CircleNode.radius;\r\n            for (var startAngle = 0, i = 0; i < this.datas.length; i++) {\r\n                var dataAngle = this.datas[i] * Math.PI * 2;\r\n                context.save();\r\n                context.beginPath();\r\n                context.fillStyle = CircleNode.colors[i];\r\n                context.moveTo(0, 0);\r\n                context.arc(0, 0, this.radius, startAngle, startAngle + dataAngle, !1);\r\n                context.fill();\r\n                context.closePath();\r\n                context.restore();\r\n                context.beginPath();\r\n                context.font = this.font;\r\n                var text = this.titles[i] + ": " + (100 * this.datas[i]).toFixed(2) + "%";\r\n                var totalWidth = context.measureText(text).width;\r\n                var textStartAngle = (startAngle + startAngle + dataAngle) / 2;\r\n                var textStartX = this.radius * Math.cos(textStartAngle);\r\n                var textStartY = this.radius * Math.sin(textStartAngle);\r\n                if((textStartAngle > Math.PI / 2 && textStartAngle <= Math.PI)||(textStartAngle > Math.PI && textStartAngle < 2 * Math.PI * 3 / 4 )){\r\n                    textStartX -= totalWidth;\r\n                }\r\n                context.fillStyle = "#FFFFFF";\r\n                context.fillText(text, textStartX, textStartY);\r\n                context.moveTo(this.radius * Math.cos(textStartAngle), this.radius * Math.sin(textStartAngle));\r\n                context.fill();\r\n                context.stroke();\r\n                context.closePath();\r\n                startAngle += dataAngle;\r\n            }\r\n        };\r\n        return  CircleNode;\r\n    }\r\n\r\n    function BarChartNode() {\r\n        var node = new jtopo.Node;\r\n        node.showSelected = !1;\r\n        node.width = 250;\r\n        node.height = 180;\r\n        node.colors = ["#3666B0", "#2CA8E0", "#77D1F6"];\r\n        node.datas = [.3, .3, .4];\r\n        node.titles = ["A", "B", "C"];\r\n        node.paint = function (context) {\r\n            var barGap = 3;\r\n            var barWidth = (this.width - barGap) / this.datas.length;\r\n            context.save();\r\n            context.beginPath();\r\n            context.fillStyle = "#FFFFFF";\r\n            context.strokeStyle = "#FFFFFF";\r\n            context.moveTo(-this.width / 2 - 1, -this.height / 2);\r\n            context.lineTo(-this.width / 2 - 1, this.height / 2 + 3);\r\n            context.lineTo(this.width / 2 + barGap + 1, this.height / 2 + 3);\r\n            context.stroke();\r\n            context.closePath();\r\n            context.restore();\r\n            for (var i = 0; i < this.datas.length; i++) {\r\n                context.save();\r\n                context.beginPath();\r\n                context.fillStyle = node.colors[i];\r\n                var data = this.datas[i];\r\n                var startX = i * (barWidth + barGap) - this.width / 2;\r\n                var startY = this.height - data - this.height / 2;\r\n                context.fillRect(startX, startY, barWidth, data);\r\n                var percent = "" + parseInt(this.datas[i]);\r\n                var totalWidth = context.measureText(percent).width;\r\n                var fontWidth = context.measureText("田").width;\r\n                context.fillStyle = "#FFFFFF";\r\n                context.fillText(percent, startX + (barWidth - totalWidth) / 2, startY - fontWidth);\r\n                context.fillText(this.titles[i], startX + (barWidth - totalWidth) / 2 ,this.height / 2 + fontWidth);\r\n                context.fill();\r\n                context.closePath();\r\n                context.restore();\r\n            }\r\n        };\r\n        return  node;\r\n    }\r\n\r\n    jtopo.BarChartNode = BarChartNode;\r\n    jtopo.PieChartNode = PieChartNode;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vbm9kZS9zcGVjaWFsTm9kZS5qcz82OTEzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLHVCQUF1QjtBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHVCQUF1QjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSIsImZpbGUiOiIxOS5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzPWZ1bmN0aW9uIChqdG9wbykge1xyXG4gICAgZnVuY3Rpb24gUGllQ2hhcnROb2RlKCkge1xyXG4gICAgICAgIHZhciBDaXJjbGVOb2RlID0gbmV3IGp0b3BvLkNpcmNsZU5vZGU7XHJcbiAgICAgICAgQ2lyY2xlTm9kZS5yYWRpdXMgPSAxNTA7XHJcbiAgICAgICAgQ2lyY2xlTm9kZS5jb2xvcnMgPSBbXCIjMzY2NkIwXCIsIFwiIzJDQThFMFwiLCBcIiM3N0QxRjZcIl07XHJcbiAgICAgICAgQ2lyY2xlTm9kZS5kYXRhcyA9IFsuMywgLjMsIC40XTtcclxuICAgICAgICBDaXJjbGVOb2RlLnRpdGxlcyA9IFtcIkFcIiwgXCJCXCIsIFwiQ1wiXTtcclxuICAgICAgICBDaXJjbGVOb2RlLnBhaW50ID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcclxuICAgICAgICAgICAgQ2lyY2xlTm9kZS53aWR0aCA9IDIgKiBDaXJjbGVOb2RlLnJhZGl1cztcclxuICAgICAgICAgICAgQ2lyY2xlTm9kZS5oZWlnaHQgPSAyICogQ2lyY2xlTm9kZS5yYWRpdXM7XHJcbiAgICAgICAgICAgIGZvciAodmFyIHN0YXJ0QW5nbGUgPSAwLCBpID0gMDsgaSA8IHRoaXMuZGF0YXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhQW5nbGUgPSB0aGlzLmRhdGFzW2ldICogTWF0aC5QSSAqIDI7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IENpcmNsZU5vZGUuY29sb3JzW2ldO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5tb3ZlVG8oMCwgMCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmFyYygwLCAwLCB0aGlzLnJhZGl1cywgc3RhcnRBbmdsZSwgc3RhcnRBbmdsZSArIGRhdGFBbmdsZSwgITEpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5mb250ID0gdGhpcy5mb250O1xyXG4gICAgICAgICAgICAgICAgdmFyIHRleHQgPSB0aGlzLnRpdGxlc1tpXSArIFwiOiBcIiArICgxMDAgKiB0aGlzLmRhdGFzW2ldKS50b0ZpeGVkKDIpICsgXCIlXCI7XHJcbiAgICAgICAgICAgICAgICB2YXIgdG90YWxXaWR0aCA9IGNvbnRleHQubWVhc3VyZVRleHQodGV4dCkud2lkdGg7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGV4dFN0YXJ0QW5nbGUgPSAoc3RhcnRBbmdsZSArIHN0YXJ0QW5nbGUgKyBkYXRhQW5nbGUpIC8gMjtcclxuICAgICAgICAgICAgICAgIHZhciB0ZXh0U3RhcnRYID0gdGhpcy5yYWRpdXMgKiBNYXRoLmNvcyh0ZXh0U3RhcnRBbmdsZSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGV4dFN0YXJ0WSA9IHRoaXMucmFkaXVzICogTWF0aC5zaW4odGV4dFN0YXJ0QW5nbGUpO1xyXG4gICAgICAgICAgICAgICAgaWYoKHRleHRTdGFydEFuZ2xlID4gTWF0aC5QSSAvIDIgJiYgdGV4dFN0YXJ0QW5nbGUgPD0gTWF0aC5QSSl8fCh0ZXh0U3RhcnRBbmdsZSA+IE1hdGguUEkgJiYgdGV4dFN0YXJ0QW5nbGUgPCAyICogTWF0aC5QSSAqIDMgLyA0ICkpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHRTdGFydFggLT0gdG90YWxXaWR0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gXCIjRkZGRkZGXCI7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxUZXh0KHRleHQsIHRleHRTdGFydFgsIHRleHRTdGFydFkpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5tb3ZlVG8odGhpcy5yYWRpdXMgKiBNYXRoLmNvcyh0ZXh0U3RhcnRBbmdsZSksIHRoaXMucmFkaXVzICogTWF0aC5zaW4odGV4dFN0YXJ0QW5nbGUpKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbCgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5zdHJva2UoKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBzdGFydEFuZ2xlICs9IGRhdGFBbmdsZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuICBDaXJjbGVOb2RlO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIEJhckNoYXJ0Tm9kZSgpIHtcclxuICAgICAgICB2YXIgbm9kZSA9IG5ldyBqdG9wby5Ob2RlO1xyXG4gICAgICAgIG5vZGUuc2hvd1NlbGVjdGVkID0gITE7XHJcbiAgICAgICAgbm9kZS53aWR0aCA9IDI1MDtcclxuICAgICAgICBub2RlLmhlaWdodCA9IDE4MDtcclxuICAgICAgICBub2RlLmNvbG9ycyA9IFtcIiMzNjY2QjBcIiwgXCIjMkNBOEUwXCIsIFwiIzc3RDFGNlwiXTtcclxuICAgICAgICBub2RlLmRhdGFzID0gWy4zLCAuMywgLjRdO1xyXG4gICAgICAgIG5vZGUudGl0bGVzID0gW1wiQVwiLCBcIkJcIiwgXCJDXCJdO1xyXG4gICAgICAgIG5vZGUucGFpbnQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgICAgICB2YXIgYmFyR2FwID0gMztcclxuICAgICAgICAgICAgdmFyIGJhcldpZHRoID0gKHRoaXMud2lkdGggLSBiYXJHYXApIC8gdGhpcy5kYXRhcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwiI0ZGRkZGRlwiO1xyXG4gICAgICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gXCIjRkZGRkZGXCI7XHJcbiAgICAgICAgICAgIGNvbnRleHQubW92ZVRvKC10aGlzLndpZHRoIC8gMiAtIDEsIC10aGlzLmhlaWdodCAvIDIpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmxpbmVUbygtdGhpcy53aWR0aCAvIDIgLSAxLCB0aGlzLmhlaWdodCAvIDIgKyAzKTtcclxuICAgICAgICAgICAgY29udGV4dC5saW5lVG8odGhpcy53aWR0aCAvIDIgKyBiYXJHYXAgKyAxLCB0aGlzLmhlaWdodCAvIDIgKyAzKTtcclxuICAgICAgICAgICAgY29udGV4dC5zdHJva2UoKTtcclxuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5kYXRhcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBub2RlLmNvbG9yc1tpXTtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5kYXRhc1tpXTtcclxuICAgICAgICAgICAgICAgIHZhciBzdGFydFggPSBpICogKGJhcldpZHRoICsgYmFyR2FwKSAtIHRoaXMud2lkdGggLyAyO1xyXG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0WSA9IHRoaXMuaGVpZ2h0IC0gZGF0YSAtIHRoaXMuaGVpZ2h0IC8gMjtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFJlY3Qoc3RhcnRYLCBzdGFydFksIGJhcldpZHRoLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgIHZhciBwZXJjZW50ID0gXCJcIiArIHBhcnNlSW50KHRoaXMuZGF0YXNbaV0pO1xyXG4gICAgICAgICAgICAgICAgdmFyIHRvdGFsV2lkdGggPSBjb250ZXh0Lm1lYXN1cmVUZXh0KHBlcmNlbnQpLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgdmFyIGZvbnRXaWR0aCA9IGNvbnRleHQubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwiI0ZGRkZGRlwiO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsVGV4dChwZXJjZW50LCBzdGFydFggKyAoYmFyV2lkdGggLSB0b3RhbFdpZHRoKSAvIDIsIHN0YXJ0WSAtIGZvbnRXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxUZXh0KHRoaXMudGl0bGVzW2ldLCBzdGFydFggKyAoYmFyV2lkdGggLSB0b3RhbFdpZHRoKSAvIDIgLHRoaXMuaGVpZ2h0IC8gMiArIGZvbnRXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuICBub2RlO1xyXG4gICAgfVxyXG5cclxuICAgIGp0b3BvLkJhckNoYXJ0Tm9kZSA9IEJhckNoYXJ0Tm9kZTtcclxuICAgIGp0b3BvLlBpZUNoYXJ0Tm9kZSA9IFBpZUNoYXJ0Tm9kZTtcclxufTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9qdG9wby9ub2RlL3NwZWNpYWxOb2RlLmpzXG4vLyBtb2R1bGUgaWQgPSAxOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAgMiJdLCJzb3VyY2VSb290IjoiIn0=')},function(module,exports){eval('module.exports=function(jtopo){\r\n    function domouseDown(event) {\r\n        event = this.toSceneEvent(event);\r\n        this.mouseDown = !0;\r\n        this.mouseDownX = event.x;\r\n        this.mouseDownY = event.y;\r\n        this.mouseDownEvent = event;\r\n        switch (this.mode) {\r\n            case jtopo.SceneMode.drag:\r\n                if (1 == this.translate) {\r\n                    this.lastTranslateX = this.translateX;\r\n                    this.lastTranslateY = this.translateY;\r\n                }\r\n                break;\r\n            case jtopo.SceneMode.select:\r\n                this.selectElement(event);\r\n                break;\r\n            default://jtopo.SceneMode.normal || jtopo.SceneMode.edit\r\n                this.selectElement(event);\r\n                if ((null == this.currentElement || this.currentElement instanceof jtopo.Link) && 1 == this.translate) {\r\n                    this.lastTranslateX = this.translateX;\r\n                    this.lastTranslateY = this.translateY;\r\n                }\r\n        }\r\n    }\r\n    jtopo.Scene.prototype.addToSelected = function (element) {\r\n        this.selectedElements.push(element);\r\n    };\r\n    jtopo.Scene.prototype.toSceneEvent = function (event) {\r\n        event = jtopo.util.clone(event);\r\n        event.x /= this.scaleX;\r\n        event.y /= this.scaleY;\r\n        if (1 == this.translate) {\r\n            var d = this.getOffsetTranslate();\r\n            event.x -= d.translateX;\r\n            event.y -= d.translateY;\r\n        }\r\n        if (null != event.dx) {\r\n            event.dx /= this.scaleX;\r\n            event.dy /= this.scaleY;\r\n        }\r\n        if (null != this.currentElement) {\r\n            event.target = this.currentElement;\r\n        }\r\n        event.scene = this;\r\n        return event\r\n    };\r\n    jtopo.Scene.prototype.notInSelectedNodes = function (element) {\r\n        return !(this.selectedElements.indexOf(element) > -1);\r\n    };\r\n    jtopo.Scene.prototype.removeFromSelected = function (element) {\r\n        this.selectedElements.del(element);\r\n    };\r\n    jtopo.Scene.prototype.selectElement = function (event) {\r\n        var element = this.getElementByXY(event.x, event.y);\r\n        if (null != element) {\r\n            event.target = element;\r\n            element.mousedownHander(event);\r\n            element.selectedHandler(event);\r\n            if (this.notInSelectedNodes(element)) {\r\n                event.ctrlKey || this.cancleAllSelected();\r\n                this.addToSelected(element);\r\n            } else {\r\n                if (1 == event.ctrlKey) {\r\n                    element.unselectedHandler();\r\n                    this.removeFromSelected(element);\r\n                }\r\n                this.selectedElements.forEach(function (el) {\r\n                    el.selectedHandler(event);\r\n                })\r\n            }\r\n        } else {\r\n            event.ctrlKey || this.cancleAllSelected();\r\n        }\r\n        this.currentElement = element\r\n    };\r\n    jtopo.Scene.prototype.cancleAllSelected = function (context) {\r\n        this.selectedElements.forEach(function (element) {\r\n            element.unselectedHandler(context);\r\n        });\r\n        this.selectedElements = [];\r\n    };\r\n    jtopo.Scene.prototype.dragElements = function (event) {\r\n        if (null != this.currentElement && 1 == this.currentElement.draggable) {\r\n            this.selectedElements.forEach(function (element) {\r\n                if (0 != element.draggable) {\r\n                    var elEvent = jtopo.util.clone(event);\r\n                    elEvent.target = element;\r\n                    element.mousedragHandler(elEvent);\r\n                }\r\n            });\r\n        }\r\n    };\r\n    jtopo.Scene.prototype.mousedownHandler = function (event) {\r\n        domouseDown.call(this, event);\r\n        this.dispatchEvent("mousedown", event);\r\n    };\r\n    jtopo.Scene.prototype.touchstartHandler = function (event) {\r\n        domouseDown.call(this, event);\r\n        this.dispatchEvent("touchstart", event);\r\n    };\r\n    jtopo.Scene.prototype.mouseupHandler = function (event) {\r\n        var self=this;\r\n        self.clearOperations();\r\n        event = this.toSceneEvent(event);\r\n        if (null != this.currentElement) {\r\n            event.target = self.currentElement;\r\n            this.currentElement.mouseupHandler(event);\r\n        }\r\n        this.dispatchEvent("mouseup", event);\r\n        this.mouseDown = !1;\r\n    };\r\n    jtopo.Scene.prototype.mousedragHandler = function (event) {\r\n        event = this.toSceneEvent(event);\r\n        switch (this.mode) {\r\n            case jtopo.SceneMode.drag:\r\n                if (1 == this.translate) {\r\n                    this.translateX = this.lastTranslateX + event.dx;\r\n                    this.translateY = this.lastTranslateY + event.dy;\r\n                }\r\n                break;\r\n            case jtopo.SceneMode.select:\r\n                if (null != this.currentElement) {\r\n                    1 == this.currentElement.draggable && this.dragElements(event);\r\n                } else {\r\n                    1 == this.areaSelect && this.areaSelectHandle(event);\r\n                }\r\n                break;\r\n            default://jtopo.SceneMode.normal || jtopo.SceneMode.edit\r\n                if (null == this.currentElement || this.currentElement instanceof jtopo.Link) {\r\n                    if (1 == this.translate) {\r\n                        this.translateX = this.lastTranslateX + event.dx;\r\n                        this.translateY = this.lastTranslateY + event.dy;\r\n                    }\r\n                } else {\r\n                    this.dragElements(event);\r\n                }\r\n        }\r\n        this.dispatchEvent("mousedrag", event);\r\n    };\r\n    jtopo.Scene.prototype.areaSelectHandle = function (event) {\r\n        var self=this;\r\n        var dragX = event.offsetLeft;\r\n        var dragY = event.offsetTop;\r\n        var downX = this.mouseDownEvent.offsetLeft;\r\n        var downY = this.mouseDownEvent.offsetTop;\r\n        var beginX = dragX >= downX ? downX : dragX;\r\n        var beginY = dragY >= downY ? downY : dragY;\r\n        var width = Math.abs(event.dx) * this.scaleX;\r\n        var height = Math.abs(event.dy) * this.scaleY;\r\n        this.clearOperations()\r\n            .addOperation(\r\n                (function (x, y, w, h) {\r\n                    return function (context) {\r\n                        context.beginPath();\r\n                        context.strokeStyle = "rgba(0,0,236,0.5)";\r\n                        context.fillStyle = "rgba(0,0,236,0.1)";\r\n                        context.rect(x, y, w, h);\r\n                        context.fill();\r\n                        context.stroke();\r\n                        context.closePath();\r\n                    }\r\n                })(beginX, beginY, width, height)\r\n            );\r\n        dragX = event.x;\r\n        dragY = event.y;\r\n        downX = this.mouseDownEvent.x;\r\n        downY = this.mouseDownEvent.y;\r\n        beginX = dragX >= downX ? downX : dragX;\r\n        beginY = dragY >= downY ? downY : dragY;\r\n        width = Math.abs(event.dx);\r\n        height = Math.abs(event.dy);\r\n        var endX = beginX + width;\r\n        var endY = beginY + height;\r\n        this.childs.forEach(function (element) {\r\n            if (element.elementType !== \'link\') {\r\n                if (element.x > beginX && element.x + element.width < endX && element.y > beginY && element.y + element.height < endY) {\r\n                    if (self.notInSelectedNodes(element)) {\r\n                        element.selectedHandler(event);\r\n                        self.addToSelected(element);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    };\r\n    jtopo.Scene.prototype.mousemoveHandler = function (e) {\r\n        var event = this.toSceneEvent(e);\r\n        if (this.mode == jtopo.SceneMode.drag) {\r\n            return;\r\n        }\r\n        var element = this.getElementByXY(event.x, event.y);\r\n        if (null != element) {\r\n            if (this.mouseOverelement && this.mouseOverelement !== element) {\r\n                this.mouseOverelement.mouseoutHandler(event);\r\n            }\r\n            this.mouseOverelement = element;\r\n            event.target = element;\r\n            if (0 == element.isMouseOver) {\r\n                element.mouseoverHandler(event);\r\n                this.dispatchEvent("mouseover", event);\r\n            } else {\r\n                element.mousemoveHandler(event);\r\n                this.dispatchEvent("mousemove", event);\r\n            }\r\n        } else {\r\n            if (this.mouseOverelement) {\r\n                event.target = this.mouseOverelement;\r\n                this.mouseOverelement.mouseoutHandler(event);\r\n                this.mouseOverelement = null;\r\n                this.dispatchEvent("mouseout", event);\r\n            } else {\r\n                event.target = null;\r\n                this.dispatchEvent("mousemove", event)\r\n            }\r\n        }\r\n    };\r\n    jtopo.Scene.prototype.mouseoverHandler = function (event) {\r\n        this.dispatchEvent("mouseover", this.toSceneEvent(event))\r\n    };\r\n    jtopo.Scene.prototype.mouseoutHandler = function (event) {\r\n        this.dispatchEvent("mouseout", this.toSceneEvent(event))\r\n    };\r\n    jtopo.Scene.prototype.clickHandler = function (event) {\r\n        event = this.toSceneEvent(event);\r\n        if (this.currentElement) {\r\n            event.target = this.currentElement;\r\n            this.currentElement.clickHandler(event);\r\n        }\r\n        this.dispatchEvent("click", event);\r\n    };\r\n    jtopo.Scene.prototype.dbclickHandler = function (event) {\r\n        event = this.toSceneEvent(event);\r\n        if (this.currentElement) {\r\n            event.target = this.currentElement;\r\n            this.currentElement.dbclickHandler(event);\r\n        } else {\r\n            this.cancleAllSelected();\r\n        }\r\n        this.dispatchEvent("dbclick", event)\r\n    };\r\n    jtopo.Scene.prototype.mousewheelHandler = function (event) {\r\n        this.dispatchEvent("mousewheel", this.toSceneEvent(event));\r\n    };\r\n    jtopo.Scene.prototype.touchmove = this.mousedragHandler;\r\n    jtopo.Scene.prototype.touchend = this.mousedownHander;\r\n    jtopo.Scene.prototype.keydownHandler = function (a) {\r\n        this.dispatchEvent("keydown", a)\r\n    };\r\n    jtopo.Scene.prototype.keyupHandler = function (a) {\r\n        this.dispatchEvent("keyup", a)\r\n    };\r\n    jtopo.Scene.prototype.addEventListener = function (eventName, fn) {\r\n        var self = this;\r\n        var b = function (e) {\r\n            fn.call(self, e);\r\n        };\r\n        this.messageBus.subscribe(eventName, fn);\r\n        return this;\r\n    };\r\n    jtopo.Scene.prototype.removeEventListener = function (a, f) {\r\n        this.messageBus.unsubscribe(a, f)\r\n    };\r\n    jtopo.Scene.prototype.removeAllEventListener = function () {\r\n        this.messageBus = new jtopo.util.MessageBus\r\n    };\r\n    jtopo.Scene.prototype.dispatchEvent = function (a, b) {\r\n        this.messageBus.publish(a, b);\r\n        return  this;\r\n    };\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vc2NlbmUvZXZlbnQuanM/MTY3MiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIyMC5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzPWZ1bmN0aW9uKGp0b3BvKXtcclxuICAgIGZ1bmN0aW9uIGRvbW91c2VEb3duKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQgPSB0aGlzLnRvU2NlbmVFdmVudChldmVudCk7XHJcbiAgICAgICAgdGhpcy5tb3VzZURvd24gPSAhMDtcclxuICAgICAgICB0aGlzLm1vdXNlRG93blggPSBldmVudC54O1xyXG4gICAgICAgIHRoaXMubW91c2VEb3duWSA9IGV2ZW50Lnk7XHJcbiAgICAgICAgdGhpcy5tb3VzZURvd25FdmVudCA9IGV2ZW50O1xyXG4gICAgICAgIHN3aXRjaCAodGhpcy5tb2RlKSB7XHJcbiAgICAgICAgICAgIGNhc2UganRvcG8uU2NlbmVNb2RlLmRyYWc6XHJcbiAgICAgICAgICAgICAgICBpZiAoMSA9PSB0aGlzLnRyYW5zbGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdFRyYW5zbGF0ZVggPSB0aGlzLnRyYW5zbGF0ZVg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0VHJhbnNsYXRlWSA9IHRoaXMudHJhbnNsYXRlWTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGp0b3BvLlNjZW5lTW9kZS5zZWxlY3Q6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEVsZW1lbnQoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6Ly9qdG9wby5TY2VuZU1vZGUubm9ybWFsIHx8IGp0b3BvLlNjZW5lTW9kZS5lZGl0XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEVsZW1lbnQoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKChudWxsID09IHRoaXMuY3VycmVudEVsZW1lbnQgfHwgdGhpcy5jdXJyZW50RWxlbWVudCBpbnN0YW5jZW9mIGp0b3BvLkxpbmspICYmIDEgPT0gdGhpcy50cmFuc2xhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RUcmFuc2xhdGVYID0gdGhpcy50cmFuc2xhdGVYO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdFRyYW5zbGF0ZVkgPSB0aGlzLnRyYW5zbGF0ZVk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAganRvcG8uU2NlbmUucHJvdG90eXBlLmFkZFRvU2VsZWN0ZWQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRFbGVtZW50cy5wdXNoKGVsZW1lbnQpO1xyXG4gICAgfTtcclxuICAgIGp0b3BvLlNjZW5lLnByb3RvdHlwZS50b1NjZW5lRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBldmVudCA9IGp0b3BvLnV0aWwuY2xvbmUoZXZlbnQpO1xyXG4gICAgICAgIGV2ZW50LnggLz0gdGhpcy5zY2FsZVg7XHJcbiAgICAgICAgZXZlbnQueSAvPSB0aGlzLnNjYWxlWTtcclxuICAgICAgICBpZiAoMSA9PSB0aGlzLnRyYW5zbGF0ZSkge1xyXG4gICAgICAgICAgICB2YXIgZCA9IHRoaXMuZ2V0T2Zmc2V0VHJhbnNsYXRlKCk7XHJcbiAgICAgICAgICAgIGV2ZW50LnggLT0gZC50cmFuc2xhdGVYO1xyXG4gICAgICAgICAgICBldmVudC55IC09IGQudHJhbnNsYXRlWTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG51bGwgIT0gZXZlbnQuZHgpIHtcclxuICAgICAgICAgICAgZXZlbnQuZHggLz0gdGhpcy5zY2FsZVg7XHJcbiAgICAgICAgICAgIGV2ZW50LmR5IC89IHRoaXMuc2NhbGVZO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobnVsbCAhPSB0aGlzLmN1cnJlbnRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnRhcmdldCA9IHRoaXMuY3VycmVudEVsZW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGV2ZW50LnNjZW5lID0gdGhpcztcclxuICAgICAgICByZXR1cm4gZXZlbnRcclxuICAgIH07XHJcbiAgICBqdG9wby5TY2VuZS5wcm90b3R5cGUubm90SW5TZWxlY3RlZE5vZGVzID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICByZXR1cm4gISh0aGlzLnNlbGVjdGVkRWxlbWVudHMuaW5kZXhPZihlbGVtZW50KSA+IC0xKTtcclxuICAgIH07XHJcbiAgICBqdG9wby5TY2VuZS5wcm90b3R5cGUucmVtb3ZlRnJvbVNlbGVjdGVkID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkRWxlbWVudHMuZGVsKGVsZW1lbnQpO1xyXG4gICAgfTtcclxuICAgIGp0b3BvLlNjZW5lLnByb3RvdHlwZS5zZWxlY3RFbGVtZW50ID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmdldEVsZW1lbnRCeVhZKGV2ZW50LngsIGV2ZW50LnkpO1xyXG4gICAgICAgIGlmIChudWxsICE9IGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQudGFyZ2V0ID0gZWxlbWVudDtcclxuICAgICAgICAgICAgZWxlbWVudC5tb3VzZWRvd25IYW5kZXIoZXZlbnQpO1xyXG4gICAgICAgICAgICBlbGVtZW50LnNlbGVjdGVkSGFuZGxlcihldmVudCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vdEluU2VsZWN0ZWROb2RlcyhlbGVtZW50KSkge1xyXG4gICAgICAgICAgICAgICAgZXZlbnQuY3RybEtleSB8fCB0aGlzLmNhbmNsZUFsbFNlbGVjdGVkKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFRvU2VsZWN0ZWQoZWxlbWVudCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoMSA9PSBldmVudC5jdHJsS2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC51bnNlbGVjdGVkSGFuZGxlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRnJvbVNlbGVjdGVkKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWwuc2VsZWN0ZWRIYW5kbGVyKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBldmVudC5jdHJsS2V5IHx8IHRoaXMuY2FuY2xlQWxsU2VsZWN0ZWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jdXJyZW50RWxlbWVudCA9IGVsZW1lbnRcclxuICAgIH07XHJcbiAgICBqdG9wby5TY2VuZS5wcm90b3R5cGUuY2FuY2xlQWxsU2VsZWN0ZWQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQudW5zZWxlY3RlZEhhbmRsZXIoY29udGV4dCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZEVsZW1lbnRzID0gW107XHJcbiAgICB9O1xyXG4gICAganRvcG8uU2NlbmUucHJvdG90eXBlLmRyYWdFbGVtZW50cyA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGlmIChudWxsICE9IHRoaXMuY3VycmVudEVsZW1lbnQgJiYgMSA9PSB0aGlzLmN1cnJlbnRFbGVtZW50LmRyYWdnYWJsZSkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkRWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKDAgIT0gZWxlbWVudC5kcmFnZ2FibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZWxFdmVudCA9IGp0b3BvLnV0aWwuY2xvbmUoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsRXZlbnQudGFyZ2V0ID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lm1vdXNlZHJhZ0hhbmRsZXIoZWxFdmVudCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBqdG9wby5TY2VuZS5wcm90b3R5cGUubW91c2Vkb3duSGFuZGxlciA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGRvbW91c2VEb3duLmNhbGwodGhpcywgZXZlbnQpO1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlZG93blwiLCBldmVudCk7XHJcbiAgICB9O1xyXG4gICAganRvcG8uU2NlbmUucHJvdG90eXBlLnRvdWNoc3RhcnRIYW5kbGVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgZG9tb3VzZURvd24uY2FsbCh0aGlzLCBldmVudCk7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwidG91Y2hzdGFydFwiLCBldmVudCk7XHJcbiAgICB9O1xyXG4gICAganRvcG8uU2NlbmUucHJvdG90eXBlLm1vdXNldXBIYW5kbGVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIHNlbGY9dGhpcztcclxuICAgICAgICBzZWxmLmNsZWFyT3BlcmF0aW9ucygpO1xyXG4gICAgICAgIGV2ZW50ID0gdGhpcy50b1NjZW5lRXZlbnQoZXZlbnQpO1xyXG4gICAgICAgIGlmIChudWxsICE9IHRoaXMuY3VycmVudEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQudGFyZ2V0ID0gc2VsZi5jdXJyZW50RWxlbWVudDtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RWxlbWVudC5tb3VzZXVwSGFuZGxlcihldmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNldXBcIiwgZXZlbnQpO1xyXG4gICAgICAgIHRoaXMubW91c2VEb3duID0gITE7XHJcbiAgICB9O1xyXG4gICAganRvcG8uU2NlbmUucHJvdG90eXBlLm1vdXNlZHJhZ0hhbmRsZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBldmVudCA9IHRoaXMudG9TY2VuZUV2ZW50KGV2ZW50KTtcclxuICAgICAgICBzd2l0Y2ggKHRoaXMubW9kZSkge1xyXG4gICAgICAgICAgICBjYXNlIGp0b3BvLlNjZW5lTW9kZS5kcmFnOlxyXG4gICAgICAgICAgICAgICAgaWYgKDEgPT0gdGhpcy50cmFuc2xhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zbGF0ZVggPSB0aGlzLmxhc3RUcmFuc2xhdGVYICsgZXZlbnQuZHg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmFuc2xhdGVZID0gdGhpcy5sYXN0VHJhbnNsYXRlWSArIGV2ZW50LmR5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UganRvcG8uU2NlbmVNb2RlLnNlbGVjdDpcclxuICAgICAgICAgICAgICAgIGlmIChudWxsICE9IHRoaXMuY3VycmVudEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAxID09IHRoaXMuY3VycmVudEVsZW1lbnQuZHJhZ2dhYmxlICYmIHRoaXMuZHJhZ0VsZW1lbnRzKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgMSA9PSB0aGlzLmFyZWFTZWxlY3QgJiYgdGhpcy5hcmVhU2VsZWN0SGFuZGxlKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0Oi8vanRvcG8uU2NlbmVNb2RlLm5vcm1hbCB8fCBqdG9wby5TY2VuZU1vZGUuZWRpdFxyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gdGhpcy5jdXJyZW50RWxlbWVudCB8fCB0aGlzLmN1cnJlbnRFbGVtZW50IGluc3RhbmNlb2YganRvcG8uTGluaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgxID09IHRoaXMudHJhbnNsYXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlWCA9IHRoaXMubGFzdFRyYW5zbGF0ZVggKyBldmVudC5keDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50cmFuc2xhdGVZID0gdGhpcy5sYXN0VHJhbnNsYXRlWSArIGV2ZW50LmR5O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmFnRWxlbWVudHMoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZWRyYWdcIiwgZXZlbnQpO1xyXG4gICAgfTtcclxuICAgIGp0b3BvLlNjZW5lLnByb3RvdHlwZS5hcmVhU2VsZWN0SGFuZGxlID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIHNlbGY9dGhpcztcclxuICAgICAgICB2YXIgZHJhZ1ggPSBldmVudC5vZmZzZXRMZWZ0O1xyXG4gICAgICAgIHZhciBkcmFnWSA9IGV2ZW50Lm9mZnNldFRvcDtcclxuICAgICAgICB2YXIgZG93blggPSB0aGlzLm1vdXNlRG93bkV2ZW50Lm9mZnNldExlZnQ7XHJcbiAgICAgICAgdmFyIGRvd25ZID0gdGhpcy5tb3VzZURvd25FdmVudC5vZmZzZXRUb3A7XHJcbiAgICAgICAgdmFyIGJlZ2luWCA9IGRyYWdYID49IGRvd25YID8gZG93blggOiBkcmFnWDtcclxuICAgICAgICB2YXIgYmVnaW5ZID0gZHJhZ1kgPj0gZG93blkgPyBkb3duWSA6IGRyYWdZO1xyXG4gICAgICAgIHZhciB3aWR0aCA9IE1hdGguYWJzKGV2ZW50LmR4KSAqIHRoaXMuc2NhbGVYO1xyXG4gICAgICAgIHZhciBoZWlnaHQgPSBNYXRoLmFicyhldmVudC5keSkgKiB0aGlzLnNjYWxlWTtcclxuICAgICAgICB0aGlzLmNsZWFyT3BlcmF0aW9ucygpXHJcbiAgICAgICAgICAgIC5hZGRPcGVyYXRpb24oXHJcbiAgICAgICAgICAgICAgICAoZnVuY3Rpb24gKHgsIHksIHcsIGgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGNvbnRleHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9IFwicmdiYSgwLDAsMjM2LDAuNSlcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBcInJnYmEoMCwwLDIzNiwwLjEpXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQucmVjdCh4LCB5LCB3LCBoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5maWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSkoYmVnaW5YLCBiZWdpblksIHdpZHRoLCBoZWlnaHQpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgZHJhZ1ggPSBldmVudC54O1xyXG4gICAgICAgIGRyYWdZID0gZXZlbnQueTtcclxuICAgICAgICBkb3duWCA9IHRoaXMubW91c2VEb3duRXZlbnQueDtcclxuICAgICAgICBkb3duWSA9IHRoaXMubW91c2VEb3duRXZlbnQueTtcclxuICAgICAgICBiZWdpblggPSBkcmFnWCA+PSBkb3duWCA/IGRvd25YIDogZHJhZ1g7XHJcbiAgICAgICAgYmVnaW5ZID0gZHJhZ1kgPj0gZG93blkgPyBkb3duWSA6IGRyYWdZO1xyXG4gICAgICAgIHdpZHRoID0gTWF0aC5hYnMoZXZlbnQuZHgpO1xyXG4gICAgICAgIGhlaWdodCA9IE1hdGguYWJzKGV2ZW50LmR5KTtcclxuICAgICAgICB2YXIgZW5kWCA9IGJlZ2luWCArIHdpZHRoO1xyXG4gICAgICAgIHZhciBlbmRZID0gYmVnaW5ZICsgaGVpZ2h0O1xyXG4gICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuZWxlbWVudFR5cGUgIT09ICdsaW5rJykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQueCA+IGJlZ2luWCAmJiBlbGVtZW50LnggKyBlbGVtZW50LndpZHRoIDwgZW5kWCAmJiBlbGVtZW50LnkgPiBiZWdpblkgJiYgZWxlbWVudC55ICsgZWxlbWVudC5oZWlnaHQgPCBlbmRZKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYubm90SW5TZWxlY3RlZE5vZGVzKGVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc2VsZWN0ZWRIYW5kbGVyKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hZGRUb1NlbGVjdGVkKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIGp0b3BvLlNjZW5lLnByb3RvdHlwZS5tb3VzZW1vdmVIYW5kbGVyID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICB2YXIgZXZlbnQgPSB0aGlzLnRvU2NlbmVFdmVudChlKTtcclxuICAgICAgICBpZiAodGhpcy5tb2RlID09IGp0b3BvLlNjZW5lTW9kZS5kcmFnKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmdldEVsZW1lbnRCeVhZKGV2ZW50LngsIGV2ZW50LnkpO1xyXG4gICAgICAgIGlmIChudWxsICE9IGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubW91c2VPdmVyZWxlbWVudCAmJiB0aGlzLm1vdXNlT3ZlcmVsZW1lbnQgIT09IGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubW91c2VPdmVyZWxlbWVudC5tb3VzZW91dEhhbmRsZXIoZXZlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VPdmVyZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGV2ZW50LnRhcmdldCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGlmICgwID09IGVsZW1lbnQuaXNNb3VzZU92ZXIpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQubW91c2VvdmVySGFuZGxlcihldmVudCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW92ZXJcIiwgZXZlbnQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5tb3VzZW1vdmVIYW5kbGVyKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlbW92ZVwiLCBldmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tb3VzZU92ZXJlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC50YXJnZXQgPSB0aGlzLm1vdXNlT3ZlcmVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdXNlT3ZlcmVsZW1lbnQubW91c2VvdXRIYW5kbGVyKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubW91c2VPdmVyZWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW91dFwiLCBldmVudCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC50YXJnZXQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2Vtb3ZlXCIsIGV2ZW50KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGp0b3BvLlNjZW5lLnByb3RvdHlwZS5tb3VzZW92ZXJIYW5kbGVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VvdmVyXCIsIHRoaXMudG9TY2VuZUV2ZW50KGV2ZW50KSlcclxuICAgIH07XHJcbiAgICBqdG9wby5TY2VuZS5wcm90b3R5cGUubW91c2VvdXRIYW5kbGVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VvdXRcIiwgdGhpcy50b1NjZW5lRXZlbnQoZXZlbnQpKVxyXG4gICAgfTtcclxuICAgIGp0b3BvLlNjZW5lLnByb3RvdHlwZS5jbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBldmVudCA9IHRoaXMudG9TY2VuZUV2ZW50KGV2ZW50KTtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50RWxlbWVudCkge1xyXG4gICAgICAgICAgICBldmVudC50YXJnZXQgPSB0aGlzLmN1cnJlbnRFbGVtZW50O1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRFbGVtZW50LmNsaWNrSGFuZGxlcihldmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcImNsaWNrXCIsIGV2ZW50KTtcclxuICAgIH07XHJcbiAgICBqdG9wby5TY2VuZS5wcm90b3R5cGUuZGJjbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBldmVudCA9IHRoaXMudG9TY2VuZUV2ZW50KGV2ZW50KTtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50RWxlbWVudCkge1xyXG4gICAgICAgICAgICBldmVudC50YXJnZXQgPSB0aGlzLmN1cnJlbnRFbGVtZW50O1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRFbGVtZW50LmRiY2xpY2tIYW5kbGVyKGV2ZW50KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNhbmNsZUFsbFNlbGVjdGVkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcImRiY2xpY2tcIiwgZXZlbnQpXHJcbiAgICB9O1xyXG4gICAganRvcG8uU2NlbmUucHJvdG90eXBlLm1vdXNld2hlZWxIYW5kbGVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2V3aGVlbFwiLCB0aGlzLnRvU2NlbmVFdmVudChldmVudCkpO1xyXG4gICAgfTtcclxuICAgIGp0b3BvLlNjZW5lLnByb3RvdHlwZS50b3VjaG1vdmUgPSB0aGlzLm1vdXNlZHJhZ0hhbmRsZXI7XHJcbiAgICBqdG9wby5TY2VuZS5wcm90b3R5cGUudG91Y2hlbmQgPSB0aGlzLm1vdXNlZG93bkhhbmRlcjtcclxuICAgIGp0b3BvLlNjZW5lLnByb3RvdHlwZS5rZXlkb3duSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwia2V5ZG93blwiLCBhKVxyXG4gICAgfTtcclxuICAgIGp0b3BvLlNjZW5lLnByb3RvdHlwZS5rZXl1cEhhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcImtleXVwXCIsIGEpXHJcbiAgICB9O1xyXG4gICAganRvcG8uU2NlbmUucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBmbikge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgYiA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGZuLmNhbGwoc2VsZiwgZSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VCdXMuc3Vic2NyaWJlKGV2ZW50TmFtZSwgZm4pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIGp0b3BvLlNjZW5lLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGEsIGYpIHtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VCdXMudW5zdWJzY3JpYmUoYSwgZilcclxuICAgIH07XHJcbiAgICBqdG9wby5TY2VuZS5wcm90b3R5cGUucmVtb3ZlQWxsRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VCdXMgPSBuZXcganRvcG8udXRpbC5NZXNzYWdlQnVzXHJcbiAgICB9O1xyXG4gICAganRvcG8uU2NlbmUucHJvdG90eXBlLmRpc3BhdGNoRXZlbnQgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgIHRoaXMubWVzc2FnZUJ1cy5wdWJsaXNoKGEsIGIpO1xyXG4gICAgICAgIHJldHVybiAgdGhpcztcclxuICAgIH07XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vc2NlbmUvZXZlbnQuanNcbi8vIG1vZHVsZSBpZCA9IDIwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==');
},function(module,exports){eval("module.exports = function (jtopo) {\r\n    jtopo.Scene = Scene;\r\n    function Scene(stage) {\r\n        jtopo.Element.call(this);\r\n        if (null != stage) {\r\n            stage.add(this);\r\n        }\r\n        this.messageBus = new jtopo.util.MessageBus;\r\n        this.elementType = \"scene\";\r\n        this.childs = [];\r\n        this.zIndexMap = {};\r\n        this.zIndexArray = [];\r\n        this.backgroundColor = \"255,255,255\";\r\n        this.visible = !0;\r\n        this.alpha = 0;\r\n        this.scaleX = 1;\r\n        this.scaleY = 1;\r\n        this.mode = jtopo.SceneMode.normal;\r\n        this.translate = !0;\r\n        this.translateX = 0;\r\n        this.translateY = 0;\r\n        this.lastTranslateX = 0;\r\n        this.lastTranslateY = 0;\r\n        this.mouseDown = !1;\r\n        this.mouseDownX = null;\r\n        this.mouseDownY = null;\r\n        this.mouseDownEvent = null;\r\n        this.areaSelect = !0;\r\n        this.operations = [];\r\n        this.selectedElements = [];\r\n        this.paintAll = !1;\r\n        var c = \"background,backgroundColor,mode,paintAll,areaSelect,translate,translateX,translateY,lastTranslatedX,lastTranslatedY,alpha,visible,scaleX,scaleY\".split(\",\");\r\n        this.serializedProperties = this.serializedProperties.concat(c);\r\n    }\r\n    jtopo.util.inherits(Scene,jtopo.Element);\r\n    Object.defineProperties(Scene.prototype, {\r\n        background: {\r\n            get: function () {\r\n                return this._background\r\n            },\r\n            set: (function () {\r\n                var imgCatch = {};\r\n                return function (img) {\r\n                    if (\"string\" == typeof img) {\r\n                        var catched = imgCatch[img];\r\n                        if (null == catched) {\r\n                            catched = new Image;\r\n                            catched.src = img;\r\n                            catched.onload = function () {\r\n                                imgCatch[img] = catched\r\n                            }\r\n                        }\r\n                        this._background = catched;\r\n                    } else {\r\n                        this._background = img;\r\n                    }\r\n                }\r\n            })()\r\n        }\r\n    });\r\n    ['click', 'dbclick', 'mousedown', 'mouseup', 'mouseover', 'mouseout', 'mousemove', 'mousedrag', 'mousewheel', 'touchstart', 'touchmove', 'touchend', 'keydown', 'keyup']\r\n        .forEach(function (name) {\r\n            Scene.prototype[name] = function (fn) {\r\n                if (null != fn) {\r\n                    this.addEventListener(name, fn);\r\n                } else {\r\n                    this.dispatchEvent(name);\r\n                }\r\n            }\r\n        });\r\n    Scene.prototype.setBackground = function (background) {\r\n        this.background = background;\r\n    };\r\n    Scene.prototype.show = function () {\r\n        this.visible = !0\r\n    };\r\n    Scene.prototype.hide = function () {\r\n        this.visible = !1\r\n    };\r\n    Scene.prototype.paint = function (context) {\r\n        if (0 != this.visible && null != this.stage) {\r\n            context.save();\r\n            this.paintBackgroud(context);\r\n            context.restore();\r\n            context.save();\r\n            context.scale(this.scaleX, this.scaleY);\r\n            if (1 == this.translate) {\r\n                var translated = this.getOffsetTranslate();\r\n                context.translate(translated.translateX, translated.translateY)\r\n            }\r\n            this.paintChilds(context);\r\n            context.restore();\r\n            context.save();\r\n            this.paintOperations(context);\r\n            context.restore();\r\n        }\r\n    };\r\n    Scene.prototype.paintBackgroud = function (context) {\r\n        if (null != this.background) {\r\n            context.drawImage(this.background, 0, 0, context.canvas.width, context.canvas.height)\r\n        } else {\r\n            context.beginPath();\r\n            context.fillStyle = \"rgba(\" + this.backgroundColor + \",\" + this.alpha + \")\";\r\n            context.fillRect(0, 0, context.canvas.width, context.canvas.height);\r\n            context.closePath();\r\n        }\r\n    };\r\n    Scene.prototype.getDisplayedElements = function () {\r\n        var self = this;\r\n        var elements = [];\r\n        this.zIndexArray.forEach(function (zIndex) {\r\n            self.zIndexMap[zIndex].forEach(function (element) {\r\n                if (self.needPaint(element)) {\r\n                    elements.push(element)\r\n                }\r\n            });\r\n        });\r\n        return elements\r\n    };\r\n    Scene.prototype.getDisplayedNodes = function () {\r\n        var self = this;\r\n        return this.childs.filter(function (child) {\r\n            return child instanceof jtopo.Node && self.needPaint(child);\r\n        });\r\n    };\r\n    Scene.prototype.paintChilds = function (context) {\r\n        var self = this;\r\n        this.zIndexArray.forEach(function (zIndex) {\r\n            self.zIndexMap[zIndex].forEach(function (element) {\r\n                if (1 == self.paintAll || self.needPaint(element)) {\r\n                    context.save();\r\n                    if (1 == element.transformAble) {\r\n                        var center = element.getCenterLocation();\r\n                        context.translate(center.x, center.y);\r\n                        if (element.rotate) {\r\n                            context.rotate(element.rotate);\r\n                        }\r\n                        if (element.scaleX && element.scaleY) {\r\n                            context.scale(element.scaleX, element.scaleY)\r\n                        } else if (element.scaleX) {\r\n                            context.scale(element.scaleX, 1);\r\n                        } else if (element.scaleY) {\r\n                            context.scale(1, element.scaleY);\r\n                        }\r\n                    }\r\n                    if (1 == element.shadow) {\r\n                        context.shadowBlur = element.shadowBlur;\r\n                        context.shadowColor = element.shadowColor;\r\n                        context.shadowOffsetX = element.shadowOffsetX;\r\n                        context.shadowOffsetY = element.shadowOffsetY;\r\n                    }\r\n                    if (element instanceof jtopo.InteractiveElement) {\r\n                        if (element.selected && 1 == element.showSelected) {\r\n                            element.paintSelected(context)\r\n                        }\r\n                        if (1 == element.isMouseOver) {\r\n                            element.paintMouseover(context)\r\n                        }\r\n                    }\r\n                    element.paint(context);\r\n                    context.restore();\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Scene.prototype.getOffsetTranslate = function () {\r\n        var width = this.stage.canvas.width;\r\n        var height = this.stage.canvas.height;\r\n        var centerX = width / this.scaleX / 2;\r\n        var centerY = height / this.scaleY / 2;\r\n        return {\r\n            translateX: this.translateX + (centerX - centerX * this.scaleX),\r\n            translateY: this.translateY + (centerY - centerY * this.scaleY)\r\n        };\r\n    };\r\n    Scene.prototype.needPaint = function (element) {\r\n        var self = this;\r\n        if (1 == element.visible) {\r\n            if (element instanceof jtopo.Link) {\r\n                return self.needPaint(element.nodeA) || self.needPaint(element.nodeZ);\r\n            } else {\r\n                var sceneOffset = this.getOffsetTranslate();\r\n                var positionX = element.x + sceneOffset.translateX;\r\n                var positionY = element.y + sceneOffset.translateY;\r\n                positionX *= this.scaleX;\r\n                positionY *= this.scaleY;\r\n                var rightX = positionX + element.width * this.scaleX;\r\n                var rightY = positionY + element.height * this.scaleY;\r\n                return positionX < this.stage.canvas.width && positionY < this.stage.canvas.height && 0 < rightX && 0 < rightY;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    Scene.prototype.paintOperations = function (context) {\r\n        this.operations.forEach(function (option) {\r\n            if (typeof option == 'function') {\r\n                option(context);\r\n            }\r\n        })\r\n    };\r\n    Scene.prototype.addOperation = function (a) {\r\n        this.operations.push(a);\r\n        return this;\r\n    };\r\n    Scene.prototype.clearOperations = function () {\r\n        this.operations = [];\r\n        return this;\r\n    };\r\n    Scene.prototype.findElements = function (fn) {\r\n        return typeof fn == 'function' ?\r\n            this.childs.filter(function (child) {\r\n                return 1 == fn(child);\r\n            })\r\n            : [];\r\n    };\r\n    Scene.prototype.getElementsByClass = function (clazz) {\r\n        return this.findElements(function (element) {\r\n            return element instanceof clazz\r\n        })\r\n    };\r\n    Scene.prototype.getElementByXY = function (x, y) {\r\n        var element = null;\r\n        for (var i = this.zIndexArray.length - 1; i >= 0; i--) {\r\n            var zIndex = this.zIndexArray[i];\r\n            var elements = this.zIndexMap[zIndex];\r\n            for (var j = elements.length - 1; j >= 0; j--) {\r\n                var el = elements[j];\r\n                if (el instanceof jtopo.InteractiveElement && this.needPaint(el) && el.isInBound(x, y)) {\r\n                    return el;\r\n                }\r\n            }\r\n        }\r\n        return element\r\n    };\r\n    Scene.prototype.add = function (element) {\r\n        this.childs.push(element);\r\n        if (null == this.zIndexMap[element.zIndex]) {\r\n            this.zIndexMap[element.zIndex] = [];\r\n            this.zIndexArray.push(element.zIndex);\r\n            this.zIndexArray.sort(function (a, b) {\r\n                return a - b\r\n            });\r\n        }\r\n        this.zIndexMap[\"\" + element.zIndex].push(element);\r\n    };\r\n    Scene.prototype.remove = function (element) {\r\n        this.childs = jtopo.util.removeFromArray(this.childs, element);\r\n        var elements = this.zIndexMap[element.zIndex];\r\n        if (elements) {\r\n            this.zIndexMap[element.zIndex] = jtopo.util.removeFromArray(elements, element);\r\n        }\r\n        element.removeHandler(this);\r\n    };\r\n    Scene.prototype.clear = function () {\r\n        var self = this;\r\n        this.childs.forEach(function (child) {\r\n            child.removeHandler(self);\r\n        });\r\n        this.childs = [];\r\n        this.operations = [];\r\n        this.zIndexArray = [];\r\n        this.zIndexMap = {};\r\n    };\r\n    Scene.prototype.zoom = function (x, y) {\r\n        if (typeof x !== 'undefined') {\r\n            this.scaleX = x > 0 ? x : 1;\r\n        }\r\n        if (typeof y !== 'undefined') {\r\n            this.scaleY = y > 0 ? y : 1;\r\n        }\r\n    };\r\n    Scene.prototype.zoomOut = function (scale) {\r\n        if (typeof scale == 'undefined' || scale <= 0) {\r\n            scale = 0.8;\r\n        }\r\n        this.scaleX /= scale;\r\n        this.scaleY /= scale;\r\n    };\r\n    Scene.prototype.zoomIn = function (scale) {\r\n        if (typeof scale == 'undefined' || scale <= 0) {\r\n            scale = 0.8;\r\n        }\r\n        this.scaleX *= scale;\r\n        this.scaleY *= scale;\r\n    };\r\n    Scene.prototype.getBound = function () {\r\n        return {\r\n            left: 0,\r\n            top: 0,\r\n            right: this.stage.canvas.width,\r\n            bottom: this.stage.canvas.height,\r\n            width: this.stage.canvas.width,\r\n            height: this.stage.canvas.height\r\n        }\r\n    };\r\n    Scene.prototype.getElementsBound = function () {\r\n        return jtopo.util.getElementsBound(this.childs)\r\n    };\r\n    Scene.prototype.translateToCenter = function (stage) {\r\n        var bound = this.getElementsBound();\r\n        var tanselateX = this.stage.canvas.width / 2 - (bound.left + bound.right) / 2;\r\n        var translateY = this.stage.canvas.height / 2 - (bound.top + bound.bottom) / 2;\r\n        if (stage) {\r\n            tanselateX = stage.canvas.width / 2 - (bound.left + bound.right) / 2;\r\n            translateY = stage.canvas.height / 2 - (bound.top + bound.bottom) / 2;\r\n        }\r\n        this.translateX = tanselateX;\r\n        this.translateY = translateY;\r\n    };\r\n    Scene.prototype.setCenter = function (x, y) {\r\n        this.translateX = (this.stage.canvas.width / 2) - x;\r\n        this.translateY = (this.stage.canvas.height / 2) - y;\r\n    };\r\n    Scene.prototype.centerAndZoom = function (scaleX, scaleY, stage) {\r\n        this.translateToCenter(stage);\r\n        if (null == scaleX || null == scaleY) {\r\n            var bound = this.getElementsBound();\r\n            scaleX = this.stage.canvas.width / bound.width;\r\n            scaleY = this.stage.canvas.height / bound.height;\r\n            if (stage) {\r\n                scaleX = stage.canvas.width / bound.width;\r\n                scaleY = stage.canvas.height / bound.height;\r\n            }\r\n            var scale = Math.min(scaleX, scaleY);\r\n            if (scale > 1)return;\r\n            this.zoom(scale, scale);\r\n        } else {\r\n            this.zoom(scaleX, scaleY);\r\n        }\r\n    };\r\n    Scene.prototype.getCenterLocation = function () {\r\n        return {\r\n            x: this.stage.canvas.width / 2,\r\n            y: this.stage.canvas.height / 2\r\n        }\r\n    };\r\n    Scene.prototype.doLayout = function (fn) {\r\n        if (fn) {\r\n            fn(this, this.childs);\r\n        }\r\n    };\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vc2NlbmUvc2NlbmUuanM/Njg0ZiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsUUFBUTtBQUN6RDtBQUNBO0FBQ0EsNkNBQTZDLFFBQVE7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIyMS5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICBqdG9wby5TY2VuZSA9IFNjZW5lO1xyXG4gICAgZnVuY3Rpb24gU2NlbmUoc3RhZ2UpIHtcclxuICAgICAgICBqdG9wby5FbGVtZW50LmNhbGwodGhpcyk7XHJcbiAgICAgICAgaWYgKG51bGwgIT0gc3RhZ2UpIHtcclxuICAgICAgICAgICAgc3RhZ2UuYWRkKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm1lc3NhZ2VCdXMgPSBuZXcganRvcG8udXRpbC5NZXNzYWdlQnVzO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudFR5cGUgPSBcInNjZW5lXCI7XHJcbiAgICAgICAgdGhpcy5jaGlsZHMgPSBbXTtcclxuICAgICAgICB0aGlzLnpJbmRleE1hcCA9IHt9O1xyXG4gICAgICAgIHRoaXMuekluZGV4QXJyYXkgPSBbXTtcclxuICAgICAgICB0aGlzLmJhY2tncm91bmRDb2xvciA9IFwiMjU1LDI1NSwyNTVcIjtcclxuICAgICAgICB0aGlzLnZpc2libGUgPSAhMDtcclxuICAgICAgICB0aGlzLmFscGhhID0gMDtcclxuICAgICAgICB0aGlzLnNjYWxlWCA9IDE7XHJcbiAgICAgICAgdGhpcy5zY2FsZVkgPSAxO1xyXG4gICAgICAgIHRoaXMubW9kZSA9IGp0b3BvLlNjZW5lTW9kZS5ub3JtYWw7XHJcbiAgICAgICAgdGhpcy50cmFuc2xhdGUgPSAhMDtcclxuICAgICAgICB0aGlzLnRyYW5zbGF0ZVggPSAwO1xyXG4gICAgICAgIHRoaXMudHJhbnNsYXRlWSA9IDA7XHJcbiAgICAgICAgdGhpcy5sYXN0VHJhbnNsYXRlWCA9IDA7XHJcbiAgICAgICAgdGhpcy5sYXN0VHJhbnNsYXRlWSA9IDA7XHJcbiAgICAgICAgdGhpcy5tb3VzZURvd24gPSAhMTtcclxuICAgICAgICB0aGlzLm1vdXNlRG93blggPSBudWxsO1xyXG4gICAgICAgIHRoaXMubW91c2VEb3duWSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5tb3VzZURvd25FdmVudCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5hcmVhU2VsZWN0ID0gITA7XHJcbiAgICAgICAgdGhpcy5vcGVyYXRpb25zID0gW107XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZEVsZW1lbnRzID0gW107XHJcbiAgICAgICAgdGhpcy5wYWludEFsbCA9ICExO1xyXG4gICAgICAgIHZhciBjID0gXCJiYWNrZ3JvdW5kLGJhY2tncm91bmRDb2xvcixtb2RlLHBhaW50QWxsLGFyZWFTZWxlY3QsdHJhbnNsYXRlLHRyYW5zbGF0ZVgsdHJhbnNsYXRlWSxsYXN0VHJhbnNsYXRlZFgsbGFzdFRyYW5zbGF0ZWRZLGFscGhhLHZpc2libGUsc2NhbGVYLHNjYWxlWVwiLnNwbGl0KFwiLFwiKTtcclxuICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzID0gdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5jb25jYXQoYyk7XHJcbiAgICB9XHJcbiAgICBqdG9wby51dGlsLmluaGVyaXRzKFNjZW5lLGp0b3BvLkVsZW1lbnQpO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoU2NlbmUucHJvdG90eXBlLCB7XHJcbiAgICAgICAgYmFja2dyb3VuZDoge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNrZ3JvdW5kXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldDogKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpbWdDYXRjaCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChpbWcpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgaW1nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYXRjaGVkID0gaW1nQ2F0Y2hbaW1nXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gY2F0Y2hlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2hlZCA9IG5ldyBJbWFnZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoZWQuc3JjID0gaW1nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2hlZC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1nQ2F0Y2hbaW1nXSA9IGNhdGNoZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9iYWNrZ3JvdW5kID0gY2F0Y2hlZDtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9iYWNrZ3JvdW5kID0gaW1nO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSkoKVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgWydjbGljaycsICdkYmNsaWNrJywgJ21vdXNlZG93bicsICdtb3VzZXVwJywgJ21vdXNlb3ZlcicsICdtb3VzZW91dCcsICdtb3VzZW1vdmUnLCAnbW91c2VkcmFnJywgJ21vdXNld2hlZWwnLCAndG91Y2hzdGFydCcsICd0b3VjaG1vdmUnLCAndG91Y2hlbmQnLCAna2V5ZG93bicsICdrZXl1cCddXHJcbiAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgICAgICAgICAgU2NlbmUucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBmbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBmbik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuYW1lKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgU2NlbmUucHJvdG90eXBlLnNldEJhY2tncm91bmQgPSBmdW5jdGlvbiAoYmFja2dyb3VuZCkge1xyXG4gICAgICAgIHRoaXMuYmFja2dyb3VuZCA9IGJhY2tncm91bmQ7XHJcbiAgICB9O1xyXG4gICAgU2NlbmUucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy52aXNpYmxlID0gITBcclxuICAgIH07XHJcbiAgICBTY2VuZS5wcm90b3R5cGUuaGlkZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnZpc2libGUgPSAhMVxyXG4gICAgfTtcclxuICAgIFNjZW5lLnByb3RvdHlwZS5wYWludCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKDAgIT0gdGhpcy52aXNpYmxlICYmIG51bGwgIT0gdGhpcy5zdGFnZSkge1xyXG4gICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcclxuICAgICAgICAgICAgdGhpcy5wYWludEJhY2tncm91ZChjb250ZXh0KTtcclxuICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgICAgICBjb250ZXh0LnNjYWxlKHRoaXMuc2NhbGVYLCB0aGlzLnNjYWxlWSk7XHJcbiAgICAgICAgICAgIGlmICgxID09IHRoaXMudHJhbnNsYXRlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdHJhbnNsYXRlZCA9IHRoaXMuZ2V0T2Zmc2V0VHJhbnNsYXRlKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZSh0cmFuc2xhdGVkLnRyYW5zbGF0ZVgsIHRyYW5zbGF0ZWQudHJhbnNsYXRlWSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnBhaW50Q2hpbGRzKGNvbnRleHQpO1xyXG4gICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGFpbnRPcGVyYXRpb25zKGNvbnRleHQpO1xyXG4gICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgU2NlbmUucHJvdG90eXBlLnBhaW50QmFja2dyb3VkID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcclxuICAgICAgICBpZiAobnVsbCAhPSB0aGlzLmJhY2tncm91bmQpIHtcclxuICAgICAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UodGhpcy5iYWNrZ3JvdW5kLCAwLCAwLCBjb250ZXh0LmNhbnZhcy53aWR0aCwgY29udGV4dC5jYW52YXMuaGVpZ2h0KVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgY29udGV4dC5maWxsUmVjdCgwLCAwLCBjb250ZXh0LmNhbnZhcy53aWR0aCwgY29udGV4dC5jYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgU2NlbmUucHJvdG90eXBlLmdldERpc3BsYXllZEVsZW1lbnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgZWxlbWVudHMgPSBbXTtcclxuICAgICAgICB0aGlzLnpJbmRleEFycmF5LmZvckVhY2goZnVuY3Rpb24gKHpJbmRleCkge1xyXG4gICAgICAgICAgICBzZWxmLnpJbmRleE1hcFt6SW5kZXhdLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLm5lZWRQYWludChlbGVtZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzLnB1c2goZWxlbWVudClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGVsZW1lbnRzXHJcbiAgICB9O1xyXG4gICAgU2NlbmUucHJvdG90eXBlLmdldERpc3BsYXllZE5vZGVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5jaGlsZHMuZmlsdGVyKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGQgaW5zdGFuY2VvZiBqdG9wby5Ob2RlICYmIHNlbGYubmVlZFBhaW50KGNoaWxkKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBTY2VuZS5wcm90b3R5cGUucGFpbnRDaGlsZHMgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLnpJbmRleEFycmF5LmZvckVhY2goZnVuY3Rpb24gKHpJbmRleCkge1xyXG4gICAgICAgICAgICBzZWxmLnpJbmRleE1hcFt6SW5kZXhdLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmICgxID09IHNlbGYucGFpbnRBbGwgfHwgc2VsZi5uZWVkUGFpbnQoZWxlbWVudCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoMSA9PSBlbGVtZW50LnRyYW5zZm9ybUFibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IGVsZW1lbnQuZ2V0Q2VudGVyTG9jYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC50cmFuc2xhdGUoY2VudGVyLngsIGNlbnRlci55KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQucm90YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnJvdGF0ZShlbGVtZW50LnJvdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuc2NhbGVYICYmIGVsZW1lbnQuc2NhbGVZKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnNjYWxlKGVsZW1lbnQuc2NhbGVYLCBlbGVtZW50LnNjYWxlWSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50LnNjYWxlWCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zY2FsZShlbGVtZW50LnNjYWxlWCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5zY2FsZVkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2NhbGUoMSwgZWxlbWVudC5zY2FsZVkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgxID09IGVsZW1lbnQuc2hhZG93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2hhZG93Qmx1ciA9IGVsZW1lbnQuc2hhZG93Qmx1cjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zaGFkb3dDb2xvciA9IGVsZW1lbnQuc2hhZG93Q29sb3I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2hhZG93T2Zmc2V0WCA9IGVsZW1lbnQuc2hhZG93T2Zmc2V0WDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zaGFkb3dPZmZzZXRZID0gZWxlbWVudC5zaGFkb3dPZmZzZXRZO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIGp0b3BvLkludGVyYWN0aXZlRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5zZWxlY3RlZCAmJiAxID09IGVsZW1lbnQuc2hvd1NlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnBhaW50U2VsZWN0ZWQoY29udGV4dClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoMSA9PSBlbGVtZW50LmlzTW91c2VPdmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnBhaW50TW91c2VvdmVyKGNvbnRleHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5wYWludChjb250ZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgU2NlbmUucHJvdG90eXBlLmdldE9mZnNldFRyYW5zbGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgd2lkdGggPSB0aGlzLnN0YWdlLmNhbnZhcy53aWR0aDtcclxuICAgICAgICB2YXIgaGVpZ2h0ID0gdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0O1xyXG4gICAgICAgIHZhciBjZW50ZXJYID0gd2lkdGggLyB0aGlzLnNjYWxlWCAvIDI7XHJcbiAgICAgICAgdmFyIGNlbnRlclkgPSBoZWlnaHQgLyB0aGlzLnNjYWxlWSAvIDI7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdHJhbnNsYXRlWDogdGhpcy50cmFuc2xhdGVYICsgKGNlbnRlclggLSBjZW50ZXJYICogdGhpcy5zY2FsZVgpLFxyXG4gICAgICAgICAgICB0cmFuc2xhdGVZOiB0aGlzLnRyYW5zbGF0ZVkgKyAoY2VudGVyWSAtIGNlbnRlclkgKiB0aGlzLnNjYWxlWSlcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIFNjZW5lLnByb3RvdHlwZS5uZWVkUGFpbnQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoMSA9PSBlbGVtZW50LnZpc2libGUpIHtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBqdG9wby5MaW5rKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5uZWVkUGFpbnQoZWxlbWVudC5ub2RlQSkgfHwgc2VsZi5uZWVkUGFpbnQoZWxlbWVudC5ub2RlWik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2NlbmVPZmZzZXQgPSB0aGlzLmdldE9mZnNldFRyYW5zbGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHBvc2l0aW9uWCA9IGVsZW1lbnQueCArIHNjZW5lT2Zmc2V0LnRyYW5zbGF0ZVg7XHJcbiAgICAgICAgICAgICAgICB2YXIgcG9zaXRpb25ZID0gZWxlbWVudC55ICsgc2NlbmVPZmZzZXQudHJhbnNsYXRlWTtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uWCAqPSB0aGlzLnNjYWxlWDtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uWSAqPSB0aGlzLnNjYWxlWTtcclxuICAgICAgICAgICAgICAgIHZhciByaWdodFggPSBwb3NpdGlvblggKyBlbGVtZW50LndpZHRoICogdGhpcy5zY2FsZVg7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmlnaHRZID0gcG9zaXRpb25ZICsgZWxlbWVudC5oZWlnaHQgKiB0aGlzLnNjYWxlWTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwb3NpdGlvblggPCB0aGlzLnN0YWdlLmNhbnZhcy53aWR0aCAmJiBwb3NpdGlvblkgPCB0aGlzLnN0YWdlLmNhbnZhcy5oZWlnaHQgJiYgMCA8IHJpZ2h0WCAmJiAwIDwgcmlnaHRZO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICBTY2VuZS5wcm90b3R5cGUucGFpbnRPcGVyYXRpb25zID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcclxuICAgICAgICB0aGlzLm9wZXJhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAob3B0aW9uKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0aW9uID09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIG9wdGlvbihjb250ZXh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9O1xyXG4gICAgU2NlbmUucHJvdG90eXBlLmFkZE9wZXJhdGlvbiA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgdGhpcy5vcGVyYXRpb25zLnB1c2goYSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgU2NlbmUucHJvdG90eXBlLmNsZWFyT3BlcmF0aW9ucyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLm9wZXJhdGlvbnMgPSBbXTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBTY2VuZS5wcm90b3R5cGUuZmluZEVsZW1lbnRzID0gZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBmbiA9PSAnZnVuY3Rpb24nID9cclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMuZmlsdGVyKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDEgPT0gZm4oY2hpbGQpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICA6IFtdO1xyXG4gICAgfTtcclxuICAgIFNjZW5lLnByb3RvdHlwZS5nZXRFbGVtZW50c0J5Q2xhc3MgPSBmdW5jdGlvbiAoY2xhenopIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5maW5kRWxlbWVudHMoZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQgaW5zdGFuY2VvZiBjbGF6elxyXG4gICAgICAgIH0pXHJcbiAgICB9O1xyXG4gICAgU2NlbmUucHJvdG90eXBlLmdldEVsZW1lbnRCeVhZID0gZnVuY3Rpb24gKHgsIHkpIHtcclxuICAgICAgICB2YXIgZWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuekluZGV4QXJyYXkubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICAgICAgdmFyIHpJbmRleCA9IHRoaXMuekluZGV4QXJyYXlbaV07XHJcbiAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IHRoaXMuekluZGV4TWFwW3pJbmRleF07XHJcbiAgICAgICAgICAgIGZvciAodmFyIGogPSBlbGVtZW50cy5sZW5ndGggLSAxOyBqID49IDA7IGotLSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGVsID0gZWxlbWVudHNbal07XHJcbiAgICAgICAgICAgICAgICBpZiAoZWwgaW5zdGFuY2VvZiBqdG9wby5JbnRlcmFjdGl2ZUVsZW1lbnQgJiYgdGhpcy5uZWVkUGFpbnQoZWwpICYmIGVsLmlzSW5Cb3VuZCh4LCB5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZWxlbWVudFxyXG4gICAgfTtcclxuICAgIFNjZW5lLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuY2hpbGRzLnB1c2goZWxlbWVudCk7XHJcbiAgICAgICAgaWYgKG51bGwgPT0gdGhpcy56SW5kZXhNYXBbZWxlbWVudC56SW5kZXhdKSB7XHJcbiAgICAgICAgICAgIHRoaXMuekluZGV4TWFwW2VsZW1lbnQuekluZGV4XSA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLnpJbmRleEFycmF5LnB1c2goZWxlbWVudC56SW5kZXgpO1xyXG4gICAgICAgICAgICB0aGlzLnpJbmRleEFycmF5LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhIC0gYlxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy56SW5kZXhNYXBbXCJcIiArIGVsZW1lbnQuekluZGV4XS5wdXNoKGVsZW1lbnQpO1xyXG4gICAgfTtcclxuICAgIFNjZW5lLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuY2hpbGRzID0ganRvcG8udXRpbC5yZW1vdmVGcm9tQXJyYXkodGhpcy5jaGlsZHMsIGVsZW1lbnQpO1xyXG4gICAgICAgIHZhciBlbGVtZW50cyA9IHRoaXMuekluZGV4TWFwW2VsZW1lbnQuekluZGV4XTtcclxuICAgICAgICBpZiAoZWxlbWVudHMpIHtcclxuICAgICAgICAgICAgdGhpcy56SW5kZXhNYXBbZWxlbWVudC56SW5kZXhdID0ganRvcG8udXRpbC5yZW1vdmVGcm9tQXJyYXkoZWxlbWVudHMsIGVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbGVtZW50LnJlbW92ZUhhbmRsZXIodGhpcyk7XHJcbiAgICB9O1xyXG4gICAgU2NlbmUucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICBjaGlsZC5yZW1vdmVIYW5kbGVyKHNlbGYpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY2hpbGRzID0gW107XHJcbiAgICAgICAgdGhpcy5vcGVyYXRpb25zID0gW107XHJcbiAgICAgICAgdGhpcy56SW5kZXhBcnJheSA9IFtdO1xyXG4gICAgICAgIHRoaXMuekluZGV4TWFwID0ge307XHJcbiAgICB9O1xyXG4gICAgU2NlbmUucHJvdG90eXBlLnpvb20gPSBmdW5jdGlvbiAoeCwgeSkge1xyXG4gICAgICAgIGlmICh0eXBlb2YgeCAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgdGhpcy5zY2FsZVggPSB4ID4gMCA/IHggOiAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodHlwZW9mIHkgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2NhbGVZID0geSA+IDAgPyB5IDogMTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgU2NlbmUucHJvdG90eXBlLnpvb21PdXQgPSBmdW5jdGlvbiAoc2NhbGUpIHtcclxuICAgICAgICBpZiAodHlwZW9mIHNjYWxlID09ICd1bmRlZmluZWQnIHx8IHNjYWxlIDw9IDApIHtcclxuICAgICAgICAgICAgc2NhbGUgPSAwLjg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2NhbGVYIC89IHNjYWxlO1xyXG4gICAgICAgIHRoaXMuc2NhbGVZIC89IHNjYWxlO1xyXG4gICAgfTtcclxuICAgIFNjZW5lLnByb3RvdHlwZS56b29tSW4gPSBmdW5jdGlvbiAoc2NhbGUpIHtcclxuICAgICAgICBpZiAodHlwZW9mIHNjYWxlID09ICd1bmRlZmluZWQnIHx8IHNjYWxlIDw9IDApIHtcclxuICAgICAgICAgICAgc2NhbGUgPSAwLjg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2NhbGVYICo9IHNjYWxlO1xyXG4gICAgICAgIHRoaXMuc2NhbGVZICo9IHNjYWxlO1xyXG4gICAgfTtcclxuICAgIFNjZW5lLnByb3RvdHlwZS5nZXRCb3VuZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBsZWZ0OiAwLFxyXG4gICAgICAgICAgICB0b3A6IDAsXHJcbiAgICAgICAgICAgIHJpZ2h0OiB0aGlzLnN0YWdlLmNhbnZhcy53aWR0aCxcclxuICAgICAgICAgICAgYm90dG9tOiB0aGlzLnN0YWdlLmNhbnZhcy5oZWlnaHQsXHJcbiAgICAgICAgICAgIHdpZHRoOiB0aGlzLnN0YWdlLmNhbnZhcy53aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLnN0YWdlLmNhbnZhcy5oZWlnaHRcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgU2NlbmUucHJvdG90eXBlLmdldEVsZW1lbnRzQm91bmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIGp0b3BvLnV0aWwuZ2V0RWxlbWVudHNCb3VuZCh0aGlzLmNoaWxkcylcclxuICAgIH07XHJcbiAgICBTY2VuZS5wcm90b3R5cGUudHJhbnNsYXRlVG9DZW50ZXIgPSBmdW5jdGlvbiAoc3RhZ2UpIHtcclxuICAgICAgICB2YXIgYm91bmQgPSB0aGlzLmdldEVsZW1lbnRzQm91bmQoKTtcclxuICAgICAgICB2YXIgdGFuc2VsYXRlWCA9IHRoaXMuc3RhZ2UuY2FudmFzLndpZHRoIC8gMiAtIChib3VuZC5sZWZ0ICsgYm91bmQucmlnaHQpIC8gMjtcclxuICAgICAgICB2YXIgdHJhbnNsYXRlWSA9IHRoaXMuc3RhZ2UuY2FudmFzLmhlaWdodCAvIDIgLSAoYm91bmQudG9wICsgYm91bmQuYm90dG9tKSAvIDI7XHJcbiAgICAgICAgaWYgKHN0YWdlKSB7XHJcbiAgICAgICAgICAgIHRhbnNlbGF0ZVggPSBzdGFnZS5jYW52YXMud2lkdGggLyAyIC0gKGJvdW5kLmxlZnQgKyBib3VuZC5yaWdodCkgLyAyO1xyXG4gICAgICAgICAgICB0cmFuc2xhdGVZID0gc3RhZ2UuY2FudmFzLmhlaWdodCAvIDIgLSAoYm91bmQudG9wICsgYm91bmQuYm90dG9tKSAvIDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudHJhbnNsYXRlWCA9IHRhbnNlbGF0ZVg7XHJcbiAgICAgICAgdGhpcy50cmFuc2xhdGVZID0gdHJhbnNsYXRlWTtcclxuICAgIH07XHJcbiAgICBTY2VuZS5wcm90b3R5cGUuc2V0Q2VudGVyID0gZnVuY3Rpb24gKHgsIHkpIHtcclxuICAgICAgICB0aGlzLnRyYW5zbGF0ZVggPSAodGhpcy5zdGFnZS5jYW52YXMud2lkdGggLyAyKSAtIHg7XHJcbiAgICAgICAgdGhpcy50cmFuc2xhdGVZID0gKHRoaXMuc3RhZ2UuY2FudmFzLmhlaWdodCAvIDIpIC0geTtcclxuICAgIH07XHJcbiAgICBTY2VuZS5wcm90b3R5cGUuY2VudGVyQW5kWm9vbSA9IGZ1bmN0aW9uIChzY2FsZVgsIHNjYWxlWSwgc3RhZ2UpIHtcclxuICAgICAgICB0aGlzLnRyYW5zbGF0ZVRvQ2VudGVyKHN0YWdlKTtcclxuICAgICAgICBpZiAobnVsbCA9PSBzY2FsZVggfHwgbnVsbCA9PSBzY2FsZVkpIHtcclxuICAgICAgICAgICAgdmFyIGJvdW5kID0gdGhpcy5nZXRFbGVtZW50c0JvdW5kKCk7XHJcbiAgICAgICAgICAgIHNjYWxlWCA9IHRoaXMuc3RhZ2UuY2FudmFzLndpZHRoIC8gYm91bmQud2lkdGg7XHJcbiAgICAgICAgICAgIHNjYWxlWSA9IHRoaXMuc3RhZ2UuY2FudmFzLmhlaWdodCAvIGJvdW5kLmhlaWdodDtcclxuICAgICAgICAgICAgaWYgKHN0YWdlKSB7XHJcbiAgICAgICAgICAgICAgICBzY2FsZVggPSBzdGFnZS5jYW52YXMud2lkdGggLyBib3VuZC53aWR0aDtcclxuICAgICAgICAgICAgICAgIHNjYWxlWSA9IHN0YWdlLmNhbnZhcy5oZWlnaHQgLyBib3VuZC5oZWlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHNjYWxlID0gTWF0aC5taW4oc2NhbGVYLCBzY2FsZVkpO1xyXG4gICAgICAgICAgICBpZiAoc2NhbGUgPiAxKXJldHVybjtcclxuICAgICAgICAgICAgdGhpcy56b29tKHNjYWxlLCBzY2FsZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy56b29tKHNjYWxlWCwgc2NhbGVZKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgU2NlbmUucHJvdG90eXBlLmdldENlbnRlckxvY2F0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHg6IHRoaXMuc3RhZ2UuY2FudmFzLndpZHRoIC8gMixcclxuICAgICAgICAgICAgeTogdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0IC8gMlxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBTY2VuZS5wcm90b3R5cGUuZG9MYXlvdXQgPSBmdW5jdGlvbiAoZm4pIHtcclxuICAgICAgICBpZiAoZm4pIHtcclxuICAgICAgICAgICAgZm4odGhpcywgdGhpcy5jaGlsZHMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vc2NlbmUvc2NlbmUuanNcbi8vIG1vZHVsZSBpZCA9IDIxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==");
},function(module,exports,__webpack_require__){eval("var initEagleEye = __webpack_require__(29);\r\nvar canvasEvent = __webpack_require__(30);\r\nmodule.exports = function (jtopo) {\r\n    jtopo.Stage = Stage;\r\n    function Stage(canvas) {\r\n        if (null != canvas) {\r\n            canvasEvent(this, canvas, jtopo);\r\n            this.canvas = canvas;\r\n            this.graphics = canvas.getContext(\"2d\");\r\n            this.childs = [];\r\n            this.frames = 24;\r\n            this.messageBus = new jtopo.util.MessageBus;\r\n            this.eagleEye = initEagleEye(this);\r\n            this.wheelZoom = null;\r\n            this.mouseDownX = 0;\r\n            this.mouseDownY = 0;\r\n            this.mouseDown = !1;\r\n            this.mouseOver = !1;\r\n            zoomCheck(this);\r\n            runStage(this);\r\n        }\r\n    }\r\n    function runStage(stage){\r\n        stage.paint();\r\n        repaint();\r\n        function repaint() {\r\n            if(stage.frames<0){\r\n                stage.frames=-stage.frames;\r\n            }\r\n            if (0 == stage.frames) {\r\n                setTimeout(repaint, 1000);\r\n            } else {\r\n                stage.paint();\r\n                setTimeout(repaint, 1e3 / stage.frames);\r\n            }\r\n        }\r\n    }\r\n    function zoomCheck(stage){\r\n        stage.mousewheel(function (event) {\r\n            if (null != stage.wheelZoom) {\r\n                if ((null == event.wheelDelta ? event.detail : event.wheelDelta) < 0) {\r\n                    stage.zoomIn(stage.wheelZoom);\r\n                } else {\r\n                    stage.zoomOut(stage.wheelZoom);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    Object.defineProperties(Stage.prototype,{\r\n        width:{\r\n            get:function () {\r\n                return this.canvas.width\r\n            }\r\n        },\r\n        height:{\r\n            get:function() {\r\n                return this.canvas.height\r\n            }\r\n        },\r\n        cursor:{\r\n            set:function(cursor){\r\n                this.canvas.style.cursor = cursor\r\n            },\r\n            get:function(){\r\n                return this.canvas.style.cursor\r\n            }\r\n        },\r\n        mode:{\r\n            set:function(mode){\r\n                this.childs.forEach(function (scene) {\r\n                    scene.mode = mode\r\n                })\r\n            }\r\n        }\r\n    });\r\n    ['click', 'dbclick', 'mousedown', 'mouseup', 'mouseover', 'mouseout', 'mousemove', 'mousedrag', 'mousewheel', 'touchstart', 'touchmove', 'touchend', 'keydown', 'keyup'].forEach(function (eventName) {\r\n        Stage.prototype[eventName] = function (e) {\r\n            null != e ? this.addEventListener(eventName, e) : this.dispatchEvent(eventName);\r\n        }\r\n    });\r\n    Stage.prototype.dispatchEventToScenes = function (name, event) {\r\n        if (1 == this.eagleEye.visible && -1 != name.indexOf(\"mouse\")) {\r\n            var eventX = event.x;\r\n            var eventY = event.y;\r\n            if (eventX > this.width - this.eagleEye.width && eventY > this.height - this.eagleEye.height) {\r\n                return void this.eagleEye.eventHandler(name, event, this);\r\n            }\r\n        }\r\n        this.childs.forEach(function (scene) {\r\n            if (1 == scene.visible) {\r\n                var handler = scene[name + \"Handler\"];\r\n                if (null == handler)throw new Error(\"Function not found:\" + name + \"Handler\");\r\n                handler.call(scene, event)\r\n            }\r\n        })\r\n    };\r\n    Stage.prototype.add = function (scene) {\r\n        for (var i = 0; i < this.childs.length; i++) {\r\n            if (this.childs[i] === scene) {\r\n                return;\r\n            }\r\n        }\r\n        scene.stage = this;\r\n        this.childs.push(scene);\r\n    };\r\n    Stage.prototype.remove = function (scene) {\r\n        if (null == scene)throw new Error(\"Stage.remove出错: 参数为null!\");\r\n        for (var i = 0; i < this.childs.length; i++) {\r\n            if (this.childs[i] === scene) {\r\n                scene.stage = null;\r\n                this.childs = this.childs.del(i);\r\n                return this;\r\n            }\r\n        }\r\n        return this\r\n    };\r\n    Stage.prototype.clear = function () {\r\n        this.childs = []\r\n    };\r\n    Stage.prototype.addEventListener = function (eventName, fn) {\r\n        var self = this;\r\n        var b = function (e) {\r\n            fn.call(self, e);\r\n        };\r\n        this.messageBus.subscribe(eventName, fn);\r\n        return this;\r\n    };\r\n    Stage.prototype.removeEventListener = function (a, f) {\r\n        this.messageBus.unsubscribe(a, f)\r\n    };\r\n    Stage.prototype.removeAllEventListener = function () {\r\n        this.messageBus = new jtopo.util.MessageBus();\r\n    };\r\n    Stage.prototype.dispatchEvent = function (a, b) {\r\n        this.messageBus.publish(a, b);\r\n        return this;\r\n    };\r\n    Stage.prototype.paint = function () {\r\n        var self = this;\r\n        if (null != this.canvas&&this.frames > 0) {\r\n            this.graphics.save();\r\n            this.graphics.clearRect(0, 0, this.width, this.height);\r\n            this.childs.forEach(function (scene) {\r\n                if (1 == scene.visible) {\r\n                    scene.paint(self.graphics);\r\n                }\r\n            });\r\n            if (1 == this.eagleEye.visible) {\r\n                this.eagleEye.paint(this)\r\n            }\r\n            this.graphics.restore();\r\n        }\r\n    };\r\n    Stage.prototype.zoom = function (scale) {\r\n        this.childs.forEach(function (scene) {\r\n            if (0 != scene.visible) {\r\n                scene.zoom(scale);\r\n            }\r\n        })\r\n    };\r\n    Stage.prototype.zoomOut = function (scale) {\r\n        this.childs.forEach(function (scene) {\r\n            if (0 != scene.visible) {\r\n                scene.zoomOut(scale);\r\n            }\r\n        })\r\n    };\r\n    Stage.prototype.zoomIn = function (scale) {\r\n        this.childs.forEach(function (scene) {\r\n            if (0 != scene.visible) {\r\n                scene.zoomIn(scale)\r\n            }\r\n        })\r\n    };\r\n    Stage.prototype.centerAndZoom = function () {\r\n        this.childs.forEach(function (a) {\r\n            0 != a.visible && a.centerAndZoom()\r\n        })\r\n    };\r\n    Stage.prototype.setCenter = function (a, b) {\r\n        var c = this;\r\n        this.childs.forEach(function (d) {\r\n            var e = a - c.canvas.width / 2, f = b - c.canvas.height / 2;\r\n            d.translateX = -e, d.translateY = -f\r\n        })\r\n    };\r\n    Stage.prototype.getBound = function () {\r\n        var bound = {\r\n            left: Number.MAX_VALUE,\r\n            right: Number.MIN_VALUE,\r\n            top: Number.MAX_VALUE,\r\n            bottom: Number.MIN_VALUE\r\n        };\r\n        this.childs.forEach(function (child) {\r\n            var childBound = child.getElementsBound();\r\n            if (childBound.left < bound.left) {\r\n                bound.left = childBound.left;\r\n                bound.leftNode = childBound.leftNode\r\n            }\r\n            if (childBound.top < bound.top) {\r\n                bound.top = childBound.top;\r\n                bound.topNode = childBound.topNode\r\n            }\r\n            if (childBound.right > bound.right) {\r\n                bound.right = childBound.right;\r\n                bound.rightNode = childBound.rightNode\r\n            }\r\n            if (childBound.bottom > bound.bottom) {\r\n                bound.bottom = childBound.bottom;\r\n                bound.bottomNode = childBound.bottomNode;\r\n            }\r\n        });\r\n        bound.width = bound.right - bound.left;\r\n        bound.height = bound.bottom - bound.top;\r\n        return bound;\r\n    };\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vc3RhZ2Uvc3RhZ2UuanM/NzJkYSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSx1QkFBdUIsd0JBQXdCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qix3QkFBd0I7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIyMi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBpbml0RWFnbGVFeWUgPSByZXF1aXJlKFwiLi9lYWdsZUV5ZS5qc1wiKTtcclxudmFyIGNhbnZhc0V2ZW50ID0gcmVxdWlyZShcIi4vZXZlbnQuanNcIik7XHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICBqdG9wby5TdGFnZSA9IFN0YWdlO1xyXG4gICAgZnVuY3Rpb24gU3RhZ2UoY2FudmFzKSB7XHJcbiAgICAgICAgaWYgKG51bGwgIT0gY2FudmFzKSB7XHJcbiAgICAgICAgICAgIGNhbnZhc0V2ZW50KHRoaXMsIGNhbnZhcywganRvcG8pO1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcyA9IGNhbnZhcztcclxuICAgICAgICAgICAgdGhpcy5ncmFwaGljcyA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuZnJhbWVzID0gMjQ7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cyA9IG5ldyBqdG9wby51dGlsLk1lc3NhZ2VCdXM7XHJcbiAgICAgICAgICAgIHRoaXMuZWFnbGVFeWUgPSBpbml0RWFnbGVFeWUodGhpcyk7XHJcbiAgICAgICAgICAgIHRoaXMud2hlZWxab29tID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5tb3VzZURvd25YID0gMDtcclxuICAgICAgICAgICAgdGhpcy5tb3VzZURvd25ZID0gMDtcclxuICAgICAgICAgICAgdGhpcy5tb3VzZURvd24gPSAhMTtcclxuICAgICAgICAgICAgdGhpcy5tb3VzZU92ZXIgPSAhMTtcclxuICAgICAgICAgICAgem9vbUNoZWNrKHRoaXMpO1xyXG4gICAgICAgICAgICBydW5TdGFnZSh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBydW5TdGFnZShzdGFnZSl7XHJcbiAgICAgICAgc3RhZ2UucGFpbnQoKTtcclxuICAgICAgICByZXBhaW50KCk7XHJcbiAgICAgICAgZnVuY3Rpb24gcmVwYWludCgpIHtcclxuICAgICAgICAgICAgaWYoc3RhZ2UuZnJhbWVzPDApe1xyXG4gICAgICAgICAgICAgICAgc3RhZ2UuZnJhbWVzPS1zdGFnZS5mcmFtZXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKDAgPT0gc3RhZ2UuZnJhbWVzKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHJlcGFpbnQsIDEwMDApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc3RhZ2UucGFpbnQoKTtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQocmVwYWludCwgMWUzIC8gc3RhZ2UuZnJhbWVzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHpvb21DaGVjayhzdGFnZSl7XHJcbiAgICAgICAgc3RhZ2UubW91c2V3aGVlbChmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gc3RhZ2Uud2hlZWxab29tKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoKG51bGwgPT0gZXZlbnQud2hlZWxEZWx0YSA/IGV2ZW50LmRldGFpbCA6IGV2ZW50LndoZWVsRGVsdGEpIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YWdlLnpvb21JbihzdGFnZS53aGVlbFpvb20pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzdGFnZS56b29tT3V0KHN0YWdlLndoZWVsWm9vbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFN0YWdlLnByb3RvdHlwZSx7XHJcbiAgICAgICAgd2lkdGg6e1xyXG4gICAgICAgICAgICBnZXQ6ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FudmFzLndpZHRoXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGhlaWdodDp7XHJcbiAgICAgICAgICAgIGdldDpmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNhbnZhcy5oZWlnaHRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY3Vyc29yOntcclxuICAgICAgICAgICAgc2V0OmZ1bmN0aW9uKGN1cnNvcil7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5jdXJzb3IgPSBjdXJzb3JcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZ2V0OmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jYW52YXMuc3R5bGUuY3Vyc29yXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIG1vZGU6e1xyXG4gICAgICAgICAgICBzZXQ6ZnVuY3Rpb24obW9kZSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNjZW5lLm1vZGUgPSBtb2RlXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBbJ2NsaWNrJywgJ2RiY2xpY2snLCAnbW91c2Vkb3duJywgJ21vdXNldXAnLCAnbW91c2VvdmVyJywgJ21vdXNlb3V0JywgJ21vdXNlbW92ZScsICdtb3VzZWRyYWcnLCAnbW91c2V3aGVlbCcsICd0b3VjaHN0YXJ0JywgJ3RvdWNobW92ZScsICd0b3VjaGVuZCcsICdrZXlkb3duJywgJ2tleXVwJ10uZm9yRWFjaChmdW5jdGlvbiAoZXZlbnROYW1lKSB7XHJcbiAgICAgICAgU3RhZ2UucHJvdG90eXBlW2V2ZW50TmFtZV0gPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBudWxsICE9IGUgPyB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBlKSA6IHRoaXMuZGlzcGF0Y2hFdmVudChldmVudE5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgU3RhZ2UucHJvdG90eXBlLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyA9IGZ1bmN0aW9uIChuYW1lLCBldmVudCkge1xyXG4gICAgICAgIGlmICgxID09IHRoaXMuZWFnbGVFeWUudmlzaWJsZSAmJiAtMSAhPSBuYW1lLmluZGV4T2YoXCJtb3VzZVwiKSkge1xyXG4gICAgICAgICAgICB2YXIgZXZlbnRYID0gZXZlbnQueDtcclxuICAgICAgICAgICAgdmFyIGV2ZW50WSA9IGV2ZW50Lnk7XHJcbiAgICAgICAgICAgIGlmIChldmVudFggPiB0aGlzLndpZHRoIC0gdGhpcy5lYWdsZUV5ZS53aWR0aCAmJiBldmVudFkgPiB0aGlzLmhlaWdodCAtIHRoaXMuZWFnbGVFeWUuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdm9pZCB0aGlzLmVhZ2xlRXllLmV2ZW50SGFuZGxlcihuYW1lLCBldmVudCwgdGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoc2NlbmUpIHtcclxuICAgICAgICAgICAgaWYgKDEgPT0gc2NlbmUudmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSBzY2VuZVtuYW1lICsgXCJIYW5kbGVyXCJdO1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gaGFuZGxlcil0aHJvdyBuZXcgRXJyb3IoXCJGdW5jdGlvbiBub3QgZm91bmQ6XCIgKyBuYW1lICsgXCJIYW5kbGVyXCIpO1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlci5jYWxsKHNjZW5lLCBldmVudClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9O1xyXG4gICAgU3RhZ2UucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jaGlsZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY2hpbGRzW2ldID09PSBzY2VuZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNjZW5lLnN0YWdlID0gdGhpcztcclxuICAgICAgICB0aGlzLmNoaWxkcy5wdXNoKHNjZW5lKTtcclxuICAgIH07XHJcbiAgICBTdGFnZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKHNjZW5lKSB7XHJcbiAgICAgICAgaWYgKG51bGwgPT0gc2NlbmUpdGhyb3cgbmV3IEVycm9yKFwiU3RhZ2UucmVtb3Zl5Ye66ZSZOiDlj4LmlbDkuLpudWxsIVwiKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY2hpbGRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNoaWxkc1tpXSA9PT0gc2NlbmUpIHtcclxuICAgICAgICAgICAgICAgIHNjZW5lLnN0YWdlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRzID0gdGhpcy5jaGlsZHMuZGVsKGkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgIH07XHJcbiAgICBTdGFnZS5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5jaGlsZHMgPSBbXVxyXG4gICAgfTtcclxuICAgIFN0YWdlLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgZm4pIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGIgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBmbi5jYWxsKHNlbGYsIGUpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlQnVzLnN1YnNjcmliZShldmVudE5hbWUsIGZuKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBTdGFnZS5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChhLCBmKSB7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlQnVzLnVuc3Vic2NyaWJlKGEsIGYpXHJcbiAgICB9O1xyXG4gICAgU3RhZ2UucHJvdG90eXBlLnJlbW92ZUFsbEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlQnVzID0gbmV3IGp0b3BvLnV0aWwuTWVzc2FnZUJ1cygpO1xyXG4gICAgfTtcclxuICAgIFN0YWdlLnByb3RvdHlwZS5kaXNwYXRjaEV2ZW50ID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VCdXMucHVibGlzaChhLCBiKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBTdGFnZS5wcm90b3R5cGUucGFpbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGlmIChudWxsICE9IHRoaXMuY2FudmFzJiZ0aGlzLmZyYW1lcyA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5ncmFwaGljcy5zYXZlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZ3JhcGhpY3MuY2xlYXJSZWN0KDAsIDAsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoc2NlbmUpIHtcclxuICAgICAgICAgICAgICAgIGlmICgxID09IHNjZW5lLnZpc2libGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZS5wYWludChzZWxmLmdyYXBoaWNzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICgxID09IHRoaXMuZWFnbGVFeWUudmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lYWdsZUV5ZS5wYWludCh0aGlzKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuZ3JhcGhpY3MucmVzdG9yZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBTdGFnZS5wcm90b3R5cGUuem9vbSA9IGZ1bmN0aW9uIChzY2FsZSkge1xyXG4gICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKHNjZW5lKSB7XHJcbiAgICAgICAgICAgIGlmICgwICE9IHNjZW5lLnZpc2libGUpIHtcclxuICAgICAgICAgICAgICAgIHNjZW5lLnpvb20oc2NhbGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH07XHJcbiAgICBTdGFnZS5wcm90b3R5cGUuem9vbU91dCA9IGZ1bmN0aW9uIChzY2FsZSkge1xyXG4gICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKHNjZW5lKSB7XHJcbiAgICAgICAgICAgIGlmICgwICE9IHNjZW5lLnZpc2libGUpIHtcclxuICAgICAgICAgICAgICAgIHNjZW5lLnpvb21PdXQoc2NhbGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH07XHJcbiAgICBTdGFnZS5wcm90b3R5cGUuem9vbUluID0gZnVuY3Rpb24gKHNjYWxlKSB7XHJcbiAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoc2NlbmUpIHtcclxuICAgICAgICAgICAgaWYgKDAgIT0gc2NlbmUudmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgc2NlbmUuem9vbUluKHNjYWxlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH07XHJcbiAgICBTdGFnZS5wcm90b3R5cGUuY2VudGVyQW5kWm9vbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIDAgIT0gYS52aXNpYmxlICYmIGEuY2VudGVyQW5kWm9vbSgpXHJcbiAgICAgICAgfSlcclxuICAgIH07XHJcbiAgICBTdGFnZS5wcm90b3R5cGUuc2V0Q2VudGVyID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICB2YXIgYyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IGEgLSBjLmNhbnZhcy53aWR0aCAvIDIsIGYgPSBiIC0gYy5jYW52YXMuaGVpZ2h0IC8gMjtcclxuICAgICAgICAgICAgZC50cmFuc2xhdGVYID0gLWUsIGQudHJhbnNsYXRlWSA9IC1mXHJcbiAgICAgICAgfSlcclxuICAgIH07XHJcbiAgICBTdGFnZS5wcm90b3R5cGUuZ2V0Qm91bmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGJvdW5kID0ge1xyXG4gICAgICAgICAgICBsZWZ0OiBOdW1iZXIuTUFYX1ZBTFVFLFxyXG4gICAgICAgICAgICByaWdodDogTnVtYmVyLk1JTl9WQUxVRSxcclxuICAgICAgICAgICAgdG9wOiBOdW1iZXIuTUFYX1ZBTFVFLFxyXG4gICAgICAgICAgICBib3R0b206IE51bWJlci5NSU5fVkFMVUVcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHZhciBjaGlsZEJvdW5kID0gY2hpbGQuZ2V0RWxlbWVudHNCb3VuZCgpO1xyXG4gICAgICAgICAgICBpZiAoY2hpbGRCb3VuZC5sZWZ0IDwgYm91bmQubGVmdCkge1xyXG4gICAgICAgICAgICAgICAgYm91bmQubGVmdCA9IGNoaWxkQm91bmQubGVmdDtcclxuICAgICAgICAgICAgICAgIGJvdW5kLmxlZnROb2RlID0gY2hpbGRCb3VuZC5sZWZ0Tm9kZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjaGlsZEJvdW5kLnRvcCA8IGJvdW5kLnRvcCkge1xyXG4gICAgICAgICAgICAgICAgYm91bmQudG9wID0gY2hpbGRCb3VuZC50b3A7XHJcbiAgICAgICAgICAgICAgICBib3VuZC50b3BOb2RlID0gY2hpbGRCb3VuZC50b3BOb2RlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNoaWxkQm91bmQucmlnaHQgPiBib3VuZC5yaWdodCkge1xyXG4gICAgICAgICAgICAgICAgYm91bmQucmlnaHQgPSBjaGlsZEJvdW5kLnJpZ2h0O1xyXG4gICAgICAgICAgICAgICAgYm91bmQucmlnaHROb2RlID0gY2hpbGRCb3VuZC5yaWdodE5vZGVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY2hpbGRCb3VuZC5ib3R0b20gPiBib3VuZC5ib3R0b20pIHtcclxuICAgICAgICAgICAgICAgIGJvdW5kLmJvdHRvbSA9IGNoaWxkQm91bmQuYm90dG9tO1xyXG4gICAgICAgICAgICAgICAgYm91bmQuYm90dG9tTm9kZSA9IGNoaWxkQm91bmQuYm90dG9tTm9kZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGJvdW5kLndpZHRoID0gYm91bmQucmlnaHQgLSBib3VuZC5sZWZ0O1xyXG4gICAgICAgIGJvdW5kLmhlaWdodCA9IGJvdW5kLmJvdHRvbSAtIGJvdW5kLnRvcDtcclxuICAgICAgICByZXR1cm4gYm91bmQ7XHJcbiAgICB9O1xyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL3N0YWdlL3N0YWdlLmpzXG4vLyBtb2R1bGUgaWQgPSAyMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAgMiJdLCJzb3VyY2VSb290IjoiIn0=")},function(module,exports){eval('module.exports = function (jtopo) {\r\n    jtopo.Animate = {};\r\n    jtopo.Effect = {};\r\n    var stopAnimate = !1;\r\n    jtopo.Effect.spring = spring;\r\n    jtopo.Effect.gravity = ef_gravity;\r\n    jtopo.Animate.stepByStep = stepByStep;\r\n    jtopo.Animate.rotate = rotate;\r\n    jtopo.Animate.scale = scale;\r\n    jtopo.Animate.move = move;\r\n    jtopo.Animate.cycle = cycle;\r\n    jtopo.Animate.repeatThrow = repeatThrow;\r\n    jtopo.Animate.dividedTwoPiece = dividedTwoPiece;\r\n    jtopo.Animate.gravity = an_gravity;\r\n    jtopo.Animate.startAll = startAll;\r\n    jtopo.Animate.stopAll = stopAll;\r\n    function AnimateObject(fn, time) {\r\n        var intervalId;\r\n        var messageBus = null;\r\n        return {\r\n            stop: function () {\r\n                var self;\r\n                if (intervalId) {\r\n                    window.clearInterval(intervalId);\r\n                    if (messageBus) {\r\n                        messageBus.publish("stop");\r\n                    }\r\n                }\r\n                return this;\r\n            },\r\n            start: function () {\r\n                var self = this;\r\n                intervalId = setInterval(function () {\r\n                    fn.call(self)\r\n                }, time);\r\n                return this\r\n            },\r\n            onStop: function (fn) {\r\n                if (null == messageBus) {\r\n                    messageBus = new jtopo.util.MessageBus();\r\n                }\r\n                messageBus.subscribe("stop", fn);\r\n                return this;\r\n            }\r\n        }\r\n    }\r\n\r\n    function stepByStep(target, configs, time, e, f) {\r\n        var intervalTime = 1e3 / 24;\r\n        var temp = {};\r\n        for (var config in configs) {\r\n            var targetValue = configs[config];\r\n            var needValue = targetValue - target[config];\r\n            temp[config] = {\r\n                oldValue: target[config],\r\n                targetValue: targetValue,\r\n                step: needValue / time * intervalTime,\r\n                isDone: function (b) {\r\n                    return this.step > 0 && target[b] >= this.targetValue || this.step < 0 && target[b] <= this.targetValue;\r\n                }\r\n            }\r\n        }\r\n        return new AnimateObject(function () {\r\n            var notDone = !0;\r\n            for (var config in configs) {\r\n                if (!temp[config].isDone(config)) {\r\n                    target[config] += temp[config].step;\r\n                    notDone = !1;\r\n                }\r\n            }\r\n            if (notDone) {\r\n                if (!e) {\r\n                    return this.stop();\r\n                }\r\n                for (var item in configs) {\r\n                    if (f) {\r\n                        var g = temp[item].targetValue;\r\n                        temp[item].targetValue = temp[item].oldValue;\r\n                        temp[item].oldValue = g;\r\n                        temp[item].step = -temp[item].step;\r\n                    } else {\r\n                        target[item] = temp[item].oldValue;\r\n                    }\r\n                }\r\n            }\r\n            return this\r\n        }, intervalTime);\r\n    }\r\n\r\n    function spring(config) {\r\n        config = config || {};\r\n        var spring = config.spring || .1; // 弹性系数\r\n        var friction = config.friction || .8;// 摩擦系数\r\n        var grivity = config.grivity || 0; // 重力大小\r\n        var minLength = config.minLength || 0;   // 节点之间最终距离\r\n        return {\r\n            items: [],\r\n            id: null,\r\n            isPause: !1,\r\n            addNode: function (node, target) {\r\n                var item = {\r\n                    node: node,\r\n                    target: target,\r\n                    vx: 0,\r\n                    vy: 0\r\n                };\r\n                this.items.push(item);\r\n                return this\r\n            },\r\n            play: function (interval) {\r\n                this.stop();\r\n                interval = interval || 1e3 / 24;\r\n                var self = this;\r\n                this.id = setInterval(function () {\r\n                    self.nextFrame()\r\n                }, interval)\r\n            },\r\n            stop: function () {\r\n                window.clearInterval(this.id);\r\n                this.id = null;\r\n            },\r\n            nextFrame: function () {\r\n                this.items.forEach(function (item) {\r\n                    var node = item.node;\r\n                    var vx = item.vx;\r\n                    var vy = item.vy;\r\n                    var root = item.target;\r\n                    var distanceX = root.x - node.x;\r\n                    var distanceY = root.y - node.y;\r\n                    var angle = Math.atan2(disY, disX);\r\n                    if (0 != minLength) {\r\n                        var targetX = root.x - Math.cos(angle) * minLength;\r\n                        var targetY = root.y - Math.sin(angle) * minLength;\r\n                        distanceX = targetX - node.x;\r\n                        distanceY = targetY - node.y;\r\n                    }\r\n                    vx += distanceX * spring;\r\n                    vy += distanceY * spring;\r\n                    vx *= friction;\r\n                    vy *= friction;\r\n                    vy += grivity;\r\n                    node.x += vx;\r\n                    node.y += vy;\r\n                    item.vx = vx;\r\n                    item.vy = vy;\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    function rotate(a, b) {\r\n        function c() {\r\n            return e = setInterval(function () {\r\n                return stopAnimate ? void f.stop() : (a.rotate += g || .2, void(a.rotate > 2 * Math.PI && (a.rotate = 0)))\r\n            }, 100), f\r\n        }\r\n\r\n        function d() {\r\n            return window.clearInterval(e), f.onStop && f.onStop(a), f\r\n        }\r\n\r\n        var e = (b.context, null), f = {}, g = b.v;\r\n        return f.run = c, f.stop = d, f.onStop = function (a) {\r\n            return f.onStop = a, f\r\n        }, f\r\n    }\r\n\r\n    function an_gravity(element, config) {\r\n        var stage;\r\n        if (config.context instanceof jtopo.Stage) {\r\n            stage = config.context;\r\n        } else if (config.context instanceof jtopo.Scene) {\r\n            stage = config.context.stage;\r\n        }\r\n        var gravity = config.gravity || 0.1;\r\n        var intervalId = null;\r\n        return {\r\n            run: function () {\r\n                var stepX = config.stepX || 0;\r\n                var stepY = config.stepY || 2;\r\n                intervalId = setInterval(function () {\r\n                    if (stopAnimate || typeof stage == \'undefined\') {\r\n                        this.stop();\r\n                    } else {\r\n                        stepY += gravity;\r\n                        if (element.y + element.height < stage.canvas.height) {\r\n                            element.setLocation(element.x + stepX, element.y + stepY)\r\n                        } else {\r\n                            stepY = 0;\r\n                            this.stop();\r\n                        }\r\n                    }\r\n                }, 20);\r\n                return this;\r\n            },\r\n            stop: function () {\r\n                window.clearInterval(intervalId);\r\n                if (typeof this.onStop == \'function\') {\r\n                    this.onStop(element);\r\n                }\r\n                return this;\r\n            },\r\n            onStop: null\r\n        };\r\n    }\r\n\r\n    function ef_gravity(element, config) {\r\n        config = config || {};\r\n        var gravity = config.gravity || 0.1;\r\n        var DX = config.dx || 0;\r\n        var DY = config.dy || 5;\r\n        var stop = config.stop;\r\n        var times = config.interval || 30;\r\n        return new AnimateObject(function () {\r\n            if (stop && stop()) {\r\n                DY = 0.5;\r\n                this.stop();\r\n            } else {\r\n                DY += gravity;\r\n                element.setLocation(element.x + DX, element.y + DY);\r\n            }\r\n        }, times);\r\n    }\r\n\r\n    function dividedTwoPiece(node, config) {\r\n        var scene = config.context;\r\n        var messageBus;\r\n        return {\r\n            onStop: function (fn) {\r\n                if (null == messageBus) {\r\n                    messageBus = new jtopo.util.MessageBus();\r\n                }\r\n                messageBus.subscribe("stop", fn);\r\n                return this;\r\n            },\r\n            run: function () {\r\n                var angle = config.angle;\r\n                var g = angle + Math.PI;\r\n                var leftPiece = createPieceNode(node.x, node.y, node.width, angle, g);\r\n                var rightPiece = createPieceNode(node.x - 2 + 4 * Math.random(), node.y, node.width, angle + Math.PI, angle);\r\n                node.visible = !1;\r\n                scene.add(leftPiece);\r\n                scene.add(rightPiece);\r\n                jtopo.Animate.gravity(leftPiece, {context: scene, dx: .3})\r\n                    .run()\r\n                    .onStop(function () {\r\n                        scene.remove(leftPiece);\r\n                        scene.remove(rightPiece);\r\n                        this.stop();\r\n                    });\r\n                jtopo.Animate.gravity(rightPiece, {context: scene, dx: -.2}).run();\r\n                return this\r\n            },\r\n            stop: function () {\r\n                if (messageBus) {\r\n                    messageBus.publish("stop");\r\n                }\r\n                return this\r\n            }\r\n        };\r\n        function createPieceNode(x, y, radius, startAngle, endAngle) {\r\n            var node = new jtopo.Node;\r\n            node.setImage(node.image);\r\n            node.setSize(node.width, node.height);\r\n            node.setLocation(x, y);\r\n            node.showSelected = !1;\r\n            node.draggable = !1;\r\n            node.paint = function (context) {\r\n                context.save();\r\n                context.arc(0, 0, radius, startAngle, endAngle);\r\n                context.clip();\r\n                context.beginPath();\r\n                if (null != this.image) {\r\n                    context.drawImage(this.image, -this.width / 2, -this.height / 2)\r\n                } else {\r\n                    context.fillStyle = "rgba(" + this.style.fillStyle + "," + this.alpha + ")";\r\n                    context.rect(-this.width / 2, -this.height / 2, this.width / 2, this.height / 2);\r\n                    context.fill();\r\n                }\r\n                context.closePath();\r\n                context.restore();\r\n            };\r\n            return node\r\n        }\r\n    }\r\n\r\n    function repeatThrow(a, b) {\r\n        function c(a) {\r\n            a.visible = !0, a.rotate = Math.random();\r\n            var b = g.stage.canvas.width / 2;\r\n            a.x = b + Math.random() * (b - 100) - Math.random() * (b - 100), a.y = g.stage.canvas.height, a.vx = 5 * Math.random() - 5 * Math.random(), a.vy = -25\r\n        }\r\n\r\n        function d() {\r\n            return c(a), h = setInterval(function () {\r\n                return stopAnimate ? void i.stop() : (a.vy += f, a.x += a.vx, a.y += a.vy, void((a.x < 0 || a.x > g.stage.canvas.width || a.y > g.stage.canvas.height) && (i.onStop && i.onStop(a), c(a))))\r\n            }, 50), i\r\n        }\r\n\r\n        function e() {\r\n            window.clearInterval(h)\r\n        }\r\n\r\n        var f = .8, g = b.context, h = null, i = {};\r\n        return i.onStop = function (a) {\r\n            return i.onStop = a, i\r\n        }, i.run = d, i.stop = e, i\r\n    }\r\n\r\n    function stopAll() {\r\n        stopAnimate = !0\r\n    }\r\n\r\n    function startAll() {\r\n        stopAnimate = !1\r\n    }\r\n\r\n    function cycle(b, c) {\r\n        function d() {\r\n            return n = setInterval(function () {\r\n                if (stopAnimate)return void m.stop();\r\n                var a = f.y + h + Math.sin(k) * j;\r\n                b.setLocation(b.x, a), k += l\r\n            }, 100), m\r\n        }\r\n\r\n        function e() {\r\n            window.clearInterval(n)\r\n        }\r\n\r\n        var f = c.p1, g = c.p2, h = (c.context, f.x + (g.x - f.x) / 2), i = f.y + (g.y - f.y) / 2, j = jtopo.util.getDistance(f, g) / 2, k = Math.atan2(i, h), l = c.speed || .2, m = {}, n = null;\r\n        return m.run = d, m.stop = e, m\r\n    }\r\n\r\n    function move(element, config) {\r\n        config = config || {};\r\n        var position = config.position;\r\n        var easing = config.easing || 0.2;\r\n        return {\r\n            id: null,\r\n            run: function () {\r\n                var self = this;\r\n                if (self.id == null) {\r\n                    self.id = setInterval(function () {\r\n                        if (!stopAnimate) {\r\n                            var totalX = position.x - element.x;\r\n                            var totalY = position.y - element.y;\r\n                            var stepX = totalX * easing;\r\n                            var stepY = totalY * easing;\r\n                            element.x += stepX;\r\n                            element.y += stepY;\r\n                            if (0.1 > stepX && 0.1 > stepY) {\r\n                                self.stop();\r\n                            }\r\n                        } else {\r\n                            self.stop()\r\n                        }\r\n                    }, 100);\r\n                }\r\n                return self;\r\n            },\r\n            stop: function () {\r\n                window.clearInterval(this.id);\r\n                this.id = null;\r\n                if (this.onStop && typeof this.onStop == \'function\') {\r\n                    this.onStop();\r\n                }\r\n                return this;\r\n            }\r\n        };\r\n    }\r\n\r\n    function scale(a, b) {\r\n        function c() {\r\n            return j = setInterval(function () {\r\n                a.scaleX += f, a.scaleY += f, a.scaleX >= e && d()\r\n            }, 100), i\r\n        }\r\n\r\n        function d() {\r\n            i.onStop && i.onStop(a), a.scaleX = g, a.scaleY = h, window.clearInterval(j)\r\n        }\r\n\r\n        var e = (b.position, b.context, b.scale || 1), f = .06, g = a.scaleX, h = a.scaleY, i = {}, j = null;\r\n        return i.onStop = function (a) {\r\n            return i.onStop = a, i\r\n        }, i.run = c, i.stop = d, i\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vdG9vbHMvYW5pbWF0ZS5qcz8xZWM2Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekMsNkNBQTZDO0FBQzdDLDBDQUEwQztBQUMxQyw4Q0FBOEM7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEseUNBQXlDO0FBQ3pDO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELHVCQUF1QjtBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLG1EQUFtRCx3QkFBd0I7QUFDM0U7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsd0xBQXdMO0FBQ3hMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBOztBQUVBLGtHQUFrRztBQUNsRztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EiLCJmaWxlIjoiMjMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChqdG9wbykge1xyXG4gICAganRvcG8uQW5pbWF0ZSA9IHt9O1xyXG4gICAganRvcG8uRWZmZWN0ID0ge307XHJcbiAgICB2YXIgc3RvcEFuaW1hdGUgPSAhMTtcclxuICAgIGp0b3BvLkVmZmVjdC5zcHJpbmcgPSBzcHJpbmc7XHJcbiAgICBqdG9wby5FZmZlY3QuZ3Jhdml0eSA9IGVmX2dyYXZpdHk7XHJcbiAgICBqdG9wby5BbmltYXRlLnN0ZXBCeVN0ZXAgPSBzdGVwQnlTdGVwO1xyXG4gICAganRvcG8uQW5pbWF0ZS5yb3RhdGUgPSByb3RhdGU7XHJcbiAgICBqdG9wby5BbmltYXRlLnNjYWxlID0gc2NhbGU7XHJcbiAgICBqdG9wby5BbmltYXRlLm1vdmUgPSBtb3ZlO1xyXG4gICAganRvcG8uQW5pbWF0ZS5jeWNsZSA9IGN5Y2xlO1xyXG4gICAganRvcG8uQW5pbWF0ZS5yZXBlYXRUaHJvdyA9IHJlcGVhdFRocm93O1xyXG4gICAganRvcG8uQW5pbWF0ZS5kaXZpZGVkVHdvUGllY2UgPSBkaXZpZGVkVHdvUGllY2U7XHJcbiAgICBqdG9wby5BbmltYXRlLmdyYXZpdHkgPSBhbl9ncmF2aXR5O1xyXG4gICAganRvcG8uQW5pbWF0ZS5zdGFydEFsbCA9IHN0YXJ0QWxsO1xyXG4gICAganRvcG8uQW5pbWF0ZS5zdG9wQWxsID0gc3RvcEFsbDtcclxuICAgIGZ1bmN0aW9uIEFuaW1hdGVPYmplY3QoZm4sIHRpbWUpIHtcclxuICAgICAgICB2YXIgaW50ZXJ2YWxJZDtcclxuICAgICAgICB2YXIgbWVzc2FnZUJ1cyA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3RvcDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlbGY7XHJcbiAgICAgICAgICAgICAgICBpZiAoaW50ZXJ2YWxJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKGludGVydmFsSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlQnVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VCdXMucHVibGlzaChcInN0b3BcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN0YXJ0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICBpbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZuLmNhbGwoc2VsZilcclxuICAgICAgICAgICAgICAgIH0sIHRpbWUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgb25TdG9wOiBmdW5jdGlvbiAoZm4pIHtcclxuICAgICAgICAgICAgICAgIGlmIChudWxsID09IG1lc3NhZ2VCdXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQnVzID0gbmV3IGp0b3BvLnV0aWwuTWVzc2FnZUJ1cygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZUJ1cy5zdWJzY3JpYmUoXCJzdG9wXCIsIGZuKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHN0ZXBCeVN0ZXAodGFyZ2V0LCBjb25maWdzLCB0aW1lLCBlLCBmKSB7XHJcbiAgICAgICAgdmFyIGludGVydmFsVGltZSA9IDFlMyAvIDI0O1xyXG4gICAgICAgIHZhciB0ZW1wID0ge307XHJcbiAgICAgICAgZm9yICh2YXIgY29uZmlnIGluIGNvbmZpZ3MpIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldFZhbHVlID0gY29uZmlnc1tjb25maWddO1xyXG4gICAgICAgICAgICB2YXIgbmVlZFZhbHVlID0gdGFyZ2V0VmFsdWUgLSB0YXJnZXRbY29uZmlnXTtcclxuICAgICAgICAgICAgdGVtcFtjb25maWddID0ge1xyXG4gICAgICAgICAgICAgICAgb2xkVmFsdWU6IHRhcmdldFtjb25maWddLFxyXG4gICAgICAgICAgICAgICAgdGFyZ2V0VmFsdWU6IHRhcmdldFZhbHVlLFxyXG4gICAgICAgICAgICAgICAgc3RlcDogbmVlZFZhbHVlIC8gdGltZSAqIGludGVydmFsVGltZSxcclxuICAgICAgICAgICAgICAgIGlzRG9uZTogZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdGVwID4gMCAmJiB0YXJnZXRbYl0gPj0gdGhpcy50YXJnZXRWYWx1ZSB8fCB0aGlzLnN0ZXAgPCAwICYmIHRhcmdldFtiXSA8PSB0aGlzLnRhcmdldFZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgQW5pbWF0ZU9iamVjdChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBub3REb25lID0gITA7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGNvbmZpZyBpbiBjb25maWdzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRlbXBbY29uZmlnXS5pc0RvbmUoY29uZmlnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFtjb25maWddICs9IHRlbXBbY29uZmlnXS5zdGVwO1xyXG4gICAgICAgICAgICAgICAgICAgIG5vdERvbmUgPSAhMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobm90RG9uZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaXRlbSBpbiBjb25maWdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSB0ZW1wW2l0ZW1dLnRhcmdldFZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wW2l0ZW1dLnRhcmdldFZhbHVlID0gdGVtcFtpdGVtXS5vbGRWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcFtpdGVtXS5vbGRWYWx1ZSA9IGc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBbaXRlbV0uc3RlcCA9IC10ZW1wW2l0ZW1dLnN0ZXA7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0W2l0ZW1dID0gdGVtcFtpdGVtXS5vbGRWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgICAgICB9LCBpbnRlcnZhbFRpbWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNwcmluZyhjb25maWcpIHtcclxuICAgICAgICBjb25maWcgPSBjb25maWcgfHwge307XHJcbiAgICAgICAgdmFyIHNwcmluZyA9IGNvbmZpZy5zcHJpbmcgfHwgLjE7IC8vIOW8ueaAp+ezu+aVsFxyXG4gICAgICAgIHZhciBmcmljdGlvbiA9IGNvbmZpZy5mcmljdGlvbiB8fCAuODsvLyDmkanmk6bns7vmlbBcclxuICAgICAgICB2YXIgZ3Jpdml0eSA9IGNvbmZpZy5ncml2aXR5IHx8IDA7IC8vIOmHjeWKm+Wkp+Wwj1xyXG4gICAgICAgIHZhciBtaW5MZW5ndGggPSBjb25maWcubWluTGVuZ3RoIHx8IDA7ICAgLy8g6IqC54K55LmL6Ze05pyA57uI6Led56a7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaXRlbXM6IFtdLFxyXG4gICAgICAgICAgICBpZDogbnVsbCxcclxuICAgICAgICAgICAgaXNQYXVzZTogITEsXHJcbiAgICAgICAgICAgIGFkZE5vZGU6IGZ1bmN0aW9uIChub2RlLCB0YXJnZXQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpdGVtID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGU6IG5vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiB0YXJnZXQsXHJcbiAgICAgICAgICAgICAgICAgICAgdng6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgdnk6IDBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBwbGF5OiBmdW5jdGlvbiAoaW50ZXJ2YWwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgaW50ZXJ2YWwgPSBpbnRlcnZhbCB8fCAxZTMgLyAyNDtcclxuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHRoaXMuaWQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5uZXh0RnJhbWUoKVxyXG4gICAgICAgICAgICAgICAgfSwgaW50ZXJ2YWwpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuaWQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pZCA9IG51bGw7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG5leHRGcmFtZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBpdGVtLm5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZ4ID0gaXRlbS52eDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdnkgPSBpdGVtLnZ5O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByb290ID0gaXRlbS50YXJnZXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRpc3RhbmNlWCA9IHJvb3QueCAtIG5vZGUueDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGlzdGFuY2VZID0gcm9vdC55IC0gbm9kZS55O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhbmdsZSA9IE1hdGguYXRhbjIoZGlzWSwgZGlzWCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKDAgIT0gbWluTGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRYID0gcm9vdC54IC0gTWF0aC5jb3MoYW5nbGUpICogbWluTGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0WSA9IHJvb3QueSAtIE1hdGguc2luKGFuZ2xlKSAqIG1pbkxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2VYID0gdGFyZ2V0WCAtIG5vZGUueDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2VZID0gdGFyZ2V0WSAtIG5vZGUueTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdnggKz0gZGlzdGFuY2VYICogc3ByaW5nO1xyXG4gICAgICAgICAgICAgICAgICAgIHZ5ICs9IGRpc3RhbmNlWSAqIHNwcmluZztcclxuICAgICAgICAgICAgICAgICAgICB2eCAqPSBmcmljdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICB2eSAqPSBmcmljdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICB2eSArPSBncml2aXR5O1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUueCArPSB2eDtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLnkgKz0gdnk7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS52eCA9IHZ4O1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0udnkgPSB2eTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJvdGF0ZShhLCBiKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gYygpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGUgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RvcEFuaW1hdGUgPyB2b2lkIGYuc3RvcCgpIDogKGEucm90YXRlICs9IGcgfHwgLjIsIHZvaWQoYS5yb3RhdGUgPiAyICogTWF0aC5QSSAmJiAoYS5yb3RhdGUgPSAwKSkpXHJcbiAgICAgICAgICAgIH0sIDEwMCksIGZcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuY2xlYXJJbnRlcnZhbChlKSwgZi5vblN0b3AgJiYgZi5vblN0b3AoYSksIGZcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBlID0gKGIuY29udGV4dCwgbnVsbCksIGYgPSB7fSwgZyA9IGIudjtcclxuICAgICAgICByZXR1cm4gZi5ydW4gPSBjLCBmLnN0b3AgPSBkLCBmLm9uU3RvcCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmLm9uU3RvcCA9IGEsIGZcclxuICAgICAgICB9LCBmXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYW5fZ3Jhdml0eShlbGVtZW50LCBjb25maWcpIHtcclxuICAgICAgICB2YXIgc3RhZ2U7XHJcbiAgICAgICAgaWYgKGNvbmZpZy5jb250ZXh0IGluc3RhbmNlb2YganRvcG8uU3RhZ2UpIHtcclxuICAgICAgICAgICAgc3RhZ2UgPSBjb25maWcuY29udGV4dDtcclxuICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy5jb250ZXh0IGluc3RhbmNlb2YganRvcG8uU2NlbmUpIHtcclxuICAgICAgICAgICAgc3RhZ2UgPSBjb25maWcuY29udGV4dC5zdGFnZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGdyYXZpdHkgPSBjb25maWcuZ3Jhdml0eSB8fCAwLjE7XHJcbiAgICAgICAgdmFyIGludGVydmFsSWQgPSBudWxsO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJ1bjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHN0ZXBYID0gY29uZmlnLnN0ZXBYIHx8IDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3RlcFkgPSBjb25maWcuc3RlcFkgfHwgMjtcclxuICAgICAgICAgICAgICAgIGludGVydmFsSWQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0b3BBbmltYXRlIHx8IHR5cGVvZiBzdGFnZSA9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGVwWSArPSBncmF2aXR5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC55ICsgZWxlbWVudC5oZWlnaHQgPCBzdGFnZS5jYW52YXMuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnNldExvY2F0aW9uKGVsZW1lbnQueCArIHN0ZXBYLCBlbGVtZW50LnkgKyBzdGVwWSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXBZID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgMjApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKGludGVydmFsSWQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9uU3RvcCA9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vblN0b3AoZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgb25TdG9wOiBudWxsXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBlZl9ncmF2aXR5KGVsZW1lbnQsIGNvbmZpZykge1xyXG4gICAgICAgIGNvbmZpZyA9IGNvbmZpZyB8fCB7fTtcclxuICAgICAgICB2YXIgZ3Jhdml0eSA9IGNvbmZpZy5ncmF2aXR5IHx8IDAuMTtcclxuICAgICAgICB2YXIgRFggPSBjb25maWcuZHggfHwgMDtcclxuICAgICAgICB2YXIgRFkgPSBjb25maWcuZHkgfHwgNTtcclxuICAgICAgICB2YXIgc3RvcCA9IGNvbmZpZy5zdG9wO1xyXG4gICAgICAgIHZhciB0aW1lcyA9IGNvbmZpZy5pbnRlcnZhbCB8fCAzMDtcclxuICAgICAgICByZXR1cm4gbmV3IEFuaW1hdGVPYmplY3QoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoc3RvcCAmJiBzdG9wKCkpIHtcclxuICAgICAgICAgICAgICAgIERZID0gMC41O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBEWSArPSBncmF2aXR5O1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5zZXRMb2NhdGlvbihlbGVtZW50LnggKyBEWCwgZWxlbWVudC55ICsgRFkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGltZXMpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGRpdmlkZWRUd29QaWVjZShub2RlLCBjb25maWcpIHtcclxuICAgICAgICB2YXIgc2NlbmUgPSBjb25maWcuY29udGV4dDtcclxuICAgICAgICB2YXIgbWVzc2FnZUJ1cztcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBvblN0b3A6IGZ1bmN0aW9uIChmbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gbWVzc2FnZUJ1cykge1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VCdXMgPSBuZXcganRvcG8udXRpbC5NZXNzYWdlQnVzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlQnVzLnN1YnNjcmliZShcInN0b3BcIiwgZm4pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHJ1bjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGFuZ2xlID0gY29uZmlnLmFuZ2xlO1xyXG4gICAgICAgICAgICAgICAgdmFyIGcgPSBhbmdsZSArIE1hdGguUEk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGVmdFBpZWNlID0gY3JlYXRlUGllY2VOb2RlKG5vZGUueCwgbm9kZS55LCBub2RlLndpZHRoLCBhbmdsZSwgZyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmlnaHRQaWVjZSA9IGNyZWF0ZVBpZWNlTm9kZShub2RlLnggLSAyICsgNCAqIE1hdGgucmFuZG9tKCksIG5vZGUueSwgbm9kZS53aWR0aCwgYW5nbGUgKyBNYXRoLlBJLCBhbmdsZSk7XHJcbiAgICAgICAgICAgICAgICBub2RlLnZpc2libGUgPSAhMTtcclxuICAgICAgICAgICAgICAgIHNjZW5lLmFkZChsZWZ0UGllY2UpO1xyXG4gICAgICAgICAgICAgICAgc2NlbmUuYWRkKHJpZ2h0UGllY2UpO1xyXG4gICAgICAgICAgICAgICAganRvcG8uQW5pbWF0ZS5ncmF2aXR5KGxlZnRQaWVjZSwge2NvbnRleHQ6IHNjZW5lLCBkeDogLjN9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5ydW4oKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vblN0b3AoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZS5yZW1vdmUobGVmdFBpZWNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NlbmUucmVtb3ZlKHJpZ2h0UGllY2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGp0b3BvLkFuaW1hdGUuZ3Jhdml0eShyaWdodFBpZWNlLCB7Y29udGV4dDogc2NlbmUsIGR4OiAtLjJ9KS5ydW4oKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlQnVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUJ1cy5wdWJsaXNoKFwic3RvcFwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVBpZWNlTm9kZSh4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlKSB7XHJcbiAgICAgICAgICAgIHZhciBub2RlID0gbmV3IGp0b3BvLk5vZGU7XHJcbiAgICAgICAgICAgIG5vZGUuc2V0SW1hZ2Uobm9kZS5pbWFnZSk7XHJcbiAgICAgICAgICAgIG5vZGUuc2V0U2l6ZShub2RlLndpZHRoLCBub2RlLmhlaWdodCk7XHJcbiAgICAgICAgICAgIG5vZGUuc2V0TG9jYXRpb24oeCwgeSk7XHJcbiAgICAgICAgICAgIG5vZGUuc2hvd1NlbGVjdGVkID0gITE7XHJcbiAgICAgICAgICAgIG5vZGUuZHJhZ2dhYmxlID0gITE7XHJcbiAgICAgICAgICAgIG5vZGUucGFpbnQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmFyYygwLCAwLCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuY2xpcCgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGlmIChudWxsICE9IHRoaXMuaW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmRyYXdJbWFnZSh0aGlzLmltYWdlLCAtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5zdHlsZS5maWxsU3R5bGUgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnJlY3QoLXRoaXMud2lkdGggLyAyLCAtdGhpcy5oZWlnaHQgLyAyLCB0aGlzLndpZHRoIC8gMiwgdGhpcy5oZWlnaHQgLyAyKTtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmV0dXJuIG5vZGVcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVwZWF0VGhyb3coYSwgYikge1xyXG4gICAgICAgIGZ1bmN0aW9uIGMoYSkge1xyXG4gICAgICAgICAgICBhLnZpc2libGUgPSAhMCwgYS5yb3RhdGUgPSBNYXRoLnJhbmRvbSgpO1xyXG4gICAgICAgICAgICB2YXIgYiA9IGcuc3RhZ2UuY2FudmFzLndpZHRoIC8gMjtcclxuICAgICAgICAgICAgYS54ID0gYiArIE1hdGgucmFuZG9tKCkgKiAoYiAtIDEwMCkgLSBNYXRoLnJhbmRvbSgpICogKGIgLSAxMDApLCBhLnkgPSBnLnN0YWdlLmNhbnZhcy5oZWlnaHQsIGEudnggPSA1ICogTWF0aC5yYW5kb20oKSAtIDUgKiBNYXRoLnJhbmRvbSgpLCBhLnZ5ID0gLTI1XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBkKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYyhhKSwgaCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdG9wQW5pbWF0ZSA/IHZvaWQgaS5zdG9wKCkgOiAoYS52eSArPSBmLCBhLnggKz0gYS52eCwgYS55ICs9IGEudnksIHZvaWQoKGEueCA8IDAgfHwgYS54ID4gZy5zdGFnZS5jYW52YXMud2lkdGggfHwgYS55ID4gZy5zdGFnZS5jYW52YXMuaGVpZ2h0KSAmJiAoaS5vblN0b3AgJiYgaS5vblN0b3AoYSksIGMoYSkpKSlcclxuICAgICAgICAgICAgfSwgNTApLCBpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbChoKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGYgPSAuOCwgZyA9IGIuY29udGV4dCwgaCA9IG51bGwsIGkgPSB7fTtcclxuICAgICAgICByZXR1cm4gaS5vblN0b3AgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaS5vblN0b3AgPSBhLCBpXHJcbiAgICAgICAgfSwgaS5ydW4gPSBkLCBpLnN0b3AgPSBlLCBpXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc3RvcEFsbCgpIHtcclxuICAgICAgICBzdG9wQW5pbWF0ZSA9ICEwXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc3RhcnRBbGwoKSB7XHJcbiAgICAgICAgc3RvcEFuaW1hdGUgPSAhMVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGN5Y2xlKGIsIGMpIHtcclxuICAgICAgICBmdW5jdGlvbiBkKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbiA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChzdG9wQW5pbWF0ZSlyZXR1cm4gdm9pZCBtLnN0b3AoKTtcclxuICAgICAgICAgICAgICAgIHZhciBhID0gZi55ICsgaCArIE1hdGguc2luKGspICogajtcclxuICAgICAgICAgICAgICAgIGIuc2V0TG9jYXRpb24oYi54LCBhKSwgayArPSBsXHJcbiAgICAgICAgICAgIH0sIDEwMCksIG1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKG4pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZiA9IGMucDEsIGcgPSBjLnAyLCBoID0gKGMuY29udGV4dCwgZi54ICsgKGcueCAtIGYueCkgLyAyKSwgaSA9IGYueSArIChnLnkgLSBmLnkpIC8gMiwgaiA9IGp0b3BvLnV0aWwuZ2V0RGlzdGFuY2UoZiwgZykgLyAyLCBrID0gTWF0aC5hdGFuMihpLCBoKSwgbCA9IGMuc3BlZWQgfHwgLjIsIG0gPSB7fSwgbiA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIG0ucnVuID0gZCwgbS5zdG9wID0gZSwgbVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG1vdmUoZWxlbWVudCwgY29uZmlnKSB7XHJcbiAgICAgICAgY29uZmlnID0gY29uZmlnIHx8IHt9O1xyXG4gICAgICAgIHZhciBwb3NpdGlvbiA9IGNvbmZpZy5wb3NpdGlvbjtcclxuICAgICAgICB2YXIgZWFzaW5nID0gY29uZmlnLmVhc2luZyB8fCAwLjI7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaWQ6IG51bGwsXHJcbiAgICAgICAgICAgIHJ1bjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuaWQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaWQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc3RvcEFuaW1hdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b3RhbFggPSBwb3NpdGlvbi54IC0gZWxlbWVudC54O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRvdGFsWSA9IHBvc2l0aW9uLnkgLSBlbGVtZW50Lnk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcFggPSB0b3RhbFggKiBlYXNpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcFkgPSB0b3RhbFkgKiBlYXNpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnggKz0gc3RlcFg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnkgKz0gc3RlcFk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMC4xID4gc3RlcFggJiYgMC4xID4gc3RlcFkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnN0b3AoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc3RvcCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGY7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuaWQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vblN0b3AgJiYgdHlwZW9mIHRoaXMub25TdG9wID09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uU3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNjYWxlKGEsIGIpIHtcclxuICAgICAgICBmdW5jdGlvbiBjKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaiA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGEuc2NhbGVYICs9IGYsIGEuc2NhbGVZICs9IGYsIGEuc2NhbGVYID49IGUgJiYgZCgpXHJcbiAgICAgICAgICAgIH0sIDEwMCksIGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGQoKSB7XHJcbiAgICAgICAgICAgIGkub25TdG9wICYmIGkub25TdG9wKGEpLCBhLnNjYWxlWCA9IGcsIGEuc2NhbGVZID0gaCwgd2luZG93LmNsZWFySW50ZXJ2YWwoailcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBlID0gKGIucG9zaXRpb24sIGIuY29udGV4dCwgYi5zY2FsZSB8fCAxKSwgZiA9IC4wNiwgZyA9IGEuc2NhbGVYLCBoID0gYS5zY2FsZVksIGkgPSB7fSwgaiA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIGkub25TdG9wID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGkub25TdG9wID0gYSwgaVxyXG4gICAgICAgIH0sIGkucnVuID0gYywgaS5zdG9wID0gZCwgaVxyXG4gICAgfVxyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL3Rvb2xzL2FuaW1hdGUuanNcbi8vIG1vZHVsZSBpZCA9IDIzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==');
},function(module,exports){eval("/**\r\n * 绘制园角矩形\r\n * @param x {number}左上角坐标点x\r\n * @param y {number}左上角坐标点y\r\n * @param width {number}矩形宽度\r\n * @param height {number}矩形高度\r\n * @param borderRadius {number}圆角弧度\r\n */\r\nCanvasRenderingContext2D.prototype._roundRect = function (x, y, width, height, borderRadius) {\r\n    //元素圆角\r\n    borderRadius = borderRadius || 5;\r\n    this.beginPath();\r\n    this.moveTo(x + borderRadius, y);\r\n    this.lineTo(x + width - borderRadius, y);\r\n    this.arcTo(x + width, y, x + width, y + borderRadius,borderRadius);\r\n    this.lineTo(x + width, y + height - borderRadius);\r\n    this.arcTo(x + width, y + height, x + width - borderRadius, y + height,borderRadius);\r\n    this.lineTo(x + borderRadius, y + height);\r\n    this.arcTo(x, y + height, x, y + height - borderRadius,borderRadius);\r\n    this.lineTo(x, y + borderRadius);\r\n    this.arcTo(x, y, x + borderRadius, y,borderRadius);\r\n    this.closePath();\r\n};\r\n/**\r\n * 绘制椭圆\r\n * @param x {number}圆心坐标x\r\n * @param y {number}圆心坐标y\r\n * @param width {number}椭圆宽度\r\n * @param height {number}椭圆高度\r\n */\r\nCanvasRenderingContext2D.prototype._ellipse = function (x, y, width, height) {\r\n    var radiusX = width / 0.75 / 2;\r\n    var radiusY = height / 2;\r\n    this.beginPath();\r\n    this.moveTo(x, y - radiusY);\r\n    this.bezierCurveTo(x + radiusX, y - radiusY, x + radiusX, y + radiusY, x, y + radiusY);//右半边\r\n    this.bezierCurveTo(x - radiusX, y + radiusY, x - radiusX, y - radiusY, x, y - radiusY);//左半边\r\n    this.closePath();\r\n};\r\n/**\r\n * 画五角星\r\n * @param x {number}圆心坐标x\r\n * @param y {number}圆心坐标y\r\n * @param radius {number}五角星外半径\r\n * @private\r\n */\r\nCanvasRenderingContext2D.prototype._star = function (x, y,radius) {\r\n    var innerRadius=radius*0.4;\r\n    this.beginPath();\r\n    //从顶点开始绘制路径\r\n    for (var i = 0; i < 5; i++) {\r\n        this.lineTo(\r\n            Math.cos((18 + i * 72) / 180 * Math.PI) * radius + x,\r\n            -Math.sin((18 + i * 72) / 180 * Math.PI) * radius + y\r\n        );\r\n        this.lineTo(\r\n            Math.cos((54 + i * 72) / 180 * Math.PI) * innerRadius + x,\r\n            -Math.sin((54 + i * 72) / 180 * Math.PI) * innerRadius + y\r\n        );\r\n    }\r\n    this.closePath();\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vdG9vbHMvYXBpLmpzPzdlOWQiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsaUJBQWlCLE9BQU87QUFDeEIsa0JBQWtCLE9BQU87QUFDekIsd0JBQXdCLE9BQU87QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixpQkFBaUIsT0FBTztBQUN4QixrQkFBa0IsT0FBTztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyRkFBMkY7QUFDM0YsMkZBQTJGO0FBQzNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixrQkFBa0IsT0FBTztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsT0FBTztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjI0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIOe7mOWItuWbreinkuefqeW9olxyXG4gKiBAcGFyYW0geCB7bnVtYmVyfeW3puS4iuinkuWdkOagh+eCuXhcclxuICogQHBhcmFtIHkge251bWJlcn3lt6bkuIrop5LlnZDmoIfngrl5XHJcbiAqIEBwYXJhbSB3aWR0aCB7bnVtYmVyfeefqeW9ouWuveW6plxyXG4gKiBAcGFyYW0gaGVpZ2h0IHtudW1iZXJ955+p5b2i6auY5bqmXHJcbiAqIEBwYXJhbSBib3JkZXJSYWRpdXMge251bWJlcn3lnIbop5LlvKfluqZcclxuICovXHJcbkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRC5wcm90b3R5cGUuX3JvdW5kUmVjdCA9IGZ1bmN0aW9uICh4LCB5LCB3aWR0aCwgaGVpZ2h0LCBib3JkZXJSYWRpdXMpIHtcclxuICAgIC8v5YWD57Sg5ZyG6KeSXHJcbiAgICBib3JkZXJSYWRpdXMgPSBib3JkZXJSYWRpdXMgfHwgNTtcclxuICAgIHRoaXMuYmVnaW5QYXRoKCk7XHJcbiAgICB0aGlzLm1vdmVUbyh4ICsgYm9yZGVyUmFkaXVzLCB5KTtcclxuICAgIHRoaXMubGluZVRvKHggKyB3aWR0aCAtIGJvcmRlclJhZGl1cywgeSk7XHJcbiAgICB0aGlzLmFyY1RvKHggKyB3aWR0aCwgeSwgeCArIHdpZHRoLCB5ICsgYm9yZGVyUmFkaXVzLGJvcmRlclJhZGl1cyk7XHJcbiAgICB0aGlzLmxpbmVUbyh4ICsgd2lkdGgsIHkgKyBoZWlnaHQgLSBib3JkZXJSYWRpdXMpO1xyXG4gICAgdGhpcy5hcmNUbyh4ICsgd2lkdGgsIHkgKyBoZWlnaHQsIHggKyB3aWR0aCAtIGJvcmRlclJhZGl1cywgeSArIGhlaWdodCxib3JkZXJSYWRpdXMpO1xyXG4gICAgdGhpcy5saW5lVG8oeCArIGJvcmRlclJhZGl1cywgeSArIGhlaWdodCk7XHJcbiAgICB0aGlzLmFyY1RvKHgsIHkgKyBoZWlnaHQsIHgsIHkgKyBoZWlnaHQgLSBib3JkZXJSYWRpdXMsYm9yZGVyUmFkaXVzKTtcclxuICAgIHRoaXMubGluZVRvKHgsIHkgKyBib3JkZXJSYWRpdXMpO1xyXG4gICAgdGhpcy5hcmNUbyh4LCB5LCB4ICsgYm9yZGVyUmFkaXVzLCB5LGJvcmRlclJhZGl1cyk7XHJcbiAgICB0aGlzLmNsb3NlUGF0aCgpO1xyXG59O1xyXG4vKipcclxuICog57uY5Yi25qSt5ZyGXHJcbiAqIEBwYXJhbSB4IHtudW1iZXJ95ZyG5b+D5Z2Q5qCHeFxyXG4gKiBAcGFyYW0geSB7bnVtYmVyfeWchuW/g+WdkOagh3lcclxuICogQHBhcmFtIHdpZHRoIHtudW1iZXJ95qSt5ZyG5a695bqmXHJcbiAqIEBwYXJhbSBoZWlnaHQge251bWJlcn3mpK3lnIbpq5jluqZcclxuICovXHJcbkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRC5wcm90b3R5cGUuX2VsbGlwc2UgPSBmdW5jdGlvbiAoeCwgeSwgd2lkdGgsIGhlaWdodCkge1xyXG4gICAgdmFyIHJhZGl1c1ggPSB3aWR0aCAvIDAuNzUgLyAyO1xyXG4gICAgdmFyIHJhZGl1c1kgPSBoZWlnaHQgLyAyO1xyXG4gICAgdGhpcy5iZWdpblBhdGgoKTtcclxuICAgIHRoaXMubW92ZVRvKHgsIHkgLSByYWRpdXNZKTtcclxuICAgIHRoaXMuYmV6aWVyQ3VydmVUbyh4ICsgcmFkaXVzWCwgeSAtIHJhZGl1c1ksIHggKyByYWRpdXNYLCB5ICsgcmFkaXVzWSwgeCwgeSArIHJhZGl1c1kpOy8v5Y+z5Y2K6L65XHJcbiAgICB0aGlzLmJlemllckN1cnZlVG8oeCAtIHJhZGl1c1gsIHkgKyByYWRpdXNZLCB4IC0gcmFkaXVzWCwgeSAtIHJhZGl1c1ksIHgsIHkgLSByYWRpdXNZKTsvL+W3puWNiui+uVxyXG4gICAgdGhpcy5jbG9zZVBhdGgoKTtcclxufTtcclxuLyoqXHJcbiAqIOeUu+S6lOinkuaYn1xyXG4gKiBAcGFyYW0geCB7bnVtYmVyfeWchuW/g+WdkOagh3hcclxuICogQHBhcmFtIHkge251bWJlcn3lnIblv4PlnZDmoId5XHJcbiAqIEBwYXJhbSByYWRpdXMge251bWJlcn3kupTop5LmmJ/lpJbljYrlvoRcclxuICogQHByaXZhdGVcclxuICovXHJcbkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRC5wcm90b3R5cGUuX3N0YXIgPSBmdW5jdGlvbiAoeCwgeSxyYWRpdXMpIHtcclxuICAgIHZhciBpbm5lclJhZGl1cz1yYWRpdXMqMC40O1xyXG4gICAgdGhpcy5iZWdpblBhdGgoKTtcclxuICAgIC8v5LuO6aG254K55byA5aeL57uY5Yi26Lev5b6EXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xyXG4gICAgICAgIHRoaXMubGluZVRvKFxyXG4gICAgICAgICAgICBNYXRoLmNvcygoMTggKyBpICogNzIpIC8gMTgwICogTWF0aC5QSSkgKiByYWRpdXMgKyB4LFxyXG4gICAgICAgICAgICAtTWF0aC5zaW4oKDE4ICsgaSAqIDcyKSAvIDE4MCAqIE1hdGguUEkpICogcmFkaXVzICsgeVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdGhpcy5saW5lVG8oXHJcbiAgICAgICAgICAgIE1hdGguY29zKCg1NCArIGkgKiA3MikgLyAxODAgKiBNYXRoLlBJKSAqIGlubmVyUmFkaXVzICsgeCxcclxuICAgICAgICAgICAgLU1hdGguc2luKCg1NCArIGkgKiA3MikgLyAxODAgKiBNYXRoLlBJKSAqIGlubmVyUmFkaXVzICsgeVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmNsb3NlUGF0aCgpO1xyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL3Rvb2xzL2FwaS5qc1xuLy8gbW9kdWxlIGlkID0gMjRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIDIiXSwic291cmNlUm9vdCI6IiJ9")},function(module,exports){eval('module.exports = function (jtopo) {\r\n    jtopo.layout = jtopo.Layout = {\r\n        layoutNode: layoutNode,\r\n        getNodeChilds: getRootChilds,\r\n        adjustPosition: adjustPosition,\r\n        springLayout: springLayout,\r\n        getTreeDeep: getTreeDeep,\r\n        getRootNodes: getRootNodes,\r\n        GridLayout: GridLayout,\r\n        FlowLayout: FlowLayout,\r\n        AutoBoundLayout: AutoBoundLayout,\r\n        FixedBoundLayout: FixedBoundLayout,\r\n        CircleLayout: CircleLayout,\r\n        TreeLayout: TreeLayout,\r\n        getNodesCenter: getNodesCenter,\r\n        circleLayoutNodes: circleLayoutNodes\r\n    };\r\n    function getNodesCenter(a) {\r\n        var b = 0, c = 0;\r\n        a.forEach(function (a) {\r\n            b += a.cx, c += a.cy\r\n        });\r\n        var d = {x: b / a.length, y: c / a.length};\r\n        return d\r\n    }\r\n\r\n    function circleLayoutNodes(nodeArray, animateConfig) {\r\n        null == animateConfig && (animateConfig = {});\r\n        var e = animateConfig.cx,\r\n            f = animateConfig.cy,\r\n            g = animateConfig.minRadius,\r\n            h = animateConfig.nodeDiameter,\r\n            i = animateConfig.hScale || 1,\r\n            j = animateConfig.vScale || 1;\r\n        if (null == e || null == f) {\r\n            var k = getNodesCenter(nodeArray);\r\n            e = k.x, f = k.y\r\n        }\r\n        var l = 0, m = [], n = [];\r\n        nodeArray.forEach(function (node) {\r\n            null == animateConfig.nodeDiameter ? (node.diameter && (h = node.diameter),\r\n                h = node.radius ? 2 * node.radius : Math.sqrt(2 * node.width * node.height),\r\n                n.push(h)) : n.push(h), l += h\r\n        }), nodeArray.forEach(function (a, b) {\r\n            var c = n[b] / l;\r\n            m.push(Math.PI * c)\r\n        });\r\n        var o = (nodeArray.length, m[0] + m[1]), p = n[0] / 2 + n[1] / 2, q = p / 2 / Math.sin(o / 2);\r\n        null != g && g > q && (q = g);\r\n        var r = q * i, s = q * j, t = animateConfig.animate;\r\n        if (t) {\r\n            var time = t.time || 1e3, v = 0;\r\n            nodeArray.forEach(function (node, c) {\r\n                v += 0 == c ? m[c] : m[c - 1] + m[c];\r\n                var d = e + Math.cos(v) * r, g = f + Math.sin(v) * s;\r\n                jtopo.Animate.stepByStep(node,\r\n                    {\r\n                        x: d - node.width / 2,\r\n                        y: g - node.height / 2\r\n                    }, time\r\n                ).start();\r\n            })\r\n        } else {\r\n            var v = 0;\r\n            nodeArray.forEach(function (a, b) {\r\n                v += 0 == b ? m[b] : m[b - 1] + m[b];\r\n                var c = e + Math.cos(v) * r, d = f + Math.sin(v) * s;\r\n                a.cx = c, a.cy = d\r\n            })\r\n        }\r\n        return {cx: e, cy: f, radius: r, radiusA: r, radiusB: s}\r\n    }\r\n\r\n    function GridLayout(row, column) {\r\n        return function (container) {\r\n            var childs = container.childs;\r\n            if (!(childs.length <= 0)) {\r\n                var cBound = container.getBound();\r\n                var childNode = childs[0];\r\n                var columSpace = (cBound.width - childNode.width) / column;\r\n                var rowSpace = (cBound.height - childNode.height) / row;\r\n                for (var childIndex = 0, rowsIndex = 0; row > rowsIndex; rowsIndex++) {\r\n                    for (var columnIndex = 0; column > columnIndex; columnIndex++) {\r\n                        var node = childs[childIndex++];\r\n                        var x = cBound.left + columSpace / 2 + columnIndex * columSpace;\r\n                        var y = cBound.top + rowSpace / 2 + rowsIndex * rowSpace;\r\n                        if(!child.visible){\r\n                            child.show();\r\n                        }\r\n                        node.setLocation(x, y);\r\n                        if (childIndex >= childs.length) {\r\n                            return\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    function FlowLayout(row, column) {\r\n        if (null == column) {\r\n            column = 0;\r\n        }\r\n        if (null == row) {\r\n            row = 0;\r\n        }\r\n        return function (container) {\r\n            var childs = container.childs;\r\n            if (!(childs.length <= 0)) {\r\n                var bound = container.getBound();\r\n                var left = bound.left;\r\n                var top = bound.top;\r\n                for (var i = 0; i < childs.length; i++) {\r\n                    var child = childs[i];\r\n                    if(!child.visible){\r\n                        child.show();\r\n                    }\r\n                    if (left + child.width >= bound.right) {\r\n                        left = bound.left;\r\n                        top += row + child.height;\r\n                    }\r\n                    child.setLocation(left, top);\r\n                    left += column + child.width;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function AutoBoundLayout() {\r\n        return function (container, children) {\r\n            if (children.length > 0) {\r\n                var left = 1e7,\r\n                    right = -1e7,\r\n                    top = 1e7,\r\n                    bottom = -1e7,\r\n                    width = right - left,\r\n                    height = bottom - top;\r\n                for (var i = 0; i < children.length; i++) {\r\n                    var child = children[i];\r\n                    if(!child.visible){\r\n                        child.show();\r\n                    }\r\n                    child.x <= left && (left = child.x);\r\n                    (child.x + child.width) >= right && (right = child.x + child.width);\r\n                    child.y <= top && (top = child.y);\r\n                    (child.y + child.height) >= bottom && (bottom = child.y + child.height);\r\n                    width = right - left;\r\n                    height = bottom - top;\r\n                }\r\n                container.x = left;\r\n                container.y = top;\r\n                container.width = width;\r\n                container.height = height;\r\n            } else {\r\n                container.width = 100;\r\n                container.height = 100;\r\n            }\r\n            if (container.qtopo) {\r\n                container.qtopo.attr.size[0] = container.width;\r\n                container.qtopo.attr.size[1] = container.height;\r\n            }\r\n        }\r\n    }\r\n\r\n    function FixedBoundLayout() {\r\n        return function (container, children) {\r\n            if (container.width <= 0) {\r\n                container.width = 100;\r\n            }\r\n            if (container.height <= 0) {\r\n                container.height = 100;\r\n            }\r\n            if (container.width > 0 && container.height > 0) {\r\n                var groupBound = container.getBound();\r\n                children.map(function (child) {\r\n                    resetLocation(groupBound, child);\r\n                });\r\n            } else {\r\n                //若未设置高宽则运行一次自动布局设置高宽\r\n                AutoBoundLayout()(container, children);\r\n            }\r\n        }\r\n    }\r\n\r\n    function resetLocation(groupBound, child) {\r\n        var childBound = child.getBound();\r\n        var location = child.getLocation();\r\n        if (childBound.bottom > groupBound.bottom) {\r\n            location.y = groupBound.bottom - childBound.height;\r\n        }\r\n        if (childBound.right > groupBound.right) {\r\n            location.x = groupBound.right - childBound.width;\r\n        }\r\n        if (childBound.left < groupBound.left) {\r\n            location.x = groupBound.left;\r\n        }\r\n        if (childBound.top < groupBound.top) {\r\n            location.y = groupBound.top;\r\n        }\r\n        if(!child.visible){\r\n            child.show();\r\n        }\r\n        child.setLocation(location.x, location.y);\r\n    }\r\n\r\n    /**\r\n     * 找到可以作为根的节点\r\n     * */\r\n    function getRootNodes(elements) {\r\n        return elements.filter(function (element) {\r\n            return (element instanceof jtopo.Node) &&\r\n                (!element.inLinks || element.inLinks.length == 0) &&\r\n                (element.outLinks && element.outLinks.length > 0);\r\n        });\r\n    }\r\n\r\n    function getGap(arr) {\r\n        var totalWidth = 0, totalHeight = 0;\r\n        arr.forEach(function (a) {\r\n            totalWidth += a.width;\r\n            totalHeight += a.height;\r\n        });\r\n        return {\r\n            width: totalWidth / arr.length,\r\n            height: totalHeight / arr.length\r\n        }\r\n    }\r\n\r\n    function i(a, b, c, d) {\r\n        b.x += c, b.y += d;\r\n        for (var e = getRootChilds(a, b), f = 0; f < e.length; f++)i(a, e[f], c, d)\r\n    }\r\n\r\n    function j(a, b) {\r\n        function c(b, e) {\r\n            var f = getRootChilds(a, b);\r\n            null == d[e] && (d[e] = {}, d[e].nodes = [], d[e].childs = []), d[e].nodes.push(b), d[e].childs.push(f);\r\n            for (var g = 0; g < f.length; g++)c(f[g], e + 1), f[g].parent = b\r\n        }\r\n\r\n        var d = [];\r\n        return c(b, 0), d\r\n    }\r\n\r\n    function TreeLayout(direction, gap, top) {\r\n        return function (scene) {\r\n            function f(childs, root) {\r\n                var h = jtopo.layout.getTreeDeep(childs, root);\r\n                var k = j(childs, root);\r\n                var l = k["" + h].nodes;\r\n                for (var m = 0; m < l.length; m++) {\r\n                    var n = l[m], o = (m + 1) * (gap + 10), p = h * top;\r\n                    "down" == direction || ("up" == direction ? p = -p : "left" == direction ? (o = -h * top, p = (m + 1) * (gap + 10)) : "right" == direction && (o = h * top, p = (m + 1) * (gap + 10))), n.setLocation(o, p)\r\n                }\r\n                for (var q = h - 1; q >= 0; q--)for (var r = k["" + q].nodes, s = k["" + q].childs, m = 0; m < r.length; m++) {\r\n                    var t = r[m], u = s[m];\r\n                    if ("down" == direction ? t.y = q * top : "up" == direction ? t.y = -q * top : "left" == direction ? t.x = -q * top : "right" == direction && (t.x = q * top), u.length > 0 ? "down" == direction || "up" == direction ? t.x = (u[0].x + u[u.length - 1].x) / 2 : ("left" == direction || "right" == direction) && (t.y = (u[0].y + u[u.length - 1].y) / 2) : m > 0 && ("down" == direction || "up" == direction ? t.x = r[m - 1].x + r[m - 1].width + gap : ("left" == direction || "right" == direction) && (t.y = r[m - 1].y + r[m - 1].height + gap)), m > 0)if ("down" == direction || "up" == direction) {\r\n                        if (t.x < r[m - 1].x + r[m - 1].width)for (var v = r[m - 1].x + r[m - 1].width + gap, w = Math.abs(v - t.x), x = m; x < r.length; x++)i(scene.childs, r[x], w, 0)\r\n                    } else if (("left" == direction || "right" == direction) && t.y < r[m - 1].y + r[m - 1].height)for (var y = r[m - 1].y + r[m - 1].height + gap, z = Math.abs(y - t.y), x = m; x < r.length; x++)i(scene.childs, r[x], 0, z)\r\n                }\r\n            }\r\n\r\n            var realGap = null;\r\n            if (null == gap) {\r\n                realGap = getGap(scene.childs);\r\n                gap = realGap.width;\r\n                if ("left" == direction || "right" == direction) {\r\n                    gap = realGap.width + 10;\r\n                }\r\n            }\r\n            if (null == top) {\r\n                if (null == realGap) {\r\n                    realGap = getGap(scene.childs)\r\n                }\r\n                top = 2 * realGap.height;\r\n            }\r\n            direction = direction || "down";\r\n            var roots = jtopo.layout.getRootNodes(scene.childs);\r\n            if (roots.length > 0) {\r\n                f(scene.childs, roots[0]);\r\n                var bound = jtopo.util.getElementsBound(scene.childs);\r\n                var center = scene.getCenterLocation();\r\n                var startX = center.x - (bound.left + bound.right) / 2,\r\n                    startY = center.y - (bound.top + bound.bottom) / 2;\r\n                scene.childs.forEach(function (element) {\r\n                    if (element instanceof jtopo.Node) {\r\n                        element.x += startX;\r\n                        element.y += startY;\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    //必须得是有向无环图才可以布局\r\n    function CircleLayout(radius) {\r\n        return function (scene) {\r\n            function locationSet(allChilds, root, ra) {\r\n                var rootsArr = getRootChilds(allChilds, root);\r\n                if (0 != rootsArr.length) {\r\n                    if (null == ra) {\r\n                        ra = radius;\r\n                    }\r\n                    var step = 2 * Math.PI / rootsArr.length;\r\n                    rootsArr.forEach(function (child, i) {\r\n                        child.setLocation(\r\n                            root.x + ra * Math.cos(step * i),\r\n                            root.y + ra * Math.sin(step * i)\r\n                        );\r\n                        locationSet(allChilds, child, ra / 2);\r\n                    })\r\n                }\r\n            }\r\n\r\n            var roots = jtopo.layout.getRootNodes(scene.childs);\r\n            if (roots.length > 0) {\r\n                locationSet(scene.childs, roots[0]);\r\n                var bound = jtopo.util.getElementsBound(scene.childs);\r\n                var center = scene.getCenterLocation();\r\n                var left = center.x - (bound.left + bound.right) / 2;\r\n                var top = center.y - (bound.top + bound.bottom) / 2;\r\n                scene.childs.forEach(function (b) {\r\n                    if (b instanceof jtopo.Node) {\r\n                        b.x += left;\r\n                        b.y += top;\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    function m(a, b, c, d, e, f) {\r\n        var g = [];\r\n        for (var h = 0; c > h; h++) {\r\n            for (var i = 0; d > i; i++) {\r\n                g.push({x: a + i * e, y: b + h * f});\r\n            }\r\n        }\r\n        return g\r\n    }\r\n\r\n    function circlePosition(centerX, centerY, total, raidus, beginAngle, endAngle) {\r\n        var begin = beginAngle ? beginAngle : 0;\r\n        var end = endAngle ? endAngle : 2 * Math.PI;\r\n        var totalAngle = end - begin;\r\n        var step = totalAngle / total;\r\n        var position = [];\r\n        begin += step / 2;\r\n        for (var i = begin; end >= i; i += step) {\r\n            position.push({\r\n                x: centerX + Math.cos(i) * raidus,\r\n                y: centerY + Math.sin(i) * raidus\r\n            });\r\n        }\r\n        return position\r\n    }\r\n\r\n    function treePostion(a, b, c, d, e, f) {\r\n        var g = f || "bottom", h = [];\r\n        if ("bottom" == g)for (var i = a - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n            x: i + j * d,\r\n            y: b + e\r\n        }); else if ("top" == g)for (var i = a - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n            x: i + j * d,\r\n            y: b - e\r\n        }); else if ("right" == g)for (var i = b - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n            x: a + e,\r\n            y: i + j * d\r\n        }); else if ("left" == g)for (var i = b - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({x: a - e, y: i + j * d});\r\n        return h\r\n    }\r\n\r\n    function gridPosition(a, b, c, d, e, f) {\r\n        for (var g = [], h = 0; c > h; h++)for (var i = 0; d > i; i++)g.push({x: a + i * e, y: b + h * f});\r\n        return g\r\n    }\r\n\r\n    function adjustPosition(root, rootChilds) {\r\n        if (root.layout) {\r\n            var layout = root.layout;\r\n            var locationArr = null;\r\n            switch (layout.type) {\r\n                case \'circle\':\r\n                    var radius = layout.radius || Math.max(root.width, root.height);\r\n                    locationArr = circlePosition(\r\n                        root.cx,\r\n                        root.cy,\r\n                        rootChilds.length,\r\n                        radius,\r\n                        root.layout.beginAngle,\r\n                        root.layout.endAngle\r\n                    );\r\n                    break;\r\n                case \'tree\':\r\n                    locationArr = treePostion(\r\n                        root.cx,\r\n                        root.cy,\r\n                        rootChilds.length,\r\n                        layout.width || 50,\r\n                        layout.height || 50,\r\n                        layout.direction\r\n                    );\r\n                    break;\r\n                case \'grid\':\r\n                    locationArr = gridPosition(\r\n                        root.x,\r\n                        root.y,\r\n                        layout.rows,\r\n                        layout.cols,\r\n                        layout.horizontal || 0,\r\n                        layout.vertical || 0\r\n                    );\r\n                    break;\r\n            }\r\n            for (var i = 0; i < rootChilds.length; i++) {\r\n                rootChilds[i].setCenterLocation(locationArr[i].x, locationArr[i].y);\r\n            }\r\n        }\r\n    }\r\n\r\n    function getRootChilds(allChilds, rootNode) {\r\n        var rootChilds;\r\n        if (rootNode.outLinks instanceof Array && rootNode.outLinks.length > 0) {\r\n            rootChilds = rootNode.outLinks.map(function (link) {\r\n                return link.nodeZ;\r\n            });\r\n        }\r\n        return rootChilds || [];\r\n    }\r\n\r\n    function layoutNode(scene, root, recursion) {\r\n        var rootChilds = getRootChilds(scene.childs, root);\r\n        if (0 != rootChilds.length) {\r\n            adjustPosition(root, rootChilds);\r\n            if (1 == recursion) {\r\n                for (var e = 0; e < rootChilds.length; e++) {\r\n                    layoutNode(scene, rootChilds[e], recursion);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function springLayout(root, scene) {\r\n        var keyA = 0.01;//移动幅度\r\n        var keyB = 0.95;\r\n        var temp = -5;\r\n        var stepX = 0;\r\n        var stepY = 0;\r\n        var times = 0;\r\n        var nodes = scene.getElementsByClass(jtopo.Node);\r\n        annimate();\r\n\r\n        function change(root, node) {\r\n            var disX = root.x - node.x;\r\n            var disY = root.y - node.y;\r\n            stepX += disX * keyA;\r\n            stepY += disY * keyA;\r\n            stepX *= keyB;\r\n            stepY *= keyB;\r\n            stepY += temp;\r\n            node.x += stepX;\r\n            node.y += stepY;\r\n        }\r\n\r\n        function annimate() {\r\n            ++times;\r\n            if (times < 150) {\r\n                for (var i = 0; i < nodes.length; i++) {\r\n                    if (nodes[i] != root) {\r\n                        change(root, nodes[i]);\r\n                    }\r\n                }\r\n                setTimeout(annimate, 1e3 / 24)\r\n            }\r\n        }\r\n    }\r\n\r\n    function getTreeDeep(childs, root) {\r\n        function reDeep(childs, root, deep) {\r\n            var rootChilds = getRootChilds(childs, root);\r\n            if (deep > d) {\r\n                d = deep;\r\n            }\r\n            for (var g = 0; g < rootChilds.length; g++) {\r\n                reDeep(childs, rootChilds[g], deep + 1);\r\n            }\r\n        }\r\n\r\n        var d = 0;\r\n        reDeep(childs, root, 0);\r\n        return d;\r\n    }\r\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vdG9vbHMvbGF5b3V0LmpzP2E2MGIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0Esb0RBQW9EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGdCQUFnQjtBQUNoQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELGlCQUFpQjtBQUN4RSw2Q0FBNkMsc0JBQXNCO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsbUJBQW1CO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHFCQUFxQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxnREFBZ0QsY0FBYztBQUM5RDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0M7QUFDdEMsMkJBQTJCLGNBQWM7QUFDekM7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixjQUFjO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxRQUFRLCtEQUErRCxjQUFjO0FBQ3hIO0FBQ0E7QUFDQSwySUFBMkksY0FBYztBQUN6SixxQkFBcUIsNEtBQTRLLGNBQWM7QUFDL007QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsdUJBQXVCLE9BQU87QUFDOUIsMkJBQTJCLE9BQU87QUFDbEMsd0JBQXdCLDJCQUEyQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixVQUFVO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9FQUFvRSxRQUFRO0FBQzVFO0FBQ0E7QUFDQSxTQUFTLEVBQUUsK0RBQStELFFBQVE7QUFDbEY7QUFDQTtBQUNBLFNBQVMsRUFBRSxpRUFBaUUsUUFBUTtBQUNwRjtBQUNBO0FBQ0EsU0FBUyxFQUFFLGdFQUFnRSxRQUFRLGFBQWEsdUJBQXVCO0FBQ3ZIO0FBQ0E7O0FBRUE7QUFDQSwrQkFBK0IsT0FBTyxvQkFBb0IsT0FBTyxhQUFhLDJCQUEyQjtBQUN6RztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHVCQUF1QjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHVCQUF1QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGtCQUFrQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQix1QkFBdUI7QUFDbEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMjUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChqdG9wbykge1xyXG4gICAganRvcG8ubGF5b3V0ID0ganRvcG8uTGF5b3V0ID0ge1xyXG4gICAgICAgIGxheW91dE5vZGU6IGxheW91dE5vZGUsXHJcbiAgICAgICAgZ2V0Tm9kZUNoaWxkczogZ2V0Um9vdENoaWxkcyxcclxuICAgICAgICBhZGp1c3RQb3NpdGlvbjogYWRqdXN0UG9zaXRpb24sXHJcbiAgICAgICAgc3ByaW5nTGF5b3V0OiBzcHJpbmdMYXlvdXQsXHJcbiAgICAgICAgZ2V0VHJlZURlZXA6IGdldFRyZWVEZWVwLFxyXG4gICAgICAgIGdldFJvb3ROb2RlczogZ2V0Um9vdE5vZGVzLFxyXG4gICAgICAgIEdyaWRMYXlvdXQ6IEdyaWRMYXlvdXQsXHJcbiAgICAgICAgRmxvd0xheW91dDogRmxvd0xheW91dCxcclxuICAgICAgICBBdXRvQm91bmRMYXlvdXQ6IEF1dG9Cb3VuZExheW91dCxcclxuICAgICAgICBGaXhlZEJvdW5kTGF5b3V0OiBGaXhlZEJvdW5kTGF5b3V0LFxyXG4gICAgICAgIENpcmNsZUxheW91dDogQ2lyY2xlTGF5b3V0LFxyXG4gICAgICAgIFRyZWVMYXlvdXQ6IFRyZWVMYXlvdXQsXHJcbiAgICAgICAgZ2V0Tm9kZXNDZW50ZXI6IGdldE5vZGVzQ2VudGVyLFxyXG4gICAgICAgIGNpcmNsZUxheW91dE5vZGVzOiBjaXJjbGVMYXlvdXROb2Rlc1xyXG4gICAgfTtcclxuICAgIGZ1bmN0aW9uIGdldE5vZGVzQ2VudGVyKGEpIHtcclxuICAgICAgICB2YXIgYiA9IDAsIGMgPSAwO1xyXG4gICAgICAgIGEuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBiICs9IGEuY3gsIGMgKz0gYS5jeVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBkID0ge3g6IGIgLyBhLmxlbmd0aCwgeTogYyAvIGEubGVuZ3RofTtcclxuICAgICAgICByZXR1cm4gZFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNpcmNsZUxheW91dE5vZGVzKG5vZGVBcnJheSwgYW5pbWF0ZUNvbmZpZykge1xyXG4gICAgICAgIG51bGwgPT0gYW5pbWF0ZUNvbmZpZyAmJiAoYW5pbWF0ZUNvbmZpZyA9IHt9KTtcclxuICAgICAgICB2YXIgZSA9IGFuaW1hdGVDb25maWcuY3gsXHJcbiAgICAgICAgICAgIGYgPSBhbmltYXRlQ29uZmlnLmN5LFxyXG4gICAgICAgICAgICBnID0gYW5pbWF0ZUNvbmZpZy5taW5SYWRpdXMsXHJcbiAgICAgICAgICAgIGggPSBhbmltYXRlQ29uZmlnLm5vZGVEaWFtZXRlcixcclxuICAgICAgICAgICAgaSA9IGFuaW1hdGVDb25maWcuaFNjYWxlIHx8IDEsXHJcbiAgICAgICAgICAgIGogPSBhbmltYXRlQ29uZmlnLnZTY2FsZSB8fCAxO1xyXG4gICAgICAgIGlmIChudWxsID09IGUgfHwgbnVsbCA9PSBmKSB7XHJcbiAgICAgICAgICAgIHZhciBrID0gZ2V0Tm9kZXNDZW50ZXIobm9kZUFycmF5KTtcclxuICAgICAgICAgICAgZSA9IGsueCwgZiA9IGsueVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbCA9IDAsIG0gPSBbXSwgbiA9IFtdO1xyXG4gICAgICAgIG5vZGVBcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XHJcbiAgICAgICAgICAgIG51bGwgPT0gYW5pbWF0ZUNvbmZpZy5ub2RlRGlhbWV0ZXIgPyAobm9kZS5kaWFtZXRlciAmJiAoaCA9IG5vZGUuZGlhbWV0ZXIpLFxyXG4gICAgICAgICAgICAgICAgaCA9IG5vZGUucmFkaXVzID8gMiAqIG5vZGUucmFkaXVzIDogTWF0aC5zcXJ0KDIgKiBub2RlLndpZHRoICogbm9kZS5oZWlnaHQpLFxyXG4gICAgICAgICAgICAgICAgbi5wdXNoKGgpKSA6IG4ucHVzaChoKSwgbCArPSBoXHJcbiAgICAgICAgfSksIG5vZGVBcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gbltiXSAvIGw7XHJcbiAgICAgICAgICAgIG0ucHVzaChNYXRoLlBJICogYylcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgbyA9IChub2RlQXJyYXkubGVuZ3RoLCBtWzBdICsgbVsxXSksIHAgPSBuWzBdIC8gMiArIG5bMV0gLyAyLCBxID0gcCAvIDIgLyBNYXRoLnNpbihvIC8gMik7XHJcbiAgICAgICAgbnVsbCAhPSBnICYmIGcgPiBxICYmIChxID0gZyk7XHJcbiAgICAgICAgdmFyIHIgPSBxICogaSwgcyA9IHEgKiBqLCB0ID0gYW5pbWF0ZUNvbmZpZy5hbmltYXRlO1xyXG4gICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgIHZhciB0aW1lID0gdC50aW1lIHx8IDFlMywgdiA9IDA7XHJcbiAgICAgICAgICAgIG5vZGVBcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChub2RlLCBjKSB7XHJcbiAgICAgICAgICAgICAgICB2ICs9IDAgPT0gYyA/IG1bY10gOiBtW2MgLSAxXSArIG1bY107XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IGUgKyBNYXRoLmNvcyh2KSAqIHIsIGcgPSBmICsgTWF0aC5zaW4odikgKiBzO1xyXG4gICAgICAgICAgICAgICAganRvcG8uQW5pbWF0ZS5zdGVwQnlTdGVwKG5vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB4OiBkIC0gbm9kZS53aWR0aCAvIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IGcgLSBub2RlLmhlaWdodCAvIDJcclxuICAgICAgICAgICAgICAgICAgICB9LCB0aW1lXHJcbiAgICAgICAgICAgICAgICApLnN0YXJ0KCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHYgPSAwO1xyXG4gICAgICAgICAgICBub2RlQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgdiArPSAwID09IGIgPyBtW2JdIDogbVtiIC0gMV0gKyBtW2JdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBlICsgTWF0aC5jb3ModikgKiByLCBkID0gZiArIE1hdGguc2luKHYpICogcztcclxuICAgICAgICAgICAgICAgIGEuY3ggPSBjLCBhLmN5ID0gZFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge2N4OiBlLCBjeTogZiwgcmFkaXVzOiByLCByYWRpdXNBOiByLCByYWRpdXNCOiBzfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIEdyaWRMYXlvdXQocm93LCBjb2x1bW4pIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGNvbnRhaW5lcikge1xyXG4gICAgICAgICAgICB2YXIgY2hpbGRzID0gY29udGFpbmVyLmNoaWxkcztcclxuICAgICAgICAgICAgaWYgKCEoY2hpbGRzLmxlbmd0aCA8PSAwKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNCb3VuZCA9IGNvbnRhaW5lci5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkTm9kZSA9IGNoaWxkc1swXTtcclxuICAgICAgICAgICAgICAgIHZhciBjb2x1bVNwYWNlID0gKGNCb3VuZC53aWR0aCAtIGNoaWxkTm9kZS53aWR0aCkgLyBjb2x1bW47XHJcbiAgICAgICAgICAgICAgICB2YXIgcm93U3BhY2UgPSAoY0JvdW5kLmhlaWdodCAtIGNoaWxkTm9kZS5oZWlnaHQpIC8gcm93O1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgY2hpbGRJbmRleCA9IDAsIHJvd3NJbmRleCA9IDA7IHJvdyA+IHJvd3NJbmRleDsgcm93c0luZGV4KyspIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2x1bW5JbmRleCA9IDA7IGNvbHVtbiA+IGNvbHVtbkluZGV4OyBjb2x1bW5JbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub2RlID0gY2hpbGRzW2NoaWxkSW5kZXgrK107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gY0JvdW5kLmxlZnQgKyBjb2x1bVNwYWNlIC8gMiArIGNvbHVtbkluZGV4ICogY29sdW1TcGFjZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSBjQm91bmQudG9wICsgcm93U3BhY2UgLyAyICsgcm93c0luZGV4ICogcm93U3BhY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFjaGlsZC52aXNpYmxlKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnNldExvY2F0aW9uKHgsIHkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGRJbmRleCA+PSBjaGlsZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gRmxvd0xheW91dChyb3csIGNvbHVtbikge1xyXG4gICAgICAgIGlmIChudWxsID09IGNvbHVtbikge1xyXG4gICAgICAgICAgICBjb2x1bW4gPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobnVsbCA9PSByb3cpIHtcclxuICAgICAgICAgICAgcm93ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjb250YWluZXIpIHtcclxuICAgICAgICAgICAgdmFyIGNoaWxkcyA9IGNvbnRhaW5lci5jaGlsZHM7XHJcbiAgICAgICAgICAgIGlmICghKGNoaWxkcy5sZW5ndGggPD0gMCkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBib3VuZCA9IGNvbnRhaW5lci5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBib3VuZC5sZWZ0O1xyXG4gICAgICAgICAgICAgICAgdmFyIHRvcCA9IGJvdW5kLnRvcDtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkID0gY2hpbGRzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCFjaGlsZC52aXNpYmxlKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAobGVmdCArIGNoaWxkLndpZHRoID49IGJvdW5kLnJpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQgPSBib3VuZC5sZWZ0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3AgKz0gcm93ICsgY2hpbGQuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjaGlsZC5zZXRMb2NhdGlvbihsZWZ0LCB0b3ApO1xyXG4gICAgICAgICAgICAgICAgICAgIGxlZnQgKz0gY29sdW1uICsgY2hpbGQud2lkdGg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gQXV0b0JvdW5kTGF5b3V0KCkge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoY29udGFpbmVyLCBjaGlsZHJlbikge1xyXG4gICAgICAgICAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxlZnQgPSAxZTcsXHJcbiAgICAgICAgICAgICAgICAgICAgcmlnaHQgPSAtMWU3LFxyXG4gICAgICAgICAgICAgICAgICAgIHRvcCA9IDFlNyxcclxuICAgICAgICAgICAgICAgICAgICBib3R0b20gPSAtMWU3LFxyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoID0gcmlnaHQgLSBsZWZ0LFxyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IGJvdHRvbSAtIHRvcDtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSBjaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgICAgICAgICBpZighY2hpbGQudmlzaWJsZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQueCA8PSBsZWZ0ICYmIChsZWZ0ID0gY2hpbGQueCk7XHJcbiAgICAgICAgICAgICAgICAgICAgKGNoaWxkLnggKyBjaGlsZC53aWR0aCkgPj0gcmlnaHQgJiYgKHJpZ2h0ID0gY2hpbGQueCArIGNoaWxkLndpZHRoKTtcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZC55IDw9IHRvcCAmJiAodG9wID0gY2hpbGQueSk7XHJcbiAgICAgICAgICAgICAgICAgICAgKGNoaWxkLnkgKyBjaGlsZC5oZWlnaHQpID49IGJvdHRvbSAmJiAoYm90dG9tID0gY2hpbGQueSArIGNoaWxkLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggPSByaWdodCAtIGxlZnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gYm90dG9tIC0gdG9wO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLnggPSBsZWZ0O1xyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLnkgPSB0b3A7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIud2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIud2lkdGggPSAxMDA7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIuaGVpZ2h0ID0gMTAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb250YWluZXIucXRvcG8pIHtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5xdG9wby5hdHRyLnNpemVbMF0gPSBjb250YWluZXIud2lkdGg7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIucXRvcG8uYXR0ci5zaXplWzFdID0gY29udGFpbmVyLmhlaWdodDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBGaXhlZEJvdW5kTGF5b3V0KCkge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoY29udGFpbmVyLCBjaGlsZHJlbikge1xyXG4gICAgICAgICAgICBpZiAoY29udGFpbmVyLndpZHRoIDw9IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lci53aWR0aCA9IDEwMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29udGFpbmVyLmhlaWdodCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIuaGVpZ2h0ID0gMTAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb250YWluZXIud2lkdGggPiAwICYmIGNvbnRhaW5lci5oZWlnaHQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZ3JvdXBCb3VuZCA9IGNvbnRhaW5lci5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc2V0TG9jYXRpb24oZ3JvdXBCb3VuZCwgY2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvL+iLpeacquiuvue9rumrmOWuveWImei/kOihjOS4gOasoeiHquWKqOW4g+WxgOiuvue9rumrmOWuvVxyXG4gICAgICAgICAgICAgICAgQXV0b0JvdW5kTGF5b3V0KCkoY29udGFpbmVyLCBjaGlsZHJlbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVzZXRMb2NhdGlvbihncm91cEJvdW5kLCBjaGlsZCkge1xyXG4gICAgICAgIHZhciBjaGlsZEJvdW5kID0gY2hpbGQuZ2V0Qm91bmQoKTtcclxuICAgICAgICB2YXIgbG9jYXRpb24gPSBjaGlsZC5nZXRMb2NhdGlvbigpO1xyXG4gICAgICAgIGlmIChjaGlsZEJvdW5kLmJvdHRvbSA+IGdyb3VwQm91bmQuYm90dG9tKSB7XHJcbiAgICAgICAgICAgIGxvY2F0aW9uLnkgPSBncm91cEJvdW5kLmJvdHRvbSAtIGNoaWxkQm91bmQuaGVpZ2h0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY2hpbGRCb3VuZC5yaWdodCA+IGdyb3VwQm91bmQucmlnaHQpIHtcclxuICAgICAgICAgICAgbG9jYXRpb24ueCA9IGdyb3VwQm91bmQucmlnaHQgLSBjaGlsZEJvdW5kLndpZHRoO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY2hpbGRCb3VuZC5sZWZ0IDwgZ3JvdXBCb3VuZC5sZWZ0KSB7XHJcbiAgICAgICAgICAgIGxvY2F0aW9uLnggPSBncm91cEJvdW5kLmxlZnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjaGlsZEJvdW5kLnRvcCA8IGdyb3VwQm91bmQudG9wKSB7XHJcbiAgICAgICAgICAgIGxvY2F0aW9uLnkgPSBncm91cEJvdW5kLnRvcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoIWNoaWxkLnZpc2libGUpe1xyXG4gICAgICAgICAgICBjaGlsZC5zaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNoaWxkLnNldExvY2F0aW9uKGxvY2F0aW9uLngsIGxvY2F0aW9uLnkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5om+5Yiw5Y+v5Lul5L2c5Li65qC555qE6IqC54K5XHJcbiAgICAgKiAqL1xyXG4gICAgZnVuY3Rpb24gZ2V0Um9vdE5vZGVzKGVsZW1lbnRzKSB7XHJcbiAgICAgICAgcmV0dXJuIGVsZW1lbnRzLmZpbHRlcihmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKGVsZW1lbnQgaW5zdGFuY2VvZiBqdG9wby5Ob2RlKSAmJlxyXG4gICAgICAgICAgICAgICAgKCFlbGVtZW50LmluTGlua3MgfHwgZWxlbWVudC5pbkxpbmtzLmxlbmd0aCA9PSAwKSAmJlxyXG4gICAgICAgICAgICAgICAgKGVsZW1lbnQub3V0TGlua3MgJiYgZWxlbWVudC5vdXRMaW5rcy5sZW5ndGggPiAwKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRHYXAoYXJyKSB7XHJcbiAgICAgICAgdmFyIHRvdGFsV2lkdGggPSAwLCB0b3RhbEhlaWdodCA9IDA7XHJcbiAgICAgICAgYXJyLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdG90YWxXaWR0aCArPSBhLndpZHRoO1xyXG4gICAgICAgICAgICB0b3RhbEhlaWdodCArPSBhLmhlaWdodDtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB3aWR0aDogdG90YWxXaWR0aCAvIGFyci5sZW5ndGgsXHJcbiAgICAgICAgICAgIGhlaWdodDogdG90YWxIZWlnaHQgLyBhcnIubGVuZ3RoXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGkoYSwgYiwgYywgZCkge1xyXG4gICAgICAgIGIueCArPSBjLCBiLnkgKz0gZDtcclxuICAgICAgICBmb3IgKHZhciBlID0gZ2V0Um9vdENoaWxkcyhhLCBiKSwgZiA9IDA7IGYgPCBlLmxlbmd0aDsgZisrKWkoYSwgZVtmXSwgYywgZClcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBqKGEsIGIpIHtcclxuICAgICAgICBmdW5jdGlvbiBjKGIsIGUpIHtcclxuICAgICAgICAgICAgdmFyIGYgPSBnZXRSb290Q2hpbGRzKGEsIGIpO1xyXG4gICAgICAgICAgICBudWxsID09IGRbZV0gJiYgKGRbZV0gPSB7fSwgZFtlXS5ub2RlcyA9IFtdLCBkW2VdLmNoaWxkcyA9IFtdKSwgZFtlXS5ub2Rlcy5wdXNoKGIpLCBkW2VdLmNoaWxkcy5wdXNoKGYpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBnID0gMDsgZyA8IGYubGVuZ3RoOyBnKyspYyhmW2ddLCBlICsgMSksIGZbZ10ucGFyZW50ID0gYlxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGQgPSBbXTtcclxuICAgICAgICByZXR1cm4gYyhiLCAwKSwgZFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIFRyZWVMYXlvdXQoZGlyZWN0aW9uLCBnYXAsIHRvcCkge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoc2NlbmUpIHtcclxuICAgICAgICAgICAgZnVuY3Rpb24gZihjaGlsZHMsIHJvb3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciBoID0ganRvcG8ubGF5b3V0LmdldFRyZWVEZWVwKGNoaWxkcywgcm9vdCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgayA9IGooY2hpbGRzLCByb290KTtcclxuICAgICAgICAgICAgICAgIHZhciBsID0ga1tcIlwiICsgaF0ubm9kZXM7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBtID0gMDsgbSA8IGwubGVuZ3RoOyBtKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IGxbbV0sIG8gPSAobSArIDEpICogKGdhcCArIDEwKSwgcCA9IGggKiB0b3A7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJkb3duXCIgPT0gZGlyZWN0aW9uIHx8IChcInVwXCIgPT0gZGlyZWN0aW9uID8gcCA9IC1wIDogXCJsZWZ0XCIgPT0gZGlyZWN0aW9uID8gKG8gPSAtaCAqIHRvcCwgcCA9IChtICsgMSkgKiAoZ2FwICsgMTApKSA6IFwicmlnaHRcIiA9PSBkaXJlY3Rpb24gJiYgKG8gPSBoICogdG9wLCBwID0gKG0gKyAxKSAqIChnYXAgKyAxMCkpKSwgbi5zZXRMb2NhdGlvbihvLCBwKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgcSA9IGggLSAxOyBxID49IDA7IHEtLSlmb3IgKHZhciByID0ga1tcIlwiICsgcV0ubm9kZXMsIHMgPSBrW1wiXCIgKyBxXS5jaGlsZHMsIG0gPSAwOyBtIDwgci5sZW5ndGg7IG0rKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ID0gclttXSwgdSA9IHNbbV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFwiZG93blwiID09IGRpcmVjdGlvbiA/IHQueSA9IHEgKiB0b3AgOiBcInVwXCIgPT0gZGlyZWN0aW9uID8gdC55ID0gLXEgKiB0b3AgOiBcImxlZnRcIiA9PSBkaXJlY3Rpb24gPyB0LnggPSAtcSAqIHRvcCA6IFwicmlnaHRcIiA9PSBkaXJlY3Rpb24gJiYgKHQueCA9IHEgKiB0b3ApLCB1Lmxlbmd0aCA+IDAgPyBcImRvd25cIiA9PSBkaXJlY3Rpb24gfHwgXCJ1cFwiID09IGRpcmVjdGlvbiA/IHQueCA9ICh1WzBdLnggKyB1W3UubGVuZ3RoIC0gMV0ueCkgLyAyIDogKFwibGVmdFwiID09IGRpcmVjdGlvbiB8fCBcInJpZ2h0XCIgPT0gZGlyZWN0aW9uKSAmJiAodC55ID0gKHVbMF0ueSArIHVbdS5sZW5ndGggLSAxXS55KSAvIDIpIDogbSA+IDAgJiYgKFwiZG93blwiID09IGRpcmVjdGlvbiB8fCBcInVwXCIgPT0gZGlyZWN0aW9uID8gdC54ID0gclttIC0gMV0ueCArIHJbbSAtIDFdLndpZHRoICsgZ2FwIDogKFwibGVmdFwiID09IGRpcmVjdGlvbiB8fCBcInJpZ2h0XCIgPT0gZGlyZWN0aW9uKSAmJiAodC55ID0gclttIC0gMV0ueSArIHJbbSAtIDFdLmhlaWdodCArIGdhcCkpLCBtID4gMClpZiAoXCJkb3duXCIgPT0gZGlyZWN0aW9uIHx8IFwidXBcIiA9PSBkaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQueCA8IHJbbSAtIDFdLnggKyByW20gLSAxXS53aWR0aClmb3IgKHZhciB2ID0gclttIC0gMV0ueCArIHJbbSAtIDFdLndpZHRoICsgZ2FwLCB3ID0gTWF0aC5hYnModiAtIHQueCksIHggPSBtOyB4IDwgci5sZW5ndGg7IHgrKylpKHNjZW5lLmNoaWxkcywgclt4XSwgdywgMClcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKChcImxlZnRcIiA9PSBkaXJlY3Rpb24gfHwgXCJyaWdodFwiID09IGRpcmVjdGlvbikgJiYgdC55IDwgclttIC0gMV0ueSArIHJbbSAtIDFdLmhlaWdodClmb3IgKHZhciB5ID0gclttIC0gMV0ueSArIHJbbSAtIDFdLmhlaWdodCArIGdhcCwgeiA9IE1hdGguYWJzKHkgLSB0LnkpLCB4ID0gbTsgeCA8IHIubGVuZ3RoOyB4KyspaShzY2VuZS5jaGlsZHMsIHJbeF0sIDAsIHopXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciByZWFsR2FwID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKG51bGwgPT0gZ2FwKSB7XHJcbiAgICAgICAgICAgICAgICByZWFsR2FwID0gZ2V0R2FwKHNjZW5lLmNoaWxkcyk7XHJcbiAgICAgICAgICAgICAgICBnYXAgPSByZWFsR2FwLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgaWYgKFwibGVmdFwiID09IGRpcmVjdGlvbiB8fCBcInJpZ2h0XCIgPT0gZGlyZWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2FwID0gcmVhbEdhcC53aWR0aCArIDEwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChudWxsID09IHRvcCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gcmVhbEdhcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlYWxHYXAgPSBnZXRHYXAoc2NlbmUuY2hpbGRzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdG9wID0gMiAqIHJlYWxHYXAuaGVpZ2h0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9IGRpcmVjdGlvbiB8fCBcImRvd25cIjtcclxuICAgICAgICAgICAgdmFyIHJvb3RzID0ganRvcG8ubGF5b3V0LmdldFJvb3ROb2RlcyhzY2VuZS5jaGlsZHMpO1xyXG4gICAgICAgICAgICBpZiAocm9vdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZihzY2VuZS5jaGlsZHMsIHJvb3RzWzBdKTtcclxuICAgICAgICAgICAgICAgIHZhciBib3VuZCA9IGp0b3BvLnV0aWwuZ2V0RWxlbWVudHNCb3VuZChzY2VuZS5jaGlsZHMpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IHNjZW5lLmdldENlbnRlckxvY2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3RhcnRYID0gY2VudGVyLnggLSAoYm91bmQubGVmdCArIGJvdW5kLnJpZ2h0KSAvIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRZID0gY2VudGVyLnkgLSAoYm91bmQudG9wICsgYm91bmQuYm90dG9tKSAvIDI7XHJcbiAgICAgICAgICAgICAgICBzY2VuZS5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YganRvcG8uTm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnggKz0gc3RhcnRYO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnkgKz0gc3RhcnRZO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy/lv4XpobvlvpfmmK/mnInlkJHml6Dnjq/lm77miY3lj6/ku6XluIPlsYBcclxuICAgIGZ1bmN0aW9uIENpcmNsZUxheW91dChyYWRpdXMpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHNjZW5lKSB7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGxvY2F0aW9uU2V0KGFsbENoaWxkcywgcm9vdCwgcmEpIHtcclxuICAgICAgICAgICAgICAgIHZhciByb290c0FyciA9IGdldFJvb3RDaGlsZHMoYWxsQ2hpbGRzLCByb290KTtcclxuICAgICAgICAgICAgICAgIGlmICgwICE9IHJvb3RzQXJyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsID09IHJhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhID0gcmFkaXVzO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcCA9IDIgKiBNYXRoLlBJIC8gcm9vdHNBcnIubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgIHJvb3RzQXJyLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLnNldExvY2F0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9vdC54ICsgcmEgKiBNYXRoLmNvcyhzdGVwICogaSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb290LnkgKyByYSAqIE1hdGguc2luKHN0ZXAgKiBpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvblNldChhbGxDaGlsZHMsIGNoaWxkLCByYSAvIDIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciByb290cyA9IGp0b3BvLmxheW91dC5nZXRSb290Tm9kZXMoc2NlbmUuY2hpbGRzKTtcclxuICAgICAgICAgICAgaWYgKHJvb3RzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uU2V0KHNjZW5lLmNoaWxkcywgcm9vdHNbMF0pO1xyXG4gICAgICAgICAgICAgICAgdmFyIGJvdW5kID0ganRvcG8udXRpbC5nZXRFbGVtZW50c0JvdW5kKHNjZW5lLmNoaWxkcyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gc2NlbmUuZ2V0Q2VudGVyTG9jYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIHZhciBsZWZ0ID0gY2VudGVyLnggLSAoYm91bmQubGVmdCArIGJvdW5kLnJpZ2h0KSAvIDI7XHJcbiAgICAgICAgICAgICAgICB2YXIgdG9wID0gY2VudGVyLnkgLSAoYm91bmQudG9wICsgYm91bmQuYm90dG9tKSAvIDI7XHJcbiAgICAgICAgICAgICAgICBzY2VuZS5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChiIGluc3RhbmNlb2YganRvcG8uTm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiLnggKz0gbGVmdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYi55ICs9IHRvcDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG0oYSwgYiwgYywgZCwgZSwgZikge1xyXG4gICAgICAgIHZhciBnID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaCA9IDA7IGMgPiBoOyBoKyspIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGQgPiBpOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGcucHVzaCh7eDogYSArIGkgKiBlLCB5OiBiICsgaCAqIGZ9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZ1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNpcmNsZVBvc2l0aW9uKGNlbnRlclgsIGNlbnRlclksIHRvdGFsLCByYWlkdXMsIGJlZ2luQW5nbGUsIGVuZEFuZ2xlKSB7XHJcbiAgICAgICAgdmFyIGJlZ2luID0gYmVnaW5BbmdsZSA/IGJlZ2luQW5nbGUgOiAwO1xyXG4gICAgICAgIHZhciBlbmQgPSBlbmRBbmdsZSA/IGVuZEFuZ2xlIDogMiAqIE1hdGguUEk7XHJcbiAgICAgICAgdmFyIHRvdGFsQW5nbGUgPSBlbmQgLSBiZWdpbjtcclxuICAgICAgICB2YXIgc3RlcCA9IHRvdGFsQW5nbGUgLyB0b3RhbDtcclxuICAgICAgICB2YXIgcG9zaXRpb24gPSBbXTtcclxuICAgICAgICBiZWdpbiArPSBzdGVwIC8gMjtcclxuICAgICAgICBmb3IgKHZhciBpID0gYmVnaW47IGVuZCA+PSBpOyBpICs9IHN0ZXApIHtcclxuICAgICAgICAgICAgcG9zaXRpb24ucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB4OiBjZW50ZXJYICsgTWF0aC5jb3MoaSkgKiByYWlkdXMsXHJcbiAgICAgICAgICAgICAgICB5OiBjZW50ZXJZICsgTWF0aC5zaW4oaSkgKiByYWlkdXNcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwb3NpdGlvblxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHRyZWVQb3N0aW9uKGEsIGIsIGMsIGQsIGUsIGYpIHtcclxuICAgICAgICB2YXIgZyA9IGYgfHwgXCJib3R0b21cIiwgaCA9IFtdO1xyXG4gICAgICAgIGlmIChcImJvdHRvbVwiID09IGcpZm9yICh2YXIgaSA9IGEgLSBjIC8gMiAqIGQgKyBkIC8gMiwgaiA9IDA7IGMgPj0gajsgaisrKWgucHVzaCh7XHJcbiAgICAgICAgICAgIHg6IGkgKyBqICogZCxcclxuICAgICAgICAgICAgeTogYiArIGVcclxuICAgICAgICB9KTsgZWxzZSBpZiAoXCJ0b3BcIiA9PSBnKWZvciAodmFyIGkgPSBhIC0gYyAvIDIgKiBkICsgZCAvIDIsIGogPSAwOyBjID49IGo7IGorKyloLnB1c2goe1xyXG4gICAgICAgICAgICB4OiBpICsgaiAqIGQsXHJcbiAgICAgICAgICAgIHk6IGIgLSBlXHJcbiAgICAgICAgfSk7IGVsc2UgaWYgKFwicmlnaHRcIiA9PSBnKWZvciAodmFyIGkgPSBiIC0gYyAvIDIgKiBkICsgZCAvIDIsIGogPSAwOyBjID49IGo7IGorKyloLnB1c2goe1xyXG4gICAgICAgICAgICB4OiBhICsgZSxcclxuICAgICAgICAgICAgeTogaSArIGogKiBkXHJcbiAgICAgICAgfSk7IGVsc2UgaWYgKFwibGVmdFwiID09IGcpZm9yICh2YXIgaSA9IGIgLSBjIC8gMiAqIGQgKyBkIC8gMiwgaiA9IDA7IGMgPj0gajsgaisrKWgucHVzaCh7eDogYSAtIGUsIHk6IGkgKyBqICogZH0pO1xyXG4gICAgICAgIHJldHVybiBoXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ3JpZFBvc2l0aW9uKGEsIGIsIGMsIGQsIGUsIGYpIHtcclxuICAgICAgICBmb3IgKHZhciBnID0gW10sIGggPSAwOyBjID4gaDsgaCsrKWZvciAodmFyIGkgPSAwOyBkID4gaTsgaSsrKWcucHVzaCh7eDogYSArIGkgKiBlLCB5OiBiICsgaCAqIGZ9KTtcclxuICAgICAgICByZXR1cm4gZ1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFkanVzdFBvc2l0aW9uKHJvb3QsIHJvb3RDaGlsZHMpIHtcclxuICAgICAgICBpZiAocm9vdC5sYXlvdXQpIHtcclxuICAgICAgICAgICAgdmFyIGxheW91dCA9IHJvb3QubGF5b3V0O1xyXG4gICAgICAgICAgICB2YXIgbG9jYXRpb25BcnIgPSBudWxsO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGxheW91dC50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjaXJjbGUnOlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSBsYXlvdXQucmFkaXVzIHx8IE1hdGgubWF4KHJvb3Qud2lkdGgsIHJvb3QuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbkFyciA9IGNpcmNsZVBvc2l0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb290LmN4LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb290LmN5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb290Q2hpbGRzLmxlbmd0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmFkaXVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb290LmxheW91dC5iZWdpbkFuZ2xlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb290LmxheW91dC5lbmRBbmdsZVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd0cmVlJzpcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbkFyciA9IHRyZWVQb3N0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb290LmN4LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb290LmN5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb290Q2hpbGRzLmxlbmd0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0LndpZHRoIHx8IDUwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXQuaGVpZ2h0IHx8IDUwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXQuZGlyZWN0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2dyaWQnOlxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uQXJyID0gZ3JpZFBvc2l0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb290LngsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QueSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0LnJvd3MsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dC5jb2xzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXQuaG9yaXpvbnRhbCB8fCAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXQudmVydGljYWwgfHwgMFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByb290Q2hpbGRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICByb290Q2hpbGRzW2ldLnNldENlbnRlckxvY2F0aW9uKGxvY2F0aW9uQXJyW2ldLngsIGxvY2F0aW9uQXJyW2ldLnkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFJvb3RDaGlsZHMoYWxsQ2hpbGRzLCByb290Tm9kZSkge1xyXG4gICAgICAgIHZhciByb290Q2hpbGRzO1xyXG4gICAgICAgIGlmIChyb290Tm9kZS5vdXRMaW5rcyBpbnN0YW5jZW9mIEFycmF5ICYmIHJvb3ROb2RlLm91dExpbmtzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgcm9vdENoaWxkcyA9IHJvb3ROb2RlLm91dExpbmtzLm1hcChmdW5jdGlvbiAobGluaykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpbmsubm9kZVo7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcm9vdENoaWxkcyB8fCBbXTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBsYXlvdXROb2RlKHNjZW5lLCByb290LCByZWN1cnNpb24pIHtcclxuICAgICAgICB2YXIgcm9vdENoaWxkcyA9IGdldFJvb3RDaGlsZHMoc2NlbmUuY2hpbGRzLCByb290KTtcclxuICAgICAgICBpZiAoMCAhPSByb290Q2hpbGRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBhZGp1c3RQb3NpdGlvbihyb290LCByb290Q2hpbGRzKTtcclxuICAgICAgICAgICAgaWYgKDEgPT0gcmVjdXJzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IHJvb3RDaGlsZHMubGVuZ3RoOyBlKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXROb2RlKHNjZW5lLCByb290Q2hpbGRzW2VdLCByZWN1cnNpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNwcmluZ0xheW91dChyb290LCBzY2VuZSkge1xyXG4gICAgICAgIHZhciBrZXlBID0gMC4wMTsvL+enu+WKqOW5heW6plxyXG4gICAgICAgIHZhciBrZXlCID0gMC45NTtcclxuICAgICAgICB2YXIgdGVtcCA9IC01O1xyXG4gICAgICAgIHZhciBzdGVwWCA9IDA7XHJcbiAgICAgICAgdmFyIHN0ZXBZID0gMDtcclxuICAgICAgICB2YXIgdGltZXMgPSAwO1xyXG4gICAgICAgIHZhciBub2RlcyA9IHNjZW5lLmdldEVsZW1lbnRzQnlDbGFzcyhqdG9wby5Ob2RlKTtcclxuICAgICAgICBhbm5pbWF0ZSgpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBjaGFuZ2Uocm9vdCwgbm9kZSkge1xyXG4gICAgICAgICAgICB2YXIgZGlzWCA9IHJvb3QueCAtIG5vZGUueDtcclxuICAgICAgICAgICAgdmFyIGRpc1kgPSByb290LnkgLSBub2RlLnk7XHJcbiAgICAgICAgICAgIHN0ZXBYICs9IGRpc1ggKiBrZXlBO1xyXG4gICAgICAgICAgICBzdGVwWSArPSBkaXNZICoga2V5QTtcclxuICAgICAgICAgICAgc3RlcFggKj0ga2V5QjtcclxuICAgICAgICAgICAgc3RlcFkgKj0ga2V5QjtcclxuICAgICAgICAgICAgc3RlcFkgKz0gdGVtcDtcclxuICAgICAgICAgICAgbm9kZS54ICs9IHN0ZXBYO1xyXG4gICAgICAgICAgICBub2RlLnkgKz0gc3RlcFk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBhbm5pbWF0ZSgpIHtcclxuICAgICAgICAgICAgKyt0aW1lcztcclxuICAgICAgICAgICAgaWYgKHRpbWVzIDwgMTUwKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVzW2ldICE9IHJvb3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlKHJvb3QsIG5vZGVzW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGFubmltYXRlLCAxZTMgLyAyNClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRUcmVlRGVlcChjaGlsZHMsIHJvb3QpIHtcclxuICAgICAgICBmdW5jdGlvbiByZURlZXAoY2hpbGRzLCByb290LCBkZWVwKSB7XHJcbiAgICAgICAgICAgIHZhciByb290Q2hpbGRzID0gZ2V0Um9vdENoaWxkcyhjaGlsZHMsIHJvb3QpO1xyXG4gICAgICAgICAgICBpZiAoZGVlcCA+IGQpIHtcclxuICAgICAgICAgICAgICAgIGQgPSBkZWVwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAodmFyIGcgPSAwOyBnIDwgcm9vdENoaWxkcy5sZW5ndGg7IGcrKykge1xyXG4gICAgICAgICAgICAgICAgcmVEZWVwKGNoaWxkcywgcm9vdENoaWxkc1tnXSwgZGVlcCArIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZCA9IDA7XHJcbiAgICAgICAgcmVEZWVwKGNoaWxkcywgcm9vdCwgMCk7XHJcbiAgICAgICAgcmV0dXJuIGQ7XHJcbiAgICB9XHJcbn1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9qdG9wby90b29scy9sYXlvdXQuanNcbi8vIG1vZHVsZSBpZCA9IDI1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==');
},function(module,exports){eval('module.exports = function (JTopo) {\r\n    window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame || function (fn) {\r\n            return setTimeout(fn, 1e3 / 24);\r\n        };\r\n    Array.prototype.del = function (item) {\r\n        if ("number" != typeof item) {\r\n            var index = this.indexOf(item);\r\n            if (index > -1) {\r\n                this.splice(index, 1);\r\n            }\r\n            return this\r\n        } else {\r\n            if (item > -1) {\r\n                this.splice(item, 1);\r\n            }\r\n            return this;\r\n        }\r\n    };\r\n    var canvas = document.createElement("canvas"), graphics = canvas.getContext("2d"), alarmImageCache = {};\r\n    JTopo.util = {\r\n        rotatePoint: rotatePoint,\r\n        rotatePoints: rotatePoints,\r\n        getDistance: getDistance,\r\n        getEventPosition: getEventPosition,\r\n        MessageBus: MessageBus,\r\n        isFirefox: navigator.userAgent.indexOf("Firefox") > 0,\r\n        isIE: !(!window.attachEvent || -1 !== navigator.userAgent.indexOf("Opera")),\r\n        isChrome: null != navigator.userAgent.toLowerCase().match(/chrome/),\r\n        clone: clone,\r\n        isPointInRect: isPointInRect,\r\n        isPointInLine: isPointInLine,\r\n        removeFromArray: removeFromArray,\r\n        cloneEvent: cloneEvent,\r\n        randomColor: randomColor,\r\n        loadStageFromJson: loadStageFromJson,\r\n        getElementsBound: getElementsBound,\r\n        genImageAlarm: genImageAlarm,\r\n        getOffsetPosition: getOffsetPosition,\r\n        inherits:inherits\r\n    };\r\n\r\n\r\n    function MessageBus(a) {\r\n        this.name = a;\r\n        this.messageMap = {};\r\n        this.messageCount = 0;\r\n    }\r\n\r\n    MessageBus.prototype.subscribe = function (evenName, fn) {\r\n        var d = this.messageMap[evenName];\r\n        if (null == d) {\r\n            this.messageMap[evenName] = [];\r\n        }\r\n        this.messageMap[evenName].push(fn);\r\n        this.messageCount++;\r\n    };\r\n    MessageBus.prototype.unsubscribe = function (evenName, fn) {\r\n        var event = this.messageMap[evenName];\r\n        if (null != event) {\r\n            if (fn && \'function\' == typeof fn) {\r\n                var index = event.indexOf(fn);\r\n                if (index > -1) {\r\n                    event.splice(index, 1);\r\n                }\r\n            } else {\r\n                this.messageMap[evenName] = null;\r\n                delete this.messageMap[evenName];\r\n                this.messageCount--;\r\n            }\r\n        }\r\n    };\r\n    MessageBus.prototype.publish = function (evenName, e, boolean) {\r\n        var eventMap = this.messageMap[evenName];\r\n        if (null != eventMap) {\r\n            eventMap.forEach(function (fn) {\r\n                if (boolean) {\r\n                    setTimeout(function () {\r\n                        fn(e);\r\n                    });\r\n                } else {\r\n                    if (e.target && e.target.qtopo) {\r\n                        fn(e, e.target.qtopo);\r\n                    } else {\r\n                        fn(e);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n    function getDistance(pointA, pointB, c, d) {\r\n        var width, height;\r\n        if (null == c && null == d) {\r\n            if (pointA && pointB) {\r\n                width = pointB.x - pointA.x;\r\n                height = pointB.y - pointA.y;\r\n            }\r\n        } else {\r\n            width = c - pointA;\r\n            height = d - pointB;\r\n        }\r\n        return Math.sqrt(width * width + height * height);\r\n    }\r\n\r\n    function getElementsBound(elements) {\r\n        var b = {\r\n            left: Number.MAX_VALUE,\r\n            right: Number.MIN_VALUE,\r\n            top: Number.MAX_VALUE,\r\n            bottom: Number.MIN_VALUE\r\n        };\r\n        elements.forEach(function (element) {\r\n            if (!(element instanceof JTopo.Link)) {\r\n                if (b.left > element.x) {\r\n                    b.left = element.x;\r\n                    b.leftNode = element;\r\n                }\r\n                if (b.right < element.x + element.width) {\r\n                    b.right = element.x + element.width;\r\n                    b.rightNode = element;\r\n                }\r\n                if (b.top > element.y) {\r\n                    b.top = element.y;\r\n                    b.topNode = element;\r\n                }\r\n                if (b.bottom < element.y + element.height) {\r\n                    b.bottom = element.y + element.height;\r\n                    b.bottomNode = element;\r\n                }\r\n            }\r\n        });\r\n        b.width = b.right - b.left;\r\n        b.height = b.bottom - b.top;\r\n        return b;\r\n    }\r\n\r\n    function getEventPosition(event) {\r\n        event = cloneEvent(event);\r\n        if (!event.pageX) {\r\n            event.pageX = event.clientX + document.body.scrollLeft - document.body.clientLeft;\r\n            event.pageY = event.clientY + document.body.scrollTop - document.body.clientTop;\r\n        }\r\n        return event;\r\n    }\r\n\r\n    function rotatePoint(aX, aY, bX, bY, c) {\r\n        var width = bX - aX;\r\n        var height = bY - aY;\r\n        var ditance = Math.sqrt(width * width + height * height);\r\n        var i = Math.atan2(height, width) + c;\r\n        return {\r\n            x: aX + Math.cos(i) * ditance,\r\n            y: aY + Math.sin(i) * ditance\r\n        }\r\n    }\r\n\r\n    function rotatePoints(root, childs, beginAngle) {\r\n        for (var d = [], e = 0; e < childs.length; e++) {\r\n            d.push(rotatePoint(root.x, root.y, childs[e].x, childs[e].y, beginAngle));\r\n        }\r\n        return d\r\n    }\r\n\r\n    function cloneEvent(a) {\r\n        var b = {};\r\n        for (var c in a) {\r\n            if ("returnValue" != c && "keyLocation" != c) {\r\n                b[c] = a[c];\r\n            }\r\n        }\r\n        return b\r\n    }\r\n\r\n    function clone(object) {\r\n        var b = {};\r\n        for (var c in object) {\r\n            b[c] = object[c];\r\n        }\r\n        return b\r\n    }\r\n\r\n    function isPointInRect(rect, points) {\r\n        var X = points.x;\r\n        var Y = points.y;\r\n        var W = points.width;\r\n        var H = points.height;\r\n        return rect.x > X && rect.x < X + W && rect.y > Y && rect.y < Y + H;\r\n    }\r\n\r\n    function isPointInLine(points, start, end) {\r\n        var line = JTopo.util.getDistance(start, end);\r\n        var toStart = JTopo.util.getDistance(start, points);\r\n        var toEnd = JTopo.util.getDistance(end, points);\r\n        return Math.abs(toStart + toEnd - line) <= 0.5;\r\n    }\r\n\r\n    function removeFromArray(arr, item) {\r\n        var index=arr.indexOf(item);\r\n        if(index>-1){\r\n            arr.splice(index,1);\r\n        }\r\n        return arr\r\n    }\r\n\r\n    function randomColor() {\r\n        return Math.floor(255 * Math.random()) + "," + Math.floor(255 * Math.random()) + "," + Math.floor(255 * Math.random())\r\n    }\r\n\r\n\r\n    function loadStageFromJson(json, canvas) {\r\n        var obj = eval(json), stage = new JTopo.Stage(canvas);\r\n        for (var k in stageObj)if ("scenes" != k)stage[k] = obj[k]; else for (var scenes = obj.scenes, i = 0; i < scenes.length; i++) {\r\n            var sceneObj = scenes[i], scene = new JTopo.Scene(stage);\r\n            for (var p in sceneObj)if ("elements" != p)scene[p] = sceneObj[p]; else for (var nodeMap = {}, elements = sceneObj.elements, m = 0; m < elements.length; m++) {\r\n                var elementObj = elements[m], type = elementObj.elementType, element;\r\n                "Node" == type && (element = new JTopo.Node);\r\n                for (var mk in elementObj)element[mk] = elementObj[mk];\r\n                nodeMap[element.text] = element, scene.add(element)\r\n            }\r\n        }\r\n        return console.log(stage), stage\r\n    }\r\n\r\n    function changeColor(ctx, image, color) {\r\n        var colorArr = color.split(",");\r\n        var R = parseInt(colorArr[0]);\r\n        var G = parseInt(colorArr[1]);\r\n        var B = parseInt(colorArr[2]);\r\n        var imageWidth = canvas.width = image.width;\r\n        var imageHeight = canvas.height = image.height;\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n        ctx.drawImage(image, 0, 0);\r\n        var ImageData = ctx.getImageData(0, 0, image.width, image.height);\r\n        var data = ImageData.data;\r\n        for (var i = 0; imageWidth > i; i++) {\r\n            for (var j = 0; imageHeight > j; j++) {\r\n                var n = 4 * (i + j * imageWidth);\r\n                if (0 != data[n + 3]) {\r\n                    if (null != R) {\r\n                        data[n + 0] += R;\r\n                    }\r\n                    if (null != G) {\r\n                        data[n + 1] += G;\r\n                    }\r\n                    if (null != B) {\r\n                        data[n + 2] += B;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        ctx.putImageData(ImageData, 0, 0, 0, 0, image.width, image.height);\r\n        return canvas.toDataURL();\r\n    }\r\n\r\n    function genImageAlarm(image, color) {\r\n        var src = image.src + color;\r\n        if (alarmImageCache[src])return alarmImageCache[src];\r\n        var newImage = new Image;\r\n        newImage.src = changeColor(graphics, image, color);\r\n        alarmImageCache[src] = newImage;\r\n        return newImage;\r\n    }\r\n\r\n    function getOffsetPosition(canvas) {\r\n        if (!canvas) {\r\n            return {left: 0, top: 0};\r\n        }\r\n        var b = 0, c = 0;\r\n        if ("getBoundingClientRect" in document.documentElement) {\r\n            var d = canvas.getBoundingClientRect();\r\n            var e = canvas.ownerDocument;\r\n            var f = e.body;\r\n            var g = e.documentElement;\r\n            var h = g.clientTop || f.clientTop || 0;\r\n            var i = g.clientLeft || f.clientLeft || 0;\r\n            b = d.top + (self.pageYOffset || g && g.scrollTop || f.scrollTop) - h;\r\n            c = d.left + (self.pageXOffset || g && g.scrollLeft || f.scrollLeft) - i;\r\n\r\n        } else {\r\n            do {\r\n                b += canvas.offsetTop || 0;\r\n                c += canvas.offsetLeft || 0;\r\n                canvas = canvas.offsetParent;\r\n            } while (canvas);\r\n        }\r\n        return {left: c, top: b}\r\n    }\r\n    function inherits(childClazz, FatherClazz) {\r\n        var clazzPrototype = childClazz.prototype;\r\n\r\n        function F() {\r\n        }\r\n\r\n        F.prototype = FatherClazz.prototype;\r\n        childClazz.prototype = new F();\r\n\r\n        for (var prop in clazzPrototype) {\r\n            childClazz.prototype[prop] = clazzPrototype[prop];\r\n        }\r\n        childClazz.constructor = childClazz;\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vdG9vbHMvdXRpbC5qcz82MjFmIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLCtCQUErQixtQkFBbUI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQSxtRUFBbUUsMENBQTBDLG1CQUFtQjtBQUNoSTtBQUNBLDhFQUE4RSwyQkFBMkIsc0NBQXNDLHFCQUFxQjtBQUNwSztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsZ0JBQWdCO0FBQ3ZDLDJCQUEyQixpQkFBaUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMjYuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChKVG9wbykge1xyXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHdpbmRvdy5tc1JlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cub1JlcXVlc3RBbmltYXRpb25GcmFtZSB8fCBmdW5jdGlvbiAoZm4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZm4sIDFlMyAvIDI0KTtcclxuICAgICAgICB9O1xyXG4gICAgQXJyYXkucHJvdG90eXBlLmRlbCA9IGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgaWYgKFwibnVtYmVyXCIgIT0gdHlwZW9mIGl0ZW0pIHtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5pbmRleE9mKGl0ZW0pO1xyXG4gICAgICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGl0ZW0gPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zcGxpY2UoaXRlbSwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLCBncmFwaGljcyA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIiksIGFsYXJtSW1hZ2VDYWNoZSA9IHt9O1xyXG4gICAgSlRvcG8udXRpbCA9IHtcclxuICAgICAgICByb3RhdGVQb2ludDogcm90YXRlUG9pbnQsXHJcbiAgICAgICAgcm90YXRlUG9pbnRzOiByb3RhdGVQb2ludHMsXHJcbiAgICAgICAgZ2V0RGlzdGFuY2U6IGdldERpc3RhbmNlLFxyXG4gICAgICAgIGdldEV2ZW50UG9zaXRpb246IGdldEV2ZW50UG9zaXRpb24sXHJcbiAgICAgICAgTWVzc2FnZUJ1czogTWVzc2FnZUJ1cyxcclxuICAgICAgICBpc0ZpcmVmb3g6IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIkZpcmVmb3hcIikgPiAwLFxyXG4gICAgICAgIGlzSUU6ICEoIXdpbmRvdy5hdHRhY2hFdmVudCB8fCAtMSAhPT0gbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKFwiT3BlcmFcIikpLFxyXG4gICAgICAgIGlzQ2hyb21lOiBudWxsICE9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKS5tYXRjaCgvY2hyb21lLyksXHJcbiAgICAgICAgY2xvbmU6IGNsb25lLFxyXG4gICAgICAgIGlzUG9pbnRJblJlY3Q6IGlzUG9pbnRJblJlY3QsXHJcbiAgICAgICAgaXNQb2ludEluTGluZTogaXNQb2ludEluTGluZSxcclxuICAgICAgICByZW1vdmVGcm9tQXJyYXk6IHJlbW92ZUZyb21BcnJheSxcclxuICAgICAgICBjbG9uZUV2ZW50OiBjbG9uZUV2ZW50LFxyXG4gICAgICAgIHJhbmRvbUNvbG9yOiByYW5kb21Db2xvcixcclxuICAgICAgICBsb2FkU3RhZ2VGcm9tSnNvbjogbG9hZFN0YWdlRnJvbUpzb24sXHJcbiAgICAgICAgZ2V0RWxlbWVudHNCb3VuZDogZ2V0RWxlbWVudHNCb3VuZCxcclxuICAgICAgICBnZW5JbWFnZUFsYXJtOiBnZW5JbWFnZUFsYXJtLFxyXG4gICAgICAgIGdldE9mZnNldFBvc2l0aW9uOiBnZXRPZmZzZXRQb3NpdGlvbixcclxuICAgICAgICBpbmhlcml0czppbmhlcml0c1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgZnVuY3Rpb24gTWVzc2FnZUJ1cyhhKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gYTtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VNYXAgPSB7fTtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VDb3VudCA9IDA7XHJcbiAgICB9XHJcblxyXG4gICAgTWVzc2FnZUJ1cy5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKGV2ZW5OYW1lLCBmbikge1xyXG4gICAgICAgIHZhciBkID0gdGhpcy5tZXNzYWdlTWFwW2V2ZW5OYW1lXTtcclxuICAgICAgICBpZiAobnVsbCA9PSBkKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZU1hcFtldmVuTmFtZV0gPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlTWFwW2V2ZW5OYW1lXS5wdXNoKGZuKTtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VDb3VudCsrO1xyXG4gICAgfTtcclxuICAgIE1lc3NhZ2VCdXMucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKGV2ZW5OYW1lLCBmbikge1xyXG4gICAgICAgIHZhciBldmVudCA9IHRoaXMubWVzc2FnZU1hcFtldmVuTmFtZV07XHJcbiAgICAgICAgaWYgKG51bGwgIT0gZXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKGZuICYmICdmdW5jdGlvbicgPT0gdHlwZW9mIGZuKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBldmVudC5pbmRleE9mKGZuKTtcclxuICAgICAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZU1hcFtldmVuTmFtZV0gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMubWVzc2FnZU1hcFtldmVuTmFtZV07XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VDb3VudC0tO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE1lc3NhZ2VCdXMucHJvdG90eXBlLnB1Ymxpc2ggPSBmdW5jdGlvbiAoZXZlbk5hbWUsIGUsIGJvb2xlYW4pIHtcclxuICAgICAgICB2YXIgZXZlbnRNYXAgPSB0aGlzLm1lc3NhZ2VNYXBbZXZlbk5hbWVdO1xyXG4gICAgICAgIGlmIChudWxsICE9IGV2ZW50TWFwKSB7XHJcbiAgICAgICAgICAgIGV2ZW50TWFwLmZvckVhY2goZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYm9vbGVhbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbihlKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0ICYmIGUudGFyZ2V0LnF0b3BvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZuKGUsIGUudGFyZ2V0LnF0b3BvKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbihlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBmdW5jdGlvbiBnZXREaXN0YW5jZShwb2ludEEsIHBvaW50QiwgYywgZCkge1xyXG4gICAgICAgIHZhciB3aWR0aCwgaGVpZ2h0O1xyXG4gICAgICAgIGlmIChudWxsID09IGMgJiYgbnVsbCA9PSBkKSB7XHJcbiAgICAgICAgICAgIGlmIChwb2ludEEgJiYgcG9pbnRCKSB7XHJcbiAgICAgICAgICAgICAgICB3aWR0aCA9IHBvaW50Qi54IC0gcG9pbnRBLng7XHJcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBwb2ludEIueSAtIHBvaW50QS55O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgd2lkdGggPSBjIC0gcG9pbnRBO1xyXG4gICAgICAgICAgICBoZWlnaHQgPSBkIC0gcG9pbnRCO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KHdpZHRoICogd2lkdGggKyBoZWlnaHQgKiBoZWlnaHQpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldEVsZW1lbnRzQm91bmQoZWxlbWVudHMpIHtcclxuICAgICAgICB2YXIgYiA9IHtcclxuICAgICAgICAgICAgbGVmdDogTnVtYmVyLk1BWF9WQUxVRSxcclxuICAgICAgICAgICAgcmlnaHQ6IE51bWJlci5NSU5fVkFMVUUsXHJcbiAgICAgICAgICAgIHRvcDogTnVtYmVyLk1BWF9WQUxVRSxcclxuICAgICAgICAgICAgYm90dG9tOiBOdW1iZXIuTUlOX1ZBTFVFXHJcbiAgICAgICAgfTtcclxuICAgICAgICBlbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGlmICghKGVsZW1lbnQgaW5zdGFuY2VvZiBKVG9wby5MaW5rKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGIubGVmdCA+IGVsZW1lbnQueCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGIubGVmdCA9IGVsZW1lbnQueDtcclxuICAgICAgICAgICAgICAgICAgICBiLmxlZnROb2RlID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChiLnJpZ2h0IDwgZWxlbWVudC54ICsgZWxlbWVudC53aWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGIucmlnaHQgPSBlbGVtZW50LnggKyBlbGVtZW50LndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIGIucmlnaHROb2RlID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChiLnRvcCA+IGVsZW1lbnQueSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGIudG9wID0gZWxlbWVudC55O1xyXG4gICAgICAgICAgICAgICAgICAgIGIudG9wTm9kZSA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoYi5ib3R0b20gPCBlbGVtZW50LnkgKyBlbGVtZW50LmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGIuYm90dG9tID0gZWxlbWVudC55ICsgZWxlbWVudC5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYi5ib3R0b21Ob2RlID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGIud2lkdGggPSBiLnJpZ2h0IC0gYi5sZWZ0O1xyXG4gICAgICAgIGIuaGVpZ2h0ID0gYi5ib3R0b20gLSBiLnRvcDtcclxuICAgICAgICByZXR1cm4gYjtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRFdmVudFBvc2l0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQgPSBjbG9uZUV2ZW50KGV2ZW50KTtcclxuICAgICAgICBpZiAoIWV2ZW50LnBhZ2VYKSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnBhZ2VYID0gZXZlbnQuY2xpZW50WCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdCAtIGRvY3VtZW50LmJvZHkuY2xpZW50TGVmdDtcclxuICAgICAgICAgICAgZXZlbnQucGFnZVkgPSBldmVudC5jbGllbnRZICsgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgLSBkb2N1bWVudC5ib2R5LmNsaWVudFRvcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGV2ZW50O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJvdGF0ZVBvaW50KGFYLCBhWSwgYlgsIGJZLCBjKSB7XHJcbiAgICAgICAgdmFyIHdpZHRoID0gYlggLSBhWDtcclxuICAgICAgICB2YXIgaGVpZ2h0ID0gYlkgLSBhWTtcclxuICAgICAgICB2YXIgZGl0YW5jZSA9IE1hdGguc3FydCh3aWR0aCAqIHdpZHRoICsgaGVpZ2h0ICogaGVpZ2h0KTtcclxuICAgICAgICB2YXIgaSA9IE1hdGguYXRhbjIoaGVpZ2h0LCB3aWR0aCkgKyBjO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHg6IGFYICsgTWF0aC5jb3MoaSkgKiBkaXRhbmNlLFxyXG4gICAgICAgICAgICB5OiBhWSArIE1hdGguc2luKGkpICogZGl0YW5jZVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByb3RhdGVQb2ludHMocm9vdCwgY2hpbGRzLCBiZWdpbkFuZ2xlKSB7XHJcbiAgICAgICAgZm9yICh2YXIgZCA9IFtdLCBlID0gMDsgZSA8IGNoaWxkcy5sZW5ndGg7IGUrKykge1xyXG4gICAgICAgICAgICBkLnB1c2gocm90YXRlUG9pbnQocm9vdC54LCByb290LnksIGNoaWxkc1tlXS54LCBjaGlsZHNbZV0ueSwgYmVnaW5BbmdsZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNsb25lRXZlbnQoYSkge1xyXG4gICAgICAgIHZhciBiID0ge307XHJcbiAgICAgICAgZm9yICh2YXIgYyBpbiBhKSB7XHJcbiAgICAgICAgICAgIGlmIChcInJldHVyblZhbHVlXCIgIT0gYyAmJiBcImtleUxvY2F0aW9uXCIgIT0gYykge1xyXG4gICAgICAgICAgICAgICAgYltjXSA9IGFbY107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGJcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjbG9uZShvYmplY3QpIHtcclxuICAgICAgICB2YXIgYiA9IHt9O1xyXG4gICAgICAgIGZvciAodmFyIGMgaW4gb2JqZWN0KSB7XHJcbiAgICAgICAgICAgIGJbY10gPSBvYmplY3RbY107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBiXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaXNQb2ludEluUmVjdChyZWN0LCBwb2ludHMpIHtcclxuICAgICAgICB2YXIgWCA9IHBvaW50cy54O1xyXG4gICAgICAgIHZhciBZID0gcG9pbnRzLnk7XHJcbiAgICAgICAgdmFyIFcgPSBwb2ludHMud2lkdGg7XHJcbiAgICAgICAgdmFyIEggPSBwb2ludHMuaGVpZ2h0O1xyXG4gICAgICAgIHJldHVybiByZWN0LnggPiBYICYmIHJlY3QueCA8IFggKyBXICYmIHJlY3QueSA+IFkgJiYgcmVjdC55IDwgWSArIEg7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaXNQb2ludEluTGluZShwb2ludHMsIHN0YXJ0LCBlbmQpIHtcclxuICAgICAgICB2YXIgbGluZSA9IEpUb3BvLnV0aWwuZ2V0RGlzdGFuY2Uoc3RhcnQsIGVuZCk7XHJcbiAgICAgICAgdmFyIHRvU3RhcnQgPSBKVG9wby51dGlsLmdldERpc3RhbmNlKHN0YXJ0LCBwb2ludHMpO1xyXG4gICAgICAgIHZhciB0b0VuZCA9IEpUb3BvLnV0aWwuZ2V0RGlzdGFuY2UoZW5kLCBwb2ludHMpO1xyXG4gICAgICAgIHJldHVybiBNYXRoLmFicyh0b1N0YXJ0ICsgdG9FbmQgLSBsaW5lKSA8PSAwLjU7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVtb3ZlRnJvbUFycmF5KGFyciwgaXRlbSkge1xyXG4gICAgICAgIHZhciBpbmRleD1hcnIuaW5kZXhPZihpdGVtKTtcclxuICAgICAgICBpZihpbmRleD4tMSl7XHJcbiAgICAgICAgICAgIGFyci5zcGxpY2UoaW5kZXgsMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhcnJcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByYW5kb21Db2xvcigpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcigyNTUgKiBNYXRoLnJhbmRvbSgpKSArIFwiLFwiICsgTWF0aC5mbG9vcigyNTUgKiBNYXRoLnJhbmRvbSgpKSArIFwiLFwiICsgTWF0aC5mbG9vcigyNTUgKiBNYXRoLnJhbmRvbSgpKVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBmdW5jdGlvbiBsb2FkU3RhZ2VGcm9tSnNvbihqc29uLCBjYW52YXMpIHtcclxuICAgICAgICB2YXIgb2JqID0gZXZhbChqc29uKSwgc3RhZ2UgPSBuZXcgSlRvcG8uU3RhZ2UoY2FudmFzKTtcclxuICAgICAgICBmb3IgKHZhciBrIGluIHN0YWdlT2JqKWlmIChcInNjZW5lc1wiICE9IGspc3RhZ2Vba10gPSBvYmpba107IGVsc2UgZm9yICh2YXIgc2NlbmVzID0gb2JqLnNjZW5lcywgaSA9IDA7IGkgPCBzY2VuZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHNjZW5lT2JqID0gc2NlbmVzW2ldLCBzY2VuZSA9IG5ldyBKVG9wby5TY2VuZShzdGFnZSk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gc2NlbmVPYmopaWYgKFwiZWxlbWVudHNcIiAhPSBwKXNjZW5lW3BdID0gc2NlbmVPYmpbcF07IGVsc2UgZm9yICh2YXIgbm9kZU1hcCA9IHt9LCBlbGVtZW50cyA9IHNjZW5lT2JqLmVsZW1lbnRzLCBtID0gMDsgbSA8IGVsZW1lbnRzLmxlbmd0aDsgbSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudE9iaiA9IGVsZW1lbnRzW21dLCB0eXBlID0gZWxlbWVudE9iai5lbGVtZW50VHlwZSwgZWxlbWVudDtcclxuICAgICAgICAgICAgICAgIFwiTm9kZVwiID09IHR5cGUgJiYgKGVsZW1lbnQgPSBuZXcgSlRvcG8uTm9kZSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBtayBpbiBlbGVtZW50T2JqKWVsZW1lbnRbbWtdID0gZWxlbWVudE9ialtta107XHJcbiAgICAgICAgICAgICAgICBub2RlTWFwW2VsZW1lbnQudGV4dF0gPSBlbGVtZW50LCBzY2VuZS5hZGQoZWxlbWVudClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY29uc29sZS5sb2coc3RhZ2UpLCBzdGFnZVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNoYW5nZUNvbG9yKGN0eCwgaW1hZ2UsIGNvbG9yKSB7XHJcbiAgICAgICAgdmFyIGNvbG9yQXJyID0gY29sb3Iuc3BsaXQoXCIsXCIpO1xyXG4gICAgICAgIHZhciBSID0gcGFyc2VJbnQoY29sb3JBcnJbMF0pO1xyXG4gICAgICAgIHZhciBHID0gcGFyc2VJbnQoY29sb3JBcnJbMV0pO1xyXG4gICAgICAgIHZhciBCID0gcGFyc2VJbnQoY29sb3JBcnJbMl0pO1xyXG4gICAgICAgIHZhciBpbWFnZVdpZHRoID0gY2FudmFzLndpZHRoID0gaW1hZ2Uud2lkdGg7XHJcbiAgICAgICAgdmFyIGltYWdlSGVpZ2h0ID0gY2FudmFzLmhlaWdodCA9IGltYWdlLmhlaWdodDtcclxuICAgICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgY3R4LmRyYXdJbWFnZShpbWFnZSwgMCwgMCk7XHJcbiAgICAgICAgdmFyIEltYWdlRGF0YSA9IGN0eC5nZXRJbWFnZURhdGEoMCwgMCwgaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCk7XHJcbiAgICAgICAgdmFyIGRhdGEgPSBJbWFnZURhdGEuZGF0YTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaW1hZ2VXaWR0aCA+IGk7IGkrKykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaW1hZ2VIZWlnaHQgPiBqOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gNCAqIChpICsgaiAqIGltYWdlV2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKDAgIT0gZGF0YVtuICsgM10pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBSKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbbiArIDBdICs9IFI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9IEcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtuICsgMV0gKz0gRztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gQikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhW24gKyAyXSArPSBCO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjdHgucHV0SW1hZ2VEYXRhKEltYWdlRGF0YSwgMCwgMCwgMCwgMCwgaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCk7XHJcbiAgICAgICAgcmV0dXJuIGNhbnZhcy50b0RhdGFVUkwoKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZW5JbWFnZUFsYXJtKGltYWdlLCBjb2xvcikge1xyXG4gICAgICAgIHZhciBzcmMgPSBpbWFnZS5zcmMgKyBjb2xvcjtcclxuICAgICAgICBpZiAoYWxhcm1JbWFnZUNhY2hlW3NyY10pcmV0dXJuIGFsYXJtSW1hZ2VDYWNoZVtzcmNdO1xyXG4gICAgICAgIHZhciBuZXdJbWFnZSA9IG5ldyBJbWFnZTtcclxuICAgICAgICBuZXdJbWFnZS5zcmMgPSBjaGFuZ2VDb2xvcihncmFwaGljcywgaW1hZ2UsIGNvbG9yKTtcclxuICAgICAgICBhbGFybUltYWdlQ2FjaGVbc3JjXSA9IG5ld0ltYWdlO1xyXG4gICAgICAgIHJldHVybiBuZXdJbWFnZTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRPZmZzZXRQb3NpdGlvbihjYW52YXMpIHtcclxuICAgICAgICBpZiAoIWNhbnZhcykge1xyXG4gICAgICAgICAgICByZXR1cm4ge2xlZnQ6IDAsIHRvcDogMH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBiID0gMCwgYyA9IDA7XHJcbiAgICAgICAgaWYgKFwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0XCIgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICB2YXIgZSA9IGNhbnZhcy5vd25lckRvY3VtZW50O1xyXG4gICAgICAgICAgICB2YXIgZiA9IGUuYm9keTtcclxuICAgICAgICAgICAgdmFyIGcgPSBlLmRvY3VtZW50RWxlbWVudDtcclxuICAgICAgICAgICAgdmFyIGggPSBnLmNsaWVudFRvcCB8fCBmLmNsaWVudFRvcCB8fCAwO1xyXG4gICAgICAgICAgICB2YXIgaSA9IGcuY2xpZW50TGVmdCB8fCBmLmNsaWVudExlZnQgfHwgMDtcclxuICAgICAgICAgICAgYiA9IGQudG9wICsgKHNlbGYucGFnZVlPZmZzZXQgfHwgZyAmJiBnLnNjcm9sbFRvcCB8fCBmLnNjcm9sbFRvcCkgLSBoO1xyXG4gICAgICAgICAgICBjID0gZC5sZWZ0ICsgKHNlbGYucGFnZVhPZmZzZXQgfHwgZyAmJiBnLnNjcm9sbExlZnQgfHwgZi5zY3JvbGxMZWZ0KSAtIGk7XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGRvIHtcclxuICAgICAgICAgICAgICAgIGIgKz0gY2FudmFzLm9mZnNldFRvcCB8fCAwO1xyXG4gICAgICAgICAgICAgICAgYyArPSBjYW52YXMub2Zmc2V0TGVmdCB8fCAwO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzID0gY2FudmFzLm9mZnNldFBhcmVudDtcclxuICAgICAgICAgICAgfSB3aGlsZSAoY2FudmFzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtsZWZ0OiBjLCB0b3A6IGJ9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBpbmhlcml0cyhjaGlsZENsYXp6LCBGYXRoZXJDbGF6eikge1xyXG4gICAgICAgIHZhciBjbGF6elByb3RvdHlwZSA9IGNoaWxkQ2xhenoucHJvdG90eXBlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBGKCkge1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgRi5wcm90b3R5cGUgPSBGYXRoZXJDbGF6ei5wcm90b3R5cGU7XHJcbiAgICAgICAgY2hpbGRDbGF6ei5wcm90b3R5cGUgPSBuZXcgRigpO1xyXG5cclxuICAgICAgICBmb3IgKHZhciBwcm9wIGluIGNsYXp6UHJvdG90eXBlKSB7XHJcbiAgICAgICAgICAgIGNoaWxkQ2xhenoucHJvdG90eXBlW3Byb3BdID0gY2xhenpQcm90b3R5cGVbcHJvcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNoaWxkQ2xhenouY29uc3RydWN0b3IgPSBjaGlsZENsYXp6O1xyXG4gICAgfVxyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL3Rvb2xzL3V0aWwuanNcbi8vIG1vZHVsZSBpZCA9IDI2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports,__webpack_require__){eval("var JTopo=__webpack_require__(13);\r\nJTopo.Element=__webpack_require__(4);\r\n//-------工具\r\n__webpack_require__(24);\r\n__webpack_require__(26)(JTopo);\r\n__webpack_require__(25)(JTopo);\r\n__webpack_require__(23)(JTopo);\r\n//-------场景\r\n__webpack_require__(22)(JTopo);\r\n//-------画布\r\n__webpack_require__(21)(JTopo);\r\n__webpack_require__(20)(JTopo);\r\n//-------基础元素\r\n__webpack_require__(5)(JTopo);\r\n__webpack_require__(7)(JTopo);\r\n__webpack_require__(6)(JTopo);\r\n//-------节点\r\n__webpack_require__(17)(JTopo);\r\n__webpack_require__(18)(JTopo);\r\n__webpack_require__(16)(JTopo);\r\n__webpack_require__(15)(JTopo);\r\n__webpack_require__(14)(JTopo);\r\n__webpack_require__(19)(JTopo);\r\n//-------链接\r\n__webpack_require__(12)(JTopo);\r\n__webpack_require__(10)(JTopo);\r\n__webpack_require__(11)(JTopo);\r\n__webpack_require__(9)(JTopo);\r\n//-------容器\r\n__webpack_require__(8)(JTopo);\r\n\r\nwindow.JTopo = JTopo;\r\nmodule.exports=JTopo;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vaW5kZXguanM/MmE3OCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSIsImZpbGUiOiIyNy5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBKVG9wbz1yZXF1aXJlKCcuL21haW4uanMnKTtcclxuSlRvcG8uRWxlbWVudD1yZXF1aXJlKFwiLi9iYXNlL0VsZW1lbnQuanNcIik7XHJcbi8vLS0tLS0tLeW3peWFt1xyXG5yZXF1aXJlKCcuL3Rvb2xzL2FwaS5qcycpO1xyXG5yZXF1aXJlKCcuL3Rvb2xzL3V0aWwuanMnKShKVG9wbyk7XHJcbnJlcXVpcmUoJy4vdG9vbHMvbGF5b3V0LmpzJykoSlRvcG8pO1xyXG5yZXF1aXJlKCcuL3Rvb2xzL2FuaW1hdGUuanMnKShKVG9wbyk7XHJcbi8vLS0tLS0tLeWcuuaZr1xyXG5yZXF1aXJlKCcuL3N0YWdlL3N0YWdlLmpzJykoSlRvcG8pO1xyXG4vLy0tLS0tLS3nlLvluINcclxucmVxdWlyZSgnLi9zY2VuZS9zY2VuZS5qcycpKEpUb3BvKTtcclxucmVxdWlyZSgnLi9zY2VuZS9ldmVudC5qcycpKEpUb3BvKTtcclxuLy8tLS0tLS0t5Z+656GA5YWD57SgXHJcbnJlcXVpcmUoJy4vYmFzZS9kaXNwbGF5RWxlbWVudC5qcycpKEpUb3BvKTtcclxucmVxdWlyZSgnLi9iYXNlL2ludGVyYWN0aXZlRWxlbWVudC5qcycpKEpUb3BvKTtcclxucmVxdWlyZSgnLi9iYXNlL2VkaXRhYmxlRWxlbWVudC5qcycpKEpUb3BvKTtcclxuLy8tLS0tLS0t6IqC54K5XHJcbnJlcXVpcmUoJy4vbm9kZS9Ob2RlLmpzJykoSlRvcG8pO1xyXG5yZXF1aXJlKCcuL25vZGUvVGV4dE5vZGUuanMnKShKVG9wbyk7XHJcbnJlcXVpcmUoJy4vbm9kZS9MaW5rTm9kZS5qcycpKEpUb3BvKTtcclxucmVxdWlyZSgnLi9ub2RlL0NpcmNsZU5vZGUuanMnKShKVG9wbyk7XHJcbnJlcXVpcmUoJy4vbm9kZS9BbmltYXRlTm9kZS5qcycpKEpUb3BvKTtcclxucmVxdWlyZSgnLi9ub2RlL3NwZWNpYWxOb2RlLmpzJykoSlRvcG8pO1xyXG4vLy0tLS0tLS3pk77mjqVcclxucmVxdWlyZSgnLi9saW5rL0xpbmsuanMnKShKVG9wbyk7XHJcbnJlcXVpcmUoJy4vbGluay9GbGV4aW9uYWxMaW5rLmpzJykoSlRvcG8pO1xyXG5yZXF1aXJlKCcuL2xpbmsvRm9sZExpbmsuanMnKShKVG9wbyk7XHJcbnJlcXVpcmUoJy4vbGluay9DdXJ2ZUxpbmsuanMnKShKVG9wbyk7XHJcbi8vLS0tLS0tLeWuueWZqFxyXG5yZXF1aXJlKCcuL2NvbnRhaW5lci9jb250YWluZXIuanMnKShKVG9wbyk7XHJcblxyXG53aW5kb3cuSlRvcG8gPSBKVG9wbztcclxubW9kdWxlLmV4cG9ydHM9SlRvcG87XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDI3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==");
},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 节点基类,用以继承 [E]开头继承于Element,[N]开头为自身api\r\n * @class [N] Node\r\n * @constructor\r\n * @extends [E] Element\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\nvar Element=__webpack_require__(2);\r\nmodule.exports =Node;\r\n\r\nfunction Node(jtopo) {\r\n    if(jtopo){\r\n        Element.call(this,jtopo);\r\n    }else{\r\n        QTopo.util.error("create Node without jtopo",this);\r\n    }\r\n    /**\r\n     * 链接记录\r\n     * @property [N] links {object}\r\n     * @param in {array} 自身为终点的链路对象\r\n     * @param out {array} 自身为起点的链路对象\r\n     */\r\n    this.links={\r\n        in:[],\r\n        out:[]\r\n    };\r\n}\r\nQTopo.util.inherits(Node,Element);\r\n/**\r\n *  获取元素基本类型,详细参考QTopo.constant中的类型定义\r\n *  @method [N] getType\r\n *  @return QTopo.constant.NODE\r\n */\r\nNode.prototype.getType=function(){\r\n    return QTopo.constant.NODE;\r\n};\r\n/**\r\n *  设置颜色,一般为设置自身填充颜色，节点有图片设置或为文字节点时无效\r\n *  @method [N] setColor\r\n *  @param color {string} "255,255,255"/"#ffffff"\r\n */\r\nNode.prototype.setColor = function (color) {\r\n    if (color) {\r\n        color = QTopo.util.transHex(color.toLowerCase());\r\n        this.jtopo.fillColor = color;\r\n    }\r\n    this.attr.color=this.jtopo.fillColor;\r\n};\r\n/**\r\n *  设置显示名称,删减首尾空格符\r\n *\r\n *  文字节点应调用setText处理文字显示\r\n *\r\n *  其他节点应用该函数处理名称，否则会出现隐藏后再显示而名称不符的Bug\r\n *  @method [N] setName\r\n *  @param name {string}\r\n */\r\nNode.prototype.setName=function(name){\r\n    if(name){\r\n        if (this.attr.namePosition != "hide") {\r\n            this.jtopo.text = (name+"").trim();\r\n        }\r\n        this.attr.name = (name+"").trim();\r\n    }\r\n};\r\n/**\r\n *  单个对象的属性提取\r\n *  @method [N] toJson\r\n *  @return {object}\r\n */\r\nNode.prototype.toJson=function(){\r\n    var json=$.extend({},this.attr);\r\n    json.extra=$.extend({},this.extra);\r\n    return json;\r\n};\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL05vZGUuanM/OTA1OCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCLGtCQUFrQixNQUFNO0FBQ3hCLG1CQUFtQixNQUFNO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixPQUFPO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QiwwQkFBMEI7QUFDMUI7QUFDQSIsImZpbGUiOiIyOC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDoioLngrnln7rnsbss55So5Lul57un5om/IFtFXeW8gOWktOe7p+aJv+S6jkVsZW1lbnQsW05d5byA5aS05Li66Ieq6LqrYXBpXHJcbiAqIEBjbGFzcyBbTl0gTm9kZVxyXG4gKiBAY29uc3RydWN0b3JcclxuICogQGV4dGVuZHMgW0VdIEVsZW1lbnRcclxuICogQHBhcmFtIGp0b3BvIOWFg+e0oOaguOW/g+eahGp0b3Bv5a+56LGhXHJcbiAqL1xyXG52YXIgRWxlbWVudD1yZXF1aXJlKFwiLi4vRWxlbWVudC5qc1wiKTtcclxubW9kdWxlLmV4cG9ydHMgPU5vZGU7XHJcblxyXG5mdW5jdGlvbiBOb2RlKGp0b3BvKSB7XHJcbiAgICBpZihqdG9wbyl7XHJcbiAgICAgICAgRWxlbWVudC5jYWxsKHRoaXMsanRvcG8pO1xyXG4gICAgfWVsc2V7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcImNyZWF0ZSBOb2RlIHdpdGhvdXQganRvcG9cIix0aGlzKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6ZO+5o6l6K6w5b2VXHJcbiAgICAgKiBAcHJvcGVydHkgW05dIGxpbmtzIHtvYmplY3R9XHJcbiAgICAgKiBAcGFyYW0gaW4ge2FycmF5fSDoh6rouqvkuLrnu4jngrnnmoTpk77ot6/lr7nosaFcclxuICAgICAqIEBwYXJhbSBvdXQge2FycmF5fSDoh6rouqvkuLrotbfngrnnmoTpk77ot6/lr7nosaFcclxuICAgICAqL1xyXG4gICAgdGhpcy5saW5rcz17XHJcbiAgICAgICAgaW46W10sXHJcbiAgICAgICAgb3V0OltdXHJcbiAgICB9O1xyXG59XHJcblFUb3BvLnV0aWwuaW5oZXJpdHMoTm9kZSxFbGVtZW50KTtcclxuLyoqXHJcbiAqICDojrflj5blhYPntKDln7rmnKznsbvlnoss6K+m57uG5Y+C6ICDUVRvcG8uY29uc3RhbnTkuK3nmoTnsbvlnovlrprkuYlcclxuICogIEBtZXRob2QgW05dIGdldFR5cGVcclxuICogIEByZXR1cm4gUVRvcG8uY29uc3RhbnQuTk9ERVxyXG4gKi9cclxuTm9kZS5wcm90b3R5cGUuZ2V0VHlwZT1mdW5jdGlvbigpe1xyXG4gICAgcmV0dXJuIFFUb3BvLmNvbnN0YW50Lk5PREU7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u6aKc6ImyLOS4gOiIrOS4uuiuvue9ruiHqui6q+Whq+WFheminOiJsu+8jOiKgueCueacieWbvueJh+iuvue9ruaIluS4uuaWh+Wtl+iKgueCueaXtuaXoOaViFxyXG4gKiAgQG1ldGhvZCBbTl0gc2V0Q29sb3JcclxuICogIEBwYXJhbSBjb2xvciB7c3RyaW5nfSBcIjI1NSwyNTUsMjU1XCIvXCIjZmZmZmZmXCJcclxuICovXHJcbk5vZGUucHJvdG90eXBlLnNldENvbG9yID0gZnVuY3Rpb24gKGNvbG9yKSB7XHJcbiAgICBpZiAoY29sb3IpIHtcclxuICAgICAgICBjb2xvciA9IFFUb3BvLnV0aWwudHJhbnNIZXgoY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgdGhpcy5qdG9wby5maWxsQ29sb3IgPSBjb2xvcjtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5jb2xvcj10aGlzLmp0b3BvLmZpbGxDb2xvcjtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7mmL7npLrlkI3np7As5Yig5YeP6aaW5bC+56m65qC856ymXHJcbiAqXHJcbiAqICDmloflrZfoioLngrnlupTosIPnlKhzZXRUZXh05aSE55CG5paH5a2X5pi+56S6XHJcbiAqXHJcbiAqICDlhbbku5boioLngrnlupTnlKjor6Xlh73mlbDlpITnkIblkI3np7DvvIzlkKbliJnkvJrlh7rnjrDpmpDol4/lkI7lho3mmL7npLrogIzlkI3np7DkuI3nrKbnmoRCdWdcclxuICogIEBtZXRob2QgW05dIHNldE5hbWVcclxuICogIEBwYXJhbSBuYW1lIHtzdHJpbmd9XHJcbiAqL1xyXG5Ob2RlLnByb3RvdHlwZS5zZXROYW1lPWZ1bmN0aW9uKG5hbWUpe1xyXG4gICAgaWYobmFtZSl7XHJcbiAgICAgICAgaWYgKHRoaXMuYXR0ci5uYW1lUG9zaXRpb24gIT0gXCJoaWRlXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby50ZXh0ID0gKG5hbWUrXCJcIikudHJpbSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmF0dHIubmFtZSA9IChuYW1lK1wiXCIpLnRyaW0oKTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqICDljZXkuKrlr7nosaHnmoTlsZ7mgKfmj5Dlj5ZcclxuICogIEBtZXRob2QgW05dIHRvSnNvblxyXG4gKiAgQHJldHVybiB7b2JqZWN0fVxyXG4gKi9cclxuTm9kZS5wcm90b3R5cGUudG9Kc29uPWZ1bmN0aW9uKCl7XHJcbiAgICB2YXIganNvbj0kLmV4dGVuZCh7fSx0aGlzLmF0dHIpO1xyXG4gICAganNvbi5leHRyYT0kLmV4dGVuZCh7fSx0aGlzLmV4dHJhKTtcclxuICAgIHJldHVybiBqc29uO1xyXG59O1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9lbGVtZW50L25vZGUvTm9kZS5qc1xuLy8gbW9kdWxlIGlkID0gMjhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports){eval('module.exports = function initEagleEye(stage) {\r\n    return {\r\n        hgap: 16,\r\n        visible: !1,\r\n        exportCanvas: document.createElement("canvas"),\r\n        getImage: function (b, c) {\r\n            var d = stage.getBound();\r\n            var e = 1;\r\n            var f = 1;\r\n            this.exportCanvas.width = stage.canvas.width;\r\n            this.exportCanvas.height = stage.canvas.height;\r\n            if (null != b && null != c) {\r\n                this.exportCanvas.width = b;\r\n                this.exportCanvas.height = c;\r\n                e = b / d.width;\r\n                f = c / d.height;\r\n            } else {\r\n                if (d.width > stage.canvas.width) {\r\n                    this.exportCanvas.width = d.width;\r\n                }\r\n                if (d.height > stage.canvas.height) {\r\n                    this.exportCanvas.height = d.height;\r\n                }\r\n            }\r\n            var g = this.exportCanvas.getContext("2d");\r\n            if (stage.childs.length > 0) {\r\n                g.save();\r\n                g.clearRect(0, 0, this.exportCanvas.width, this.exportCanvas.height);\r\n                stage.childs.forEach(function (scene) {\r\n                    if (1 == scene.visible) {\r\n                        scene.save();\r\n                        scene.translateX = 0;\r\n                        scene.translateY = 0;\r\n                        scene.scaleX = 1;\r\n                        scene.scaleY = 1;\r\n                        g.scale(e, f);\r\n                        if (d.left < 0) {\r\n                            scene.translateX = Math.abs(d.left)\r\n                        }\r\n                        if (d.top < 0) {\r\n                            scene.translateY = Math.abs(d.top)\r\n                        }\r\n                        scene.paintAll = !0;\r\n                        scene.paint(g);\r\n                        scene.paintAll = !1;\r\n                        scene.restore();\r\n                    }\r\n                });\r\n                g.restore();\r\n            }\r\n            return this.exportCanvas.toDataURL("image/png");\r\n        },\r\n        canvas: document.createElement("canvas"),\r\n        update: function () {\r\n            this.eagleImageDatas = this.getData(stage);\r\n        },\r\n        setSize: function (a, b) {\r\n            this.width = this.canvas.width = a;\r\n            this.height = this.canvas.height = b;\r\n        },\r\n        getData: function (b, c) {\r\n            function d(a) {\r\n                var b = a.stage.canvas.width, c = a.stage.canvas.height, d = b / a.scaleX / 2, e = c / a.scaleY / 2;\r\n                return {translateX: a.translateX + d - d * a.scaleX, translateY: a.translateY + e - e * a.scaleY}\r\n            }\r\n\r\n            null != j && null != k ? this.setSize(b, c) : this.setSize(200, 160);\r\n            var context = this.canvas.getContext("2d");\r\n            if (stage.childs.length > 0) {\r\n                context.save();\r\n                context.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n                stage.childs.forEach(function (scene) {\r\n                    if (1 == scene.visible) {\r\n                        scene.save();\r\n                        scene.centerAndZoom(null, null, context);\r\n                        scene.paint(context);\r\n                        scene.restore();\r\n                    }\r\n                });\r\n                var f = d(stage.childs[0]), g = f.translateX * (this.canvas.width / stage.canvas.width) * stage.childs[0].scaleX, h = f.translateY * (this.canvas.height / stage.canvas.height) * stage.childs[0].scaleY, i = stage.getBound(), j = stage.canvas.width / stage.childs[0].scaleX / i.width, k = stage.canvas.height / stage.childs[0].scaleY / i.height;\r\n                j > 1 && (j = 1), k > 1 && (j = 1), g *= j, h *= k, i.left < 0 && (g -= Math.abs(i.left) * (this.width / i.width)), i.top < 0 && (h -= Math.abs(i.top) * (this.height / i.height)), context.save(), context.lineWidth = 1, context.strokeStyle = "rgba(255,0,0,1)", context.strokeRect(-g, -h, context.canvas.width * j, context.canvas.height * k), context.restore();\r\n                var l = null;\r\n                try {\r\n                    l = context.getImageData(0, 0, context.canvas.width, context.canvas.height)\r\n                } catch (m) {\r\n                }\r\n                return l\r\n            }\r\n            return null\r\n        },\r\n        paint: function () {\r\n            if (null != this.eagleImageDatas) {\r\n                var b = stage.graphics;\r\n                b.save();\r\n                b.fillStyle = "rgba(211,211,211,0.3)";\r\n                b.fillRect(stage.canvas.width - this.canvas.width - 2 * this.hgap, stage.canvas.height - this.canvas.height - 1, stage.canvas.width - this.canvas.width, this.canvas.height + 1);\r\n                b.fill();\r\n                b.save();\r\n                b.lineWidth = 1;\r\n                b.strokeStyle = "rgba(0,0,0,1)";\r\n                b.rect(stage.canvas.width - this.canvas.width - 2 * this.hgap, stage.canvas.height - this.canvas.height - 1, stage.canvas.width - this.canvas.width, this.canvas.height + 1);\r\n                b.stroke();\r\n                b.restore();\r\n                b.putImageData(this.eagleImageDatas, stage.canvas.width - this.canvas.width - this.hgap, stage.canvas.height - this.canvas.height);\r\n                b.restore()\r\n            } else {\r\n                this.eagleImageDatas = this.getData(stage);\r\n            }\r\n        },\r\n        eventHandler: function (a, b, c) {\r\n            var d = b.x, e = b.y;\r\n            if (d > c.canvas.width - this.canvas.width && e > c.canvas.height - this.canvas.height) {\r\n                if (d = b.x - this.canvas.width, e = b.y - this.canvas.height, "mousedown" == a && (this.lastTranslateX = c.childs[0].translateX, this.lastTranslateY = c.childs[0].translateY), "mousedrag" == a && c.childs.length > 0) {\r\n                    var f = b.dx, g = b.dy, h = c.getBound(), i = this.canvas.width / c.childs[0].scaleX / h.width, j = this.canvas.height / c.childs[0].scaleY / h.height;\r\n                    c.childs[0].translateX = this.lastTranslateX - f / i, c.childs[0].translateY = this.lastTranslateY - g / j\r\n                }\r\n            }\r\n        }\r\n    }\r\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vc3RhZ2UvZWFnbGVFeWUuanM/MjlmNyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMjkuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGluaXRFYWdsZUV5ZShzdGFnZSkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBoZ2FwOiAxNixcclxuICAgICAgICB2aXNpYmxlOiAhMSxcclxuICAgICAgICBleHBvcnRDYW52YXM6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksXHJcbiAgICAgICAgZ2V0SW1hZ2U6IGZ1bmN0aW9uIChiLCBjKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gc3RhZ2UuZ2V0Qm91bmQoKTtcclxuICAgICAgICAgICAgdmFyIGUgPSAxO1xyXG4gICAgICAgICAgICB2YXIgZiA9IDE7XHJcbiAgICAgICAgICAgIHRoaXMuZXhwb3J0Q2FudmFzLndpZHRoID0gc3RhZ2UuY2FudmFzLndpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmV4cG9ydENhbnZhcy5oZWlnaHQgPSBzdGFnZS5jYW52YXMuaGVpZ2h0O1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSBiICYmIG51bGwgIT0gYykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5leHBvcnRDYW52YXMud2lkdGggPSBiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5leHBvcnRDYW52YXMuaGVpZ2h0ID0gYztcclxuICAgICAgICAgICAgICAgIGUgPSBiIC8gZC53aWR0aDtcclxuICAgICAgICAgICAgICAgIGYgPSBjIC8gZC5oZWlnaHQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZC53aWR0aCA+IHN0YWdlLmNhbnZhcy53aWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXhwb3J0Q2FudmFzLndpZHRoID0gZC53aWR0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChkLmhlaWdodCA+IHN0YWdlLmNhbnZhcy5oZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydENhbnZhcy5oZWlnaHQgPSBkLmhlaWdodDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZyA9IHRoaXMuZXhwb3J0Q2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICAgICAgICAgICAgaWYgKHN0YWdlLmNoaWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBnLnNhdmUoKTtcclxuICAgICAgICAgICAgICAgIGcuY2xlYXJSZWN0KDAsIDAsIHRoaXMuZXhwb3J0Q2FudmFzLndpZHRoLCB0aGlzLmV4cG9ydENhbnZhcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgc3RhZ2UuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKHNjZW5lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKDEgPT0gc2NlbmUudmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZS5zYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lLnRyYW5zbGF0ZVggPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZS50cmFuc2xhdGVZID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NlbmUuc2NhbGVYID0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NlbmUuc2NhbGVZID0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZy5zY2FsZShlLCBmKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQubGVmdCA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lLnRyYW5zbGF0ZVggPSBNYXRoLmFicyhkLmxlZnQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQudG9wIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NlbmUudHJhbnNsYXRlWSA9IE1hdGguYWJzKGQudG9wKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lLnBhaW50QWxsID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lLnBhaW50KGcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZS5wYWludEFsbCA9ICExO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZS5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBnLnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5leHBvcnRDYW52YXMudG9EYXRhVVJMKFwiaW1hZ2UvcG5nXCIpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2FudmFzOiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLFxyXG4gICAgICAgIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLmVhZ2xlSW1hZ2VEYXRhcyA9IHRoaXMuZ2V0RGF0YShzdGFnZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXRTaXplOiBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICB0aGlzLndpZHRoID0gdGhpcy5jYW52YXMud2lkdGggPSBhO1xyXG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9IHRoaXMuY2FudmFzLmhlaWdodCA9IGI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXREYXRhOiBmdW5jdGlvbiAoYiwgYykge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBkKGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gYS5zdGFnZS5jYW52YXMud2lkdGgsIGMgPSBhLnN0YWdlLmNhbnZhcy5oZWlnaHQsIGQgPSBiIC8gYS5zY2FsZVggLyAyLCBlID0gYyAvIGEuc2NhbGVZIC8gMjtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7dHJhbnNsYXRlWDogYS50cmFuc2xhdGVYICsgZCAtIGQgKiBhLnNjYWxlWCwgdHJhbnNsYXRlWTogYS50cmFuc2xhdGVZICsgZSAtIGUgKiBhLnNjYWxlWX1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbnVsbCAhPSBqICYmIG51bGwgIT0gayA/IHRoaXMuc2V0U2l6ZShiLCBjKSA6IHRoaXMuc2V0U2l6ZSgyMDAsIDE2MCk7XHJcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgICAgICAgICBpZiAoc3RhZ2UuY2hpbGRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICBzdGFnZS5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoc2NlbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoMSA9PSBzY2VuZS52aXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lLnNhdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NlbmUuY2VudGVyQW5kWm9vbShudWxsLCBudWxsLCBjb250ZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NlbmUucGFpbnQoY29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lLnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gZChzdGFnZS5jaGlsZHNbMF0pLCBnID0gZi50cmFuc2xhdGVYICogKHRoaXMuY2FudmFzLndpZHRoIC8gc3RhZ2UuY2FudmFzLndpZHRoKSAqIHN0YWdlLmNoaWxkc1swXS5zY2FsZVgsIGggPSBmLnRyYW5zbGF0ZVkgKiAodGhpcy5jYW52YXMuaGVpZ2h0IC8gc3RhZ2UuY2FudmFzLmhlaWdodCkgKiBzdGFnZS5jaGlsZHNbMF0uc2NhbGVZLCBpID0gc3RhZ2UuZ2V0Qm91bmQoKSwgaiA9IHN0YWdlLmNhbnZhcy53aWR0aCAvIHN0YWdlLmNoaWxkc1swXS5zY2FsZVggLyBpLndpZHRoLCBrID0gc3RhZ2UuY2FudmFzLmhlaWdodCAvIHN0YWdlLmNoaWxkc1swXS5zY2FsZVkgLyBpLmhlaWdodDtcclxuICAgICAgICAgICAgICAgIGogPiAxICYmIChqID0gMSksIGsgPiAxICYmIChqID0gMSksIGcgKj0gaiwgaCAqPSBrLCBpLmxlZnQgPCAwICYmIChnIC09IE1hdGguYWJzKGkubGVmdCkgKiAodGhpcy53aWR0aCAvIGkud2lkdGgpKSwgaS50b3AgPCAwICYmIChoIC09IE1hdGguYWJzKGkudG9wKSAqICh0aGlzLmhlaWdodCAvIGkuaGVpZ2h0KSksIGNvbnRleHQuc2F2ZSgpLCBjb250ZXh0LmxpbmVXaWR0aCA9IDEsIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcInJnYmEoMjU1LDAsMCwxKVwiLCBjb250ZXh0LnN0cm9rZVJlY3QoLWcsIC1oLCBjb250ZXh0LmNhbnZhcy53aWR0aCAqIGosIGNvbnRleHQuY2FudmFzLmhlaWdodCAqIGspLCBjb250ZXh0LnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgICAgIHZhciBsID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbCA9IGNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIGNvbnRleHQuY2FudmFzLndpZHRoLCBjb250ZXh0LmNhbnZhcy5oZWlnaHQpXHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChtKSB7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwYWludDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSB0aGlzLmVhZ2xlSW1hZ2VEYXRhcykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSBzdGFnZS5ncmFwaGljcztcclxuICAgICAgICAgICAgICAgIGIuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgYi5maWxsU3R5bGUgPSBcInJnYmEoMjExLDIxMSwyMTEsMC4zKVwiO1xyXG4gICAgICAgICAgICAgICAgYi5maWxsUmVjdChzdGFnZS5jYW52YXMud2lkdGggLSB0aGlzLmNhbnZhcy53aWR0aCAtIDIgKiB0aGlzLmhnYXAsIHN0YWdlLmNhbnZhcy5oZWlnaHQgLSB0aGlzLmNhbnZhcy5oZWlnaHQgLSAxLCBzdGFnZS5jYW52YXMud2lkdGggLSB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0ICsgMSk7XHJcbiAgICAgICAgICAgICAgICBiLmZpbGwoKTtcclxuICAgICAgICAgICAgICAgIGIuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgYi5saW5lV2lkdGggPSAxO1xyXG4gICAgICAgICAgICAgICAgYi5zdHJva2VTdHlsZSA9IFwicmdiYSgwLDAsMCwxKVwiO1xyXG4gICAgICAgICAgICAgICAgYi5yZWN0KHN0YWdlLmNhbnZhcy53aWR0aCAtIHRoaXMuY2FudmFzLndpZHRoIC0gMiAqIHRoaXMuaGdhcCwgc3RhZ2UuY2FudmFzLmhlaWdodCAtIHRoaXMuY2FudmFzLmhlaWdodCAtIDEsIHN0YWdlLmNhbnZhcy53aWR0aCAtIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQgKyAxKTtcclxuICAgICAgICAgICAgICAgIGIuc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgICAgICBiLnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgICAgIGIucHV0SW1hZ2VEYXRhKHRoaXMuZWFnbGVJbWFnZURhdGFzLCBzdGFnZS5jYW52YXMud2lkdGggLSB0aGlzLmNhbnZhcy53aWR0aCAtIHRoaXMuaGdhcCwgc3RhZ2UuY2FudmFzLmhlaWdodCAtIHRoaXMuY2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICBiLnJlc3RvcmUoKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lYWdsZUltYWdlRGF0YXMgPSB0aGlzLmdldERhdGEoc3RhZ2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBldmVudEhhbmRsZXI6IGZ1bmN0aW9uIChhLCBiLCBjKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gYi54LCBlID0gYi55O1xyXG4gICAgICAgICAgICBpZiAoZCA+IGMuY2FudmFzLndpZHRoIC0gdGhpcy5jYW52YXMud2lkdGggJiYgZSA+IGMuY2FudmFzLmhlaWdodCAtIHRoaXMuY2FudmFzLmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGQgPSBiLnggLSB0aGlzLmNhbnZhcy53aWR0aCwgZSA9IGIueSAtIHRoaXMuY2FudmFzLmhlaWdodCwgXCJtb3VzZWRvd25cIiA9PSBhICYmICh0aGlzLmxhc3RUcmFuc2xhdGVYID0gYy5jaGlsZHNbMF0udHJhbnNsYXRlWCwgdGhpcy5sYXN0VHJhbnNsYXRlWSA9IGMuY2hpbGRzWzBdLnRyYW5zbGF0ZVkpLCBcIm1vdXNlZHJhZ1wiID09IGEgJiYgYy5jaGlsZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmID0gYi5keCwgZyA9IGIuZHksIGggPSBjLmdldEJvdW5kKCksIGkgPSB0aGlzLmNhbnZhcy53aWR0aCAvIGMuY2hpbGRzWzBdLnNjYWxlWCAvIGgud2lkdGgsIGogPSB0aGlzLmNhbnZhcy5oZWlnaHQgLyBjLmNoaWxkc1swXS5zY2FsZVkgLyBoLmhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICBjLmNoaWxkc1swXS50cmFuc2xhdGVYID0gdGhpcy5sYXN0VHJhbnNsYXRlWCAtIGYgLyBpLCBjLmNoaWxkc1swXS50cmFuc2xhdGVZID0gdGhpcy5sYXN0VHJhbnNsYXRlWSAtIGcgLyBqXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9qdG9wby9zdGFnZS9lYWdsZUV5ZS5qc1xuLy8gbW9kdWxlIGlkID0gMjlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIDIiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports){eval('/**\r\n * Created by qiyc on 2017/4/18.\r\n */\r\nmodule.exports=function(self,canvas,jtopo){\r\n    var innerTimeOutId = null;\r\n    var flag = !0;\r\n    document.oncontextmenu = function () {\r\n        return flag\r\n    };\r\n    init(canvas);\r\n    function init(canvas) {\r\n        if (jtopo.util.isIE || !window.addEventListener) {\r\n            canvas.onmouseout = mouseOut;\r\n            canvas.onmouseover = mouseOver;\r\n            canvas.onmousedown = mouseDown;\r\n            canvas.onmouseup = mouseUp;\r\n            canvas.onmousemove = mouseMove;\r\n            canvas.onclick = click;\r\n            canvas.ondblclick = dbclick;\r\n            canvas.onmousewheel = mouseWheel;\r\n            canvas.touchstart = touchStart;\r\n            canvas.touchmove = mouseMove;\r\n            canvas.touchend = mouseUp;\r\n        } else {\r\n            canvas.addEventListener("mouseout", mouseOut);\r\n            canvas.addEventListener("mouseover", mouseOver);\r\n            canvas.addEventListener("mousedown", mouseDown);\r\n            canvas.addEventListener("mouseup", mouseUp);\r\n            canvas.addEventListener("mousemove", mouseMove);\r\n            canvas.addEventListener("click", click);\r\n            canvas.addEventListener("dblclick", dbclick);\r\n            if (jtopo.util.isFirefox) {\r\n                canvas.addEventListener("DOMMouseScroll", mouseWheel);\r\n            } else {\r\n                canvas.addEventListener("mousewheel", mouseWheel);\r\n            }\r\n        }\r\n        if (window.addEventListener) {\r\n            window.addEventListener("keydown", function (event) {\r\n                self.dispatchEventToScenes("keydown", jtopo.util.cloneEvent(event));\r\n                var keyCode = event.keyCode;\r\n                if (37 == keyCode || 38 == keyCode || 39 == keyCode || 40 == keyCode) {\r\n                    if (event.preventDefault) {\r\n                        event.preventDefault()\r\n                    } else {\r\n                        event = event || window.event;\r\n                        event.returnValue = !1;\r\n                    }\r\n                }\r\n            }, !0);\r\n            window.addEventListener("keyup", function (event) {\r\n                self.dispatchEventToScenes("keyup", jtopo.util.cloneEvent(event));\r\n                var keyCode = event.keyCode;\r\n                if (37 == keyCode || 38 == keyCode || 39 == keyCode || 40 == keyCode) {\r\n                    if (event.preventDefault) {\r\n                        event.preventDefault()\r\n                    } else {\r\n                        event = event || window.event;\r\n                        event.returnValue = !1;\r\n                    }\r\n                }\r\n            }, !0);\r\n        }\r\n    }\r\n    function getEventObject(event) {\r\n        var eventPosition = jtopo.util.getEventPosition(event);\r\n        var offsetPosition = jtopo.util.getOffsetPosition(self.canvas);\r\n        eventPosition.offsetLeft = eventPosition.pageX - offsetPosition.left;\r\n        eventPosition.offsetTop = eventPosition.pageY - offsetPosition.top;\r\n        eventPosition.x = eventPosition.offsetLeft;\r\n        eventPosition.y = eventPosition.offsetTop;\r\n        eventPosition.target = null;\r\n        return eventPosition;\r\n    }\r\n\r\n    function mouseOver(event) {\r\n        document.onselectstart = function () {\r\n            return !1\r\n        };\r\n        this.mouseOver = !0;\r\n        event = getEventObject(event);\r\n        self.dispatchEventToScenes("mouseover", event);\r\n        self.dispatchEvent("mouseover", event);\r\n    }\r\n\r\n    function mouseOut(a) {\r\n        innerTimeOutId = setTimeout(function () {\r\n            flag = true;\r\n        }, 500);\r\n        document.onselectstart = function () {\r\n            return true;\r\n        };\r\n        var b = getEventObject(a);\r\n        self.dispatchEventToScenes("mouseout", b);\r\n        self.dispatchEvent("mouseout", b);\r\n    }\r\n\r\n    function mouseDown(event) {\r\n        event = getEventObject(event);\r\n        self.mouseDown = !0;\r\n        self.mouseDownX = event.x;\r\n        self.mouseDownY = event.y;\r\n        self.dispatchEventToScenes("mousedown", event);\r\n        self.dispatchEvent("mousedown", event);\r\n    }\r\n    function touchStart(event){\r\n        event = getEventObject(event);\r\n        self.mouseDown = !0;\r\n        self.mouseDownX = event.x;\r\n        self.mouseDownY = event.y;\r\n        self.dispatchEventToScenes("touchstart", event);\r\n        self.dispatchEvent("touchstart", event);\r\n    }\r\n    function mouseUp(a) {\r\n        var b = getEventObject(a);\r\n        self.mouseDown = !1;\r\n        self.dispatchEventToScenes("mouseup", b);\r\n        self.dispatchEvent("mouseup", b);\r\n    }\r\n\r\n    function mouseMove(event) {\r\n        if (innerTimeOutId) {\r\n            window.clearTimeout(innerTimeOutId);\r\n            innerTimeOutId = null;\r\n        }\r\n        flag = !1;\r\n        event = getEventObject(event);\r\n        if (self.mouseDown) {\r\n            if (0 == event.button) {\r\n                event.dx = event.x - self.mouseDownX;\r\n                event.dy = event.y - self.mouseDownY;\r\n                self.dispatchEventToScenes("mousedrag", event);\r\n                self.dispatchEvent("mousedrag", event);\r\n                if (1 == self.eagleEye.visible) {\r\n                    self.eagleEye.update();\r\n                }\r\n            }\r\n        } else {\r\n            self.dispatchEventToScenes("mousemove", event);\r\n            self.dispatchEvent("mousemove", event);\r\n        }\r\n    }\r\n\r\n    function click(event) {\r\n        event = getEventObject(event);\r\n        self.dispatchEventToScenes("click", event);\r\n        self.dispatchEvent("click", event);\r\n    }\r\n\r\n    function dbclick(event) {\r\n        event = getEventObject(event);\r\n        self.dispatchEventToScenes("dbclick", event);\r\n        self.dispatchEvent("dbclick", event);\r\n    }\r\n\r\n    function mouseWheel(e) {\r\n        var event = getEventObject(e);\r\n        self.dispatchEventToScenes("mousewheel", event);\r\n        self.dispatchEvent("mousewheel", event);\r\n        if(null != self.wheelZoom){\r\n            if(e.preventDefault){\r\n                e.preventDefault()\r\n            }else{\r\n                e = e || window.event;\r\n                e.returnValue = !1;\r\n            }\r\n            if(1 == self.eagleEye.visible){\r\n                self.eagleEye.update();\r\n            }\r\n        }\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vc3RhZ2UvZXZlbnQuanM/MWYzZiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjMwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgcWl5YyBvbiAyMDE3LzQvMTguXHJcbiAqL1xyXG5tb2R1bGUuZXhwb3J0cz1mdW5jdGlvbihzZWxmLGNhbnZhcyxqdG9wbyl7XHJcbiAgICB2YXIgaW5uZXJUaW1lT3V0SWQgPSBudWxsO1xyXG4gICAgdmFyIGZsYWcgPSAhMDtcclxuICAgIGRvY3VtZW50Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZsYWdcclxuICAgIH07XHJcbiAgICBpbml0KGNhbnZhcyk7XHJcbiAgICBmdW5jdGlvbiBpbml0KGNhbnZhcykge1xyXG4gICAgICAgIGlmIChqdG9wby51dGlsLmlzSUUgfHwgIXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy5vbm1vdXNlb3V0ID0gbW91c2VPdXQ7XHJcbiAgICAgICAgICAgIGNhbnZhcy5vbm1vdXNlb3ZlciA9IG1vdXNlT3ZlcjtcclxuICAgICAgICAgICAgY2FudmFzLm9ubW91c2Vkb3duID0gbW91c2VEb3duO1xyXG4gICAgICAgICAgICBjYW52YXMub25tb3VzZXVwID0gbW91c2VVcDtcclxuICAgICAgICAgICAgY2FudmFzLm9ubW91c2Vtb3ZlID0gbW91c2VNb3ZlO1xyXG4gICAgICAgICAgICBjYW52YXMub25jbGljayA9IGNsaWNrO1xyXG4gICAgICAgICAgICBjYW52YXMub25kYmxjbGljayA9IGRiY2xpY2s7XHJcbiAgICAgICAgICAgIGNhbnZhcy5vbm1vdXNld2hlZWwgPSBtb3VzZVdoZWVsO1xyXG4gICAgICAgICAgICBjYW52YXMudG91Y2hzdGFydCA9IHRvdWNoU3RhcnQ7XHJcbiAgICAgICAgICAgIGNhbnZhcy50b3VjaG1vdmUgPSBtb3VzZU1vdmU7XHJcbiAgICAgICAgICAgIGNhbnZhcy50b3VjaGVuZCA9IG1vdXNlVXA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW91dFwiLCBtb3VzZU91dCk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsIG1vdXNlT3Zlcik7XHJcbiAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIG1vdXNlRG93bik7XHJcbiAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBtb3VzZVVwKTtcclxuICAgICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgbW91c2VNb3ZlKTtcclxuICAgICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbGljayk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwiZGJsY2xpY2tcIiwgZGJjbGljayk7XHJcbiAgICAgICAgICAgIGlmIChqdG9wby51dGlsLmlzRmlyZWZveCkge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJET01Nb3VzZVNjcm9sbFwiLCBtb3VzZVdoZWVsKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2V3aGVlbFwiLCBtb3VzZVdoZWVsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAod2luZG93LmFkZEV2ZW50TGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJrZXlkb3duXCIsIGp0b3BvLnV0aWwuY2xvbmVFdmVudChldmVudCkpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGtleUNvZGUgPSBldmVudC5rZXlDb2RlO1xyXG4gICAgICAgICAgICAgICAgaWYgKDM3ID09IGtleUNvZGUgfHwgMzggPT0ga2V5Q29kZSB8fCAzOSA9PSBrZXlDb2RlIHx8IDQwID09IGtleUNvZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQucHJldmVudERlZmF1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50ID0gZXZlbnQgfHwgd2luZG93LmV2ZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5yZXR1cm5WYWx1ZSA9ICExO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgITApO1xyXG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJrZXl1cFwiLCBqdG9wby51dGlsLmNsb25lRXZlbnQoZXZlbnQpKTtcclxuICAgICAgICAgICAgICAgIHZhciBrZXlDb2RlID0gZXZlbnQua2V5Q29kZTtcclxuICAgICAgICAgICAgICAgIGlmICgzNyA9PSBrZXlDb2RlIHx8IDM4ID09IGtleUNvZGUgfHwgMzkgPT0ga2V5Q29kZSB8fCA0MCA9PSBrZXlDb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LnByZXZlbnREZWZhdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGV2ZW50IHx8IHdpbmRvdy5ldmVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucmV0dXJuVmFsdWUgPSAhMTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sICEwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZXRFdmVudE9iamVjdChldmVudCkge1xyXG4gICAgICAgIHZhciBldmVudFBvc2l0aW9uID0ganRvcG8udXRpbC5nZXRFdmVudFBvc2l0aW9uKGV2ZW50KTtcclxuICAgICAgICB2YXIgb2Zmc2V0UG9zaXRpb24gPSBqdG9wby51dGlsLmdldE9mZnNldFBvc2l0aW9uKHNlbGYuY2FudmFzKTtcclxuICAgICAgICBldmVudFBvc2l0aW9uLm9mZnNldExlZnQgPSBldmVudFBvc2l0aW9uLnBhZ2VYIC0gb2Zmc2V0UG9zaXRpb24ubGVmdDtcclxuICAgICAgICBldmVudFBvc2l0aW9uLm9mZnNldFRvcCA9IGV2ZW50UG9zaXRpb24ucGFnZVkgLSBvZmZzZXRQb3NpdGlvbi50b3A7XHJcbiAgICAgICAgZXZlbnRQb3NpdGlvbi54ID0gZXZlbnRQb3NpdGlvbi5vZmZzZXRMZWZ0O1xyXG4gICAgICAgIGV2ZW50UG9zaXRpb24ueSA9IGV2ZW50UG9zaXRpb24ub2Zmc2V0VG9wO1xyXG4gICAgICAgIGV2ZW50UG9zaXRpb24udGFyZ2V0ID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gZXZlbnRQb3NpdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBtb3VzZU92ZXIoZXZlbnQpIHtcclxuICAgICAgICBkb2N1bWVudC5vbnNlbGVjdHN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gITFcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMubW91c2VPdmVyID0gITA7XHJcbiAgICAgICAgZXZlbnQgPSBnZXRFdmVudE9iamVjdChldmVudCk7XHJcbiAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJtb3VzZW92ZXJcIiwgZXZlbnQpO1xyXG4gICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcIm1vdXNlb3ZlclwiLCBldmVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbW91c2VPdXQoYSkge1xyXG4gICAgICAgIGlubmVyVGltZU91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGZsYWcgPSB0cnVlO1xyXG4gICAgICAgIH0sIDUwMCk7XHJcbiAgICAgICAgZG9jdW1lbnQub25zZWxlY3RzdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgYiA9IGdldEV2ZW50T2JqZWN0KGEpO1xyXG4gICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwibW91c2VvdXRcIiwgYik7XHJcbiAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwibW91c2VvdXRcIiwgYik7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbW91c2VEb3duKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQgPSBnZXRFdmVudE9iamVjdChldmVudCk7XHJcbiAgICAgICAgc2VsZi5tb3VzZURvd24gPSAhMDtcclxuICAgICAgICBzZWxmLm1vdXNlRG93blggPSBldmVudC54O1xyXG4gICAgICAgIHNlbGYubW91c2VEb3duWSA9IGV2ZW50Lnk7XHJcbiAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJtb3VzZWRvd25cIiwgZXZlbnQpO1xyXG4gICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcIm1vdXNlZG93blwiLCBldmVudCk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiB0b3VjaFN0YXJ0KGV2ZW50KXtcclxuICAgICAgICBldmVudCA9IGdldEV2ZW50T2JqZWN0KGV2ZW50KTtcclxuICAgICAgICBzZWxmLm1vdXNlRG93biA9ICEwO1xyXG4gICAgICAgIHNlbGYubW91c2VEb3duWCA9IGV2ZW50Lng7XHJcbiAgICAgICAgc2VsZi5tb3VzZURvd25ZID0gZXZlbnQueTtcclxuICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcInRvdWNoc3RhcnRcIiwgZXZlbnQpO1xyXG4gICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcInRvdWNoc3RhcnRcIiwgZXZlbnQpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gbW91c2VVcChhKSB7XHJcbiAgICAgICAgdmFyIGIgPSBnZXRFdmVudE9iamVjdChhKTtcclxuICAgICAgICBzZWxmLm1vdXNlRG93biA9ICExO1xyXG4gICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwibW91c2V1cFwiLCBiKTtcclxuICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJtb3VzZXVwXCIsIGIpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG1vdXNlTW92ZShldmVudCkge1xyXG4gICAgICAgIGlmIChpbm5lclRpbWVPdXRJZCkge1xyXG4gICAgICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KGlubmVyVGltZU91dElkKTtcclxuICAgICAgICAgICAgaW5uZXJUaW1lT3V0SWQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmbGFnID0gITE7XHJcbiAgICAgICAgZXZlbnQgPSBnZXRFdmVudE9iamVjdChldmVudCk7XHJcbiAgICAgICAgaWYgKHNlbGYubW91c2VEb3duKSB7XHJcbiAgICAgICAgICAgIGlmICgwID09IGV2ZW50LmJ1dHRvbikge1xyXG4gICAgICAgICAgICAgICAgZXZlbnQuZHggPSBldmVudC54IC0gc2VsZi5tb3VzZURvd25YO1xyXG4gICAgICAgICAgICAgICAgZXZlbnQuZHkgPSBldmVudC55IC0gc2VsZi5tb3VzZURvd25ZO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJtb3VzZWRyYWdcIiwgZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwibW91c2VkcmFnXCIsIGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIGlmICgxID09IHNlbGYuZWFnbGVFeWUudmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZWFnbGVFeWUudXBkYXRlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcIm1vdXNlbW92ZVwiLCBldmVudCk7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcIm1vdXNlbW92ZVwiLCBldmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNsaWNrKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQgPSBnZXRFdmVudE9iamVjdChldmVudCk7XHJcbiAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJjbGlja1wiLCBldmVudCk7XHJcbiAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwiY2xpY2tcIiwgZXZlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGRiY2xpY2soZXZlbnQpIHtcclxuICAgICAgICBldmVudCA9IGdldEV2ZW50T2JqZWN0KGV2ZW50KTtcclxuICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcImRiY2xpY2tcIiwgZXZlbnQpO1xyXG4gICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImRiY2xpY2tcIiwgZXZlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG1vdXNlV2hlZWwoZSkge1xyXG4gICAgICAgIHZhciBldmVudCA9IGdldEV2ZW50T2JqZWN0KGUpO1xyXG4gICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwibW91c2V3aGVlbFwiLCBldmVudCk7XHJcbiAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwibW91c2V3aGVlbFwiLCBldmVudCk7XHJcbiAgICAgICAgaWYobnVsbCAhPSBzZWxmLndoZWVsWm9vbSl7XHJcbiAgICAgICAgICAgIGlmKGUucHJldmVudERlZmF1bHQpe1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50O1xyXG4gICAgICAgICAgICAgICAgZS5yZXR1cm5WYWx1ZSA9ICExO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKDEgPT0gc2VsZi5lYWdsZUV5ZS52aXNpYmxlKXtcclxuICAgICAgICAgICAgICAgIHNlbGYuZWFnbGVFeWUudXBkYXRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vc3RhZ2UvZXZlbnQuanNcbi8vIG1vZHVsZSBpZCA9IDMwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIl0sInNvdXJjZVJvb3QiOiIifQ==');
},,,,,function(module,exports){eval('/**\r\n * @module QTopo\r\n */\r\n/**\r\n * @class QTopo\r\n * @static\r\n */\r\n/**\r\n * 定义的通用常量,一般用getType()来区分元素基本类型,getUseType()区分元素具体类型\r\n * @property constant\r\n * @type Object\r\n * @param SCENE {string}\r\n * @param CONTAINER {string}\r\n * @param LINK {string}\r\n * @param LINE {string}\r\n * @param NODE {string}\r\n * @param CASUAL {string} 临时元素，用以元素变换收缩等操作的过渡元素,一般不对其做操作\r\n * @param node.IMAGE {string}\r\n * @param node.TEXT {string}\r\n * @param node.SHAPE {string}\r\n * @param container.GROUP {string}\r\n * @param link.CURVE {string}\r\n * @param link.DIRECT {string}\r\n * @param link.FLEXIONAL {string}\r\n * @param link.FOLD {string}\r\n * @param line.DIRECT {string}\r\n * @param mode.NORMAL {string}\r\n * @param mode.EDIT {string}\r\n * @param mode.DRAG {string}\r\n * @param mode.SELECT {string}\r\n * @example\r\n *      if(node.getType()==QTopo.constant.NODE){.....}\r\n *      if(node.getUseType()!=QTopo.constant.CASUAL){.....}\r\n *      if(node.getUseType()==QTopo.constant.node.IMAGE){.....}\r\n */\r\nmodule.exports = {\r\n    SCENE:\'10\',\r\n    CONTAINER:"100",\r\n    LINK:"1000",\r\n    LINE:"1100",\r\n    NODE:\'10000\',\r\n    CASUAL:"临时工",//\r\n    node:{\r\n        IMAGE:"10010",\r\n        TEXT:"10001",\r\n        SHAPE:"10011"\r\n    },\r\n    container:{\r\n        GROUP:"101"\r\n    },\r\n    link:{\r\n        CURVE:"1001",\r\n        DIRECT:"1002",\r\n        FLEXIONAL:"1003",\r\n        FOLD:"1004"\r\n    },\r\n    line:{\r\n        DIRECT:"1101"\r\n    },\r\n    mode:{\r\n        NORMAL:"normal",\r\n        EDIT:"edit",\r\n        DRAG:"drag",\r\n        SELECT:"select"\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvbnN0YW50LmpzPzhiZDkiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixxQkFBcUI7QUFDckIsZ0JBQWdCO0FBQ2hCLGdCQUFnQjtBQUNoQixnQkFBZ0I7QUFDaEIsa0JBQWtCLE9BQU87QUFDekIsc0JBQXNCO0FBQ3RCLHFCQUFxQjtBQUNyQixzQkFBc0I7QUFDdEIsMkJBQTJCO0FBQzNCLHNCQUFzQjtBQUN0Qix1QkFBdUI7QUFDdkIsMEJBQTBCO0FBQzFCLHFCQUFxQjtBQUNyQix1QkFBdUI7QUFDdkIsdUJBQXVCO0FBQ3ZCLHFCQUFxQjtBQUNyQixxQkFBcUI7QUFDckIsdUJBQXVCO0FBQ3ZCO0FBQ0EsZ0RBQWdEO0FBQ2hELHFEQUFxRDtBQUNyRCx5REFBeUQ7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjM1LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgUVRvcG9cclxuICovXHJcbi8qKlxyXG4gKiBAY2xhc3MgUVRvcG9cclxuICogQHN0YXRpY1xyXG4gKi9cclxuLyoqXHJcbiAqIOWumuS5ieeahOmAmueUqOW4uOmHjyzkuIDoiKznlKhnZXRUeXBlKCnmnaXljLrliIblhYPntKDln7rmnKznsbvlnossZ2V0VXNlVHlwZSgp5Yy65YiG5YWD57Sg5YW35L2T57G75Z6LXHJcbiAqIEBwcm9wZXJ0eSBjb25zdGFudFxyXG4gKiBAdHlwZSBPYmplY3RcclxuICogQHBhcmFtIFNDRU5FIHtzdHJpbmd9XHJcbiAqIEBwYXJhbSBDT05UQUlORVIge3N0cmluZ31cclxuICogQHBhcmFtIExJTksge3N0cmluZ31cclxuICogQHBhcmFtIExJTkUge3N0cmluZ31cclxuICogQHBhcmFtIE5PREUge3N0cmluZ31cclxuICogQHBhcmFtIENBU1VBTCB7c3RyaW5nfSDkuLTml7blhYPntKDvvIznlKjku6XlhYPntKDlj5jmjaLmlLbnvKnnrYnmk43kvZznmoTov4fmuKHlhYPntKAs5LiA6Iis5LiN5a+55YW25YGa5pON5L2cXHJcbiAqIEBwYXJhbSBub2RlLklNQUdFIHtzdHJpbmd9XHJcbiAqIEBwYXJhbSBub2RlLlRFWFQge3N0cmluZ31cclxuICogQHBhcmFtIG5vZGUuU0hBUEUge3N0cmluZ31cclxuICogQHBhcmFtIGNvbnRhaW5lci5HUk9VUCB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gbGluay5DVVJWRSB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gbGluay5ESVJFQ1Qge3N0cmluZ31cclxuICogQHBhcmFtIGxpbmsuRkxFWElPTkFMIHtzdHJpbmd9XHJcbiAqIEBwYXJhbSBsaW5rLkZPTEQge3N0cmluZ31cclxuICogQHBhcmFtIGxpbmUuRElSRUNUIHtzdHJpbmd9XHJcbiAqIEBwYXJhbSBtb2RlLk5PUk1BTCB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gbW9kZS5FRElUIHtzdHJpbmd9XHJcbiAqIEBwYXJhbSBtb2RlLkRSQUcge3N0cmluZ31cclxuICogQHBhcmFtIG1vZGUuU0VMRUNUIHtzdHJpbmd9XHJcbiAqIEBleGFtcGxlXHJcbiAqICAgICAgaWYobm9kZS5nZXRUeXBlKCk9PVFUb3BvLmNvbnN0YW50Lk5PREUpey4uLi4ufVxyXG4gKiAgICAgIGlmKG5vZGUuZ2V0VXNlVHlwZSgpIT1RVG9wby5jb25zdGFudC5DQVNVQUwpey4uLi4ufVxyXG4gKiAgICAgIGlmKG5vZGUuZ2V0VXNlVHlwZSgpPT1RVG9wby5jb25zdGFudC5ub2RlLklNQUdFKXsuLi4uLn1cclxuICovXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgU0NFTkU6JzEwJyxcclxuICAgIENPTlRBSU5FUjpcIjEwMFwiLFxyXG4gICAgTElOSzpcIjEwMDBcIixcclxuICAgIExJTkU6XCIxMTAwXCIsXHJcbiAgICBOT0RFOicxMDAwMCcsXHJcbiAgICBDQVNVQUw6XCLkuLTml7blt6VcIiwvL1xyXG4gICAgbm9kZTp7XHJcbiAgICAgICAgSU1BR0U6XCIxMDAxMFwiLFxyXG4gICAgICAgIFRFWFQ6XCIxMDAwMVwiLFxyXG4gICAgICAgIFNIQVBFOlwiMTAwMTFcIlxyXG4gICAgfSxcclxuICAgIGNvbnRhaW5lcjp7XHJcbiAgICAgICAgR1JPVVA6XCIxMDFcIlxyXG4gICAgfSxcclxuICAgIGxpbms6e1xyXG4gICAgICAgIENVUlZFOlwiMTAwMVwiLFxyXG4gICAgICAgIERJUkVDVDpcIjEwMDJcIixcclxuICAgICAgICBGTEVYSU9OQUw6XCIxMDAzXCIsXHJcbiAgICAgICAgRk9MRDpcIjEwMDRcIlxyXG4gICAgfSxcclxuICAgIGxpbmU6e1xyXG4gICAgICAgIERJUkVDVDpcIjExMDFcIlxyXG4gICAgfSxcclxuICAgIG1vZGU6e1xyXG4gICAgICAgIE5PUk1BTDpcIm5vcm1hbFwiLFxyXG4gICAgICAgIEVESVQ6XCJlZGl0XCIsXHJcbiAgICAgICAgRFJBRzpcImRyYWdcIixcclxuICAgICAgICBTRUxFQ1Q6XCJzZWxlY3RcIlxyXG4gICAgfVxyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb25zdGFudC5qc1xuLy8gbW9kdWxlIGlkID0gMzVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n//-\r\nvar Node = {\r\n    Image: __webpack_require__(63),\r\n    Text: __webpack_require__(65),\r\n    Shape: __webpack_require__(64)\r\n};\r\nvar Link = {\r\n    Curve: __webpack_require__(59),\r\n    Direct: __webpack_require__(60),\r\n    Flexional: __webpack_require__(61),\r\n    Fold: __webpack_require__(62)\r\n};\r\n\r\nvar Line = {\r\n    Direct: __webpack_require__(57)\r\n};\r\nvar Container = {\r\n    Group: __webpack_require__(56)\r\n};\r\nvar events = __webpack_require__(66);\r\nmodule.exports = Scene;\r\n//-\r\n//画布对象\r\nvar defaults = function () {\r\n    return {\r\n        mode: QTopo.constant.mode.NORMAL,\r\n        backgroundImage: ""\r\n    };\r\n};\r\n/**\r\n * 图层对象\r\n * @class Scene\r\n * @constructor\r\n * @param canvas 绘图所在的canvas标签对象\r\n * @param config 图层的基本设置,参见attr属性\r\n */\r\nfunction Scene(canvas, config) {\r\n    var self = this;\r\n    /**\r\n     * 核心Jtopo对象\r\n     * @property jtopo {Object}\r\n     */\r\n    self.jtopo = new JTopo.Scene();\r\n    self.jtopo.qtopo = self;\r\n    /**\r\n     * 图层中有效记录的元素\r\n     * @property children {object}\r\n     * @param node {array}\r\n     * @param link {array}\r\n     * @param container {array}\r\n     * @param line {array}\r\n     */\r\n    self.children = {\r\n        node: [],\r\n        link: [],\r\n        container: [],\r\n        line: []\r\n    };\r\n    /**\r\n     * 图层的主要属性\r\n     * @property attr {objcet}\r\n     * @param [mode=QTopo.constant.mode.NORMAL],\r\n     * @param [backgroundImage=\'\'],\r\n     * @param [backgroundColor=\'\'],\r\n     */\r\n    self.attr = defaults();\r\n    /**\r\n     * 图层的额外属性\r\n     * @property extra {objcet}\r\n     */\r\n    self.extra = config.extra || {};\r\n    new JTopo.Stage(canvas).add(self.jtopo);\r\n    events.init(self);\r\n    //延时执行\r\n    setTimeout(function () {\r\n        if (config) {\r\n            if (config.backgroundImage) {\r\n                self.setBackgroundImage(config.backgroundImage);\r\n            }\r\n            if (config.backgroundColor) {\r\n                self.setBackgroundColor(config.backgroundColor);\r\n            }\r\n            if (config.mode) {\r\n                self.setMode(config.mode);\r\n            }\r\n        }\r\n    });\r\n}\r\n//-\r\n/**\r\n *  获取图层的基本属性\r\n *  @method get\r\n *  @param key {string} 要获取的属性名\r\n *  @returns {string|object} 属性值\r\n *  @example\r\n *          scene.get(\'mode\')       //"normal"\r\n */\r\nScene.prototype.get = function (key) {\r\n    return this.attr[key];\r\n};\r\n/**\r\n *  获取图层的属性,或添加/修改额外属性\r\n *  @method val\r\n *  @param key {string}\r\n *\r\n *  要操作的属性名,与get不同，该函数会在整个对象中查找与key匹配的属性\r\n *  无论是额外属性还是基本属性又或是Scene.xx属性，只要匹配成功即返回.\r\n *  优先级为 额外属性>基本属性>Scene.xx属性\r\n *\r\n *  用该函数赋予额外属性时，可以直接传入一个对象作为参数\r\n *  该函数会遍历该参数对象将其内容全部覆盖到额外属性上\r\n *\r\n *  @param [value] {string|object} 属性值，若无则函数为获取属性，若有则为修改/添加属性\r\n *  @returns {string|object|void}\r\n *  @example\r\n *\r\n *       赋值操作   1. scene.val(\'pid\',\'12345\')\r\n *                  2. scene.val({\r\n *                          pid:"12345",\r\n *                          path:[]\r\n *                      })\r\n *       取属性操作 scene.val(\'pid\')       //"12345"\r\n *                  scene.val(\'position\') //undefined\r\n *                  scene.val(\'path\')       //[]\r\n *                  scene.val(\'mode\')       //"normal"\r\n */\r\nScene.prototype.val = function (key, value) {\r\n    if (QTopo.util.getClass(key) == \'Object\') {\r\n        var self = this;\r\n        $.each(key, function (name, value) {\r\n            self.extra[name] = value;\r\n        })\r\n    } else {\r\n        if (typeof value==\'undefined\') {\r\n            var result;\r\n            if (typeof this.extra[key]!=\'undefined\') {\r\n                result = this.extra[key];\r\n            } else if (typeof this.attr[key]!=\'undefined\') {\r\n                result = this.attr[key];\r\n            } else {\r\n                result = this[key];\r\n            }\r\n            return result;\r\n        } else {\r\n            this.extra[key] = value;\r\n        }\r\n    }\r\n};\r\n/**\r\n *  配置图层中元素全局样式\r\n *  @method setDefault\r\n *  @param type {string} 要配置的元素类型 例：QTopo.constant.node.IMAGE\r\n *  @param config {object} 样式属性，可参考对应的元素attr属性\r\n */\r\nScene.prototype.setDefault = function (type, config) {\r\n    if (config) {\r\n        var constant = QTopo.constant;\r\n        switch (type) {\r\n            case constant.node.IMAGE:\r\n                Node.Image.setDefault(config);\r\n                break;\r\n            case constant.node.TEXT:\r\n                Node.Text.setDefault(config);\r\n                break;\r\n            case constant.link.DIRECT:\r\n                Link.Direct.setDefault(config);\r\n                break;\r\n            case constant.link.CURVE:\r\n                Link.Curve.setDefault(config);\r\n                break;\r\n            case constant.link.FLEXIONAL:\r\n                Link.Flexional.setDefault(config);\r\n                break;\r\n            case constant.link.FOLD:\r\n                Link.Fold.setDefault(config);\r\n                break;\r\n            case constant.line.DIRECT:\r\n                Line.Direct.setDefault(config);\r\n                break;\r\n            case constant.container.GROUP:\r\n                Container.Group.setDefault(config);\r\n                break;\r\n        }\r\n    }\r\n};\r\n/**\r\n *  获取图层中元素全局样式\r\n *  @method getDefault\r\n *  @param type {string} 要配置的元素类型 例：QTopo.constant.node.IMAGE\r\n *  @return {object} 样式属性，可参考对应的元素attr属性\r\n */\r\nScene.prototype.getDefault = function (type) {\r\n    if (type) {\r\n        var result;\r\n        var constant = QTopo.constant;\r\n        switch (type) {\r\n            case constant.node.IMAGE:\r\n                result = Node.Image.getDefault();\r\n                break;\r\n            case constant.node.TEXT:\r\n                result = Node.Text.getDefault();\r\n                break;\r\n            case constant.link.DIRECT:\r\n                result = Link.Direct.getDefault();\r\n                break;\r\n            case constant.link.CURVE:\r\n                result = Link.Curve.getDefault();\r\n                break;\r\n            case constant.link.FLEXIONAL:\r\n                result = Link.Flexional.getDefault();\r\n                break;\r\n            case constant.link.FOLD:\r\n                result = Link.Fold.getDefault();\r\n                break;\r\n            case constant.line.DIRECT:\r\n                result = Line.Direct.getDefault();\r\n                break;\r\n            case constant.container.GROUP:\r\n                result = Container.Group.getDefault();\r\n                break;\r\n        }\r\n        return result;\r\n    }\r\n};\r\n/**\r\n *  设置图层背景图片，与setBackgroundColor冲突\r\n *  @method setBackgroundImage\r\n *  @param image {string} 图片url\r\n */\r\nScene.prototype.setBackgroundImage = function (image) {\r\n    this.jtopo.background = image;\r\n    this.attr.background = image;\r\n};\r\n/**\r\n *  设置图层背景颜色，与setBackgroundImage冲突\r\n *  @method setBackgroundColor\r\n *  @param color {string} #xxxxxx/255,255,255\r\n */\r\nScene.prototype.setBackgroundColor = function (color) {\r\n    this.jtopo.backgroundColor = QTopo.util.transHex(color);\r\n    this.jtopo.alpha = 1;\r\n    this.attr.background = this.jtopo.backgroundColor;\r\n};\r\n/**\r\n *  设置图层模式\r\n *  @method setMode\r\n *  @param mode {string} 例:QTopo.constant.mode.NORMAL\r\n */\r\nScene.prototype.setMode = function (mode) {\r\n    if (["normal", "edit", "drag", "select"].indexOf(mode) > -1) {\r\n        this.attr.mode = mode;\r\n        this.jtopo.mode = mode;\r\n    } else {\r\n        QTopo.util.error("set wrong mode :", mode);\r\n    }\r\n};\r\n/**\r\n *  图层清空，清除图层内所有元素\r\n *  @method clear\r\n */\r\nScene.prototype.clear = function () {\r\n    QTopo.util.info("scene clear");\r\n    this.children = {\r\n        node: [],\r\n        link: [],\r\n        container: [],\r\n        line: []\r\n    };\r\n    this.jtopo.clear();\r\n};\r\n/**\r\n *  获取类型，常用在右键菜单上对触发对象的识别\r\n *  @method getType\r\n *  @return QTopo.constant.SCENE\r\n */\r\nScene.prototype.getType = function () {\r\n    return QTopo.constant.SCENE;\r\n};\r\n/**\r\n *  获取使用类型，常用在右键菜单上对触发对象的识别\r\n *  @method getUseType\r\n *  @return QTopo.constant.SCENE\r\n */\r\nScene.prototype.getUseType = function () {\r\n    return QTopo.constant.SCENE;\r\n};\r\n/**\r\n *  绑定事件，可用off删除对应事件\r\n *  @method on\r\n *  @param name {string} 事件名\r\n *\r\n *  click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup\r\n *\r\n *  @param fn {function} 处理函数\r\n */\r\nScene.prototype.on = function (name, fn) {\r\n    this.jtopo.addEventListener(name, fn);\r\n};\r\n/**\r\n *  删除事件，可删除on绑定的事件\r\n *  @method off\r\n *  @param name {string} 事件名\r\n *\r\n *  click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup\r\n *\r\n *  @param [fn]{function} 处理的函数对象，若无参则删除该事件下所有函数\r\n */\r\nScene.prototype.off = function (name, fn) {\r\n    this.jtopo.removeEventListener(name, fn);\r\n};\r\n/**\r\n *  根据搜索当前图层，查找基本属性或额外属性满足条件的元素\r\n *  @method find\r\n *  @param scan {string} 查询条件,格式为"key=value,key=value",多个条件用,分割\r\n *  @param [type] {string} 可指定元素类型精确查找\r\n *  @return {array} 返回数组，数组成员为满足至少一个条件的元素\r\n */\r\nScene.prototype.find = function (scan, type) {\r\n    var children = this.children;\r\n    var result = [];\r\n    var condition = typeof scan == "string" ? scan.split(",") : [];\r\n    if (condition.length > 0) {\r\n        $.each(condition, function (i, temp) {\r\n            temp = temp.split("=");\r\n            if (temp.length >= 2) {\r\n                //制定了类型，缩小查找范围，未指定则全部遍历\r\n                if (type) {\r\n                    switch (type) {\r\n                        case "node":\r\n                            scanArr(children.node, temp[0], temp[1]);\r\n                            break;\r\n                        case "link":\r\n                            scanArr(children.link, temp[0], temp[1]);\r\n                            break;\r\n                        case "container":\r\n                            scanArr(children.container, temp[0], temp[1]);\r\n                            break;\r\n                        case "line":\r\n                            scanArr(children.line, temp[0], temp[1]);\r\n                            break;\r\n                    }\r\n                } else {\r\n                    $.each(children, function (j, arr) {\r\n                        scanArr(arr, temp[0], temp[1]);\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return result;\r\n    //扫描数组中对象对应的属性是否相等\r\n    function scanArr(arr, key, value) {\r\n        $.each(arr, function (i, item) {\r\n            //只扫描对象的attr和extra中的属性\r\n            if (equal(item.extra, key, value) || equal(item.attr, key, value)) {\r\n                //排除重复的\r\n                if (result.indexOf(item) < 0) {\r\n                    result.push(item);\r\n                }\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n\r\n    function equal(object, key, value) {\r\n        return object && object[key] && object[key] == value;\r\n    }\r\n};\r\n/**\r\n *  获取当前图层在正常视角下(未放大缩小)最左上角的坐标\r\n *  @method getOrigin\r\n *  @return {object} 包含 x,y属性\r\n */\r\nScene.prototype.getOrigin = function () {\r\n    return {\r\n        x: 0 - this.jtopo.translateX,\r\n        y: 0 - this.jtopo.translateY\r\n    }\r\n};\r\n//-\r\nfunction addJTopo(element) {\r\n    try {\r\n        this.jtopo.add(element.jtopo);\r\n    } catch (e) {\r\n        QTopo.util.error("In Scene, jtopo add error : ", e);\r\n    }\r\n}\r\nfunction removeJTopo(element) {\r\n    try {\r\n        this.jtopo.remove(element.jtopo);\r\n    } catch (e) {\r\n        QTopo.util.error("In Scene, jtopo remove error : ", e);\r\n    }\r\n}\r\n/**\r\n *  根据配置在当前图层上绘制节点\r\n *  @method createNode\r\n *  @param [config] {object}\r\n *\r\n *  无参则根据全局配置绘制QTopo.constant.node.IMAGE对应的节点,\r\n *\r\n *  config.type可指定绘制节点类型\r\n *\r\n *  参考QTopo.contant.node选择可绘制的种类\r\n *  @return {Node|boolean} 创建成功返回节点对象，失败返回false\r\n */\r\nScene.prototype.createNode = function (config) {\r\n    var newNode;\r\n    var constant = QTopo.constant.node;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        case constant.TEXT:\r\n            newNode = new Node.Text.constructor(config);\r\n            break;\r\n        case constant.SHAPE:\r\n            newNode = new Node.Shape.constructor(config);\r\n            break;\r\n        default:\r\n            newNode = new Node.Image.constructor(config);\r\n    }\r\n    if (newNode && newNode.jtopo) {\r\n        addJTopo.call(this, newNode);\r\n        this.children.node.push(newNode);\r\n        return newNode;\r\n    } else {\r\n        QTopo.util.error("create Node error", config);\r\n        return false;\r\n    }\r\n};\r\n/**\r\n *  根据配置在两个元素之间绘制新的链接\r\n *  @method createLink\r\n *  @param [config] {object}\r\n *  无参则根据全局配置绘制QTopo.constant.link.DIRECT对应的链接,\r\n *\r\n *  config.type可指定绘制链接类型\r\n *\r\n *  参考QTopo.contant.link选择可绘制的种类\r\n *  @return {Link|boolean} 创建成功返回链接对象，失败返回false\r\n */\r\nScene.prototype.createLink = function (config) {\r\n    var newLink;\r\n    var constant = QTopo.constant.link;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        case constant.CURVE:\r\n            newLink = new Link.Curve.constructor(config);\r\n            break;\r\n        case constant.FLEXIONAL:\r\n            newLink = new Link.Flexional.constructor(config);\r\n            break;\r\n        case constant.FOLD:\r\n            newLink = new Link.Fold.constructor(config);\r\n            break;\r\n        default:\r\n            newLink = new Link.Direct.constructor(config);\r\n    }\r\n    if (newLink && newLink.jtopo) {\r\n        addJTopo.call(this, newLink);\r\n        this.children.link.push(newLink);\r\n        return newLink;\r\n    } else {\r\n        QTopo.util.error("create Link error", config);\r\n        return false;\r\n    }\r\n};\r\n//--\r\n/**\r\n *  根据配置在两个元素之间创建链接,若两元素已有链接则原链接计数上加1,\r\n *  可操作于有展开功能的链接上，可自适应选择添加新链接或计数+1\r\n *  @method addLink\r\n *  @param config {object} 创建新链接时所依赖的配置，可参考createLink函数\r\n *  @param [fn] {function} 判断两元素间无链接时的可选操作，若无则调用createLink函数建立链接\r\n *  @return {Link|boolean} 创建成功返回链接对象，失败返回false\r\n */\r\nScene.prototype.addLink = function (config, fn) {\r\n    if (config && config.start && config.end) {\r\n        var links = this.linksBetween(config.start, config.end);//按number属性从大到小排列\r\n        if (links.length == 0) {\r\n            if ($.isFunction(fn)) {\r\n                fn();\r\n            } else {\r\n                return this.createLink(config);\r\n            }\r\n        } else {\r\n            //两点之间连线为1则认为是已有链接，超过1则认为是可以展开且已经展开的直线\r\n            var number = 1;\r\n            if ($.isNumeric(config.number)) {\r\n                number = parseInt(config.number);\r\n                if (number < 1) {\r\n                    number = 1;\r\n                }\r\n            }\r\n            if (links.length == 1) {\r\n                links[0].set({\r\n                    number: links[0].attr.number + number\r\n                });\r\n                return links[0];\r\n            } else if (links.length > 1) {\r\n                var parent = links[0].parent;\r\n                if (parent) {\r\n                    parent.attr.number += number;\r\n                    parent.addChild(number);\r\n                }\r\n                return parent;\r\n            }\r\n        }\r\n    }\r\n};\r\n/**\r\n *\r\n *  获取两元素之间所有的链接\r\n *  @method linksBetween\r\n *  @param start {element} 元素，起始无关\r\n *  @param end {element} 元素，起始无关\r\n *  @return {array} 元素间的链接集合，按链接的计数右大到小排列\r\n */\r\nScene.prototype.linksBetween = function (start, end) {\r\n    var result = [];\r\n    var links = start.links;\r\n    //检测两元素间的连线是否已有\r\n    if ($.isArray(links.out)) {\r\n        $.each(links.out, function (i, linkOut) {\r\n            if (linkOut.path.end == end) {\r\n                result.push(linkOut);\r\n            }\r\n        });\r\n    }\r\n    if ($.isArray(links.in)) {\r\n        $.each(links.in, function (j, linkIn) {\r\n            if (linkIn.path.start == end) {\r\n                result.push(linkIn);\r\n            }\r\n        });\r\n    }\r\n    return result.sort(function (a, b) {\r\n        return b.attr.number - a.attr.number;\r\n    });\r\n};\r\n//--\r\n/**\r\n *\r\n *  在图层上绘制不可以移动的线元素\r\n *  @method createLine\r\n *  @param [config] {object} 配置参数,若无则按全局配置创建\r\n *  @return {Line|boolean} 创建成功返回线元素，失败返回false\r\n */\r\nScene.prototype.createLine = function (config) {\r\n    var newLine;\r\n    var constant = QTopo.constant.line;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        default:\r\n            newLine = new Line.Direct.constructor(config);\r\n    }\r\n    if (newLine && newLine.jtopo) {\r\n        addJTopo.call(this, newLine);\r\n        this.children.line.push(newLine);\r\n        return newLine;\r\n    } else {\r\n        QTopo.util.error("create Link error", config);\r\n        return false;\r\n    }\r\n};\r\n//--\r\n/**\r\n *\r\n *  在图层上绘制分组元素\r\n *  @method createContainer\r\n *  @param [config] {object} 配置参数,若无则按全局配置创建\r\n *  @return {container|boolean} 创建成功返回线元素，失败返回false\r\n */\r\nScene.prototype.createContainer = function (config) {\r\n    var newContainer;\r\n    var constant = QTopo.constant.container;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        default:\r\n            newContainer = new Container.Group.constructor(config);\r\n    }\r\n    if (newContainer && newContainer.jtopo) {\r\n        //分组只加入其本身，切换节点不作数\r\n        var nodeConfig = {};\r\n        if (config.toggle) {\r\n            nodeConfig = config.toggle\r\n        }\r\n        //可选禁用分组切换\r\n        if (!(config.toggle && typeof config.toggle.close == "boolean" && config.toggle.close)) {\r\n            addToggle(this, newContainer, nodeConfig);\r\n        }\r\n        this.children.container.push(newContainer);\r\n        addJTopo.call(this, newContainer);\r\n        return newContainer;\r\n    } else {\r\n        QTopo.util.error("create Container error", config);\r\n        return false;\r\n    }\r\n};\r\nfunction addToggle(scene, container, configToggle) {\r\n    configToggle.useType = QTopo.constant.CASUAL;//标记用途\r\n    container.toggleTo = new Node.Image.constructor(configToggle);\r\n    container.toggleTo.toggleTo = container;//互相索引\r\n    container.toggleTo.hide();//初始隐藏\r\n    addJTopo.call(scene, container.toggleTo);//加入画布\r\n}\r\n//--\r\n//-\r\n/**\r\n *\r\n *  删除图层内元素,元素删除其上的链接也会删除和更新\r\n *  @method remove\r\n *  @param element {element}\r\n */\r\nScene.prototype.remove = function (element) {\r\n    var self = this;\r\n    if (element) {\r\n        if ($.isArray(element)) {\r\n            $.each(element, function (i, item) {\r\n                removeOnce(item);\r\n            });\r\n        } else {\r\n            removeOnce(element);\r\n        }\r\n        function removeOnce(oneElement) {\r\n            if (oneElement.jtopo) {\r\n                switch (oneElement.getType()) {\r\n                    case QTopo.constant.NODE:\r\n                        if (QTopo.util.arrayDelete(self.children.node, oneElement) || oneElement.getUseType() == QTopo.constant.CASUAL) {\r\n                            removeNode.call(self, oneElement);\r\n                        }\r\n                        break;\r\n                    case QTopo.constant.LINK:\r\n                        if (QTopo.util.arrayDelete(self.children.link, oneElement) || oneElement.getUseType() == QTopo.constant.CASUAL) {\r\n                            removeLink.call(self, oneElement);\r\n                        }\r\n                        break;\r\n                    case QTopo.constant.LINE:\r\n                        if (QTopo.util.arrayDelete(self.children.line, oneElement) || oneElement.getUseType() == QTopo.constant.CASUAL) {\r\n                            removeLine.call(self, oneElement);\r\n                        }\r\n                        break;\r\n                    case QTopo.constant.CONTAINER:\r\n                        if (QTopo.util.arrayDelete(self.children.container, oneElement) || oneElement.getUseType() == QTopo.constant.CASUAL) {\r\n                            removeContainer.call(self, oneElement);\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\nfunction upDataLinks(element) {\r\n    var links = element.links;\r\n    if (links) {\r\n        //更新其上连线的另一方的links属性\r\n        while (links.in.length > 0) {\r\n            this.remove(links.in.pop());\r\n        }\r\n        while (links.out.length > 0) {\r\n            this.remove(links.out.pop());\r\n        }\r\n    }\r\n}\r\n//线上删除时候,要更新node和container中的links属性\r\nfunction removeLink(link) {\r\n    try {\r\n        QTopo.util.arrayDelete(link.path.start.links.out, link);\r\n        QTopo.util.arrayDelete(link.path.end.links.in, link);\r\n        removeJTopo.call(this, link);\r\n    } catch (e) {\r\n        QTopo.util.error("Scene removeLink error", e);\r\n    }\r\n}\r\nfunction removeLine(line) {\r\n    try {\r\n        removeJTopo.call(this, line);\r\n    } catch (e) {\r\n        QTopo.util.error("Scene removeLine error", e);\r\n    }\r\n}\r\nfunction removeNode(node) {\r\n    //刷新一下现有的线\r\n    try {\r\n        //更新其上线另一头的links属性\r\n        upDataLinks.call(this, node);\r\n        //要更新其父的children属性,父删除子\r\n        if (node.parent && $.isArray(node.parent.children)) {\r\n            node.parent.remove(node);\r\n        }\r\n        //删除分组切换的节点时同时删除其切换的分组\r\n        if (node.toggleTo) {\r\n            //分组若隐藏了,应该展示\r\n            node.toggleTo.toggle();\r\n            this.remove(node.toggleTo);\r\n        }\r\n        removeJTopo.call(this, node);\r\n    } catch (e) {\r\n        QTopo.util.error("Scene removeNode error", e);\r\n    }\r\n}\r\n//容器删除时,要更与其相连的线的另一端的links属性,要更新其子类的parent属性\r\nfunction removeContainer(container) {\r\n    try {\r\n        //分组若隐藏了,应该展示\r\n        container.toggle(true);\r\n        //更新其上线另一头的links属性\r\n        upDataLinks.call(this, container);\r\n        //更新子元素的Parent属性\r\n        if ($.isArray(container.children) && container.children.length > 0) {\r\n            for (var i = 0; i < container.children.length; i++) {\r\n                container.children[i].parent = null;\r\n            }\r\n        }\r\n        //删除分组同时删除其切换节点\r\n        if (container.toggleTo) {\r\n            this.remove(container.toggleTo);\r\n        }\r\n        removeJTopo.call(this, container);\r\n    } catch (e) {\r\n        QTopo.util.error("Scene removeContainer error", e);\r\n    }\r\n}\r\n//-\r\n/**\r\n *\r\n *  图层信息转化为json\r\n *  @method toJson\r\n *  @return {object}\r\n */\r\nScene.prototype.toJson = function () {\r\n    var json = $.extend({}, this.attr);\r\n    json.extra = $.extend({}, this.extra);\r\n    return json;\r\n};\r\n/**\r\n *\r\n *  判断元素是否在当前图层内\r\n *  @method isChildren\r\n *  @param element {element}\r\n *  @return {boolean}\r\n */\r\nScene.prototype.isChildren = function (element) {\r\n    var result = false;\r\n    if (element.jtopo) {\r\n        $.each(this.children, function (name, arr) {\r\n            if (arr.indexOf(element) > -1) {\r\n                result = true;\r\n                return false;\r\n            }\r\n        });\r\n    }\r\n    return result;\r\n};\r\n/**\r\n *\r\n * 图层缩放,元素一屏显示\r\n *  @method goCenter\r\n */\r\nScene.prototype.goCenter = function () {\r\n    if (this.jtopo.childs && this.jtopo.childs.length > 0) {\r\n        this.jtopo.stage.centerAndZoom();\r\n    }\r\n};\r\n/**\r\n *\r\n * 图层缩放\r\n *  @method resize\r\n *  @param size {number} 根据比例放大或缩小 参数可 0-1缩小 1-n放大\r\n */\r\nScene.prototype.resize = function (size) {\r\n    if ($.isNumeric(size)) {\r\n        this.jtopo.scaleX = size;\r\n        this.jtopo.scaleY = size;\r\n    }\r\n};\r\n/**\r\n *\r\n * 启用/禁用鼠标缩放\r\n *  @method toggleZoom\r\n */\r\nScene.prototype.toggleZoom = function () {\r\n    if (!this.jtopo.stage.wheelZoom) {\r\n        this.jtopo.stage.wheelZoom = 0.85; // 设置鼠标缩放比例\r\n    } else {\r\n        this.jtopo.stage.wheelZoom = null;\r\n    }\r\n};\r\n/**\r\n *\r\n * 启用/禁用鹰眼\r\n *  @method toggleEagleEye\r\n */\r\nScene.prototype.toggleEagleEye = function () {\r\n    this.jtopo.stage.eagleEye.visible = !this.jtopo.stage.eagleEye.visible;\r\n};\r\n/**\r\n *\r\n * 获取当前图层的png格式图片在新的窗口打开\r\n *  @method getPicture\r\n */\r\nScene.prototype.getPicture = function () {\r\n    //stage.saveImageInfo();\r\n    //在新页面打开图片\r\n    var image = this.jtopo.stage.canvas.toDataURL("image/png");\r\n    var w = window.open(\'about:blank\', \'image from canvas\');\r\n    w.document.write("<img src=\'" + image + "\' alt=\'from canvas\'/>");\r\n    //下载图片\r\n    // here is the most important part because if you dont replace you will get a DOM 18 exception.\r\n    // var image =  stage.canvas.toDataURL("image/png").replace("image/png", "image/octet-stream;Content-Disposition: attachment;filename=foobar.png");\r\n    //var image = stage.canvas.toDataURL("image/png").replace("image/png", "image/octet-stream");\r\n    //window.location.href=image; // it will save locally\r\n};\r\n/**\r\n * 切换元素的层次\r\n * @method toggleZIndex\r\n * @param element 待控制元素\r\n * @param [flag] true为降低false为提升，无参则默认提升，若已提升到最高则降至最低\r\n */\r\nScene.prototype.toggleZIndex = function (element, flag) {\r\n    if (element) {\r\n        var jtopo = element.jtopo;\r\n        var scene = this.jtopo;\r\n        if (jtopo && scene) {\r\n            var map = scene.zIndexMap[jtopo.zIndex];\r\n            var index = map.indexOf(jtopo);\r\n            var todo = true;\r\n            if (typeof flag == \'boolean\') {\r\n                todo = flag;\r\n            } else {\r\n                if (index == map.length - 1) {\r\n                    todo = false;\r\n                }\r\n            }\r\n            if (todo) {\r\n                //提升层次\r\n                map.push(map[index]);\r\n                map.splice(index, 1);\r\n\r\n            } else {\r\n                //降低层次\r\n                map.splice(0, 0, map[index]);\r\n                map.splice(index + 1, 1);\r\n            }\r\n        }\r\n    }\r\n};\r\nvar selectedCatch = {\r\n    jtopo: [],\r\n    qtopo: []\r\n};\r\n/**\r\n * 获取被选中的元素\r\n * @method getSelected\r\n * @return {array} 返回图层中被选中的元素\r\n */\r\nScene.prototype.getSelected = function () {\r\n    var jtopo = this.jtopo.selectedElements;\r\n    if ($.isArray(jtopo)) {\r\n        if (selectedCatch.jtopo != jtopo) {\r\n            selectedCatch.jtopo = jtopo;\r\n            selectedCatch.qtopo = [];\r\n            jtopo.forEach(function (el) {\r\n                if (el.qtopo && el.qtopo.getUseType() != QTopo.constant.CASUAL) {\r\n                    selectedCatch.qtopo.push(el.qtopo);\r\n                }\r\n            });\r\n        }\r\n        return selectedCatch.qtopo;\r\n    } else {\r\n        return [];\r\n    }\r\n};\r\n/**\r\n * 高亮目标隐藏其他\r\n * @method toggleLight\r\n * @param [target] 数组或对象,高亮其相关对象,无参则全部高亮\r\n * @param [flag] 若为true则只高亮传入的对象,不选则只对传入对象相关的对象高亮\r\n */\r\nScene.prototype.toggleLight = function (target, flag) {\r\n    try {\r\n        var alpha = 1;\r\n        var lighting;\r\n        if (target) {\r\n            alpha = 0.1;\r\n            if (flag) {\r\n                if ($.isArray(target)) {\r\n                    lighting = target;\r\n                } else {\r\n                    lighting = [target];\r\n                }\r\n            } else {\r\n                if ($.isArray(target)) {\r\n                    lighting = getConnectionLightings(target);\r\n                } else {\r\n                    lighting = getConnectionLightings([target]);\r\n                }\r\n            }\r\n        }\r\n        totalSetAlpha(this.children.node.concat(this.children.link), alpha);\r\n        totalSetAlpha(lighting, 1);\r\n    } catch (e) {\r\n        QTopo.util.error("scene toggleLight error", e);\r\n    }\r\n    function getConnectionLightings(arr) {\r\n        var lighting = [];\r\n        $.each(arr, function (i, target) {\r\n            if (target.getType() == QTopo.constant.NODE && target.getUseType() != QTopo.constant.CASUAL) {\r\n                var links = target.links;\r\n                QTopo.util.arrayPush(lighting, target);\r\n                if (links) {\r\n                    if ($.isArray(links.out)) {\r\n                        $.each(links.out, function (l, outlink) {\r\n                            QTopo.util.arrayPush(lighting, outlink);\r\n                            QTopo.util.arrayPush(lighting, outlink.path.end);\r\n                        });\r\n                    }\r\n                    if ($.isArray(links.in)) {\r\n                        $.each(links.in, function (n, inlink) {\r\n                            QTopo.util.arrayPush(lighting, inlink);\r\n                            QTopo.util.arrayPush(lighting, inlink.path.start);\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return lighting;\r\n    }\r\n\r\n    function totalSetAlpha(total, alpha) {\r\n        //全部隐藏\r\n        if ($.isArray(total)) {\r\n            $.each(total, function (i, element) {\r\n                element.set({\r\n                    alpha: alpha\r\n                });\r\n            });\r\n        }\r\n    }\r\n};\r\n/**\r\n * 正常尺寸展示，并将视角移动到以参数节点为中心的位置\r\n * @method moveToNode\r\n * @param node 节点对象\r\n */\r\nScene.prototype.moveToNode = function (node) {\r\n    // 查询到的节点居中显示\r\n    if (this.children.node.indexOf(node) > -1) {\r\n        var location = node.jtopo.getCenterLocation();\r\n        this.resize(1);\r\n        this.jtopo.setCenter(location.x, location.y);\r\n        // 闪烁几下\r\n        nodeFlash(node.jtopo, 5);\r\n    }\r\n    function nodeFlash(node, num) {\r\n        if ($.isNumeric(num)) {\r\n            if (num == 0) {\r\n                node.selected = false;\r\n            } else {\r\n                node.selected = !node.selected;\r\n                setTimeout(function () {\r\n                    nodeFlash(node, num - 1);\r\n                }, 300);\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * 自动布局\r\n * @method autoLayout\r\n * @param config 自动布局配置参数\r\n * @example\r\n *      参数配置:\r\n *          config:{\r\n *              type:\r\n *                  1.\'round\'   无需其他配置\r\n *                  2.\'default\' 需配置行数，列间距，行间距\r\n *              rows:行数\r\n *              rowSpace:行间距\r\n *              columnSpace:列间距\r\n *          }\r\n */\r\nScene.prototype.autoLayout = function (config) {\r\n    if (config && config.type) {\r\n        var needSort = [];\r\n        var jtopos = [];\r\n        this.children.node.forEach(function (v) {\r\n            if (!v.parent) {\r\n                needSort.push(v);\r\n                jtopos.push(v.jtopo);\r\n            }\r\n        });\r\n        switch (config.type) {\r\n            case "round":\r\n                layout_round(this.jtopo, jtopos);\r\n                break;\r\n            case "default":\r\n                layout_default(needSort, parseInt(config.rows), parseInt(config.rowSpace), parseInt(config.columnSpace), this.getOrigin());\r\n                break;\r\n        }\r\n    }\r\n};\r\nfunction layout_round(scene, jtopos) {\r\n    JTopo.layout.circleLayoutNodes(jtopos, {animate: {time: 1000}});\r\n}\r\nfunction layout_default(elements, rows, rowSpace, columnSpace, begin) {\r\n    if ($.isNumeric(rows)) {\r\n        rows = parseInt(rows);\r\n        if (rows < 1) {\r\n            rows = 1;\r\n        }\r\n        $.each(elements.sort(function (a, b) {\r\n            return getDegree(b) - getDegree(a);\r\n        }), function (i, v) {\r\n            //v.setLocation(begin.x + (i % rows) * columnSpace, begin.y);\r\n            move(v, begin.x + (i % rows) * columnSpace, begin.y);\r\n            if ((i + 1) % rows == 0) {\r\n                begin.y += rowSpace;\r\n            }\r\n        });\r\n    }\r\n}\r\n//-------工具函数\r\n//获取节点的度\r\nfunction getDegree(node) {\r\n    var inLinks = node.links.in;\r\n    var outLinks = node.links.out;\r\n    var degree = 0;\r\n    if (inLinks.length == 1) {\r\n        degree += inLinks[0].attr.number;\r\n    } else {\r\n        degree += inLinks.length;\r\n    }\r\n    if (outLinks.length == 1) {\r\n        degree += outLinks[0].attr.number;\r\n    } else {\r\n        degree += outLinks.length;\r\n    }\r\n    return degree;\r\n}\r\n//移动动画\r\nfunction move(node, targetX, targetY) {\r\n    targetX = parseInt(targetX);\r\n    targetY = parseInt(targetY);\r\n    var x = node.attr.position[0];\r\n    var y = node.attr.position[1];\r\n    var partX = parseInt((targetX - x)) / 10;\r\n    var partY = parseInt((targetY - y)) / 10;\r\n    var part = 0;\r\n    var temp = setInterval(function () {\r\n        if (Math.abs(targetX - x) > 1) {\r\n            x += partX;\r\n        }\r\n        if (Math.abs(targetY - y) > 1) {\r\n            y += partY;\r\n        }\r\n        node.setPosition([parseInt(x), parseInt(y)]);\r\n        part++;\r\n        if (Math.abs(targetX - x) <= 1 && Math.abs(targetY - y) <= 1) {\r\n            clearInterval(temp);\r\n        } else if (part >= 10) {\r\n            clearInterval(temp);\r\n        }\r\n    }, 100);\r\n}\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvU2NlbmUuanM/OWVjOSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0Isb0JBQW9CO0FBQ3BCLG9CQUFvQjtBQUNwQix5QkFBeUI7QUFDekIsb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsT0FBTztBQUN2QixjQUFjLGNBQWM7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsY0FBYztBQUNsQyxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsT0FBTztBQUN4QixtQkFBbUIsT0FBTztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLE9BQU87QUFDeEIsYUFBYSxPQUFPO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLE9BQU87QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixPQUFPO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLE9BQU87QUFDeEI7QUFDQTtBQUNBO0FBQ0EsZUFBZSxTQUFTO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLE9BQU87QUFDeEI7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFNBQVM7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsT0FBTztBQUN4QixtQkFBbUIsT0FBTztBQUMxQixhQUFhLE1BQU07QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLGFBQWE7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsYUFBYTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsT0FBTztBQUMxQixpQkFBaUIsU0FBUztBQUMxQixhQUFhLGFBQWE7QUFDMUI7QUFDQTtBQUNBO0FBQ0EsZ0VBQWdFO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixRQUFRO0FBQzFCLGdCQUFnQixRQUFRO0FBQ3hCLGFBQWEsTUFBTTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixPQUFPO0FBQzVCLGFBQWEsYUFBYTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsT0FBTztBQUM1QixhQUFhLGtCQUFrQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlEO0FBQ2pEO0FBQ0EsNENBQTRDO0FBQzVDLDhCQUE4QjtBQUM5Qiw2Q0FBNkM7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLCtCQUErQjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQiw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEM7QUFDMUMsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlHQUFpRyxnQ0FBZ0M7QUFDakk7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxNQUFNO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxVQUFVLFlBQVk7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0wiLCJmaWxlIjoiMzYuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQG1vZHVsZSBjb3JlXHJcbiAqL1xyXG4vLy1cclxudmFyIE5vZGUgPSB7XHJcbiAgICBJbWFnZTogcmVxdWlyZShcIi4vZWxlbWVudC9ub2RlL0ltYWdlLmpzXCIpLFxyXG4gICAgVGV4dDogcmVxdWlyZShcIi4vZWxlbWVudC9ub2RlL1RleHQuanNcIiksXHJcbiAgICBTaGFwZTogcmVxdWlyZShcIi4vZWxlbWVudC9ub2RlL1NoYXBlLmpzXCIpXHJcbn07XHJcbnZhciBMaW5rID0ge1xyXG4gICAgQ3VydmU6IHJlcXVpcmUoXCIuL2VsZW1lbnQvbGluay9DdXJ2ZS5qc1wiKSxcclxuICAgIERpcmVjdDogcmVxdWlyZShcIi4vZWxlbWVudC9saW5rL0RpcmVjdC5qc1wiKSxcclxuICAgIEZsZXhpb25hbDogcmVxdWlyZShcIi4vZWxlbWVudC9saW5rL0ZsZXhpb25hbC5qc1wiKSxcclxuICAgIEZvbGQ6IHJlcXVpcmUoXCIuL2VsZW1lbnQvbGluay9Gb2xkLmpzXCIpXHJcbn07XHJcblxyXG52YXIgTGluZSA9IHtcclxuICAgIERpcmVjdDogcmVxdWlyZShcIi4vZWxlbWVudC9saW5lL0RpcmVjdC5qc1wiKVxyXG59O1xyXG52YXIgQ29udGFpbmVyID0ge1xyXG4gICAgR3JvdXA6IHJlcXVpcmUoXCIuL2VsZW1lbnQvY29udGFpbmVyL0dyb3VwLmpzXCIpXHJcbn07XHJcbnZhciBldmVudHMgPSByZXF1aXJlKFwiLi9ldmVudHMuanNcIik7XHJcbm1vZHVsZS5leHBvcnRzID0gU2NlbmU7XHJcbi8vLVxyXG4vL+eUu+W4g+WvueixoVxyXG52YXIgZGVmYXVsdHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG1vZGU6IFFUb3BvLmNvbnN0YW50Lm1vZGUuTk9STUFMLFxyXG4gICAgICAgIGJhY2tncm91bmRJbWFnZTogXCJcIlxyXG4gICAgfTtcclxufTtcclxuLyoqXHJcbiAqIOWbvuWxguWvueixoVxyXG4gKiBAY2xhc3MgU2NlbmVcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBwYXJhbSBjYW52YXMg57uY5Zu+5omA5Zyo55qEY2FudmFz5qCH562+5a+56LGhXHJcbiAqIEBwYXJhbSBjb25maWcg5Zu+5bGC55qE5Z+65pys6K6+572uLOWPguingWF0dHLlsZ7mgKdcclxuICovXHJcbmZ1bmN0aW9uIFNjZW5lKGNhbnZhcywgY29uZmlnKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAvKipcclxuICAgICAqIOaguOW/g0p0b3Bv5a+56LGhXHJcbiAgICAgKiBAcHJvcGVydHkganRvcG8ge09iamVjdH1cclxuICAgICAqL1xyXG4gICAgc2VsZi5qdG9wbyA9IG5ldyBKVG9wby5TY2VuZSgpO1xyXG4gICAgc2VsZi5qdG9wby5xdG9wbyA9IHNlbGY7XHJcbiAgICAvKipcclxuICAgICAqIOWbvuWxguS4reacieaViOiusOW9leeahOWFg+e0oFxyXG4gICAgICogQHByb3BlcnR5IGNoaWxkcmVuIHtvYmplY3R9XHJcbiAgICAgKiBAcGFyYW0gbm9kZSB7YXJyYXl9XHJcbiAgICAgKiBAcGFyYW0gbGluayB7YXJyYXl9XHJcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyIHthcnJheX1cclxuICAgICAqIEBwYXJhbSBsaW5lIHthcnJheX1cclxuICAgICAqL1xyXG4gICAgc2VsZi5jaGlsZHJlbiA9IHtcclxuICAgICAgICBub2RlOiBbXSxcclxuICAgICAgICBsaW5rOiBbXSxcclxuICAgICAgICBjb250YWluZXI6IFtdLFxyXG4gICAgICAgIGxpbmU6IFtdXHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlm77lsYLnmoTkuLvopoHlsZ7mgKdcclxuICAgICAqIEBwcm9wZXJ0eSBhdHRyIHtvYmpjZXR9XHJcbiAgICAgKiBAcGFyYW0gW21vZGU9UVRvcG8uY29uc3RhbnQubW9kZS5OT1JNQUxdLFxyXG4gICAgICogQHBhcmFtIFtiYWNrZ3JvdW5kSW1hZ2U9JyddLFxyXG4gICAgICogQHBhcmFtIFtiYWNrZ3JvdW5kQ29sb3I9JyddLFxyXG4gICAgICovXHJcbiAgICBzZWxmLmF0dHIgPSBkZWZhdWx0cygpO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlm77lsYLnmoTpop3lpJblsZ7mgKdcclxuICAgICAqIEBwcm9wZXJ0eSBleHRyYSB7b2JqY2V0fVxyXG4gICAgICovXHJcbiAgICBzZWxmLmV4dHJhID0gY29uZmlnLmV4dHJhIHx8IHt9O1xyXG4gICAgbmV3IEpUb3BvLlN0YWdlKGNhbnZhcykuYWRkKHNlbGYuanRvcG8pO1xyXG4gICAgZXZlbnRzLmluaXQoc2VsZik7XHJcbiAgICAvL+W7tuaXtuaJp+ihjFxyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgICAgICBpZiAoY29uZmlnLmJhY2tncm91bmRJbWFnZSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZXRCYWNrZ3JvdW5kSW1hZ2UoY29uZmlnLmJhY2tncm91bmRJbWFnZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNvbmZpZy5iYWNrZ3JvdW5kQ29sb3IpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2V0QmFja2dyb3VuZENvbG9yKGNvbmZpZy5iYWNrZ3JvdW5kQ29sb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb25maWcubW9kZSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZXRNb2RlKGNvbmZpZy5tb2RlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbi8vLVxyXG4vKipcclxuICogIOiOt+WPluWbvuWxgueahOWfuuacrOWxnuaAp1xyXG4gKiAgQG1ldGhvZCBnZXRcclxuICogIEBwYXJhbSBrZXkge3N0cmluZ30g6KaB6I635Y+W55qE5bGe5oCn5ZCNXHJcbiAqICBAcmV0dXJucyB7c3RyaW5nfG9iamVjdH0g5bGe5oCn5YC8XHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICAgICBzY2VuZS5nZXQoJ21vZGUnKSAgICAgICAvL1wibm9ybWFsXCJcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICByZXR1cm4gdGhpcy5hdHRyW2tleV07XHJcbn07XHJcbi8qKlxyXG4gKiAg6I635Y+W5Zu+5bGC55qE5bGe5oCnLOaIlua3u+WKoC/kv67mlLnpop3lpJblsZ7mgKdcclxuICogIEBtZXRob2QgdmFsXHJcbiAqICBAcGFyYW0ga2V5IHtzdHJpbmd9XHJcbiAqXHJcbiAqICDopoHmk43kvZznmoTlsZ7mgKflkI0s5LiOZ2V05LiN5ZCM77yM6K+l5Ye95pWw5Lya5Zyo5pW05Liq5a+56LGh5Lit5p+l5om+5LiOa2V55Yy56YWN55qE5bGe5oCnXHJcbiAqICDml6DorrrmmK/pop3lpJblsZ7mgKfov5jmmK/ln7rmnKzlsZ7mgKflj4jmiJbmmK9TY2VuZS54eOWxnuaAp++8jOWPquimgeWMuemFjeaIkOWKn+WNs+i/lOWbni5cclxuICogIOS8mOWFiOe6p+S4uiDpop3lpJblsZ7mgKc+5Z+65pys5bGe5oCnPlNjZW5lLnh45bGe5oCnXHJcbiAqXHJcbiAqICDnlKjor6Xlh73mlbDotYvkuojpop3lpJblsZ7mgKfml7bvvIzlj6/ku6Xnm7TmjqXkvKDlhaXkuIDkuKrlr7nosaHkvZzkuLrlj4LmlbBcclxuICogIOivpeWHveaVsOS8mumBjeWOhuivpeWPguaVsOWvueixoeWwhuWFtuWGheWuueWFqOmDqOimhuebluWIsOmineWkluWxnuaAp+S4ilxyXG4gKlxyXG4gKiAgQHBhcmFtIFt2YWx1ZV0ge3N0cmluZ3xvYmplY3R9IOWxnuaAp+WAvO+8jOiLpeaXoOWImeWHveaVsOS4uuiOt+WPluWxnuaAp++8jOiLpeacieWImeS4uuS/ruaUuS/mt7vliqDlsZ7mgKdcclxuICogIEByZXR1cm5zIHtzdHJpbmd8b2JqZWN0fHZvaWR9XHJcbiAqICBAZXhhbXBsZVxyXG4gKlxyXG4gKiAgICAgICDotYvlgLzmk43kvZwgICAxLiBzY2VuZS52YWwoJ3BpZCcsJzEyMzQ1JylcclxuICogICAgICAgICAgICAgICAgICAyLiBzY2VuZS52YWwoe1xyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgcGlkOlwiMTIzNDVcIixcclxuICogICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6W11cclxuICogICAgICAgICAgICAgICAgICAgICAgfSlcclxuICogICAgICAg5Y+W5bGe5oCn5pON5L2cIHNjZW5lLnZhbCgncGlkJykgICAgICAgLy9cIjEyMzQ1XCJcclxuICogICAgICAgICAgICAgICAgICBzY2VuZS52YWwoJ3Bvc2l0aW9uJykgLy91bmRlZmluZWRcclxuICogICAgICAgICAgICAgICAgICBzY2VuZS52YWwoJ3BhdGgnKSAgICAgICAvL1tdXHJcbiAqICAgICAgICAgICAgICAgICAgc2NlbmUudmFsKCdtb2RlJykgICAgICAgLy9cIm5vcm1hbFwiXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUudmFsID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgIGlmIChRVG9wby51dGlsLmdldENsYXNzKGtleSkgPT0gJ09iamVjdCcpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgJC5lYWNoKGtleSwgZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZXh0cmFbbmFtZV0gPSB2YWx1ZTtcclxuICAgICAgICB9KVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAodHlwZW9mIHZhbHVlPT0ndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0O1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuZXh0cmFba2V5XSE9J3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuZXh0cmFba2V5XTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdGhpcy5hdHRyW2tleV0hPSd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLmF0dHJba2V5XTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXNba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXh0cmFba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqICDphY3nva7lm77lsYLkuK3lhYPntKDlhajlsYDmoLflvI9cclxuICogIEBtZXRob2Qgc2V0RGVmYXVsdFxyXG4gKiAgQHBhcmFtIHR5cGUge3N0cmluZ30g6KaB6YWN572u55qE5YWD57Sg57G75Z6LIOS+i++8mlFUb3BvLmNvbnN0YW50Lm5vZGUuSU1BR0VcclxuICogIEBwYXJhbSBjb25maWcge29iamVjdH0g5qC35byP5bGe5oCn77yM5Y+v5Y+C6ICD5a+55bqU55qE5YWD57SgYXR0cuWxnuaAp1xyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLnNldERlZmF1bHQgPSBmdW5jdGlvbiAodHlwZSwgY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIGNvbnN0YW50ID0gUVRvcG8uY29uc3RhbnQ7XHJcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnQubm9kZS5JTUFHRTpcclxuICAgICAgICAgICAgICAgIE5vZGUuSW1hZ2Uuc2V0RGVmYXVsdChjb25maWcpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnQubm9kZS5URVhUOlxyXG4gICAgICAgICAgICAgICAgTm9kZS5UZXh0LnNldERlZmF1bHQoY29uZmlnKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50LmxpbmsuRElSRUNUOlxyXG4gICAgICAgICAgICAgICAgTGluay5EaXJlY3Quc2V0RGVmYXVsdChjb25maWcpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnQubGluay5DVVJWRTpcclxuICAgICAgICAgICAgICAgIExpbmsuQ3VydmUuc2V0RGVmYXVsdChjb25maWcpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnQubGluay5GTEVYSU9OQUw6XHJcbiAgICAgICAgICAgICAgICBMaW5rLkZsZXhpb25hbC5zZXREZWZhdWx0KGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5saW5rLkZPTEQ6XHJcbiAgICAgICAgICAgICAgICBMaW5rLkZvbGQuc2V0RGVmYXVsdChjb25maWcpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnQubGluZS5ESVJFQ1Q6XHJcbiAgICAgICAgICAgICAgICBMaW5lLkRpcmVjdC5zZXREZWZhdWx0KGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5jb250YWluZXIuR1JPVVA6XHJcbiAgICAgICAgICAgICAgICBDb250YWluZXIuR3JvdXAuc2V0RGVmYXVsdChjb25maWcpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogIOiOt+WPluWbvuWxguS4reWFg+e0oOWFqOWxgOagt+W8j1xyXG4gKiAgQG1ldGhvZCBnZXREZWZhdWx0XHJcbiAqICBAcGFyYW0gdHlwZSB7c3RyaW5nfSDopoHphY3nva7nmoTlhYPntKDnsbvlnosg5L6L77yaUVRvcG8uY29uc3RhbnQubm9kZS5JTUFHRVxyXG4gKiAgQHJldHVybiB7b2JqZWN0fSDmoLflvI/lsZ7mgKfvvIzlj6/lj4LogIPlr7nlupTnmoTlhYPntKBhdHRy5bGe5oCnXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuZ2V0RGVmYXVsdCA9IGZ1bmN0aW9uICh0eXBlKSB7XHJcbiAgICBpZiAodHlwZSkge1xyXG4gICAgICAgIHZhciByZXN1bHQ7XHJcbiAgICAgICAgdmFyIGNvbnN0YW50ID0gUVRvcG8uY29uc3RhbnQ7XHJcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnQubm9kZS5JTUFHRTpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IE5vZGUuSW1hZ2UuZ2V0RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnQubm9kZS5URVhUOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gTm9kZS5UZXh0LmdldERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50LmxpbmsuRElSRUNUOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gTGluay5EaXJlY3QuZ2V0RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnQubGluay5DVVJWRTpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IExpbmsuQ3VydmUuZ2V0RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnQubGluay5GTEVYSU9OQUw6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBMaW5rLkZsZXhpb25hbC5nZXREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5saW5rLkZPTEQ6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBMaW5rLkZvbGQuZ2V0RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnQubGluZS5ESVJFQ1Q6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBMaW5lLkRpcmVjdC5nZXREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5jb250YWluZXIuR1JPVVA6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBDb250YWluZXIuR3JvdXAuZ2V0RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5Zu+5bGC6IOM5pmv5Zu+54mH77yM5LiOc2V0QmFja2dyb3VuZENvbG9y5Yay56qBXHJcbiAqICBAbWV0aG9kIHNldEJhY2tncm91bmRJbWFnZVxyXG4gKiAgQHBhcmFtIGltYWdlIHtzdHJpbmd9IOWbvueJh3VybFxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLnNldEJhY2tncm91bmRJbWFnZSA9IGZ1bmN0aW9uIChpbWFnZSkge1xyXG4gICAgdGhpcy5qdG9wby5iYWNrZ3JvdW5kID0gaW1hZ2U7XHJcbiAgICB0aGlzLmF0dHIuYmFja2dyb3VuZCA9IGltYWdlO1xyXG59O1xyXG4vKipcclxuICogIOiuvue9ruWbvuWxguiDjOaZr+minOiJsu+8jOS4jnNldEJhY2tncm91bmRJbWFnZeWGsueqgVxyXG4gKiAgQG1ldGhvZCBzZXRCYWNrZ3JvdW5kQ29sb3JcclxuICogIEBwYXJhbSBjb2xvciB7c3RyaW5nfSAjeHh4eHh4LzI1NSwyNTUsMjU1XHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuc2V0QmFja2dyb3VuZENvbG9yID0gZnVuY3Rpb24gKGNvbG9yKSB7XHJcbiAgICB0aGlzLmp0b3BvLmJhY2tncm91bmRDb2xvciA9IFFUb3BvLnV0aWwudHJhbnNIZXgoY29sb3IpO1xyXG4gICAgdGhpcy5qdG9wby5hbHBoYSA9IDE7XHJcbiAgICB0aGlzLmF0dHIuYmFja2dyb3VuZCA9IHRoaXMuanRvcG8uYmFja2dyb3VuZENvbG9yO1xyXG59O1xyXG4vKipcclxuICogIOiuvue9ruWbvuWxguaooeW8j1xyXG4gKiAgQG1ldGhvZCBzZXRNb2RlXHJcbiAqICBAcGFyYW0gbW9kZSB7c3RyaW5nfSDkvos6UVRvcG8uY29uc3RhbnQubW9kZS5OT1JNQUxcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5zZXRNb2RlID0gZnVuY3Rpb24gKG1vZGUpIHtcclxuICAgIGlmIChbXCJub3JtYWxcIiwgXCJlZGl0XCIsIFwiZHJhZ1wiLCBcInNlbGVjdFwiXS5pbmRleE9mKG1vZGUpID4gLTEpIHtcclxuICAgICAgICB0aGlzLmF0dHIubW9kZSA9IG1vZGU7XHJcbiAgICAgICAgdGhpcy5qdG9wby5tb2RlID0gbW9kZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcInNldCB3cm9uZyBtb2RlIDpcIiwgbW9kZSk7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg5Zu+5bGC5riF56m677yM5riF6Zmk5Zu+5bGC5YaF5omA5pyJ5YWD57SgXHJcbiAqICBAbWV0aG9kIGNsZWFyXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBRVG9wby51dGlsLmluZm8oXCJzY2VuZSBjbGVhclwiKTtcclxuICAgIHRoaXMuY2hpbGRyZW4gPSB7XHJcbiAgICAgICAgbm9kZTogW10sXHJcbiAgICAgICAgbGluazogW10sXHJcbiAgICAgICAgY29udGFpbmVyOiBbXSxcclxuICAgICAgICBsaW5lOiBbXVxyXG4gICAgfTtcclxuICAgIHRoaXMuanRvcG8uY2xlYXIoKTtcclxufTtcclxuLyoqXHJcbiAqICDojrflj5bnsbvlnovvvIzluLjnlKjlnKjlj7PplK7oj5zljZXkuIrlr7nop6blj5Hlr7nosaHnmoTor4bliKtcclxuICogIEBtZXRob2QgZ2V0VHlwZVxyXG4gKiAgQHJldHVybiBRVG9wby5jb25zdGFudC5TQ0VORVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gUVRvcG8uY29uc3RhbnQuU0NFTkU7XHJcbn07XHJcbi8qKlxyXG4gKiAg6I635Y+W5L2/55So57G75Z6L77yM5bi455So5Zyo5Y+z6ZSu6I+c5Y2V5LiK5a+56Kem5Y+R5a+56LGh55qE6K+G5YirXHJcbiAqICBAbWV0aG9kIGdldFVzZVR5cGVcclxuICogIEByZXR1cm4gUVRvcG8uY29uc3RhbnQuU0NFTkVcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5nZXRVc2VUeXBlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIFFUb3BvLmNvbnN0YW50LlNDRU5FO1xyXG59O1xyXG4vKipcclxuICogIOe7keWumuS6i+S7tu+8jOWPr+eUqG9mZuWIoOmZpOWvueW6lOS6i+S7tlxyXG4gKiAgQG1ldGhvZCBvblxyXG4gKiAgQHBhcmFtIG5hbWUge3N0cmluZ30g5LqL5Lu25ZCNXHJcbiAqXHJcbiAqICBjbGljayxkYmNsaWNrLG1vdXNlZG93bixtb3VzZXVwLG1vdXNlb3Zlcixtb3VzZW91dCxtb3VzZW1vdmUsbW91c2VkcmFnLG1vdXNld2hlZWwsdG91Y2hzdGFydCx0b3VjaG1vdmUsdG91Y2hlbmQsa2V5ZG93bixrZXl1cFxyXG4gKlxyXG4gKiAgQHBhcmFtIGZuIHtmdW5jdGlvbn0g5aSE55CG5Ye95pWwXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUub24gPSBmdW5jdGlvbiAobmFtZSwgZm4pIHtcclxuICAgIHRoaXMuanRvcG8uYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBmbik7XHJcbn07XHJcbi8qKlxyXG4gKiAg5Yig6Zmk5LqL5Lu277yM5Y+v5Yig6Zmkb27nu5HlrprnmoTkuovku7ZcclxuICogIEBtZXRob2Qgb2ZmXHJcbiAqICBAcGFyYW0gbmFtZSB7c3RyaW5nfSDkuovku7blkI1cclxuICpcclxuICogIGNsaWNrLGRiY2xpY2ssbW91c2Vkb3duLG1vdXNldXAsbW91c2VvdmVyLG1vdXNlb3V0LG1vdXNlbW92ZSxtb3VzZWRyYWcsbW91c2V3aGVlbCx0b3VjaHN0YXJ0LHRvdWNobW92ZSx0b3VjaGVuZCxrZXlkb3duLGtleXVwXHJcbiAqXHJcbiAqICBAcGFyYW0gW2ZuXXtmdW5jdGlvbn0g5aSE55CG55qE5Ye95pWw5a+56LGh77yM6Iul5peg5Y+C5YiZ5Yig6Zmk6K+l5LqL5Lu25LiL5omA5pyJ5Ye95pWwXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24gKG5hbWUsIGZuKSB7XHJcbiAgICB0aGlzLmp0b3BvLnJlbW92ZUV2ZW50TGlzdGVuZXIobmFtZSwgZm4pO1xyXG59O1xyXG4vKipcclxuICogIOagueaNruaQnOe0ouW9k+WJjeWbvuWxgu+8jOafpeaJvuWfuuacrOWxnuaAp+aIlumineWkluWxnuaAp+a7oei2s+adoeS7tueahOWFg+e0oFxyXG4gKiAgQG1ldGhvZCBmaW5kXHJcbiAqICBAcGFyYW0gc2NhbiB7c3RyaW5nfSDmn6Xor6LmnaHku7Ys5qC85byP5Li6XCJrZXk9dmFsdWUsa2V5PXZhbHVlXCIs5aSa5Liq5p2h5Lu255SoLOWIhuWJslxyXG4gKiAgQHBhcmFtIFt0eXBlXSB7c3RyaW5nfSDlj6/mjIflrprlhYPntKDnsbvlnovnsr7noa7mn6Xmib5cclxuICogIEByZXR1cm4ge2FycmF5fSDov5Tlm57mlbDnu4TvvIzmlbDnu4TmiJDlkZjkuLrmu6HotrPoh7PlsJHkuIDkuKrmnaHku7bnmoTlhYPntKBcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKHNjYW4sIHR5cGUpIHtcclxuICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47XHJcbiAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICB2YXIgY29uZGl0aW9uID0gdHlwZW9mIHNjYW4gPT0gXCJzdHJpbmdcIiA/IHNjYW4uc3BsaXQoXCIsXCIpIDogW107XHJcbiAgICBpZiAoY29uZGl0aW9uLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAkLmVhY2goY29uZGl0aW9uLCBmdW5jdGlvbiAoaSwgdGVtcCkge1xyXG4gICAgICAgICAgICB0ZW1wID0gdGVtcC5zcGxpdChcIj1cIik7XHJcbiAgICAgICAgICAgIGlmICh0ZW1wLmxlbmd0aCA+PSAyKSB7XHJcbiAgICAgICAgICAgICAgICAvL+WItuWumuS6huexu+Wei++8jOe8qeWwj+afpeaJvuiMg+WbtO+8jOacquaMh+WumuWImeWFqOmDqOmBjeWOhlxyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm5vZGVcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYW5BcnIoY2hpbGRyZW4ubm9kZSwgdGVtcFswXSwgdGVtcFsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImxpbmtcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYW5BcnIoY2hpbGRyZW4ubGluaywgdGVtcFswXSwgdGVtcFsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImNvbnRhaW5lclwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbkFycihjaGlsZHJlbi5jb250YWluZXIsIHRlbXBbMF0sIHRlbXBbMV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJsaW5lXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FuQXJyKGNoaWxkcmVuLmxpbmUsIHRlbXBbMF0sIHRlbXBbMV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkLmVhY2goY2hpbGRyZW4sIGZ1bmN0aW9uIChqLCBhcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbkFycihhcnIsIHRlbXBbMF0sIHRlbXBbMV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgLy/miavmj4/mlbDnu4TkuK3lr7nosaHlr7nlupTnmoTlsZ7mgKfmmK/lkKbnm7jnrYlcclxuICAgIGZ1bmN0aW9uIHNjYW5BcnIoYXJyLCBrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgJC5lYWNoKGFyciwgZnVuY3Rpb24gKGksIGl0ZW0pIHtcclxuICAgICAgICAgICAgLy/lj6rmiavmj4/lr7nosaHnmoRhdHRy5ZKMZXh0cmHkuK3nmoTlsZ7mgKdcclxuICAgICAgICAgICAgaWYgKGVxdWFsKGl0ZW0uZXh0cmEsIGtleSwgdmFsdWUpIHx8IGVxdWFsKGl0ZW0uYXR0ciwga2V5LCB2YWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgIC8v5o6S6Zmk6YeN5aSN55qEXHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmluZGV4T2YoaXRlbSkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGVxdWFsKG9iamVjdCwga2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiBvYmplY3QgJiYgb2JqZWN0W2tleV0gJiYgb2JqZWN0W2tleV0gPT0gdmFsdWU7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg6I635Y+W5b2T5YmN5Zu+5bGC5Zyo5q2j5bi46KeG6KeS5LiLKOacquaUvuWkp+e8qeWwjynmnIDlt6bkuIrop5LnmoTlnZDmoIdcclxuICogIEBtZXRob2QgZ2V0T3JpZ2luXHJcbiAqICBAcmV0dXJuIHtvYmplY3R9IOWMheWQqyB4LHnlsZ7mgKdcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5nZXRPcmlnaW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHg6IDAgLSB0aGlzLmp0b3BvLnRyYW5zbGF0ZVgsXHJcbiAgICAgICAgeTogMCAtIHRoaXMuanRvcG8udHJhbnNsYXRlWVxyXG4gICAgfVxyXG59O1xyXG4vLy1cclxuZnVuY3Rpb24gYWRkSlRvcG8oZWxlbWVudCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB0aGlzLmp0b3BvLmFkZChlbGVtZW50Lmp0b3BvKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiSW4gU2NlbmUsIGp0b3BvIGFkZCBlcnJvciA6IFwiLCBlKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiByZW1vdmVKVG9wbyhlbGVtZW50KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHRoaXMuanRvcG8ucmVtb3ZlKGVsZW1lbnQuanRvcG8pO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJJbiBTY2VuZSwganRvcG8gcmVtb3ZlIGVycm9yIDogXCIsIGUpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiAg5qC55o2u6YWN572u5Zyo5b2T5YmN5Zu+5bGC5LiK57uY5Yi26IqC54K5XHJcbiAqICBAbWV0aG9kIGNyZWF0ZU5vZGVcclxuICogIEBwYXJhbSBbY29uZmlnXSB7b2JqZWN0fVxyXG4gKlxyXG4gKiAg5peg5Y+C5YiZ5qC55o2u5YWo5bGA6YWN572u57uY5Yi2UVRvcG8uY29uc3RhbnQubm9kZS5JTUFHReWvueW6lOeahOiKgueCuSxcclxuICpcclxuICogIGNvbmZpZy50eXBl5Y+v5oyH5a6a57uY5Yi26IqC54K557G75Z6LXHJcbiAqXHJcbiAqICDlj4LogINRVG9wby5jb250YW50Lm5vZGXpgInmi6nlj6/nu5jliLbnmoTnp43nsbtcclxuICogIEByZXR1cm4ge05vZGV8Ym9vbGVhbn0g5Yib5bu65oiQ5Yqf6L+U5Zue6IqC54K55a+56LGh77yM5aSx6LSl6L+U5ZueZmFsc2VcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5jcmVhdGVOb2RlID0gZnVuY3Rpb24gKGNvbmZpZykge1xyXG4gICAgdmFyIG5ld05vZGU7XHJcbiAgICB2YXIgY29uc3RhbnQgPSBRVG9wby5jb25zdGFudC5ub2RlO1xyXG4gICAgY29uZmlnID0gY29uZmlnIHx8IHt9O1xyXG4gICAgc3dpdGNoIChjb25maWcudHlwZSkge1xyXG4gICAgICAgIGNhc2UgY29uc3RhbnQuVEVYVDpcclxuICAgICAgICAgICAgbmV3Tm9kZSA9IG5ldyBOb2RlLlRleHQuY29uc3RydWN0b3IoY29uZmlnKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBjb25zdGFudC5TSEFQRTpcclxuICAgICAgICAgICAgbmV3Tm9kZSA9IG5ldyBOb2RlLlNoYXBlLmNvbnN0cnVjdG9yKGNvbmZpZyk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIG5ld05vZGUgPSBuZXcgTm9kZS5JbWFnZS5jb25zdHJ1Y3Rvcihjb25maWcpO1xyXG4gICAgfVxyXG4gICAgaWYgKG5ld05vZGUgJiYgbmV3Tm9kZS5qdG9wbykge1xyXG4gICAgICAgIGFkZEpUb3BvLmNhbGwodGhpcywgbmV3Tm9kZSk7XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5ub2RlLnB1c2gobmV3Tm9kZSk7XHJcbiAgICAgICAgcmV0dXJuIG5ld05vZGU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJjcmVhdGUgTm9kZSBlcnJvclwiLCBjb25maWcpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqICDmoLnmja7phY3nva7lnKjkuKTkuKrlhYPntKDkuYvpl7Tnu5jliLbmlrDnmoTpk77mjqVcclxuICogIEBtZXRob2QgY3JlYXRlTGlua1xyXG4gKiAgQHBhcmFtIFtjb25maWddIHtvYmplY3R9XHJcbiAqICDml6Dlj4LliJnmoLnmja7lhajlsYDphY3nva7nu5jliLZRVG9wby5jb25zdGFudC5saW5rLkRJUkVDVOWvueW6lOeahOmTvuaOpSxcclxuICpcclxuICogIGNvbmZpZy50eXBl5Y+v5oyH5a6a57uY5Yi26ZO+5o6l57G75Z6LXHJcbiAqXHJcbiAqICDlj4LogINRVG9wby5jb250YW50LmxpbmvpgInmi6nlj6/nu5jliLbnmoTnp43nsbtcclxuICogIEByZXR1cm4ge0xpbmt8Ym9vbGVhbn0g5Yib5bu65oiQ5Yqf6L+U5Zue6ZO+5o6l5a+56LGh77yM5aSx6LSl6L+U5ZueZmFsc2VcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5jcmVhdGVMaW5rID0gZnVuY3Rpb24gKGNvbmZpZykge1xyXG4gICAgdmFyIG5ld0xpbms7XHJcbiAgICB2YXIgY29uc3RhbnQgPSBRVG9wby5jb25zdGFudC5saW5rO1xyXG4gICAgY29uZmlnID0gY29uZmlnIHx8IHt9O1xyXG4gICAgc3dpdGNoIChjb25maWcudHlwZSkge1xyXG4gICAgICAgIGNhc2UgY29uc3RhbnQuQ1VSVkU6XHJcbiAgICAgICAgICAgIG5ld0xpbmsgPSBuZXcgTGluay5DdXJ2ZS5jb25zdHJ1Y3Rvcihjb25maWcpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIGNvbnN0YW50LkZMRVhJT05BTDpcclxuICAgICAgICAgICAgbmV3TGluayA9IG5ldyBMaW5rLkZsZXhpb25hbC5jb25zdHJ1Y3Rvcihjb25maWcpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIGNvbnN0YW50LkZPTEQ6XHJcbiAgICAgICAgICAgIG5ld0xpbmsgPSBuZXcgTGluay5Gb2xkLmNvbnN0cnVjdG9yKGNvbmZpZyk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIG5ld0xpbmsgPSBuZXcgTGluay5EaXJlY3QuY29uc3RydWN0b3IoY29uZmlnKTtcclxuICAgIH1cclxuICAgIGlmIChuZXdMaW5rICYmIG5ld0xpbmsuanRvcG8pIHtcclxuICAgICAgICBhZGRKVG9wby5jYWxsKHRoaXMsIG5ld0xpbmspO1xyXG4gICAgICAgIHRoaXMuY2hpbGRyZW4ubGluay5wdXNoKG5ld0xpbmspO1xyXG4gICAgICAgIHJldHVybiBuZXdMaW5rO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiY3JlYXRlIExpbmsgZXJyb3JcIiwgY29uZmlnKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn07XHJcbi8vLS1cclxuLyoqXHJcbiAqICDmoLnmja7phY3nva7lnKjkuKTkuKrlhYPntKDkuYvpl7TliJvlu7rpk77mjqUs6Iul5Lik5YWD57Sg5bey5pyJ6ZO+5o6l5YiZ5Y6f6ZO+5o6l6K6h5pWw5LiK5YqgMSxcclxuICogIOWPr+aTjeS9nOS6juacieWxleW8gOWKn+iDveeahOmTvuaOpeS4iu+8jOWPr+iHqumAguW6lOmAieaLqea3u+WKoOaWsOmTvuaOpeaIluiuoeaVsCsxXHJcbiAqICBAbWV0aG9kIGFkZExpbmtcclxuICogIEBwYXJhbSBjb25maWcge29iamVjdH0g5Yib5bu65paw6ZO+5o6l5pe25omA5L6d6LWW55qE6YWN572u77yM5Y+v5Y+C6ICDY3JlYXRlTGlua+WHveaVsFxyXG4gKiAgQHBhcmFtIFtmbl0ge2Z1bmN0aW9ufSDliKTmlq3kuKTlhYPntKDpl7Tml6Dpk77mjqXml7bnmoTlj6/pgInmk43kvZzvvIzoi6Xml6DliJnosIPnlKhjcmVhdGVMaW5r5Ye95pWw5bu656uL6ZO+5o6lXHJcbiAqICBAcmV0dXJuIHtMaW5rfGJvb2xlYW59IOWIm+W7uuaIkOWKn+i/lOWbnumTvuaOpeWvueixoe+8jOWksei0pei/lOWbnmZhbHNlXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuYWRkTGluayA9IGZ1bmN0aW9uIChjb25maWcsIGZuKSB7XHJcbiAgICBpZiAoY29uZmlnICYmIGNvbmZpZy5zdGFydCAmJiBjb25maWcuZW5kKSB7XHJcbiAgICAgICAgdmFyIGxpbmtzID0gdGhpcy5saW5rc0JldHdlZW4oY29uZmlnLnN0YXJ0LCBjb25maWcuZW5kKTsvL+aMiW51bWJlcuWxnuaAp+S7juWkp+WIsOWwj+aOkuWIl1xyXG4gICAgICAgIGlmIChsaW5rcy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICBpZiAoJC5pc0Z1bmN0aW9uKGZuKSkge1xyXG4gICAgICAgICAgICAgICAgZm4oKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUxpbmsoY29uZmlnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8v5Lik54K55LmL6Ze06L+e57q/5Li6MeWImeiupOS4uuaYr+W3suaciemTvuaOpe+8jOi2hei/hzHliJnorqTkuLrmmK/lj6/ku6XlsZXlvIDkuJTlt7Lnu4/lsZXlvIDnmoTnm7Tnur9cclxuICAgICAgICAgICAgdmFyIG51bWJlciA9IDE7XHJcbiAgICAgICAgICAgIGlmICgkLmlzTnVtZXJpYyhjb25maWcubnVtYmVyKSkge1xyXG4gICAgICAgICAgICAgICAgbnVtYmVyID0gcGFyc2VJbnQoY29uZmlnLm51bWJlcik7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVtYmVyIDwgMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG51bWJlciA9IDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGxpbmtzLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICBsaW5rc1swXS5zZXQoe1xyXG4gICAgICAgICAgICAgICAgICAgIG51bWJlcjogbGlua3NbMF0uYXR0ci5udW1iZXIgKyBudW1iZXJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpbmtzWzBdO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmtzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBsaW5rc1swXS5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50LmF0dHIubnVtYmVyICs9IG51bWJlcjtcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQuYWRkQ2hpbGQobnVtYmVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBwYXJlbnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKlxyXG4gKiAg6I635Y+W5Lik5YWD57Sg5LmL6Ze05omA5pyJ55qE6ZO+5o6lXHJcbiAqICBAbWV0aG9kIGxpbmtzQmV0d2VlblxyXG4gKiAgQHBhcmFtIHN0YXJ0IHtlbGVtZW50fSDlhYPntKDvvIzotbflp4vml6DlhbNcclxuICogIEBwYXJhbSBlbmQge2VsZW1lbnR9IOWFg+e0oO+8jOi1t+Wni+aXoOWFs1xyXG4gKiAgQHJldHVybiB7YXJyYXl9IOWFg+e0oOmXtOeahOmTvuaOpembhuWQiO+8jOaMiemTvuaOpeeahOiuoeaVsOWPs+Wkp+WIsOWwj+aOkuWIl1xyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmxpbmtzQmV0d2VlbiA9IGZ1bmN0aW9uIChzdGFydCwgZW5kKSB7XHJcbiAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICB2YXIgbGlua3MgPSBzdGFydC5saW5rcztcclxuICAgIC8v5qOA5rWL5Lik5YWD57Sg6Ze055qE6L+e57q/5piv5ZCm5bey5pyJXHJcbiAgICBpZiAoJC5pc0FycmF5KGxpbmtzLm91dCkpIHtcclxuICAgICAgICAkLmVhY2gobGlua3Mub3V0LCBmdW5jdGlvbiAoaSwgbGlua091dCkge1xyXG4gICAgICAgICAgICBpZiAobGlua091dC5wYXRoLmVuZCA9PSBlbmQpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGxpbmtPdXQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAoJC5pc0FycmF5KGxpbmtzLmluKSkge1xyXG4gICAgICAgICQuZWFjaChsaW5rcy5pbiwgZnVuY3Rpb24gKGosIGxpbmtJbikge1xyXG4gICAgICAgICAgICBpZiAobGlua0luLnBhdGguc3RhcnQgPT0gZW5kKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChsaW5rSW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICByZXR1cm4gYi5hdHRyLm51bWJlciAtIGEuYXR0ci5udW1iZXI7XHJcbiAgICB9KTtcclxufTtcclxuLy8tLVxyXG4vKipcclxuICpcclxuICogIOWcqOWbvuWxguS4iue7mOWItuS4jeWPr+S7peenu+WKqOeahOe6v+WFg+e0oFxyXG4gKiAgQG1ldGhvZCBjcmVhdGVMaW5lXHJcbiAqICBAcGFyYW0gW2NvbmZpZ10ge29iamVjdH0g6YWN572u5Y+C5pWwLOiLpeaXoOWImeaMieWFqOWxgOmFjee9ruWIm+W7ulxyXG4gKiAgQHJldHVybiB7TGluZXxib29sZWFufSDliJvlu7rmiJDlip/ov5Tlm57nur/lhYPntKDvvIzlpLHotKXov5Tlm55mYWxzZVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmNyZWF0ZUxpbmUgPSBmdW5jdGlvbiAoY29uZmlnKSB7XHJcbiAgICB2YXIgbmV3TGluZTtcclxuICAgIHZhciBjb25zdGFudCA9IFFUb3BvLmNvbnN0YW50LmxpbmU7XHJcbiAgICBjb25maWcgPSBjb25maWcgfHwge307XHJcbiAgICBzd2l0Y2ggKGNvbmZpZy50eXBlKSB7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgbmV3TGluZSA9IG5ldyBMaW5lLkRpcmVjdC5jb25zdHJ1Y3Rvcihjb25maWcpO1xyXG4gICAgfVxyXG4gICAgaWYgKG5ld0xpbmUgJiYgbmV3TGluZS5qdG9wbykge1xyXG4gICAgICAgIGFkZEpUb3BvLmNhbGwodGhpcywgbmV3TGluZSk7XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5saW5lLnB1c2gobmV3TGluZSk7XHJcbiAgICAgICAgcmV0dXJuIG5ld0xpbmU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJjcmVhdGUgTGluayBlcnJvclwiLCBjb25maWcpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufTtcclxuLy8tLVxyXG4vKipcclxuICpcclxuICogIOWcqOWbvuWxguS4iue7mOWItuWIhue7hOWFg+e0oFxyXG4gKiAgQG1ldGhvZCBjcmVhdGVDb250YWluZXJcclxuICogIEBwYXJhbSBbY29uZmlnXSB7b2JqZWN0fSDphY3nva7lj4LmlbAs6Iul5peg5YiZ5oyJ5YWo5bGA6YWN572u5Yib5bu6XHJcbiAqICBAcmV0dXJuIHtjb250YWluZXJ8Ym9vbGVhbn0g5Yib5bu65oiQ5Yqf6L+U5Zue57q/5YWD57Sg77yM5aSx6LSl6L+U5ZueZmFsc2VcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5jcmVhdGVDb250YWluZXIgPSBmdW5jdGlvbiAoY29uZmlnKSB7XHJcbiAgICB2YXIgbmV3Q29udGFpbmVyO1xyXG4gICAgdmFyIGNvbnN0YW50ID0gUVRvcG8uY29uc3RhbnQuY29udGFpbmVyO1xyXG4gICAgY29uZmlnID0gY29uZmlnIHx8IHt9O1xyXG4gICAgc3dpdGNoIChjb25maWcudHlwZSkge1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIG5ld0NvbnRhaW5lciA9IG5ldyBDb250YWluZXIuR3JvdXAuY29uc3RydWN0b3IoY29uZmlnKTtcclxuICAgIH1cclxuICAgIGlmIChuZXdDb250YWluZXIgJiYgbmV3Q29udGFpbmVyLmp0b3BvKSB7XHJcbiAgICAgICAgLy/liIbnu4Tlj6rliqDlhaXlhbbmnKzouqvvvIzliIfmjaLoioLngrnkuI3kvZzmlbBcclxuICAgICAgICB2YXIgbm9kZUNvbmZpZyA9IHt9O1xyXG4gICAgICAgIGlmIChjb25maWcudG9nZ2xlKSB7XHJcbiAgICAgICAgICAgIG5vZGVDb25maWcgPSBjb25maWcudG9nZ2xlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v5Y+v6YCJ56aB55So5YiG57uE5YiH5o2iXHJcbiAgICAgICAgaWYgKCEoY29uZmlnLnRvZ2dsZSAmJiB0eXBlb2YgY29uZmlnLnRvZ2dsZS5jbG9zZSA9PSBcImJvb2xlYW5cIiAmJiBjb25maWcudG9nZ2xlLmNsb3NlKSkge1xyXG4gICAgICAgICAgICBhZGRUb2dnbGUodGhpcywgbmV3Q29udGFpbmVyLCBub2RlQ29uZmlnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5jb250YWluZXIucHVzaChuZXdDb250YWluZXIpO1xyXG4gICAgICAgIGFkZEpUb3BvLmNhbGwodGhpcywgbmV3Q29udGFpbmVyKTtcclxuICAgICAgICByZXR1cm4gbmV3Q29udGFpbmVyO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiY3JlYXRlIENvbnRhaW5lciBlcnJvclwiLCBjb25maWcpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gYWRkVG9nZ2xlKHNjZW5lLCBjb250YWluZXIsIGNvbmZpZ1RvZ2dsZSkge1xyXG4gICAgY29uZmlnVG9nZ2xlLnVzZVR5cGUgPSBRVG9wby5jb25zdGFudC5DQVNVQUw7Ly/moIforrDnlKjpgJRcclxuICAgIGNvbnRhaW5lci50b2dnbGVUbyA9IG5ldyBOb2RlLkltYWdlLmNvbnN0cnVjdG9yKGNvbmZpZ1RvZ2dsZSk7XHJcbiAgICBjb250YWluZXIudG9nZ2xlVG8udG9nZ2xlVG8gPSBjb250YWluZXI7Ly/kupLnm7jntKLlvJVcclxuICAgIGNvbnRhaW5lci50b2dnbGVUby5oaWRlKCk7Ly/liJ3lp4vpmpDol49cclxuICAgIGFkZEpUb3BvLmNhbGwoc2NlbmUsIGNvbnRhaW5lci50b2dnbGVUbyk7Ly/liqDlhaXnlLvluINcclxufVxyXG4vLy0tXHJcbi8vLVxyXG4vKipcclxuICpcclxuICogIOWIoOmZpOWbvuWxguWGheWFg+e0oCzlhYPntKDliKDpmaTlhbbkuIrnmoTpk77mjqXkuZ/kvJrliKDpmaTlkozmm7TmlrBcclxuICogIEBtZXRob2QgcmVtb3ZlXHJcbiAqICBAcGFyYW0gZWxlbWVudCB7ZWxlbWVudH1cclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgaWYgKGVsZW1lbnQpIHtcclxuICAgICAgICBpZiAoJC5pc0FycmF5KGVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgICQuZWFjaChlbGVtZW50LCBmdW5jdGlvbiAoaSwgaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlT25jZShpdGVtKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVtb3ZlT25jZShlbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlT25jZShvbmVFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChvbmVFbGVtZW50Lmp0b3BvKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9uZUVsZW1lbnQuZ2V0VHlwZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBRVG9wby5jb25zdGFudC5OT0RFOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoUVRvcG8udXRpbC5hcnJheURlbGV0ZShzZWxmLmNoaWxkcmVuLm5vZGUsIG9uZUVsZW1lbnQpIHx8IG9uZUVsZW1lbnQuZ2V0VXNlVHlwZSgpID09IFFUb3BvLmNvbnN0YW50LkNBU1VBTCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlTm9kZS5jYWxsKHNlbGYsIG9uZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgUVRvcG8uY29uc3RhbnQuTElOSzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFFUb3BvLnV0aWwuYXJyYXlEZWxldGUoc2VsZi5jaGlsZHJlbi5saW5rLCBvbmVFbGVtZW50KSB8fCBvbmVFbGVtZW50LmdldFVzZVR5cGUoKSA9PSBRVG9wby5jb25zdGFudC5DQVNVQUwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUxpbmsuY2FsbChzZWxmLCBvbmVFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFFUb3BvLmNvbnN0YW50LkxJTkU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChRVG9wby51dGlsLmFycmF5RGVsZXRlKHNlbGYuY2hpbGRyZW4ubGluZSwgb25lRWxlbWVudCkgfHwgb25lRWxlbWVudC5nZXRVc2VUeXBlKCkgPT0gUVRvcG8uY29uc3RhbnQuQ0FTVUFMKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVMaW5lLmNhbGwoc2VsZiwgb25lRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBRVG9wby5jb25zdGFudC5DT05UQUlORVI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChRVG9wby51dGlsLmFycmF5RGVsZXRlKHNlbGYuY2hpbGRyZW4uY29udGFpbmVyLCBvbmVFbGVtZW50KSB8fCBvbmVFbGVtZW50LmdldFVzZVR5cGUoKSA9PSBRVG9wby5jb25zdGFudC5DQVNVQUwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUNvbnRhaW5lci5jYWxsKHNlbGYsIG9uZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5mdW5jdGlvbiB1cERhdGFMaW5rcyhlbGVtZW50KSB7XHJcbiAgICB2YXIgbGlua3MgPSBlbGVtZW50LmxpbmtzO1xyXG4gICAgaWYgKGxpbmtzKSB7XHJcbiAgICAgICAgLy/mm7TmlrDlhbbkuIrov57nur/nmoTlj6bkuIDmlrnnmoRsaW5rc+WxnuaAp1xyXG4gICAgICAgIHdoaWxlIChsaW5rcy5pbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlKGxpbmtzLmluLnBvcCgpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgd2hpbGUgKGxpbmtzLm91dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlKGxpbmtzLm91dC5wb3AoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8v57q/5LiK5Yig6Zmk5pe25YCZLOimgeabtOaWsG5vZGXlkoxjb250YWluZXLkuK3nmoRsaW5rc+WxnuaAp1xyXG5mdW5jdGlvbiByZW1vdmVMaW5rKGxpbmspIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5hcnJheURlbGV0ZShsaW5rLnBhdGguc3RhcnQubGlua3Mub3V0LCBsaW5rKTtcclxuICAgICAgICBRVG9wby51dGlsLmFycmF5RGVsZXRlKGxpbmsucGF0aC5lbmQubGlua3MuaW4sIGxpbmspO1xyXG4gICAgICAgIHJlbW92ZUpUb3BvLmNhbGwodGhpcywgbGluayk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcIlNjZW5lIHJlbW92ZUxpbmsgZXJyb3JcIiwgZSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVtb3ZlTGluZShsaW5lKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHJlbW92ZUpUb3BvLmNhbGwodGhpcywgbGluZSk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcIlNjZW5lIHJlbW92ZUxpbmUgZXJyb3JcIiwgZSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVtb3ZlTm9kZShub2RlKSB7XHJcbiAgICAvL+WIt+aWsOS4gOS4i+eOsOacieeahOe6v1xyXG4gICAgdHJ5IHtcclxuICAgICAgICAvL+abtOaWsOWFtuS4iue6v+WPpuS4gOWktOeahGxpbmtz5bGe5oCnXHJcbiAgICAgICAgdXBEYXRhTGlua3MuY2FsbCh0aGlzLCBub2RlKTtcclxuICAgICAgICAvL+imgeabtOaWsOWFtueItueahGNoaWxkcmVu5bGe5oCnLOeItuWIoOmZpOWtkFxyXG4gICAgICAgIGlmIChub2RlLnBhcmVudCAmJiAkLmlzQXJyYXkobm9kZS5wYXJlbnQuY2hpbGRyZW4pKSB7XHJcbiAgICAgICAgICAgIG5vZGUucGFyZW50LnJlbW92ZShub2RlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy/liKDpmaTliIbnu4TliIfmjaLnmoToioLngrnml7blkIzml7bliKDpmaTlhbbliIfmjaLnmoTliIbnu4RcclxuICAgICAgICBpZiAobm9kZS50b2dnbGVUbykge1xyXG4gICAgICAgICAgICAvL+WIhue7hOiLpemakOiXj+S6hizlupTor6XlsZXnpLpcclxuICAgICAgICAgICAgbm9kZS50b2dnbGVUby50b2dnbGUoKTtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmUobm9kZS50b2dnbGVUbyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlbW92ZUpUb3BvLmNhbGwodGhpcywgbm9kZSk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcIlNjZW5lIHJlbW92ZU5vZGUgZXJyb3JcIiwgZSk7XHJcbiAgICB9XHJcbn1cclxuLy/lrrnlmajliKDpmaTml7Ys6KaB5pu05LiO5YW255u46L+e55qE57q/55qE5Y+m5LiA56uv55qEbGlua3PlsZ7mgKcs6KaB5pu05paw5YW25a2Q57G755qEcGFyZW505bGe5oCnXHJcbmZ1bmN0aW9uIHJlbW92ZUNvbnRhaW5lcihjb250YWluZXIpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgLy/liIbnu4Toi6XpmpDol4/kuoYs5bqU6K+l5bGV56S6XHJcbiAgICAgICAgY29udGFpbmVyLnRvZ2dsZSh0cnVlKTtcclxuICAgICAgICAvL+abtOaWsOWFtuS4iue6v+WPpuS4gOWktOeahGxpbmtz5bGe5oCnXHJcbiAgICAgICAgdXBEYXRhTGlua3MuY2FsbCh0aGlzLCBjb250YWluZXIpO1xyXG4gICAgICAgIC8v5pu05paw5a2Q5YWD57Sg55qEUGFyZW505bGe5oCnXHJcbiAgICAgICAgaWYgKCQuaXNBcnJheShjb250YWluZXIuY2hpbGRyZW4pICYmIGNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIuY2hpbGRyZW5baV0ucGFyZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvL+WIoOmZpOWIhue7hOWQjOaXtuWIoOmZpOWFtuWIh+aNouiKgueCuVxyXG4gICAgICAgIGlmIChjb250YWluZXIudG9nZ2xlVG8pIHtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmUoY29udGFpbmVyLnRvZ2dsZVRvKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmVtb3ZlSlRvcG8uY2FsbCh0aGlzLCBjb250YWluZXIpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJTY2VuZSByZW1vdmVDb250YWluZXIgZXJyb3JcIiwgZSk7XHJcbiAgICB9XHJcbn1cclxuLy8tXHJcbi8qKlxyXG4gKlxyXG4gKiAg5Zu+5bGC5L+h5oGv6L2s5YyW5Li6anNvblxyXG4gKiAgQG1ldGhvZCB0b0pzb25cclxuICogIEByZXR1cm4ge29iamVjdH1cclxuICovXHJcblNjZW5lLnByb3RvdHlwZS50b0pzb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIganNvbiA9ICQuZXh0ZW5kKHt9LCB0aGlzLmF0dHIpO1xyXG4gICAganNvbi5leHRyYSA9ICQuZXh0ZW5kKHt9LCB0aGlzLmV4dHJhKTtcclxuICAgIHJldHVybiBqc29uO1xyXG59O1xyXG4vKipcclxuICpcclxuICogIOWIpOaWreWFg+e0oOaYr+WQpuWcqOW9k+WJjeWbvuWxguWGhVxyXG4gKiAgQG1ldGhvZCBpc0NoaWxkcmVuXHJcbiAqICBAcGFyYW0gZWxlbWVudCB7ZWxlbWVudH1cclxuICogIEByZXR1cm4ge2Jvb2xlYW59XHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuaXNDaGlsZHJlbiA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICB2YXIgcmVzdWx0ID0gZmFsc2U7XHJcbiAgICBpZiAoZWxlbWVudC5qdG9wbykge1xyXG4gICAgICAgICQuZWFjaCh0aGlzLmNoaWxkcmVuLCBmdW5jdGlvbiAobmFtZSwgYXJyKSB7XHJcbiAgICAgICAgICAgIGlmIChhcnIuaW5kZXhPZihlbGVtZW50KSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59O1xyXG4vKipcclxuICpcclxuICog5Zu+5bGC57yp5pS+LOWFg+e0oOS4gOWxj+aYvuekulxyXG4gKiAgQG1ldGhvZCBnb0NlbnRlclxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmdvQ2VudGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKHRoaXMuanRvcG8uY2hpbGRzICYmIHRoaXMuanRvcG8uY2hpbGRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICB0aGlzLmp0b3BvLnN0YWdlLmNlbnRlckFuZFpvb20oKTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqXHJcbiAqIOWbvuWxgue8qeaUvlxyXG4gKiAgQG1ldGhvZCByZXNpemVcclxuICogIEBwYXJhbSBzaXplIHtudW1iZXJ9IOagueaNruavlOS+i+aUvuWkp+aIlue8qeWwjyDlj4LmlbDlj68gMC0x57yp5bCPIDEtbuaUvuWkp1xyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uIChzaXplKSB7XHJcbiAgICBpZiAoJC5pc051bWVyaWMoc2l6ZSkpIHtcclxuICAgICAgICB0aGlzLmp0b3BvLnNjYWxlWCA9IHNpemU7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zY2FsZVkgPSBzaXplO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICpcclxuICog5ZCv55SoL+emgeeUqOm8oOagh+e8qeaUvlxyXG4gKiAgQG1ldGhvZCB0b2dnbGVab29tXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUudG9nZ2xlWm9vbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICghdGhpcy5qdG9wby5zdGFnZS53aGVlbFpvb20pIHtcclxuICAgICAgICB0aGlzLmp0b3BvLnN0YWdlLndoZWVsWm9vbSA9IDAuODU7IC8vIOiuvue9rum8oOagh+e8qeaUvuavlOS+i1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmp0b3BvLnN0YWdlLndoZWVsWm9vbSA9IG51bGw7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKlxyXG4gKiDlkK/nlKgv56aB55So6bmw55y8XHJcbiAqICBAbWV0aG9kIHRvZ2dsZUVhZ2xlRXllXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUudG9nZ2xlRWFnbGVFeWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmp0b3BvLnN0YWdlLmVhZ2xlRXllLnZpc2libGUgPSAhdGhpcy5qdG9wby5zdGFnZS5lYWdsZUV5ZS52aXNpYmxlO1xyXG59O1xyXG4vKipcclxuICpcclxuICog6I635Y+W5b2T5YmN5Zu+5bGC55qEcG5n5qC85byP5Zu+54mH5Zyo5paw55qE56qX5Y+j5omT5byAXHJcbiAqICBAbWV0aG9kIGdldFBpY3R1cmVcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5nZXRQaWN0dXJlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgLy9zdGFnZS5zYXZlSW1hZ2VJbmZvKCk7XHJcbiAgICAvL+WcqOaWsOmhtemdouaJk+W8gOWbvueJh1xyXG4gICAgdmFyIGltYWdlID0gdGhpcy5qdG9wby5zdGFnZS5jYW52YXMudG9EYXRhVVJMKFwiaW1hZ2UvcG5nXCIpO1xyXG4gICAgdmFyIHcgPSB3aW5kb3cub3BlbignYWJvdXQ6YmxhbmsnLCAnaW1hZ2UgZnJvbSBjYW52YXMnKTtcclxuICAgIHcuZG9jdW1lbnQud3JpdGUoXCI8aW1nIHNyYz0nXCIgKyBpbWFnZSArIFwiJyBhbHQ9J2Zyb20gY2FudmFzJy8+XCIpO1xyXG4gICAgLy/kuIvovb3lm77niYdcclxuICAgIC8vIGhlcmUgaXMgdGhlIG1vc3QgaW1wb3J0YW50IHBhcnQgYmVjYXVzZSBpZiB5b3UgZG9udCByZXBsYWNlIHlvdSB3aWxsIGdldCBhIERPTSAxOCBleGNlcHRpb24uXHJcbiAgICAvLyB2YXIgaW1hZ2UgPSAgc3RhZ2UuY2FudmFzLnRvRGF0YVVSTChcImltYWdlL3BuZ1wiKS5yZXBsYWNlKFwiaW1hZ2UvcG5nXCIsIFwiaW1hZ2Uvb2N0ZXQtc3RyZWFtO0NvbnRlbnQtRGlzcG9zaXRpb246IGF0dGFjaG1lbnQ7ZmlsZW5hbWU9Zm9vYmFyLnBuZ1wiKTtcclxuICAgIC8vdmFyIGltYWdlID0gc3RhZ2UuY2FudmFzLnRvRGF0YVVSTChcImltYWdlL3BuZ1wiKS5yZXBsYWNlKFwiaW1hZ2UvcG5nXCIsIFwiaW1hZ2Uvb2N0ZXQtc3RyZWFtXCIpO1xyXG4gICAgLy93aW5kb3cubG9jYXRpb24uaHJlZj1pbWFnZTsgLy8gaXQgd2lsbCBzYXZlIGxvY2FsbHlcclxufTtcclxuLyoqXHJcbiAqIOWIh+aNouWFg+e0oOeahOWxguasoVxyXG4gKiBAbWV0aG9kIHRvZ2dsZVpJbmRleFxyXG4gKiBAcGFyYW0gZWxlbWVudCDlvoXmjqfliLblhYPntKBcclxuICogQHBhcmFtIFtmbGFnXSB0cnVl5Li66ZmN5L2OZmFsc2XkuLrmj5DljYfvvIzml6Dlj4LliJnpu5jorqTmj5DljYfvvIzoi6Xlt7Lmj5DljYfliLDmnIDpq5jliJnpmY3oh7PmnIDkvY5cclxuICovXHJcblNjZW5lLnByb3RvdHlwZS50b2dnbGVaSW5kZXggPSBmdW5jdGlvbiAoZWxlbWVudCwgZmxhZykge1xyXG4gICAgaWYgKGVsZW1lbnQpIHtcclxuICAgICAgICB2YXIganRvcG8gPSBlbGVtZW50Lmp0b3BvO1xyXG4gICAgICAgIHZhciBzY2VuZSA9IHRoaXMuanRvcG87XHJcbiAgICAgICAgaWYgKGp0b3BvICYmIHNjZW5lKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXAgPSBzY2VuZS56SW5kZXhNYXBbanRvcG8uekluZGV4XTtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gbWFwLmluZGV4T2YoanRvcG8pO1xyXG4gICAgICAgICAgICB2YXIgdG9kbyA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZmxhZyA9PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgICAgIHRvZG8gPSBmbGFnO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID09IG1hcC5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9kbyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0b2RvKSB7XHJcbiAgICAgICAgICAgICAgICAvL+aPkOWNh+WxguasoVxyXG4gICAgICAgICAgICAgICAgbWFwLnB1c2gobWFwW2luZGV4XSk7XHJcbiAgICAgICAgICAgICAgICBtYXAuc3BsaWNlKGluZGV4LCAxKTtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvL+mZjeS9juWxguasoVxyXG4gICAgICAgICAgICAgICAgbWFwLnNwbGljZSgwLCAwLCBtYXBbaW5kZXhdKTtcclxuICAgICAgICAgICAgICAgIG1hcC5zcGxpY2UoaW5kZXggKyAxLCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxudmFyIHNlbGVjdGVkQ2F0Y2ggPSB7XHJcbiAgICBqdG9wbzogW10sXHJcbiAgICBxdG9wbzogW11cclxufTtcclxuLyoqXHJcbiAqIOiOt+WPluiiq+mAieS4reeahOWFg+e0oFxyXG4gKiBAbWV0aG9kIGdldFNlbGVjdGVkXHJcbiAqIEByZXR1cm4ge2FycmF5fSDov5Tlm57lm77lsYLkuK3ooqvpgInkuK3nmoTlhYPntKBcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5nZXRTZWxlY3RlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBqdG9wbyA9IHRoaXMuanRvcG8uc2VsZWN0ZWRFbGVtZW50cztcclxuICAgIGlmICgkLmlzQXJyYXkoanRvcG8pKSB7XHJcbiAgICAgICAgaWYgKHNlbGVjdGVkQ2F0Y2guanRvcG8gIT0ganRvcG8pIHtcclxuICAgICAgICAgICAgc2VsZWN0ZWRDYXRjaC5qdG9wbyA9IGp0b3BvO1xyXG4gICAgICAgICAgICBzZWxlY3RlZENhdGNoLnF0b3BvID0gW107XHJcbiAgICAgICAgICAgIGp0b3BvLmZvckVhY2goZnVuY3Rpb24gKGVsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZWwucXRvcG8gJiYgZWwucXRvcG8uZ2V0VXNlVHlwZSgpICE9IFFUb3BvLmNvbnN0YW50LkNBU1VBTCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ2F0Y2gucXRvcG8ucHVzaChlbC5xdG9wbyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc2VsZWN0ZWRDYXRjaC5xdG9wbztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICog6auY5Lqu55uu5qCH6ZqQ6JeP5YW25LuWXHJcbiAqIEBtZXRob2QgdG9nZ2xlTGlnaHRcclxuICogQHBhcmFtIFt0YXJnZXRdIOaVsOe7hOaIluWvueixoSzpq5jkuq7lhbbnm7jlhbPlr7nosaEs5peg5Y+C5YiZ5YWo6YOo6auY5LquXHJcbiAqIEBwYXJhbSBbZmxhZ10g6Iul5Li6dHJ1ZeWImeWPqumrmOS6ruS8oOWFpeeahOWvueixoSzkuI3pgInliJnlj6rlr7nkvKDlhaXlr7nosaHnm7jlhbPnmoTlr7nosaHpq5jkuq5cclxuICovXHJcblNjZW5lLnByb3RvdHlwZS50b2dnbGVMaWdodCA9IGZ1bmN0aW9uICh0YXJnZXQsIGZsYWcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdmFyIGFscGhhID0gMTtcclxuICAgICAgICB2YXIgbGlnaHRpbmc7XHJcbiAgICAgICAgaWYgKHRhcmdldCkge1xyXG4gICAgICAgICAgICBhbHBoYSA9IDAuMTtcclxuICAgICAgICAgICAgaWYgKGZsYWcpIHtcclxuICAgICAgICAgICAgICAgIGlmICgkLmlzQXJyYXkodGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxpZ2h0aW5nID0gdGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBsaWdodGluZyA9IFt0YXJnZXRdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheSh0YXJnZXQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlnaHRpbmcgPSBnZXRDb25uZWN0aW9uTGlnaHRpbmdzKHRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGxpZ2h0aW5nID0gZ2V0Q29ubmVjdGlvbkxpZ2h0aW5ncyhbdGFyZ2V0XSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdG90YWxTZXRBbHBoYSh0aGlzLmNoaWxkcmVuLm5vZGUuY29uY2F0KHRoaXMuY2hpbGRyZW4ubGluayksIGFscGhhKTtcclxuICAgICAgICB0b3RhbFNldEFscGhhKGxpZ2h0aW5nLCAxKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwic2NlbmUgdG9nZ2xlTGlnaHQgZXJyb3JcIiwgZSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZXRDb25uZWN0aW9uTGlnaHRpbmdzKGFycikge1xyXG4gICAgICAgIHZhciBsaWdodGluZyA9IFtdO1xyXG4gICAgICAgICQuZWFjaChhcnIsIGZ1bmN0aW9uIChpLCB0YXJnZXQpIHtcclxuICAgICAgICAgICAgaWYgKHRhcmdldC5nZXRUeXBlKCkgPT0gUVRvcG8uY29uc3RhbnQuTk9ERSAmJiB0YXJnZXQuZ2V0VXNlVHlwZSgpICE9IFFUb3BvLmNvbnN0YW50LkNBU1VBTCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gdGFyZ2V0LmxpbmtzO1xyXG4gICAgICAgICAgICAgICAgUVRvcG8udXRpbC5hcnJheVB1c2gobGlnaHRpbmcsIHRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobGlua3MpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJC5pc0FycmF5KGxpbmtzLm91dCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGxpbmtzLm91dCwgZnVuY3Rpb24gKGwsIG91dGxpbmspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFFUb3BvLnV0aWwuYXJyYXlQdXNoKGxpZ2h0aW5nLCBvdXRsaW5rKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFFUb3BvLnV0aWwuYXJyYXlQdXNoKGxpZ2h0aW5nLCBvdXRsaW5rLnBhdGguZW5kKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkLmlzQXJyYXkobGlua3MuaW4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQuZWFjaChsaW5rcy5pbiwgZnVuY3Rpb24gKG4sIGlubGluaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUVRvcG8udXRpbC5hcnJheVB1c2gobGlnaHRpbmcsIGlubGluayk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBRVG9wby51dGlsLmFycmF5UHVzaChsaWdodGluZywgaW5saW5rLnBhdGguc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gbGlnaHRpbmc7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdG90YWxTZXRBbHBoYSh0b3RhbCwgYWxwaGEpIHtcclxuICAgICAgICAvL+WFqOmDqOmakOiXj1xyXG4gICAgICAgIGlmICgkLmlzQXJyYXkodG90YWwpKSB7XHJcbiAgICAgICAgICAgICQuZWFjaCh0b3RhbCwgZnVuY3Rpb24gKGksIGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0KHtcclxuICAgICAgICAgICAgICAgICAgICBhbHBoYTogYWxwaGFcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiDmraPluLjlsLrlr7jlsZXnpLrvvIzlubblsIbop4bop5Lnp7vliqjliLDku6Xlj4LmlbDoioLngrnkuLrkuK3lv4PnmoTkvY3nva5cclxuICogQG1ldGhvZCBtb3ZlVG9Ob2RlXHJcbiAqIEBwYXJhbSBub2RlIOiKgueCueWvueixoVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLm1vdmVUb05vZGUgPSBmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgLy8g5p+l6K+i5Yiw55qE6IqC54K55bGF5Lit5pi+56S6XHJcbiAgICBpZiAodGhpcy5jaGlsZHJlbi5ub2RlLmluZGV4T2Yobm9kZSkgPiAtMSkge1xyXG4gICAgICAgIHZhciBsb2NhdGlvbiA9IG5vZGUuanRvcG8uZ2V0Q2VudGVyTG9jYXRpb24oKTtcclxuICAgICAgICB0aGlzLnJlc2l6ZSgxKTtcclxuICAgICAgICB0aGlzLmp0b3BvLnNldENlbnRlcihsb2NhdGlvbi54LCBsb2NhdGlvbi55KTtcclxuICAgICAgICAvLyDpl6rng4Hlh6DkuItcclxuICAgICAgICBub2RlRmxhc2gobm9kZS5qdG9wbywgNSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBub2RlRmxhc2gobm9kZSwgbnVtKSB7XHJcbiAgICAgICAgaWYgKCQuaXNOdW1lcmljKG51bSkpIHtcclxuICAgICAgICAgICAgaWYgKG51bSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBub2RlLnNlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBub2RlLnNlbGVjdGVkID0gIW5vZGUuc2VsZWN0ZWQ7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlRmxhc2gobm9kZSwgbnVtIC0gMSk7XHJcbiAgICAgICAgICAgICAgICB9LCAzMDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIOiHquWKqOW4g+WxgFxyXG4gKiBAbWV0aG9kIGF1dG9MYXlvdXRcclxuICogQHBhcmFtIGNvbmZpZyDoh6rliqjluIPlsYDphY3nva7lj4LmlbBcclxuICogQGV4YW1wbGVcclxuICogICAgICDlj4LmlbDphY3nva46XHJcbiAqICAgICAgICAgIGNvbmZpZzp7XHJcbiAqICAgICAgICAgICAgICB0eXBlOlxyXG4gKiAgICAgICAgICAgICAgICAgIDEuJ3JvdW5kJyAgIOaXoOmcgOWFtuS7lumFjee9rlxyXG4gKiAgICAgICAgICAgICAgICAgIDIuJ2RlZmF1bHQnIOmcgOmFjee9ruihjOaVsO+8jOWIl+mXtOi3ne+8jOihjOmXtOi3nVxyXG4gKiAgICAgICAgICAgICAgcm93czrooYzmlbBcclxuICogICAgICAgICAgICAgIHJvd1NwYWNlOuihjOmXtOi3nVxyXG4gKiAgICAgICAgICAgICAgY29sdW1uU3BhY2U65YiX6Ze06LedXHJcbiAqICAgICAgICAgIH1cclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5hdXRvTGF5b3V0ID0gZnVuY3Rpb24gKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZyAmJiBjb25maWcudHlwZSkge1xyXG4gICAgICAgIHZhciBuZWVkU29ydCA9IFtdO1xyXG4gICAgICAgIHZhciBqdG9wb3MgPSBbXTtcclxuICAgICAgICB0aGlzLmNoaWxkcmVuLm5vZGUuZm9yRWFjaChmdW5jdGlvbiAodikge1xyXG4gICAgICAgICAgICBpZiAoIXYucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICBuZWVkU29ydC5wdXNoKHYpO1xyXG4gICAgICAgICAgICAgICAganRvcG9zLnB1c2godi5qdG9wbyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBzd2l0Y2ggKGNvbmZpZy50eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgXCJyb3VuZFwiOlxyXG4gICAgICAgICAgICAgICAgbGF5b3V0X3JvdW5kKHRoaXMuanRvcG8sIGp0b3Bvcyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImRlZmF1bHRcIjpcclxuICAgICAgICAgICAgICAgIGxheW91dF9kZWZhdWx0KG5lZWRTb3J0LCBwYXJzZUludChjb25maWcucm93cyksIHBhcnNlSW50KGNvbmZpZy5yb3dTcGFjZSksIHBhcnNlSW50KGNvbmZpZy5jb2x1bW5TcGFjZSksIHRoaXMuZ2V0T3JpZ2luKCkpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5mdW5jdGlvbiBsYXlvdXRfcm91bmQoc2NlbmUsIGp0b3Bvcykge1xyXG4gICAgSlRvcG8ubGF5b3V0LmNpcmNsZUxheW91dE5vZGVzKGp0b3Bvcywge2FuaW1hdGU6IHt0aW1lOiAxMDAwfX0pO1xyXG59XHJcbmZ1bmN0aW9uIGxheW91dF9kZWZhdWx0KGVsZW1lbnRzLCByb3dzLCByb3dTcGFjZSwgY29sdW1uU3BhY2UsIGJlZ2luKSB7XHJcbiAgICBpZiAoJC5pc051bWVyaWMocm93cykpIHtcclxuICAgICAgICByb3dzID0gcGFyc2VJbnQocm93cyk7XHJcbiAgICAgICAgaWYgKHJvd3MgPCAxKSB7XHJcbiAgICAgICAgICAgIHJvd3MgPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkLmVhY2goZWxlbWVudHMuc29ydChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICByZXR1cm4gZ2V0RGVncmVlKGIpIC0gZ2V0RGVncmVlKGEpO1xyXG4gICAgICAgIH0pLCBmdW5jdGlvbiAoaSwgdikge1xyXG4gICAgICAgICAgICAvL3Yuc2V0TG9jYXRpb24oYmVnaW4ueCArIChpICUgcm93cykgKiBjb2x1bW5TcGFjZSwgYmVnaW4ueSk7XHJcbiAgICAgICAgICAgIG1vdmUodiwgYmVnaW4ueCArIChpICUgcm93cykgKiBjb2x1bW5TcGFjZSwgYmVnaW4ueSk7XHJcbiAgICAgICAgICAgIGlmICgoaSArIDEpICUgcm93cyA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBiZWdpbi55ICs9IHJvd1NwYWNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuLy8tLS0tLS0t5bel5YW35Ye95pWwXHJcbi8v6I635Y+W6IqC54K555qE5bqmXHJcbmZ1bmN0aW9uIGdldERlZ3JlZShub2RlKSB7XHJcbiAgICB2YXIgaW5MaW5rcyA9IG5vZGUubGlua3MuaW47XHJcbiAgICB2YXIgb3V0TGlua3MgPSBub2RlLmxpbmtzLm91dDtcclxuICAgIHZhciBkZWdyZWUgPSAwO1xyXG4gICAgaWYgKGluTGlua3MubGVuZ3RoID09IDEpIHtcclxuICAgICAgICBkZWdyZWUgKz0gaW5MaW5rc1swXS5hdHRyLm51bWJlcjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZGVncmVlICs9IGluTGlua3MubGVuZ3RoO1xyXG4gICAgfVxyXG4gICAgaWYgKG91dExpbmtzLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgZGVncmVlICs9IG91dExpbmtzWzBdLmF0dHIubnVtYmVyO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBkZWdyZWUgKz0gb3V0TGlua3MubGVuZ3RoO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRlZ3JlZTtcclxufVxyXG4vL+enu+WKqOWKqOeUu1xyXG5mdW5jdGlvbiBtb3ZlKG5vZGUsIHRhcmdldFgsIHRhcmdldFkpIHtcclxuICAgIHRhcmdldFggPSBwYXJzZUludCh0YXJnZXRYKTtcclxuICAgIHRhcmdldFkgPSBwYXJzZUludCh0YXJnZXRZKTtcclxuICAgIHZhciB4ID0gbm9kZS5hdHRyLnBvc2l0aW9uWzBdO1xyXG4gICAgdmFyIHkgPSBub2RlLmF0dHIucG9zaXRpb25bMV07XHJcbiAgICB2YXIgcGFydFggPSBwYXJzZUludCgodGFyZ2V0WCAtIHgpKSAvIDEwO1xyXG4gICAgdmFyIHBhcnRZID0gcGFyc2VJbnQoKHRhcmdldFkgLSB5KSkgLyAxMDtcclxuICAgIHZhciBwYXJ0ID0gMDtcclxuICAgIHZhciB0ZW1wID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChNYXRoLmFicyh0YXJnZXRYIC0geCkgPiAxKSB7XHJcbiAgICAgICAgICAgIHggKz0gcGFydFg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChNYXRoLmFicyh0YXJnZXRZIC0geSkgPiAxKSB7XHJcbiAgICAgICAgICAgIHkgKz0gcGFydFk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG5vZGUuc2V0UG9zaXRpb24oW3BhcnNlSW50KHgpLCBwYXJzZUludCh5KV0pO1xyXG4gICAgICAgIHBhcnQrKztcclxuICAgICAgICBpZiAoTWF0aC5hYnModGFyZ2V0WCAtIHgpIDw9IDEgJiYgTWF0aC5hYnModGFyZ2V0WSAtIHkpIDw9IDEpIHtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0ZW1wKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhcnQgPj0gMTApIHtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0ZW1wKTtcclxuICAgICAgICB9XHJcbiAgICB9LCAxMDApO1xyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL1NjZW5lLmpzXG4vLyBtb2R1bGUgaWQgPSAzNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9');
},function(module,exports){eval('/**\r\n * @module QTopo\r\n */\r\n/**\r\n * QTopo通用工具包\r\n * @class QTopo.util\r\n * @static\r\n */\r\nfunction cached(fn) {\r\n    var cache = Object.create(null);\r\n    return function cachedFn(str) {\r\n        var hit = cache[str];\r\n        return hit || (cache[str] = fn(str))\r\n    };\r\n}\r\n\r\nvar util = {\r\n        /**\r\n         *  给函数添加缓存机制\r\n         *  @method cached\r\n         *  @param fn {function} 需处理的函数\r\n         *  @returns {function} 处理过的函数\r\n         */\r\n        cached:cached,\r\n        /**\r\n         * 字符串转化json\r\n         * @method toJson\r\n         * @param json {string|object}\r\n         * @returns json对象 {json}\r\n         */\r\n        toJson: function (json) {\r\n            if (typeof json == \'string\') {\r\n                json = $.parseJSON(json.replace(/\'/g, \'"\'));\r\n            }\r\n            return json;\r\n        },\r\n        /**\r\n         * 首字母大写\r\n         * @method upFirst\r\n         * @param string 字符串\r\n         * @returns {string} 首字母大写的字符串\r\n         */\r\n        upFirst: cached(function (str) {\r\n            return str.charAt(0).toUpperCase() + str.slice(1);\r\n        }),\r\n        /**\r\n         * 对象深度合并，只继承原对象有的属性\r\n         * @method extend\r\n         * @param base 原对象\r\n         * @param config 合并对象\r\n         * @returns {object} 处理完的原对象\r\n         */\r\n        extend: function (base, config) {\r\n            try {\r\n                if (typeof base == "object" && typeof config == "object") {\r\n                    deep(base, config);\r\n                }\r\n                else {\r\n                    QTopo.util.error("some extend error:", base, config);\r\n                }\r\n            } catch (e) {\r\n                QTopo.util.error("extend error", e, base, config);\r\n            }\r\n            function deep(attr, config) {\r\n                $.each(attr, function (key, value) {\r\n                    if (attr[key] && typeof attr[key] == "object" && typeof config[key] == "object") {\r\n                        if ($.isArray(attr[key]) && $.isArray(config[key])) {\r\n                            attr[key] = config[key];\r\n                        } else if ($.isFunction(attr[key]) && $.isFunction(config[key])) {\r\n                            attr[key] = config[key];\r\n                        } else {\r\n                            deep(attr[key], config[key]);\r\n                        }\r\n                    } else if (typeof attr[key] != "undefined" && typeof config[key] != "undefined") {\r\n                        attr[key] = config[key];\r\n                    }\r\n                });\r\n            }\r\n\r\n            return base;\r\n        },\r\n        /**\r\n         * 获取浏览器连接上的参数\r\n         * @method getParameter\r\n         * @param param 参数名\r\n         * @returns {string}\r\n         */\r\n        getParameter: function (param) {\r\n            var query = window.location.search;//获取URL地址中？后的所有字符\r\n            var iLen = param.length;//获取你的参数名称长度\r\n            var iStart = query.indexOf(param);//获取你该参数名称的其实索引\r\n            if (iStart == -1)//-1为没有该参数\r\n                return "";\r\n            iStart += iLen + 1;\r\n            var iEnd = query.indexOf("&", iStart);//获取第二个参数的其实索引\r\n            if (iEnd == -1)//只有一个参数\r\n                return query.substring(iStart);//获取单个参数的参数值\r\n            return query.substring(iStart, iEnd);//获取第二个参数的值\r\n        },\r\n        /**\r\n         * 仅画布全屏展示\r\n         * @method runPrefixMethod\r\n         * @param element {document} 例:canvas\r\n         * @param method {string} "RequestFullScreen"全屏的模式\r\n         */\r\n        runPrefixMethod: function (element, method) {\r\n            var usablePrefixMethod;\r\n            ["webkit", "moz", "ms", "o", ""].forEach(function (prefix) {\r\n                    if (usablePrefixMethod) return;\r\n                    if (prefix === "") {\r\n                        // 无前缀，方法首字母小写\r\n                        method = method.slice(0, 1).toLowerCase() + method.slice(1);\r\n                    }\r\n                    var typePrefixMethod = typeof element[prefix + method];\r\n                    if (typePrefixMethod + "" !== "undefined") {\r\n                        if (typePrefixMethod === "function") {\r\n                            usablePrefixMethod = element[prefix + method]();\r\n                        } else {\r\n                            usablePrefixMethod = element[prefix + method];\r\n                        }\r\n                    }\r\n                }\r\n            );\r\n        },\r\n        /**\r\n         * 浏览器全屏展示\r\n         * @method launchFullScreen\r\n         * @param element {document} 例:document.documentElement\r\n         */\r\n        launchFullScreen: function (element) {\r\n            if (element.requestFullscreen) {\r\n                element.requestFullscreen();\r\n            } else if (element.mozRequestFullScreen) {\r\n                element.mozRequestFullScreen();\r\n            } else if (element.webkitRequestFullscreen) {\r\n                element.webkitRequestFullscreen();\r\n            } else if (element.msRequestFullscreen) {\r\n                element.msRequestFullscreen();\r\n            }\r\n        },\r\n        /**\r\n         * 关闭浏览器全屏\r\n         * @method exitFullScreen\r\n         * @param document {document} 例:window.document\r\n         */\r\n        exitFullScreen: function (document) {\r\n            if (document.exitFullscreen) {\r\n                document.exitFullscreen();\r\n            } else if (document.mozCancelFullScreen) {\r\n                document.mozCancelFullScreen();\r\n            } else if (document.webkitExitFullscreen) {\r\n                document.webkitExitFullscreen();\r\n            }\r\n        },\r\n        /**\r\n         * 颜色字符串转换成rgb 16进制\r\n         * @method transHex\r\n         * @param color {string} 例:"#asdd00"\r\n         * @return {string} 16进制 例:"255,255,255"\r\n         */\r\n        transHex: cached(function (color) {\r\n            if (color && color.length == 7 && color.charAt(0) == \'#\') {\r\n                return [\r\n                    parseInt(color.substr(1, 2), 16),\r\n                    parseInt(color.substr(3, 2), 16),\r\n                    parseInt(color.substr(5, 2), 16)\r\n                ].join(\',\');\r\n            } else {\r\n                return color;\r\n            }\r\n        }),\r\n        /**\r\n         * 数组添加元素,如果数组中不存在则存入，否则不做操作\r\n         * @method arrayPush\r\n         * @param arr 操作的数组\r\n         * @param value 操作的元素\r\n         * @return {boolean} 操作是否成功\r\n         */\r\n        arrayPush: function (arr, value) {\r\n            if (arr.indexOf(value) < 0) {\r\n                arr.push(value);\r\n                return true;\r\n            }\r\n            return false;\r\n        },\r\n        /**\r\n         * 数组删除元素,如果数组中不存在则删除，否则不做操作\r\n         * @method arrayDelete\r\n         * @param arr 操作的数组\r\n         * @param value 操作的元素\r\n         * @return {boolean} 操作是否成功\r\n         */\r\n        arrayDelete: function (arr, value) {\r\n            var i = arr.indexOf(value);\r\n            if (i >= 0) {\r\n                arr.splice(i, 1);\r\n                return true;\r\n            }\r\n            return false;\r\n        },\r\n        /**\r\n         * 构造类继承关系\r\n         * @method inherits\r\n         * @param {Function} childClazz 子类\r\n         * @param {Function} FatherClazz 父类\r\n         */\r\n        inherits: function (childClazz, FatherClazz) {\r\n            var clazzPrototype = childClazz.prototype;\r\n\r\n            function F() {\r\n            }\r\n\r\n            F.prototype = FatherClazz.prototype;\r\n            childClazz.prototype = new F();\r\n\r\n            for (var prop in clazzPrototype) {\r\n                childClazz.prototype[prop] = clazzPrototype[prop];\r\n            }\r\n            childClazz.constructor = childClazz;\r\n        },\r\n        /**\r\n         * 深度克隆对象\r\n         * @method deepClone\r\n         * @param {object} obj 待克隆对象\r\n         * @return {object} 克隆后的新对象\r\n         */\r\n        deepClone: function (obj) {\r\n            var result, oClass = util.getClass(obj);\r\n            //确定result的类型\r\n            if (oClass === "Object") {\r\n                result = {};\r\n            } else if (oClass === "Array") {\r\n                result = [];\r\n            } else {\r\n                return obj;\r\n            }\r\n            for (key in obj) {\r\n                var copy = obj[key];\r\n                if (util.getClass(copy) == "Object") {\r\n                    result[key] = arguments.callee(copy);//递归调用\r\n                } else if ($.isArray(copy)) {\r\n                    result[key] = arguments.callee(copy);\r\n                } else {\r\n                    result[key] = obj[key];\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n        /**\r\n         * 获取对象的类\r\n         * @method getClass\r\n         * @param {object} o 待处理对象\r\n         * @return {string} 类名，如"Object","Array"\r\n         */\r\n        getClass: function (o) {\r\n            if (o === null) return "Null";\r\n            if (o === undefined) return "Undefined";\r\n            return Object.prototype.toString.call(o).slice(8, -1);\r\n        },\r\n        /**\r\n         * 加入时间戳的信息日志\r\n         * @method info\r\n         * @param {arguments} arguments\r\n         */\r\n        info: function () {\r\n            if (QTopo.log.info) {\r\n                console.info.apply(console, $.merge([util.dateFormat(new Date(), "hh:mm:ss")], arguments));\r\n            }\r\n        },\r\n        /**\r\n         * 加入时间戳的错误日志\r\n         * @method error\r\n         * @param {arguments} arguments\r\n         */\r\n        error: function () {\r\n            if (QTopo.log.error) {\r\n                console.error.apply(console, $.merge([util.dateFormat(new Date(), "hh:mm:ss")], arguments));\r\n            }\r\n        },\r\n        /**\r\n         * 格式化Date对象\r\n         * @method dateFormat\r\n         * @param {Date} date Date对象\r\n         * @param {string} ftString 格式化字符串,如"hh:mm:ss"\r\n         * @return {string}\r\n         */\r\n        dateFormat: function (date, ftString) {\r\n            if (date instanceof Date) {\r\n                var fomat = {\r\n                    "M+": date.getMonth() + 1, //月份\r\n                    "d+": date.getDate(), //日\r\n                    "h+": date.getHours(), //小时\r\n                    "m+": date.getMinutes(), //分\r\n                    "s+": date.getSeconds(), //秒\r\n                    "q+": Math.floor((date.getMonth() + 3) / 3), //季度\r\n                    "S": date.getMilliseconds() //毫秒\r\n                };\r\n                if (/(y+)/.test(ftString)) {\r\n                    ftString = ftString.replace(RegExp.$1, (date.getFullYear() + "")\r\n                        .substr(4 - RegExp.$1.length));\r\n                }\r\n                for (var type in fomat) {\r\n                    if (new RegExp("(" + type + ")").test(ftString)) {\r\n                        var temp;\r\n                        if (RegExp.$1.length == 1) {\r\n                            temp = fomat[type];\r\n                        } else {\r\n                            temp = ("00" + fomat[type]).substr(("" + fomat[type]).length);\r\n                        }\r\n                        ftString = ftString.replace(RegExp.$1, temp);\r\n                    }\r\n                }\r\n            }\r\n            return ftString;\r\n        },\r\n        /**\r\n         * 构造唯一Id字符串\r\n         * @method makeId\r\n         * @return {string}\r\n         */\r\n        makeId: function () {\r\n            return S4() + "-" + S4() + "-" + S4();\r\n        },\r\n        /**\r\n         * 判断对象是否是元素\r\n         * @method isElement\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isElement: function (target) {\r\n            return target &&target.getType &&target.getType() != QTopo.constant.SCENE && target.getUseType() != QTopo.constant.CASUAL;\r\n        },\r\n        /**\r\n         * 判断QTopo对象是否是图层\r\n         * @method isScene\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isScene: function (target) {\r\n            return !target || target.getType() == QTopo.constant.SCENE;\r\n        },\r\n        /**\r\n         * 判断QTopo对象是否是节点\r\n         * @method isNode\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isNode: function (target) {\r\n            return target && target.getType() == QTopo.constant.NODE && target.getUseType() != QTopo.constant.CASUAL;\r\n        },\r\n        /**\r\n         * 判断QTopo对象是否是分组\r\n         * @method isContainer\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isContainer: function (target) {\r\n            return target && target.getType() == QTopo.constant.CONTAINER && target.getUseType() != QTopo.constant.CASUAL;\r\n        },\r\n        /**\r\n         * 判断QTopo对象是否是链接\r\n         * @method isLink\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isLink: function (target) {\r\n            return target && target.getType() == QTopo.constant.LINK && target.getUseType() != QTopo.constant.CASUAL;\r\n        }\r\n    }\r\n    ;\r\nfunction S4() {\r\n    return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\r\n}\r\nmodule.exports = util;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL3V0aWwuanM/MjkyNiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsU0FBUztBQUNoQyxzQkFBc0IsU0FBUztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsT0FBTztBQUM1QjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixPQUFPO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7O0FBRUE7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLCtDQUErQztBQUMvQyxvQ0FBb0M7QUFDcEMsOENBQThDO0FBQzlDO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRDtBQUNsRDtBQUNBLCtDQUErQztBQUMvQyxpREFBaUQ7QUFDakQsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixTQUFTO0FBQ3BDLDBCQUEwQixPQUFPO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLFNBQVM7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsU0FBUztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixPQUFPO0FBQ2hDLG9CQUFvQixPQUFPO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFFBQVE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLFNBQVM7QUFDNUIsbUJBQW1CLFNBQVM7QUFDNUI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsT0FBTztBQUMxQixvQkFBb0IsT0FBTztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RDtBQUN6RCxpQkFBaUI7QUFDakI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLE9BQU87QUFDMUIsb0JBQW9CLE9BQU87QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsVUFBVTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixVQUFVO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLEtBQUs7QUFDeEIsbUJBQW1CLE9BQU87QUFDMUIsb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQixvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQixvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQixvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQixvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQixvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMzcuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQG1vZHVsZSBRVG9wb1xyXG4gKi9cclxuLyoqXHJcbiAqIFFUb3Bv6YCa55So5bel5YW35YyFXHJcbiAqIEBjbGFzcyBRVG9wby51dGlsXHJcbiAqIEBzdGF0aWNcclxuICovXHJcbmZ1bmN0aW9uIGNhY2hlZChmbikge1xyXG4gICAgdmFyIGNhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuICAgIHJldHVybiBmdW5jdGlvbiBjYWNoZWRGbihzdHIpIHtcclxuICAgICAgICB2YXIgaGl0ID0gY2FjaGVbc3RyXTtcclxuICAgICAgICByZXR1cm4gaGl0IHx8IChjYWNoZVtzdHJdID0gZm4oc3RyKSlcclxuICAgIH07XHJcbn1cclxuXHJcbnZhciB1dGlsID0ge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICDnu5nlh73mlbDmt7vliqDnvJPlrZjmnLrliLZcclxuICAgICAgICAgKiAgQG1ldGhvZCBjYWNoZWRcclxuICAgICAgICAgKiAgQHBhcmFtIGZuIHtmdW5jdGlvbn0g6ZyA5aSE55CG55qE5Ye95pWwXHJcbiAgICAgICAgICogIEByZXR1cm5zIHtmdW5jdGlvbn0g5aSE55CG6L+H55qE5Ye95pWwXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2FjaGVkOmNhY2hlZCxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlrZfnrKbkuLLovazljJZqc29uXHJcbiAgICAgICAgICogQG1ldGhvZCB0b0pzb25cclxuICAgICAgICAgKiBAcGFyYW0ganNvbiB7c3RyaW5nfG9iamVjdH1cclxuICAgICAgICAgKiBAcmV0dXJucyBqc29u5a+56LGhIHtqc29ufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvSnNvbjogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBqc29uID09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICBqc29uID0gJC5wYXJzZUpTT04oanNvbi5yZXBsYWNlKC8nL2csICdcIicpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4ganNvbjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOmmluWtl+avjeWkp+WGmVxyXG4gICAgICAgICAqIEBtZXRob2QgdXBGaXJzdFxyXG4gICAgICAgICAqIEBwYXJhbSBzdHJpbmcg5a2X56ym5LiyXHJcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ30g6aaW5a2X5q+N5aSn5YaZ55qE5a2X56ym5LiyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdXBGaXJzdDogY2FjaGVkKGZ1bmN0aW9uIChzdHIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHN0ci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0ci5zbGljZSgxKTtcclxuICAgICAgICB9KSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlr7nosaHmt7HluqblkIjlubbvvIzlj6rnu6fmib/ljp/lr7nosaHmnInnmoTlsZ7mgKdcclxuICAgICAgICAgKiBAbWV0aG9kIGV4dGVuZFxyXG4gICAgICAgICAqIEBwYXJhbSBiYXNlIOWOn+WvueixoVxyXG4gICAgICAgICAqIEBwYXJhbSBjb25maWcg5ZCI5bm25a+56LGhXHJcbiAgICAgICAgICogQHJldHVybnMge29iamVjdH0g5aSE55CG5a6M55qE5Y6f5a+56LGhXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZXh0ZW5kOiBmdW5jdGlvbiAoYmFzZSwgY29uZmlnKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGJhc2UgPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgY29uZmlnID09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWVwKGJhc2UsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBRVG9wby51dGlsLmVycm9yKFwic29tZSBleHRlbmQgZXJyb3I6XCIsIGJhc2UsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJleHRlbmQgZXJyb3JcIiwgZSwgYmFzZSwgY29uZmlnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiBkZWVwKGF0dHIsIGNvbmZpZykge1xyXG4gICAgICAgICAgICAgICAgJC5lYWNoKGF0dHIsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJba2V5XSAmJiB0eXBlb2YgYXR0cltrZXldID09IFwib2JqZWN0XCIgJiYgdHlwZW9mIGNvbmZpZ1trZXldID09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheShhdHRyW2tleV0pICYmICQuaXNBcnJheShjb25maWdba2V5XSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJba2V5XSA9IGNvbmZpZ1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCQuaXNGdW5jdGlvbihhdHRyW2tleV0pICYmICQuaXNGdW5jdGlvbihjb25maWdba2V5XSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJba2V5XSA9IGNvbmZpZ1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVlcChhdHRyW2tleV0sIGNvbmZpZ1trZXldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGF0dHJba2V5XSAhPSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBjb25maWdba2V5XSAhPSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJba2V5XSA9IGNvbmZpZ1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gYmFzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPlua1j+iniOWZqOi/nuaOpeS4iueahOWPguaVsFxyXG4gICAgICAgICAqIEBtZXRob2QgZ2V0UGFyYW1ldGVyXHJcbiAgICAgICAgICogQHBhcmFtIHBhcmFtIOWPguaVsOWQjVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0UGFyYW1ldGVyOiBmdW5jdGlvbiAocGFyYW0pIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDsvL+iOt+WPllVSTOWcsOWdgOS4re+8n+WQjueahOaJgOacieWtl+esplxyXG4gICAgICAgICAgICB2YXIgaUxlbiA9IHBhcmFtLmxlbmd0aDsvL+iOt+WPluS9oOeahOWPguaVsOWQjeensOmVv+W6plxyXG4gICAgICAgICAgICB2YXIgaVN0YXJ0ID0gcXVlcnkuaW5kZXhPZihwYXJhbSk7Ly/ojrflj5bkvaDor6Xlj4LmlbDlkI3np7DnmoTlhbblrp7ntKLlvJVcclxuICAgICAgICAgICAgaWYgKGlTdGFydCA9PSAtMSkvLy0x5Li65rKh5pyJ6K+l5Y+C5pWwXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgICAgICAgICAgaVN0YXJ0ICs9IGlMZW4gKyAxO1xyXG4gICAgICAgICAgICB2YXIgaUVuZCA9IHF1ZXJ5LmluZGV4T2YoXCImXCIsIGlTdGFydCk7Ly/ojrflj5bnrKzkuozkuKrlj4LmlbDnmoTlhbblrp7ntKLlvJVcclxuICAgICAgICAgICAgaWYgKGlFbmQgPT0gLTEpLy/lj6rmnInkuIDkuKrlj4LmlbBcclxuICAgICAgICAgICAgICAgIHJldHVybiBxdWVyeS5zdWJzdHJpbmcoaVN0YXJ0KTsvL+iOt+WPluWNleS4quWPguaVsOeahOWPguaVsOWAvFxyXG4gICAgICAgICAgICByZXR1cm4gcXVlcnkuc3Vic3RyaW5nKGlTdGFydCwgaUVuZCk7Ly/ojrflj5bnrKzkuozkuKrlj4LmlbDnmoTlgLxcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOS7heeUu+W4g+WFqOWxj+WxleekulxyXG4gICAgICAgICAqIEBtZXRob2QgcnVuUHJlZml4TWV0aG9kXHJcbiAgICAgICAgICogQHBhcmFtIGVsZW1lbnQge2RvY3VtZW50fSDkvos6Y2FudmFzXHJcbiAgICAgICAgICogQHBhcmFtIG1ldGhvZCB7c3RyaW5nfSBcIlJlcXVlc3RGdWxsU2NyZWVuXCLlhajlsY/nmoTmqKHlvI9cclxuICAgICAgICAgKi9cclxuICAgICAgICBydW5QcmVmaXhNZXRob2Q6IGZ1bmN0aW9uIChlbGVtZW50LCBtZXRob2QpIHtcclxuICAgICAgICAgICAgdmFyIHVzYWJsZVByZWZpeE1ldGhvZDtcclxuICAgICAgICAgICAgW1wid2Via2l0XCIsIFwibW96XCIsIFwibXNcIiwgXCJvXCIsIFwiXCJdLmZvckVhY2goZnVuY3Rpb24gKHByZWZpeCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2FibGVQcmVmaXhNZXRob2QpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocHJlZml4ID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaXoOWJjee8gO+8jOaWueazlemmluWtl+avjeWwj+WGmVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2QgPSBtZXRob2Quc2xpY2UoMCwgMSkudG9Mb3dlckNhc2UoKSArIG1ldGhvZC5zbGljZSgxKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGVQcmVmaXhNZXRob2QgPSB0eXBlb2YgZWxlbWVudFtwcmVmaXggKyBtZXRob2RdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlUHJlZml4TWV0aG9kICsgXCJcIiAhPT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZVByZWZpeE1ldGhvZCA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FibGVQcmVmaXhNZXRob2QgPSBlbGVtZW50W3ByZWZpeCArIG1ldGhvZF0oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWJsZVByZWZpeE1ldGhvZCA9IGVsZW1lbnRbcHJlZml4ICsgbWV0aG9kXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOa1j+iniOWZqOWFqOWxj+WxleekulxyXG4gICAgICAgICAqIEBtZXRob2QgbGF1bmNoRnVsbFNjcmVlblxyXG4gICAgICAgICAqIEBwYXJhbSBlbGVtZW50IHtkb2N1bWVudH0g5L6LOmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGxhdW5jaEZ1bGxTY3JlZW46IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChlbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5tb3pSZXF1ZXN0RnVsbFNjcmVlbikge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5tb3pSZXF1ZXN0RnVsbFNjcmVlbigpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4oKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50Lm1zUmVxdWVzdEZ1bGxzY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQubXNSZXF1ZXN0RnVsbHNjcmVlbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlhbPpl63mtY/op4jlmajlhajlsY9cclxuICAgICAgICAgKiBAbWV0aG9kIGV4aXRGdWxsU2NyZWVuXHJcbiAgICAgICAgICogQHBhcmFtIGRvY3VtZW50IHtkb2N1bWVudH0g5L6LOndpbmRvdy5kb2N1bWVudFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGV4aXRGdWxsU2NyZWVuOiBmdW5jdGlvbiAoZG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKSB7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5leGl0RnVsbHNjcmVlbigpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4oKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlbikge1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6aKc6Imy5a2X56ym5Liy6L2s5o2i5oiQcmdiIDE26L+b5Yi2XHJcbiAgICAgICAgICogQG1ldGhvZCB0cmFuc0hleFxyXG4gICAgICAgICAqIEBwYXJhbSBjb2xvciB7c3RyaW5nfSDkvos6XCIjYXNkZDAwXCJcclxuICAgICAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IDE26L+b5Yi2IOS+izpcIjI1NSwyNTUsMjU1XCJcclxuICAgICAgICAgKi9cclxuICAgICAgICB0cmFuc0hleDogY2FjaGVkKGZ1bmN0aW9uIChjb2xvcikge1xyXG4gICAgICAgICAgICBpZiAoY29sb3IgJiYgY29sb3IubGVuZ3RoID09IDcgJiYgY29sb3IuY2hhckF0KDApID09ICcjJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChjb2xvci5zdWJzdHIoMSwgMiksIDE2KSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChjb2xvci5zdWJzdHIoMywgMiksIDE2KSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChjb2xvci5zdWJzdHIoNSwgMiksIDE2KVxyXG4gICAgICAgICAgICAgICAgXS5qb2luKCcsJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29sb3I7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmlbDnu4Tmt7vliqDlhYPntKAs5aaC5p6c5pWw57uE5Lit5LiN5a2Y5Zyo5YiZ5a2Y5YWl77yM5ZCm5YiZ5LiN5YGa5pON5L2cXHJcbiAgICAgICAgICogQG1ldGhvZCBhcnJheVB1c2hcclxuICAgICAgICAgKiBAcGFyYW0gYXJyIOaTjeS9nOeahOaVsOe7hFxyXG4gICAgICAgICAqIEBwYXJhbSB2YWx1ZSDmk43kvZznmoTlhYPntKBcclxuICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufSDmk43kvZzmmK/lkKbmiJDlip9cclxuICAgICAgICAgKi9cclxuICAgICAgICBhcnJheVB1c2g6IGZ1bmN0aW9uIChhcnIsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmIChhcnIuaW5kZXhPZih2YWx1ZSkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICBhcnIucHVzaCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmlbDnu4TliKDpmaTlhYPntKAs5aaC5p6c5pWw57uE5Lit5LiN5a2Y5Zyo5YiZ5Yig6Zmk77yM5ZCm5YiZ5LiN5YGa5pON5L2cXHJcbiAgICAgICAgICogQG1ldGhvZCBhcnJheURlbGV0ZVxyXG4gICAgICAgICAqIEBwYXJhbSBhcnIg5pON5L2c55qE5pWw57uEXHJcbiAgICAgICAgICogQHBhcmFtIHZhbHVlIOaTjeS9nOeahOWFg+e0oFxyXG4gICAgICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IOaTjeS9nOaYr+WQpuaIkOWKn1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFycmF5RGVsZXRlOiBmdW5jdGlvbiAoYXJyLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IGFyci5pbmRleE9mKHZhbHVlKTtcclxuICAgICAgICAgICAgaWYgKGkgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgYXJyLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaehOmAoOexu+e7p+aJv+WFs+ezu1xyXG4gICAgICAgICAqIEBtZXRob2QgaW5oZXJpdHNcclxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjaGlsZENsYXp6IOWtkOexu1xyXG4gICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IEZhdGhlckNsYXp6IOeItuexu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaGVyaXRzOiBmdW5jdGlvbiAoY2hpbGRDbGF6eiwgRmF0aGVyQ2xhenopIHtcclxuICAgICAgICAgICAgdmFyIGNsYXp6UHJvdG90eXBlID0gY2hpbGRDbGF6ei5wcm90b3R5cGU7XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBGKCkge1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBGLnByb3RvdHlwZSA9IEZhdGhlckNsYXp6LnByb3RvdHlwZTtcclxuICAgICAgICAgICAgY2hpbGRDbGF6ei5wcm90b3R5cGUgPSBuZXcgRigpO1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBjbGF6elByb3RvdHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2hpbGRDbGF6ei5wcm90b3R5cGVbcHJvcF0gPSBjbGF6elByb3RvdHlwZVtwcm9wXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjaGlsZENsYXp6LmNvbnN0cnVjdG9yID0gY2hpbGRDbGF6ejtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOa3seW6puWFi+mahuWvueixoVxyXG4gICAgICAgICAqIEBtZXRob2QgZGVlcENsb25lXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IG9iaiDlvoXlhYvpmoblr7nosaFcclxuICAgICAgICAgKiBAcmV0dXJuIHtvYmplY3R9IOWFi+mahuWQjueahOaWsOWvueixoVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRlZXBDbG9uZTogZnVuY3Rpb24gKG9iaikge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0LCBvQ2xhc3MgPSB1dGlsLmdldENsYXNzKG9iaik7XHJcbiAgICAgICAgICAgIC8v56Gu5a6acmVzdWx055qE57G75Z6LXHJcbiAgICAgICAgICAgIGlmIChvQ2xhc3MgPT09IFwiT2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG9DbGFzcyA9PT0gXCJBcnJheVwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBbXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvYmo7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY29weSA9IG9ialtrZXldO1xyXG4gICAgICAgICAgICAgICAgaWYgKHV0aWwuZ2V0Q2xhc3MoY29weSkgPT0gXCJPYmplY3RcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtrZXldID0gYXJndW1lbnRzLmNhbGxlZShjb3B5KTsvL+mAkuW9kuiwg+eUqFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICgkLmlzQXJyYXkoY29weSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IGFyZ3VtZW50cy5jYWxsZWUoY29weSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtrZXldID0gb2JqW2tleV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluWvueixoeeahOexu1xyXG4gICAgICAgICAqIEBtZXRob2QgZ2V0Q2xhc3NcclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gbyDlvoXlpITnkIblr7nosaFcclxuICAgICAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IOexu+WQje+8jOWmglwiT2JqZWN0XCIsXCJBcnJheVwiXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0Q2xhc3M6IGZ1bmN0aW9uIChvKSB7XHJcbiAgICAgICAgICAgIGlmIChvID09PSBudWxsKSByZXR1cm4gXCJOdWxsXCI7XHJcbiAgICAgICAgICAgIGlmIChvID09PSB1bmRlZmluZWQpIHJldHVybiBcIlVuZGVmaW5lZFwiO1xyXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWKoOWFpeaXtumXtOaIs+eahOS/oeaBr+aXpeW/l1xyXG4gICAgICAgICAqIEBtZXRob2QgaW5mb1xyXG4gICAgICAgICAqIEBwYXJhbSB7YXJndW1lbnRzfSBhcmd1bWVudHNcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbmZvOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChRVG9wby5sb2cuaW5mbykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvLmFwcGx5KGNvbnNvbGUsICQubWVyZ2UoW3V0aWwuZGF0ZUZvcm1hdChuZXcgRGF0ZSgpLCBcImhoOm1tOnNzXCIpXSwgYXJndW1lbnRzKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWKoOWFpeaXtumXtOaIs+eahOmUmeivr+aXpeW/l1xyXG4gICAgICAgICAqIEBtZXRob2QgZXJyb3JcclxuICAgICAgICAgKiBAcGFyYW0ge2FyZ3VtZW50c30gYXJndW1lbnRzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKFFUb3BvLmxvZy5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvci5hcHBseShjb25zb2xlLCAkLm1lcmdlKFt1dGlsLmRhdGVGb3JtYXQobmV3IERhdGUoKSwgXCJoaDptbTpzc1wiKV0sIGFyZ3VtZW50cykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmoLzlvI/ljJZEYXRl5a+56LGhXHJcbiAgICAgICAgICogQG1ldGhvZCBkYXRlRm9ybWF0XHJcbiAgICAgICAgICogQHBhcmFtIHtEYXRlfSBkYXRlIERhdGXlr7nosaFcclxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gZnRTdHJpbmcg5qC85byP5YyW5a2X56ym5LiyLOWmglwiaGg6bW06c3NcIlxyXG4gICAgICAgICAqIEByZXR1cm4ge3N0cmluZ31cclxuICAgICAgICAgKi9cclxuICAgICAgICBkYXRlRm9ybWF0OiBmdW5jdGlvbiAoZGF0ZSwgZnRTdHJpbmcpIHtcclxuICAgICAgICAgICAgaWYgKGRhdGUgaW5zdGFuY2VvZiBEYXRlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZm9tYXQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJNK1wiOiBkYXRlLmdldE1vbnRoKCkgKyAxLCAvL+aciOS7vVxyXG4gICAgICAgICAgICAgICAgICAgIFwiZCtcIjogZGF0ZS5nZXREYXRlKCksIC8v5pelXHJcbiAgICAgICAgICAgICAgICAgICAgXCJoK1wiOiBkYXRlLmdldEhvdXJzKCksIC8v5bCP5pe2XHJcbiAgICAgICAgICAgICAgICAgICAgXCJtK1wiOiBkYXRlLmdldE1pbnV0ZXMoKSwgLy/liIZcclxuICAgICAgICAgICAgICAgICAgICBcInMrXCI6IGRhdGUuZ2V0U2Vjb25kcygpLCAvL+enklxyXG4gICAgICAgICAgICAgICAgICAgIFwicStcIjogTWF0aC5mbG9vcigoZGF0ZS5nZXRNb250aCgpICsgMykgLyAzKSwgLy/lraPluqZcclxuICAgICAgICAgICAgICAgICAgICBcIlNcIjogZGF0ZS5nZXRNaWxsaXNlY29uZHMoKSAvL+avq+enklxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGlmICgvKHkrKS8udGVzdChmdFN0cmluZykpIHtcclxuICAgICAgICAgICAgICAgICAgICBmdFN0cmluZyA9IGZ0U3RyaW5nLnJlcGxhY2UoUmVnRXhwLiQxLCAoZGF0ZS5nZXRGdWxsWWVhcigpICsgXCJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1YnN0cig0IC0gUmVnRXhwLiQxLmxlbmd0aCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgdHlwZSBpbiBmb21hdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXcgUmVnRXhwKFwiKFwiICsgdHlwZSArIFwiKVwiKS50ZXN0KGZ0U3RyaW5nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFJlZ0V4cC4kMS5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcCA9IGZvbWF0W3R5cGVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcCA9IChcIjAwXCIgKyBmb21hdFt0eXBlXSkuc3Vic3RyKChcIlwiICsgZm9tYXRbdHlwZV0pLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZnRTdHJpbmcgPSBmdFN0cmluZy5yZXBsYWNlKFJlZ0V4cC4kMSwgdGVtcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmdFN0cmluZztcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaehOmAoOWUr+S4gElk5a2X56ym5LiyXHJcbiAgICAgICAgICogQG1ldGhvZCBtYWtlSWRcclxuICAgICAgICAgKiBAcmV0dXJuIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbWFrZUlkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTNCgpICsgXCItXCIgKyBTNCgpICsgXCItXCIgKyBTNCgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5Yik5pat5a+56LGh5piv5ZCm5piv5YWD57SgXHJcbiAgICAgICAgICogQG1ldGhvZCBpc0VsZW1lbnRcclxuICAgICAgICAgKiBAcGFyYW0gZWxlbWVudCB7ZWxlbWVudH1cclxuICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGlzRWxlbWVudDogZnVuY3Rpb24gKHRhcmdldCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0ICYmdGFyZ2V0LmdldFR5cGUgJiZ0YXJnZXQuZ2V0VHlwZSgpICE9IFFUb3BvLmNvbnN0YW50LlNDRU5FICYmIHRhcmdldC5nZXRVc2VUeXBlKCkgIT0gUVRvcG8uY29uc3RhbnQuQ0FTVUFMO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5Yik5patUVRvcG/lr7nosaHmmK/lkKbmmK/lm77lsYJcclxuICAgICAgICAgKiBAbWV0aG9kIGlzU2NlbmVcclxuICAgICAgICAgKiBAcGFyYW0gZWxlbWVudCB7ZWxlbWVudH1cclxuICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGlzU2NlbmU6IGZ1bmN0aW9uICh0YXJnZXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICF0YXJnZXQgfHwgdGFyZ2V0LmdldFR5cGUoKSA9PSBRVG9wby5jb25zdGFudC5TQ0VORTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWIpOaWrVFUb3Bv5a+56LGh5piv5ZCm5piv6IqC54K5XHJcbiAgICAgICAgICogQG1ldGhvZCBpc05vZGVcclxuICAgICAgICAgKiBAcGFyYW0gZWxlbWVudCB7ZWxlbWVudH1cclxuICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGlzTm9kZTogZnVuY3Rpb24gKHRhcmdldCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0ICYmIHRhcmdldC5nZXRUeXBlKCkgPT0gUVRvcG8uY29uc3RhbnQuTk9ERSAmJiB0YXJnZXQuZ2V0VXNlVHlwZSgpICE9IFFUb3BvLmNvbnN0YW50LkNBU1VBTDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWIpOaWrVFUb3Bv5a+56LGh5piv5ZCm5piv5YiG57uEXHJcbiAgICAgICAgICogQG1ldGhvZCBpc0NvbnRhaW5lclxyXG4gICAgICAgICAqIEBwYXJhbSBlbGVtZW50IHtlbGVtZW50fVxyXG4gICAgICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaXNDb250YWluZXI6IGZ1bmN0aW9uICh0YXJnZXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldCAmJiB0YXJnZXQuZ2V0VHlwZSgpID09IFFUb3BvLmNvbnN0YW50LkNPTlRBSU5FUiAmJiB0YXJnZXQuZ2V0VXNlVHlwZSgpICE9IFFUb3BvLmNvbnN0YW50LkNBU1VBTDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWIpOaWrVFUb3Bv5a+56LGh5piv5ZCm5piv6ZO+5o6lXHJcbiAgICAgICAgICogQG1ldGhvZCBpc0xpbmtcclxuICAgICAgICAgKiBAcGFyYW0gZWxlbWVudCB7ZWxlbWVudH1cclxuICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGlzTGluazogZnVuY3Rpb24gKHRhcmdldCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0ICYmIHRhcmdldC5nZXRUeXBlKCkgPT0gUVRvcG8uY29uc3RhbnQuTElOSyAmJiB0YXJnZXQuZ2V0VXNlVHlwZSgpICE9IFFUb3BvLmNvbnN0YW50LkNBU1VBTDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICA7XHJcbmZ1bmN0aW9uIFM0KCkge1xyXG4gICAgcmV0dXJuICgoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApIHwgMCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKTtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IHV0aWw7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL3V0aWwuanNcbi8vIG1vZHVsZSBpZCA9IDM3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=');
},,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 容器基类,用以继承 [E]开头继承于Element,[C]开头为自身api\r\n * @class [C] Container\r\n * @constructor\r\n * @extends [E] Element\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\n\r\nvar Element = __webpack_require__(2);\r\nmodule.exports = Container;\r\nfunction Container(jtopo) {\r\n    if (jtopo) {\r\n        Element.call(this, jtopo);\r\n    } else {\r\n        QTopo.util.error("create Container without jtopo", this);\r\n    }\r\n    /**\r\n     * 记录容器内的元素\r\n     * @property [C] children {array}\r\n     */\r\n    this.children = [];\r\n    /**\r\n     * 记录容器上的链路\r\n     * @property [C] links {array}\r\n     * @param in 以容器为终点的链路\r\n     * @param out 以容器为起点的链路\r\n     */\r\n    this.links = {\r\n        in: [],\r\n        out: []\r\n    };\r\n}\r\nQTopo.util.inherits(Container, Element);\r\n/**\r\n *  设置容器名称\r\n *  @method [C] setName\r\n *  @param name {string}\r\n */\r\nContainer.prototype.setName = function (name) {\r\n    if (name) {\r\n        if (this.attr.namePosition != "hide") {\r\n            this.jtopo.text = name.trim();\r\n        }\r\n        this.attr.name = name.trim();\r\n    }\r\n};\r\n/**\r\n *  将元素加入容器内\r\n *  @method [C] add\r\n *  @param element {element|array} 一般为节点类型对象或数组，容器加入容器容易产生Bug\r\n */\r\nContainer.prototype.add = function (element) {\r\n    var self=this;\r\n    if (!$.isArray(this.children)) {\r\n        this.children = [];\r\n    }\r\n    if ($.isArray(element)) {\r\n        $.each(element,function(i,el){\r\n            addOnce(el);\r\n        });\r\n    }else{\r\n        addOnce(element);\r\n    }\r\n    function addOnce(element){\r\n        if (element&&check(element)&&!self.isChild(element)) {\r\n            self.children.push(element);\r\n            element.parent = self;\r\n            self.jtopo.add(element.jtopo);\r\n            if (self.attr.children && typeof self.attr.children.draggable == "boolean") {\r\n                //若分组不允许移动组内元素，手动设置元素不可移动\r\n                element.setDraggable(self.attr.children.draggable);\r\n            }\r\n        }\r\n    }\r\n    function check(element){\r\n        return element.getType()==QTopo.constant.NODE&&element.getUseType()!=QTopo.constant.CASUAL&&!element.parent;\r\n    }\r\n};\r\n/**\r\n * 将子元素从容器中删除\r\n * @method [C] remove\r\n * @param element {element}\r\n */\r\nContainer.prototype.remove = function (element) {\r\n    if ($.isArray(this.children) && this.isChild(element)) {\r\n        this.children.splice(this.children.indexOf(element), 1);\r\n        delete element.parent;\r\n        this.jtopo.remove(element.jtopo);\r\n        //移除元素，应手动设回元素可移动\r\n        element.setDraggable(true);\r\n    }\r\n};\r\n/**\r\n * 获取容器基本类型\r\n * @method [C] getType\r\n * @return QTopo.constant.CONTAINER\r\n */\r\nContainer.prototype.getType = function () {\r\n    return QTopo.constant.CONTAINER;\r\n};\r\n/**\r\n * 设置容器背景色\r\n * @method [C] setColor\r\n * @param color {string} "255,255,255"/"#ffffff"\r\n */\r\nContainer.prototype.setColor = function (color) {\r\n    if (color) {\r\n        color = QTopo.util.transHex(color.toLowerCase());\r\n        this.jtopo.fillColor = color;\r\n    }\r\n    this.attr.color = this.jtopo.fillColor;\r\n};\r\n/**\r\n * 设置容器内子元素一般行为,未完全实现\r\n * @method [C] setChildren\r\n * @param children {object}\r\n *          children={\r\n *                  draggable:是否可移动{boolean}\r\n *          }\r\n */\r\nContainer.prototype.setChildren = function (children) {\r\n    var jtopo = this.jtopo;\r\n    if (children) {\r\n        if (typeof children.draggable == "boolean") {\r\n            this.jtopo.childDraggable = children.draggable;\r\n            for (var i = 0; i < this.children.length; i++) {\r\n                this.children[i].setDraggable(children.draggable);\r\n            }\r\n        }\r\n    }\r\n    this.attr.children.draggable = jtopo.childDraggable;\r\n};\r\n/**\r\n * 容器缩放切换,在scene创建时可选是否提供切换\r\n *\r\n * 可在创建时增加参数 toggle:{close:true}来创建一个不可切换的容器\r\n *\r\n * 若无切换对象，则该方法无动作\r\n * @method [C] toggle\r\n * @param [flag] 为true则强制缩放，为false则强制展开，无值则自适应切换,\r\n */\r\nContainer.prototype.toggle = function (flag) {\r\n    if (this.toggleTo) {\r\n        var gJtopo = this.jtopo;\r\n        var nJtopo = this.toggleTo.jtopo;\r\n        var todo = typeof flag == "boolean" ? flag : gJtopo.visible;\r\n        if (todo) {\r\n            //缩放\r\n            this.hide();\r\n            this.toggleTo.show();\r\n            this.toggleTo.setPosition([gJtopo.cx - nJtopo.width / 2, gJtopo.cy - nJtopo.height / 2]);\r\n        } else {\r\n            //展开\r\n            this.show();\r\n            this.toggleTo.hide();\r\n            this.setPosition([nJtopo.cx - gJtopo.width / 2, nJtopo.cy - gJtopo.height / 2]);\r\n        }\r\n    }\r\n};\r\n/**\r\n * 判断元素是否已是子元素\r\n * @method [C] isChild\r\n * @param element 判断的子元素\r\n * @return {boolean}\r\n */\r\nContainer.prototype.isChild = function (element) {\r\n    if ($.isArray(this.children)) {\r\n        var index=this.children.indexOf(element);\r\n        if (element.parent != this&& index> -1) {\r\n            QTopo.util.error("some group get error,the child\'s parent is not it and the child in its children,index is "+index, this,element);\r\n        }\r\n        return index>-1;\r\n    } else {\r\n        return false;\r\n    }\r\n};\r\n/**\r\n * 判断元素是否在分组覆盖的范围内,临时元素不考虑\r\n * @method [C] isInside\r\n * @param element 判断的元素\r\n * @return {boolean}\r\n */\r\nContainer.prototype.isInside = function (element) {\r\n    if (element && element.getType() != QTopo.constant.CASUAL) {\r\n        var center = element.getCenterPosition();\r\n        return !this.isChild(element) && center.x > this.x && center.x < (this.x + this.width) && center.y > this.y && center.y < (this.y + this.height);\r\n    } else {\r\n        return false;\r\n    }\r\n};\r\n/**\r\n * 分组属性提取\r\n * @method [C] toJson\r\n * @return {object}\r\n */\r\nContainer.prototype.toJson=function(){\r\n    var json=$.extend({},this.attr);\r\n    json.extra=$.extend({},this.extra);\r\n    json.children=[];\r\n    this.children.map(function(child){\r\n        json.children.push(child.get(\'jsonId\'));\r\n    });\r\n    json.toggle=this.toggleTo.toJson();\r\n    return json;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9jb250YWluZXIvQ29udGFpbmVyLmpzPzNhZTMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGNBQWM7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsMEJBQTBCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixXQUFXO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QiwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSIsImZpbGUiOiI1NS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDlrrnlmajln7rnsbss55So5Lul57un5om/IFtFXeW8gOWktOe7p+aJv+S6jkVsZW1lbnQsW0Nd5byA5aS05Li66Ieq6LqrYXBpXHJcbiAqIEBjbGFzcyBbQ10gQ29udGFpbmVyXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbRV0gRWxlbWVudFxyXG4gKiBAcGFyYW0ganRvcG8g5YWD57Sg5qC45b+D55qEanRvcG/lr7nosaFcclxuICovXHJcblxyXG52YXIgRWxlbWVudCA9IHJlcXVpcmUoXCIuLi9FbGVtZW50LmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IENvbnRhaW5lcjtcclxuZnVuY3Rpb24gQ29udGFpbmVyKGp0b3BvKSB7XHJcbiAgICBpZiAoanRvcG8pIHtcclxuICAgICAgICBFbGVtZW50LmNhbGwodGhpcywganRvcG8pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiY3JlYXRlIENvbnRhaW5lciB3aXRob3V0IGp0b3BvXCIsIHRoaXMpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDorrDlvZXlrrnlmajlhoXnmoTlhYPntKBcclxuICAgICAqIEBwcm9wZXJ0eSBbQ10gY2hpbGRyZW4ge2FycmF5fVxyXG4gICAgICovXHJcbiAgICB0aGlzLmNoaWxkcmVuID0gW107XHJcbiAgICAvKipcclxuICAgICAqIOiusOW9leWuueWZqOS4iueahOmTvui3r1xyXG4gICAgICogQHByb3BlcnR5IFtDXSBsaW5rcyB7YXJyYXl9XHJcbiAgICAgKiBAcGFyYW0gaW4g5Lul5a655Zmo5Li657uI54K555qE6ZO+6LevXHJcbiAgICAgKiBAcGFyYW0gb3V0IOS7peWuueWZqOS4uui1t+eCueeahOmTvui3r1xyXG4gICAgICovXHJcbiAgICB0aGlzLmxpbmtzID0ge1xyXG4gICAgICAgIGluOiBbXSxcclxuICAgICAgICBvdXQ6IFtdXHJcbiAgICB9O1xyXG59XHJcblFUb3BvLnV0aWwuaW5oZXJpdHMoQ29udGFpbmVyLCBFbGVtZW50KTtcclxuLyoqXHJcbiAqICDorr7nva7lrrnlmajlkI3np7BcclxuICogIEBtZXRob2QgW0NdIHNldE5hbWVcclxuICogIEBwYXJhbSBuYW1lIHtzdHJpbmd9XHJcbiAqL1xyXG5Db250YWluZXIucHJvdG90eXBlLnNldE5hbWUgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgaWYgKG5hbWUpIHtcclxuICAgICAgICBpZiAodGhpcy5hdHRyLm5hbWVQb3NpdGlvbiAhPSBcImhpZGVcIikge1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLnRleHQgPSBuYW1lLnRyaW0oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hdHRyLm5hbWUgPSBuYW1lLnRyaW0oKTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqICDlsIblhYPntKDliqDlhaXlrrnlmajlhoVcclxuICogIEBtZXRob2QgW0NdIGFkZFxyXG4gKiAgQHBhcmFtIGVsZW1lbnQge2VsZW1lbnR8YXJyYXl9IOS4gOiIrOS4uuiKgueCueexu+Wei+WvueixoeaIluaVsOe7hO+8jOWuueWZqOWKoOWFpeWuueWZqOWuueaYk+S6p+eUn0J1Z1xyXG4gKi9cclxuQ29udGFpbmVyLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgdmFyIHNlbGY9dGhpcztcclxuICAgIGlmICghJC5pc0FycmF5KHRoaXMuY2hpbGRyZW4pKSB7XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xyXG4gICAgfVxyXG4gICAgaWYgKCQuaXNBcnJheShlbGVtZW50KSkge1xyXG4gICAgICAgICQuZWFjaChlbGVtZW50LGZ1bmN0aW9uKGksZWwpe1xyXG4gICAgICAgICAgICBhZGRPbmNlKGVsKTtcclxuICAgICAgICB9KTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIGFkZE9uY2UoZWxlbWVudCk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBhZGRPbmNlKGVsZW1lbnQpe1xyXG4gICAgICAgIGlmIChlbGVtZW50JiZjaGVjayhlbGVtZW50KSYmIXNlbGYuaXNDaGlsZChlbGVtZW50KSkge1xyXG4gICAgICAgICAgICBzZWxmLmNoaWxkcmVuLnB1c2goZWxlbWVudCk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQucGFyZW50ID0gc2VsZjtcclxuICAgICAgICAgICAgc2VsZi5qdG9wby5hZGQoZWxlbWVudC5qdG9wbyk7XHJcbiAgICAgICAgICAgIGlmIChzZWxmLmF0dHIuY2hpbGRyZW4gJiYgdHlwZW9mIHNlbGYuYXR0ci5jaGlsZHJlbi5kcmFnZ2FibGUgPT0gXCJib29sZWFuXCIpIHtcclxuICAgICAgICAgICAgICAgIC8v6Iul5YiG57uE5LiN5YWB6K6456e75Yqo57uE5YaF5YWD57Sg77yM5omL5Yqo6K6+572u5YWD57Sg5LiN5Y+v56e75YqoXHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnNldERyYWdnYWJsZShzZWxmLmF0dHIuY2hpbGRyZW4uZHJhZ2dhYmxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGNoZWNrKGVsZW1lbnQpe1xyXG4gICAgICAgIHJldHVybiBlbGVtZW50LmdldFR5cGUoKT09UVRvcG8uY29uc3RhbnQuTk9ERSYmZWxlbWVudC5nZXRVc2VUeXBlKCkhPVFUb3BvLmNvbnN0YW50LkNBU1VBTCYmIWVsZW1lbnQucGFyZW50O1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICog5bCG5a2Q5YWD57Sg5LuO5a655Zmo5Lit5Yig6ZmkXHJcbiAqIEBtZXRob2QgW0NdIHJlbW92ZVxyXG4gKiBAcGFyYW0gZWxlbWVudCB7ZWxlbWVudH1cclxuICovXHJcbkNvbnRhaW5lci5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgIGlmICgkLmlzQXJyYXkodGhpcy5jaGlsZHJlbikgJiYgdGhpcy5pc0NoaWxkKGVsZW1lbnQpKSB7XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UodGhpcy5jaGlsZHJlbi5pbmRleE9mKGVsZW1lbnQpLCAxKTtcclxuICAgICAgICBkZWxldGUgZWxlbWVudC5wYXJlbnQ7XHJcbiAgICAgICAgdGhpcy5qdG9wby5yZW1vdmUoZWxlbWVudC5qdG9wbyk7XHJcbiAgICAgICAgLy/np7vpmaTlhYPntKDvvIzlupTmiYvliqjorr7lm57lhYPntKDlj6/np7vliqhcclxuICAgICAgICBlbGVtZW50LnNldERyYWdnYWJsZSh0cnVlKTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIOiOt+WPluWuueWZqOWfuuacrOexu+Wei1xyXG4gKiBAbWV0aG9kIFtDXSBnZXRUeXBlXHJcbiAqIEByZXR1cm4gUVRvcG8uY29uc3RhbnQuQ09OVEFJTkVSXHJcbiAqL1xyXG5Db250YWluZXIucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gUVRvcG8uY29uc3RhbnQuQ09OVEFJTkVSO1xyXG59O1xyXG4vKipcclxuICog6K6+572u5a655Zmo6IOM5pmv6ImyXHJcbiAqIEBtZXRob2QgW0NdIHNldENvbG9yXHJcbiAqIEBwYXJhbSBjb2xvciB7c3RyaW5nfSBcIjI1NSwyNTUsMjU1XCIvXCIjZmZmZmZmXCJcclxuICovXHJcbkNvbnRhaW5lci5wcm90b3R5cGUuc2V0Q29sb3IgPSBmdW5jdGlvbiAoY29sb3IpIHtcclxuICAgIGlmIChjb2xvcikge1xyXG4gICAgICAgIGNvbG9yID0gUVRvcG8udXRpbC50cmFuc0hleChjb2xvci50b0xvd2VyQ2FzZSgpKTtcclxuICAgICAgICB0aGlzLmp0b3BvLmZpbGxDb2xvciA9IGNvbG9yO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmNvbG9yID0gdGhpcy5qdG9wby5maWxsQ29sb3I7XHJcbn07XHJcbi8qKlxyXG4gKiDorr7nva7lrrnlmajlhoXlrZDlhYPntKDkuIDoiKzooYzkuLos5pyq5a6M5YWo5a6e546wXHJcbiAqIEBtZXRob2QgW0NdIHNldENoaWxkcmVuXHJcbiAqIEBwYXJhbSBjaGlsZHJlbiB7b2JqZWN0fVxyXG4gKiAgICAgICAgICBjaGlsZHJlbj17XHJcbiAqICAgICAgICAgICAgICAgICAgZHJhZ2dhYmxlOuaYr+WQpuWPr+enu+WKqHtib29sZWFufVxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5Db250YWluZXIucHJvdG90eXBlLnNldENoaWxkcmVuID0gZnVuY3Rpb24gKGNoaWxkcmVuKSB7XHJcbiAgICB2YXIganRvcG8gPSB0aGlzLmp0b3BvO1xyXG4gICAgaWYgKGNoaWxkcmVuKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBjaGlsZHJlbi5kcmFnZ2FibGUgPT0gXCJib29sZWFuXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5jaGlsZERyYWdnYWJsZSA9IGNoaWxkcmVuLmRyYWdnYWJsZTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuW2ldLnNldERyYWdnYWJsZShjaGlsZHJlbi5kcmFnZ2FibGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmNoaWxkcmVuLmRyYWdnYWJsZSA9IGp0b3BvLmNoaWxkRHJhZ2dhYmxlO1xyXG59O1xyXG4vKipcclxuICog5a655Zmo57yp5pS+5YiH5o2iLOWcqHNjZW5l5Yib5bu65pe25Y+v6YCJ5piv5ZCm5o+Q5L6b5YiH5o2iXHJcbiAqXHJcbiAqIOWPr+WcqOWIm+W7uuaXtuWinuWKoOWPguaVsCB0b2dnbGU6e2Nsb3NlOnRydWV95p2l5Yib5bu65LiA5Liq5LiN5Y+v5YiH5o2i55qE5a655ZmoXHJcbiAqXHJcbiAqIOiLpeaXoOWIh+aNouWvueixoe+8jOWImeivpeaWueazleaXoOWKqOS9nFxyXG4gKiBAbWV0aG9kIFtDXSB0b2dnbGVcclxuICogQHBhcmFtIFtmbGFnXSDkuLp0cnVl5YiZ5by65Yi257yp5pS+77yM5Li6ZmFsc2XliJnlvLrliLblsZXlvIDvvIzml6DlgLzliJnoh6rpgILlupTliIfmjaIsXHJcbiAqL1xyXG5Db250YWluZXIucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uIChmbGFnKSB7XHJcbiAgICBpZiAodGhpcy50b2dnbGVUbykge1xyXG4gICAgICAgIHZhciBnSnRvcG8gPSB0aGlzLmp0b3BvO1xyXG4gICAgICAgIHZhciBuSnRvcG8gPSB0aGlzLnRvZ2dsZVRvLmp0b3BvO1xyXG4gICAgICAgIHZhciB0b2RvID0gdHlwZW9mIGZsYWcgPT0gXCJib29sZWFuXCIgPyBmbGFnIDogZ0p0b3BvLnZpc2libGU7XHJcbiAgICAgICAgaWYgKHRvZG8pIHtcclxuICAgICAgICAgICAgLy/nvKnmlL5cclxuICAgICAgICAgICAgdGhpcy5oaWRlKCk7XHJcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlVG8uc2hvdygpO1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVRvLnNldFBvc2l0aW9uKFtnSnRvcG8uY3ggLSBuSnRvcG8ud2lkdGggLyAyLCBnSnRvcG8uY3kgLSBuSnRvcG8uaGVpZ2h0IC8gMl0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8v5bGV5byAXHJcbiAgICAgICAgICAgIHRoaXMuc2hvdygpO1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVRvLmhpZGUoKTtcclxuICAgICAgICAgICAgdGhpcy5zZXRQb3NpdGlvbihbbkp0b3BvLmN4IC0gZ0p0b3BvLndpZHRoIC8gMiwgbkp0b3BvLmN5IC0gZ0p0b3BvLmhlaWdodCAvIDJdKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiDliKTmlq3lhYPntKDmmK/lkKblt7LmmK/lrZDlhYPntKBcclxuICogQG1ldGhvZCBbQ10gaXNDaGlsZFxyXG4gKiBAcGFyYW0gZWxlbWVudCDliKTmlq3nmoTlrZDlhYPntKBcclxuICogQHJldHVybiB7Ym9vbGVhbn1cclxuICovXHJcbkNvbnRhaW5lci5wcm90b3R5cGUuaXNDaGlsZCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICBpZiAoJC5pc0FycmF5KHRoaXMuY2hpbGRyZW4pKSB7XHJcbiAgICAgICAgdmFyIGluZGV4PXRoaXMuY2hpbGRyZW4uaW5kZXhPZihlbGVtZW50KTtcclxuICAgICAgICBpZiAoZWxlbWVudC5wYXJlbnQgIT0gdGhpcyYmIGluZGV4PiAtMSkge1xyXG4gICAgICAgICAgICBRVG9wby51dGlsLmVycm9yKFwic29tZSBncm91cCBnZXQgZXJyb3IsdGhlIGNoaWxkJ3MgcGFyZW50IGlzIG5vdCBpdCBhbmQgdGhlIGNoaWxkIGluIGl0cyBjaGlsZHJlbixpbmRleCBpcyBcIitpbmRleCwgdGhpcyxlbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGluZGV4Pi0xO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiDliKTmlq3lhYPntKDmmK/lkKblnKjliIbnu4Topobnm5bnmoTojIPlm7TlhoUs5Li05pe25YWD57Sg5LiN6ICD6JmRXHJcbiAqIEBtZXRob2QgW0NdIGlzSW5zaWRlXHJcbiAqIEBwYXJhbSBlbGVtZW50IOWIpOaWreeahOWFg+e0oFxyXG4gKiBAcmV0dXJuIHtib29sZWFufVxyXG4gKi9cclxuQ29udGFpbmVyLnByb3RvdHlwZS5pc0luc2lkZSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50LmdldFR5cGUoKSAhPSBRVG9wby5jb25zdGFudC5DQVNVQUwpIHtcclxuICAgICAgICB2YXIgY2VudGVyID0gZWxlbWVudC5nZXRDZW50ZXJQb3NpdGlvbigpO1xyXG4gICAgICAgIHJldHVybiAhdGhpcy5pc0NoaWxkKGVsZW1lbnQpICYmIGNlbnRlci54ID4gdGhpcy54ICYmIGNlbnRlci54IDwgKHRoaXMueCArIHRoaXMud2lkdGgpICYmIGNlbnRlci55ID4gdGhpcy55ICYmIGNlbnRlci55IDwgKHRoaXMueSArIHRoaXMuaGVpZ2h0KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICog5YiG57uE5bGe5oCn5o+Q5Y+WXHJcbiAqIEBtZXRob2QgW0NdIHRvSnNvblxyXG4gKiBAcmV0dXJuIHtvYmplY3R9XHJcbiAqL1xyXG5Db250YWluZXIucHJvdG90eXBlLnRvSnNvbj1mdW5jdGlvbigpe1xyXG4gICAgdmFyIGpzb249JC5leHRlbmQoe30sdGhpcy5hdHRyKTtcclxuICAgIGpzb24uZXh0cmE9JC5leHRlbmQoe30sdGhpcy5leHRyYSk7XHJcbiAgICBqc29uLmNoaWxkcmVuPVtdO1xyXG4gICAgdGhpcy5jaGlsZHJlbi5tYXAoZnVuY3Rpb24oY2hpbGQpe1xyXG4gICAgICAgIGpzb24uY2hpbGRyZW4ucHVzaChjaGlsZC5nZXQoJ2pzb25JZCcpKTtcclxuICAgIH0pO1xyXG4gICAganNvbi50b2dnbGU9dGhpcy50b2dnbGVUby50b0pzb24oKTtcclxuICAgIHJldHVybiBqc29uO1xyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvY29udGFpbmVyL0NvbnRhaW5lci5qc1xuLy8gbW9kdWxlIGlkID0gNTVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports,__webpack_require__){eval("/**\r\n * @module core\r\n */\r\n/**\r\n * 图形节点\r\n * @class  Group\r\n * @constructor\r\n * @extends [C] Container\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Container=__webpack_require__(55);\r\nmodule.exports =  {\r\n    constructor:Group,\r\n    setDefault:setDefault,\r\n    getDefault:getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n        name: 'group',\r\n        font:{\r\n            size:16,\r\n            type:\"微软雅黑\",\r\n            color:'255,255,255'\r\n        },\r\n        color: '10,10,100',\r\n        alpha: 0.5,\r\n        draggable: true,\r\n        zIndex: 1,\r\n        jsonId:\"\",\r\n        border:{\r\n            width:0,\r\n            radius:30,\r\n            color:\"255,0,0\"\r\n        },\r\n        size:[500,500],\r\n        position:[0,0],\r\n        namePosition: 'bottom',//Bottom_Center Top_Center Middle_Left Middle_Right Hidden,\r\n        layout: {\r\n            type:\"default\"\r\n        },\r\n        children:{\r\n            showLink: false,\r\n            showName: true,\r\n            draggable: true\r\n        },\r\n        useType:QTopo.constant.container.GROUP\r\n};\r\nfunction setDefault(config){\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault(){\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\n//----\r\n//----\r\nfunction Group(config) {\r\n    this.attr =  QTopo.util.extend(getDefault(), config || {});\r\n    Container.call(this, new JTopo.Container());\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(Group,Container);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName(\"..\")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\n//-\r\n/**\r\n *\r\n *  @method setLayout\r\n *  @param layout {object} 图片相对路径\r\n *      @param layout.type {string} flow(固定宽高,组员流式布局), grid(固定宽高,组员行列布局), fixed(固定宽高,组员可拖动), default(宽高自适应)\r\n *      @param [layout.row] {number} 当type=flow时,用以设置水平间隔 ,当type=grid时,用以设置行数\r\n *      @param [layout.column] {number} 当type=flow时,用以设置垂直间隔 ,当type=grid时,用以设置列数\r\n */\r\nGroup.prototype.setLayout=function(layout){\r\n    var selected;\r\n    if (layout) {\r\n        switch (layout.type) {\r\n            case 'flow':\r\n                // 流式布局（水平,垂直间隔)\r\n                selected = JTopo.layout.FlowLayout(parseInt(layout.row), parseInt(layout.column));\r\n                this.attr.layout=layout;\r\n                break;\r\n            case 'grid':\r\n                // 网格布局(行,列)\r\n                var rows=parseInt(layout.row);\r\n                var columns=parseInt(layout.column);\r\n                if(rows*columns<this.children.length){\r\n                    QTopo.util.error(\"GridLayout's row*column need bigger than group's children length\");\r\n                    columns=rows= Math.ceil(Math.sqrt(todo.target.children.length));\r\n                }\r\n                selected = JTopo.layout.GridLayout(rows,columns);\r\n                this.attr.layout=layout;\r\n                break;\r\n            case 'fixed':\r\n                //固定长宽布局\r\n                selected = JTopo.Layout.FixedBoundLayout();\r\n                this.attr.layout=layout;\r\n                break;\r\n            default:\r\n                selected = JTopo.Layout.AutoBoundLayout();\r\n                this.attr.layout={};\r\n                this.attr.layout.type=\"default\";\r\n        }\r\n    } else {\r\n        selected = JTopo.Layout.AutoBoundLayout();\r\n        this.attr.layout={};\r\n        this.attr.layout.type=\"default\";\r\n    }\r\n    this.jtopo.layout = selected;\r\n};\r\n/**\r\n *  获取全局设置\r\n *  @method getDefault\r\n *  @return config {object} 全局配置的克隆对象[只读]，修改该对象不会直接修改全局配置，若要修改全局配置请使用scene.setDefault\r\n *  @example\r\n *          默认全局参数:\r\n *              var DEFAULT = {\r\n                                name: 'group',\r\n                                font:{\r\n                                    size:16,\r\n                                    type:\"微软雅黑\",\r\n                                    color:'255,255,255'\r\n                                },\r\n                                color: '10,10,100',\r\n                                alpha: 0.5,\r\n                                draggable: true,\r\n                                zIndex: 1,\r\n                                jsonId:\"\",\r\n                                border:{\r\n                                    width:0,\r\n                                    radius:30,\r\n                                    color:\"255,0,0\"\r\n                                },\r\n                                size:[500,500],\r\n                                position:[0,0],\r\n                                namePosition: 'bottom',//Bottom_Center Top_Center Middle_Left Middle_Right Hidden,\r\n                                layout: {\r\n                                    type:\"default\"\r\n                                },\r\n                                children:{//待定设置，未完全实现\r\n                                    showLink: false,\r\n                                    showName: true,\r\n                                    draggable: true\r\n                                },\r\n                                useType:QTopo.constant.container.GROUP\r\n                        };\r\n */\r\nGroup.prototype.getDefault=getDefault;\r\n//-//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9jb250YWluZXIvR3JvdXAuanM/YjdmYSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZEO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixPQUFPO0FBQzFCLDRCQUE0QixPQUFPO0FBQ25DLDZCQUE2QixPQUFPO0FBQ3BDLGdDQUFnQyxPQUFPO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixPQUFPO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakMsMENBQTBDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjU2LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLyoqXHJcbiAqIOWbvuW9ouiKgueCuVxyXG4gKiBAY2xhc3MgIEdyb3VwXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbQ10gQ29udGFpbmVyXHJcbiAqIEBwYXJhbSBbY29uZmlnXSDphY3nva7lj4LmlbDvvIzml6Dlj4LliJnmjInlhajlsYDphY3nva7liJvlu7pcclxuICovXHJcbnZhciBDb250YWluZXI9cmVxdWlyZShcIi4vQ29udGFpbmVyLmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9ICB7XHJcbiAgICBjb25zdHJ1Y3RvcjpHcm91cCxcclxuICAgIHNldERlZmF1bHQ6c2V0RGVmYXVsdCxcclxuICAgIGdldERlZmF1bHQ6Z2V0RGVmYXVsdFxyXG59O1xyXG4vLy1cclxudmFyIERFRkFVTFQgPSB7XHJcbiAgICAgICAgbmFtZTogJ2dyb3VwJyxcclxuICAgICAgICBmb250OntcclxuICAgICAgICAgICAgc2l6ZToxNixcclxuICAgICAgICAgICAgdHlwZTpcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICBjb2xvcjonMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb2xvcjogJzEwLDEwLDEwMCcsXHJcbiAgICAgICAgYWxwaGE6IDAuNSxcclxuICAgICAgICBkcmFnZ2FibGU6IHRydWUsXHJcbiAgICAgICAgekluZGV4OiAxLFxyXG4gICAgICAgIGpzb25JZDpcIlwiLFxyXG4gICAgICAgIGJvcmRlcjp7XHJcbiAgICAgICAgICAgIHdpZHRoOjAsXHJcbiAgICAgICAgICAgIHJhZGl1czozMCxcclxuICAgICAgICAgICAgY29sb3I6XCIyNTUsMCwwXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNpemU6WzUwMCw1MDBdLFxyXG4gICAgICAgIHBvc2l0aW9uOlswLDBdLFxyXG4gICAgICAgIG5hbWVQb3NpdGlvbjogJ2JvdHRvbScsLy9Cb3R0b21fQ2VudGVyIFRvcF9DZW50ZXIgTWlkZGxlX0xlZnQgTWlkZGxlX1JpZ2h0IEhpZGRlbixcclxuICAgICAgICBsYXlvdXQ6IHtcclxuICAgICAgICAgICAgdHlwZTpcImRlZmF1bHRcIlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2hpbGRyZW46e1xyXG4gICAgICAgICAgICBzaG93TGluazogZmFsc2UsXHJcbiAgICAgICAgICAgIHNob3dOYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICBkcmFnZ2FibGU6IHRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIHVzZVR5cGU6UVRvcG8uY29uc3RhbnQuY29udGFpbmVyLkdST1VQXHJcbn07XHJcbmZ1bmN0aW9uIHNldERlZmF1bHQoY29uZmlnKXtcclxuICAgIFFUb3BvLnV0aWwuZXh0ZW5kKERFRkFVTFQsIGNvbmZpZyB8fCB7fSk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0RGVmYXVsdCgpe1xyXG4gICAgcmV0dXJuIFFUb3BvLnV0aWwuZGVlcENsb25lKERFRkFVTFQpO1xyXG59XHJcbi8vLVxyXG4vLy0tLS1cclxuLy8tLS0tXHJcbmZ1bmN0aW9uIEdyb3VwKGNvbmZpZykge1xyXG4gICAgdGhpcy5hdHRyID0gIFFUb3BvLnV0aWwuZXh0ZW5kKGdldERlZmF1bHQoKSwgY29uZmlnIHx8IHt9KTtcclxuICAgIENvbnRhaW5lci5jYWxsKHRoaXMsIG5ldyBKVG9wby5Db250YWluZXIoKSk7XHJcbiAgICAvL+WHveaVsFxyXG4gICAgdGhpcy5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICB0aGlzLnNldCh0aGlzLmF0dHIpO1xyXG59XHJcblFUb3BvLnV0aWwuaW5oZXJpdHMoR3JvdXAsQ29udGFpbmVyKTtcclxuLy8tXHJcbi8qKlxyXG4gKiAg5YWD57Sg5a+55bGe5oCn55qE57uf5LiA6K6+572u5Ye95pWw77yM5o6o6I2Q5L2/55SoXHJcbiAqXHJcbiAqICDlj4LmlbDlj6/orr7nva7kuIDpobnmiJblpJrpobks5pyq6K6+572u6YOo5YiG5Y+C6ICD5YWo5bGA6YWN572uXHJcbiAqICBAbWV0aG9kIHNldFxyXG4gKiAgQHBhcmFtIGNvbmZpZ1xyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAg5a6e6ZmF5Y+C5pWw5Y+C6ICDYXR0cuWGheWxnuaApyzlj6rkvJrkv67mlLnmnInlr7nlupRzZXTlh73mlbDnmoTlsZ7mgKcs6Iul5paw5aKe5bGe5oCn5LiU5re75Yqg5LqGc2V0WFhY5Ye95pWw77yM5Lmf5Y+v55So5q2k5Ye95pWw6YWN572uXHJcbiAqICAgICAgICAgIOWmgjpuYW1lIOWvueW6lCBzZXROYW1lKFwiLi5cIilcclxuICogICAgICAgICAg5Y+C5pWw5qC85byP5aaC5LiLXHJcbiAqICAgICAgICAgIGNvbmZpZz17XHJcbiAqICAgICAgICAgICAgICB4eDouLi4sXHJcbiAqICAgICAgICAgICAgICB4eDouLi5cclxuICogICAgICAgICAgfVxyXG4gKi9cclxuZnVuY3Rpb24gc2V0SlRvcG8oY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGY9dGhpcztcclxuICAgICAgICBzZWxmLl9zZXRBdHRyKGNvbmZpZyk7XHJcbiAgICB9XHJcbn1cclxuLy8tXHJcbi8qKlxyXG4gKlxyXG4gKiAgQG1ldGhvZCBzZXRMYXlvdXRcclxuICogIEBwYXJhbSBsYXlvdXQge29iamVjdH0g5Zu+54mH55u45a+56Lev5b6EXHJcbiAqICAgICAgQHBhcmFtIGxheW91dC50eXBlIHtzdHJpbmd9IGZsb3co5Zu65a6a5a696auYLOe7hOWRmOa1geW8j+W4g+WxgCksIGdyaWQo5Zu65a6a5a696auYLOe7hOWRmOihjOWIl+W4g+WxgCksIGZpeGVkKOWbuuWumuWuvemrmCznu4TlkZjlj6/mi5bliqgpLCBkZWZhdWx0KOWuvemrmOiHqumAguW6lClcclxuICogICAgICBAcGFyYW0gW2xheW91dC5yb3ddIHtudW1iZXJ9IOW9k3R5cGU9Zmxvd+aXtiznlKjku6Xorr7nva7msLTlubPpl7TpmpQgLOW9k3R5cGU9Z3JpZOaXtiznlKjku6Xorr7nva7ooYzmlbBcclxuICogICAgICBAcGFyYW0gW2xheW91dC5jb2x1bW5dIHtudW1iZXJ9IOW9k3R5cGU9Zmxvd+aXtiznlKjku6Xorr7nva7lnoLnm7Tpl7TpmpQgLOW9k3R5cGU9Z3JpZOaXtiznlKjku6Xorr7nva7liJfmlbBcclxuICovXHJcbkdyb3VwLnByb3RvdHlwZS5zZXRMYXlvdXQ9ZnVuY3Rpb24obGF5b3V0KXtcclxuICAgIHZhciBzZWxlY3RlZDtcclxuICAgIGlmIChsYXlvdXQpIHtcclxuICAgICAgICBzd2l0Y2ggKGxheW91dC50eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2Zsb3cnOlxyXG4gICAgICAgICAgICAgICAgLy8g5rWB5byP5biD5bGA77yI5rC05bmzLOWeguebtOmXtOmalClcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gSlRvcG8ubGF5b3V0LkZsb3dMYXlvdXQocGFyc2VJbnQobGF5b3V0LnJvdyksIHBhcnNlSW50KGxheW91dC5jb2x1bW4pKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci5sYXlvdXQ9bGF5b3V0O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2dyaWQnOlxyXG4gICAgICAgICAgICAgICAgLy8g572R5qC85biD5bGAKOihjCzliJcpXHJcbiAgICAgICAgICAgICAgICB2YXIgcm93cz1wYXJzZUludChsYXlvdXQucm93KTtcclxuICAgICAgICAgICAgICAgIHZhciBjb2x1bW5zPXBhcnNlSW50KGxheW91dC5jb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgaWYocm93cypjb2x1bW5zPHRoaXMuY2hpbGRyZW4ubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiR3JpZExheW91dCdzIHJvdypjb2x1bW4gbmVlZCBiaWdnZXIgdGhhbiBncm91cCdzIGNoaWxkcmVuIGxlbmd0aFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zPXJvd3M9IE1hdGguY2VpbChNYXRoLnNxcnQodG9kby50YXJnZXQuY2hpbGRyZW4ubGVuZ3RoKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IEpUb3BvLmxheW91dC5HcmlkTGF5b3V0KHJvd3MsY29sdW1ucyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIubGF5b3V0PWxheW91dDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdmaXhlZCc6XHJcbiAgICAgICAgICAgICAgICAvL+WbuuWumumVv+WuveW4g+WxgFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQgPSBKVG9wby5MYXlvdXQuRml4ZWRCb3VuZExheW91dCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyLmxheW91dD1sYXlvdXQ7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gSlRvcG8uTGF5b3V0LkF1dG9Cb3VuZExheW91dCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyLmxheW91dD17fTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci5sYXlvdXQudHlwZT1cImRlZmF1bHRcIjtcclxuICAgICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHNlbGVjdGVkID0gSlRvcG8uTGF5b3V0LkF1dG9Cb3VuZExheW91dCgpO1xyXG4gICAgICAgIHRoaXMuYXR0ci5sYXlvdXQ9e307XHJcbiAgICAgICAgdGhpcy5hdHRyLmxheW91dC50eXBlPVwiZGVmYXVsdFwiO1xyXG4gICAgfVxyXG4gICAgdGhpcy5qdG9wby5sYXlvdXQgPSBzZWxlY3RlZDtcclxufTtcclxuLyoqXHJcbiAqICDojrflj5blhajlsYDorr7nva5cclxuICogIEBtZXRob2QgZ2V0RGVmYXVsdFxyXG4gKiAgQHJldHVybiBjb25maWcge29iamVjdH0g5YWo5bGA6YWN572u55qE5YWL6ZqG5a+56LGhW+WPquivu13vvIzkv67mlLnor6Xlr7nosaHkuI3kvJrnm7TmjqXkv67mlLnlhajlsYDphY3nva7vvIzoi6XopoHkv67mlLnlhajlsYDphY3nva7or7fkvb/nlKhzY2VuZS5zZXREZWZhdWx0XHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICAgICDpu5jorqTlhajlsYDlj4LmlbA6XHJcbiAqICAgICAgICAgICAgICB2YXIgREVGQVVMVCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnZ3JvdXAnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOjE2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOlwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOicyNTUsMjU1LDI1NSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnMTAsMTAsMTAwJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTogMC41LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdnYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6SW5kZXg6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbklkOlwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyOntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6MCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFkaXVzOjMwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjpcIjI1NSwwLDBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTpbNTAwLDUwMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246WzAsMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVBvc2l0aW9uOiAnYm90dG9tJywvL0JvdHRvbV9DZW50ZXIgVG9wX0NlbnRlciBNaWRkbGVfTGVmdCBNaWRkbGVfUmlnaHQgSGlkZGVuLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOlwiZGVmYXVsdFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjp7Ly/lvoXlrprorr7nva7vvIzmnKrlrozlhajlrp7njrBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0xpbms6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93TmFtZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ2dhYmxlOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOlFUb3BvLmNvbnN0YW50LmNvbnRhaW5lci5HUk9VUFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gKi9cclxuR3JvdXAucHJvdG90eXBlLmdldERlZmF1bHQ9Z2V0RGVmYXVsdDtcclxuLy8tXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9jb250YWluZXIvR3JvdXAuanNcbi8vIG1vZHVsZSBpZCA9IDU2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=");
},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 图形节点\r\n * @class  DirectLine\r\n * @constructor\r\n * @extends [LE] Line\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Line=__webpack_require__(58);\r\nmodule.exports =  {\r\n    constructor:DirectLine,\r\n    setDefault:setDefault,\r\n    getDefault:getDefault\r\n};\r\n//-\r\nvar DEFAULT={\r\n        num: 1,\r\n        alpha:1,\r\n        color: \'22,124,255\',\r\n        arrow:{\r\n            size:null,\r\n            offset:0,\r\n            start:false,\r\n            end:true\r\n        },\r\n        jsonId:"",\r\n        gap:20,\r\n        position:{\r\n            start:[0,0],\r\n            end:[0,100]\r\n        },\r\n        path:{\r\n            start:{},\r\n            end:{}\r\n        },\r\n        width: 2,\r\n        dashed:  null,\r\n        zIndex : 2,\r\n        font:{\r\n            size:16,\r\n            type:"微软雅黑",\r\n            color:\'255,255,255\'\r\n        },\r\n        useType: QTopo.constant.line.DIRECT,\r\n        offset:60// 多条直线时，线条折线拐角处的长度\r\n};\r\nfunction setDefault(config){\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault(){\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\nfunction DirectLine(config) {\r\n    this.attr =  QTopo.util.extend(getDefault(), config || {});\r\n    //line基于不加入画布的节点之间的线生成\r\n    Line.call(this,new JTopo.Link(new JTopo.Node(), new JTopo.Node()));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(DirectLine,Line);\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *          var DEFAULT = {\r\n                                number: 1,\r\n                                alpha: 1,\r\n                                color: \'22,124,255\',\r\n                                arrow: {\r\n                                    size: 10,\r\n                                    offset: 0,\r\n                                    start: false,\r\n                                    end: false\r\n                                },\r\n                                position:{\r\n                                    start:[0,0],\r\n                                    end:[0,100]\r\n                                },\r\n                                jsonId:"",\r\n                                gap: 20,\r\n                                width: 3,\r\n                                dashed: null,\r\n                                zIndex: 2,\r\n                                font: {\r\n                                    size: 16,\r\n                                    type: "微软雅黑",\r\n                                    color: \'255,255,255\'\r\n                                },\r\n                                expendAble: true,\r\n                                useType: QTopo.constant.line.DIRECT,\r\n                                offset: 60\r\n                            };\r\n */\r\nDirectLine.prototype.getDefault=getDefault;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5lL0RpcmVjdC5qcz85OTFmIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQ7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiI1Ny5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDlm77lvaLoioLngrlcclxuICogQGNsYXNzICBEaXJlY3RMaW5lXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbTEVdIExpbmVcclxuICogQHBhcmFtIFtjb25maWddIOmFjee9ruWPguaVsO+8jOaXoOWPguWImeaMieWFqOWxgOmFjee9ruWIm+W7ulxyXG4gKi9cclxudmFyIExpbmU9cmVxdWlyZShcIi4vTGluZS5qc1wiKTtcclxubW9kdWxlLmV4cG9ydHMgPSAge1xyXG4gICAgY29uc3RydWN0b3I6RGlyZWN0TGluZSxcclxuICAgIHNldERlZmF1bHQ6c2V0RGVmYXVsdCxcclxuICAgIGdldERlZmF1bHQ6Z2V0RGVmYXVsdFxyXG59O1xyXG4vLy1cclxudmFyIERFRkFVTFQ9e1xyXG4gICAgICAgIG51bTogMSxcclxuICAgICAgICBhbHBoYToxLFxyXG4gICAgICAgIGNvbG9yOiAnMjIsMTI0LDI1NScsXHJcbiAgICAgICAgYXJyb3c6e1xyXG4gICAgICAgICAgICBzaXplOm51bGwsXHJcbiAgICAgICAgICAgIG9mZnNldDowLFxyXG4gICAgICAgICAgICBzdGFydDpmYWxzZSxcclxuICAgICAgICAgICAgZW5kOnRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIGpzb25JZDpcIlwiLFxyXG4gICAgICAgIGdhcDoyMCxcclxuICAgICAgICBwb3NpdGlvbjp7XHJcbiAgICAgICAgICAgIHN0YXJ0OlswLDBdLFxyXG4gICAgICAgICAgICBlbmQ6WzAsMTAwXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcGF0aDp7XHJcbiAgICAgICAgICAgIHN0YXJ0Ont9LFxyXG4gICAgICAgICAgICBlbmQ6e31cclxuICAgICAgICB9LFxyXG4gICAgICAgIHdpZHRoOiAyLFxyXG4gICAgICAgIGRhc2hlZDogIG51bGwsXHJcbiAgICAgICAgekluZGV4IDogMixcclxuICAgICAgICBmb250OntcclxuICAgICAgICAgICAgc2l6ZToxNixcclxuICAgICAgICAgICAgdHlwZTpcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICBjb2xvcjonMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgfSxcclxuICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5lLkRJUkVDVCxcclxuICAgICAgICBvZmZzZXQ6NjAvLyDlpJrmnaHnm7Tnur/ml7bvvIznur/mnaHmipjnur/mi5Dop5LlpITnmoTplb/luqZcclxufTtcclxuZnVuY3Rpb24gc2V0RGVmYXVsdChjb25maWcpe1xyXG4gICAgUVRvcG8udXRpbC5leHRlbmQoREVGQVVMVCwgY29uZmlnIHx8IHt9KTtcclxufVxyXG5mdW5jdGlvbiBnZXREZWZhdWx0KCl7XHJcbiAgICByZXR1cm4gUVRvcG8udXRpbC5kZWVwQ2xvbmUoREVGQVVMVCk7XHJcbn1cclxuLy8tXHJcbmZ1bmN0aW9uIERpcmVjdExpbmUoY29uZmlnKSB7XHJcbiAgICB0aGlzLmF0dHIgPSAgUVRvcG8udXRpbC5leHRlbmQoZ2V0RGVmYXVsdCgpLCBjb25maWcgfHwge30pO1xyXG4gICAgLy9saW5l5Z+65LqO5LiN5Yqg5YWl55S75biD55qE6IqC54K55LmL6Ze055qE57q/55Sf5oiQXHJcbiAgICBMaW5lLmNhbGwodGhpcyxuZXcgSlRvcG8uTGluayhuZXcgSlRvcG8uTm9kZSgpLCBuZXcgSlRvcG8uTm9kZSgpKSk7XHJcbiAgICAvL+WHveaVsFxyXG4gICAgdGhpcy5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICB0aGlzLnNldCh0aGlzLmF0dHIpO1xyXG59XHJcblFUb3BvLnV0aWwuaW5oZXJpdHMoRGlyZWN0TGluZSxMaW5lKTtcclxuLyoqXHJcbiAqICDlhYPntKDlr7nlsZ7mgKfnmoTnu5/kuIDorr7nva7lh73mlbDvvIzmjqjojZDkvb/nlKhcclxuICpcclxuICogIOWPguaVsOWPr+iuvue9ruS4gOmhueaIluWkmumhuSzmnKrorr7nva7pg6jliIblj4LogIPlhajlsYDphY3nva5cclxuICogIEBtZXRob2Qgc2V0XHJcbiAqICBAcGFyYW0gY29uZmlnXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICAgICDlrp7pmYXlj4LmlbDlj4LogINhdHRy5YaF5bGe5oCnLOWPquS8muS/ruaUueacieWvueW6lHNldOWHveaVsOeahOWxnuaApyzoi6XmlrDlop7lsZ7mgKfkuJTmt7vliqDkuoZzZXRYWFjlh73mlbDvvIzkuZ/lj6/nlKjmraTlh73mlbDphY3nva5cclxuICogICAgICAgICAg5aaCOm5hbWUg5a+55bqUIHNldE5hbWUoXCIuLlwiKVxyXG4gKiAgICAgICAgICDlj4LmlbDmoLzlvI/lpoLkuItcclxuICogICAgICAgICAgY29uZmlnPXtcclxuICogICAgICAgICAgICAgIHh4Oi4uLixcclxuICogICAgICAgICAgICAgIHh4Oi4uLlxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5mdW5jdGlvbiBzZXRKVG9wbyhjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICB2YXIgc2VsZj10aGlzO1xyXG4gICAgICAgIHNlbGYuX3NldEF0dHIoY29uZmlnKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICog6I635Y+W5YWD57Sg5YWo5bGA5qC35byPXHJcbiAqIEBtZXRob2QgZ2V0RGVmYXVsdFxyXG4gKiBAcmV0dXJuIHtvYmplY3R9XHJcbiAqIEBleGFtcGxlXHJcbiAqICAgICAgICAgIHZhciBERUZBVUxUID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlcjogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFycm93OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDEwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDpbMCwwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOlswLDEwMF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb25JZDpcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhcDogMjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFzaGVkOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpJbmRleDogMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJzI1NSwyNTUsMjU1J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZW5kQWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5lLkRJUkVDVCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IDYwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gKi9cclxuRGlyZWN0TGluZS5wcm90b3R5cGUuZ2V0RGVmYXVsdD1nZXREZWZhdWx0O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbGluZS9EaXJlY3QuanNcbi8vIG1vZHVsZSBpZCA9IDU3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=')},function(module,exports,__webpack_require__){eval("/**\r\n * @module core\r\n */\r\n/**\r\n * 线段基类,用以继承 [E]开头继承于Element,[LE]开头为自身api\r\n * @class [LE] Line\r\n * @constructor\r\n * @extends [E] Element\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\nvar Element=__webpack_require__(2);\r\nmodule.exports =Line;\r\nfunction Line(jtopo) {\r\n    if(jtopo){\r\n        Element.call(this,jtopo);\r\n    }else{\r\n        QTopo.util.error(\"create Line without jtopo\",this);\r\n    }\r\n    /**\r\n     * 记录线段的首尾元素,首尾元素一般隐藏，且为jtopo对象，仅作为绘制的坐标点\r\n     * @property [LE] path {object}\r\n     * @param start {object} 起始元素\r\n     * @param end {object} 终点元素\r\n     */\r\n    this.attr.path={\r\n        start:this.jtopo.nodeA,\r\n        end:this.jtopo.nodeZ\r\n    };\r\n}\r\nQTopo.util.inherits(Line,Element);\r\n/**\r\n *  设置线段位置,原理是设置线段首尾处隐藏jtopo节点的位置\r\n *  @method [LE] setPosition\r\n *  @param position {object}\r\n *\r\n *          position={\r\n *              start:[x,y],\r\n *              end:[x,y]\r\n *          }\r\n */\r\nLine.prototype.setPosition=function(position){\r\n    var start=this.attr.path.start;\r\n    var end=this.attr.path.end;\r\n    if($.isArray(position.start)&&$.isNumeric(position.start[0])&&$.isNumeric(position.start[1])){\r\n        start.setLocation(parseInt(position.start[0]), parseInt(position.start[1]));\r\n    }\r\n    if($.isArray(position.end)&&$.isNumeric(position.end[0])&&$.isNumeric(position.end[1])){\r\n        end.setLocation(parseInt(position.end[0]), parseInt(position.end[1]));\r\n    }\r\n    this.attr.position={\r\n        start:[start.x,start.y],\r\n        end:[end.x,end.y]\r\n    };\r\n};\r\n/**\r\n *  获取基本类型\r\n *  @method [LE] getType\r\n *  @return QTopo.constant.Line {string}\r\n */\r\nLine.prototype.getType=function(){\r\n    return QTopo.constant.Line;\r\n};\r\n/**\r\n *  设置线段颜色\r\n *  @method [LE] setColor\r\n *  @param color{string} \"255,255,255\"/\"#ffffff\"\r\n */\r\nLine.prototype.setColor = function (color) {\r\n    if (color) {\r\n        this.jtopo.strokeColor = QTopo.util.transHex(color.toLowerCase());\r\n    }\r\n    this.attr.color=this.jtopo.strokeColor;\r\n};\r\n/**\r\n *  设置线段计数\r\n *  @method [LE] setNum\r\n *  @param {number} num\r\n */\r\nLine.prototype.setNum = function (num) {\r\n    if ($.isNumeric(num)) {\r\n        if(num > 1){\r\n            this.jtopo.text = '(+' + num + ')';\r\n        }else {\r\n            this.jtopo.text = '';\r\n        }\r\n        this.attr.num=num;\r\n    }\r\n};\r\n/**\r\n *  设置线段宽度\r\n *  @method [LE] setWidth\r\n *  @param {number} width\r\n */\r\nLine.prototype.setWidth=function(width){\r\n    if($.isNumeric(width)){\r\n        this.jtopo.lineWidth = width; // 线宽\r\n    }\r\n    this.attr.width=this.jtopo.lineWidth;\r\n};\r\n/**\r\n *  设置线段两端箭头参数\r\n *  @method [LE] setArrow\r\n *  @param arrow {object}\r\n *\r\n *          arrow={\r\n *              size:箭头大小{number},\r\n *              offset:箭头在链路上的偏移量{number},\r\n *              start:是否显示起点箭头{boolean},\r\n *              end:是否显示终点箭头{boolean},\r\n *          }\r\n */\r\nLine.prototype.setArrow = function(arrow){\r\n    if(arrow){\r\n        this.jtopo.arrowsRadius = $.isNumeric(arrow.size)?arrow.size:0;\r\n        this.jtopo.arrowsOffset = $.isNumeric(arrow.offset)?arrow.offset:0;\r\n    }\r\n    if(!this.attr.arrow){\r\n        this.attr.arrow={};\r\n    }\r\n    this.attr.arrow.size=this.jtopo.arrowsRadius;\r\n    this.attr.arrow.offset=this.jtopo.arrowsOffset;\r\n};\r\n/**\r\n *  设置相同起点和终点的链路之间的间隔大小\r\n *\r\n *  @method [LE] setGap\r\n *  @param gap {number}\r\n */\r\nLine.prototype.setGap=function(gap){\r\n    if(gap){\r\n        this.jtopo.bundleGap = $.isNumeric(gap)?gap:0; // 线条之间的间隔\r\n    }\r\n    this.attr.gap=this.jtopo.bundleGap;\r\n};\r\n/**\r\n *  设置链路的虚线线段长度\r\n *\r\n *  设置不为number类型或小于0时，则认为不要虚线\r\n *\r\n *  @method [LE] setDashed\r\n *  @param dashedPattern {number|null}\r\n */\r\nLine.prototype.setDashed=function(dashedPattern){\r\n    if($.isNumeric(dashedPattern)&&dashedPattern>0){\r\n        this.jtopo.dashedPattern=parseInt(dashedPattern);\r\n    }else{\r\n        this.jtopo.dashedPattern=null;\r\n    }\r\n    this.attr.dashed=this.jtopo.dashedPattern;\r\n};\r\n/**\r\n *  单个对象的属性提取\r\n *  @method [LE] toJson\r\n *  @return {object}\r\n */\r\nLine.prototype.toJson=function(){\r\n    var json=$.extend({},this.attr);\r\n    json.extra=$.extend({},this.extra);\r\n    return json;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5lL0xpbmUuanM/YjkwZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUIscUJBQXFCLE9BQU87QUFDNUIsbUJBQW1CLE9BQU87QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxPQUFPO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksT0FBTztBQUNuQjtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQSwwQkFBMEIsT0FBTztBQUNqQyxrQ0FBa0MsT0FBTztBQUN6QywrQkFBK0IsUUFBUTtBQUN2Qyw2QkFBNkIsUUFBUTtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QiwwQkFBMEI7QUFDMUI7QUFDQSIsImZpbGUiOiI1OC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDnur/mrrXln7rnsbss55So5Lul57un5om/IFtFXeW8gOWktOe7p+aJv+S6jkVsZW1lbnQsW0xFXeW8gOWktOS4uuiHqui6q2FwaVxyXG4gKiBAY2xhc3MgW0xFXSBMaW5lXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbRV0gRWxlbWVudFxyXG4gKiBAcGFyYW0ganRvcG8g5YWD57Sg5qC45b+D55qEanRvcG/lr7nosaFcclxuICovXHJcbnZhciBFbGVtZW50PXJlcXVpcmUoXCIuLi9FbGVtZW50LmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9TGluZTtcclxuZnVuY3Rpb24gTGluZShqdG9wbykge1xyXG4gICAgaWYoanRvcG8pe1xyXG4gICAgICAgIEVsZW1lbnQuY2FsbCh0aGlzLGp0b3BvKTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJjcmVhdGUgTGluZSB3aXRob3V0IGp0b3BvXCIsdGhpcyk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOiusOW9lee6v+auteeahOmmluWwvuWFg+e0oCzpppblsL7lhYPntKDkuIDoiKzpmpDol4/vvIzkuJTkuLpqdG9wb+Wvueixoe+8jOS7heS9nOS4uue7mOWItueahOWdkOagh+eCuVxyXG4gICAgICogQHByb3BlcnR5IFtMRV0gcGF0aCB7b2JqZWN0fVxyXG4gICAgICogQHBhcmFtIHN0YXJ0IHtvYmplY3R9IOi1t+Wni+WFg+e0oFxyXG4gICAgICogQHBhcmFtIGVuZCB7b2JqZWN0fSDnu4jngrnlhYPntKBcclxuICAgICAqL1xyXG4gICAgdGhpcy5hdHRyLnBhdGg9e1xyXG4gICAgICAgIHN0YXJ0OnRoaXMuanRvcG8ubm9kZUEsXHJcbiAgICAgICAgZW5kOnRoaXMuanRvcG8ubm9kZVpcclxuICAgIH07XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhMaW5lLEVsZW1lbnQpO1xyXG4vKipcclxuICogIOiuvue9rue6v+auteS9jee9rizljp/nkIbmmK/orr7nva7nur/mrrXpppblsL7lpITpmpDol49qdG9wb+iKgueCueeahOS9jee9rlxyXG4gKiAgQG1ldGhvZCBbTEVdIHNldFBvc2l0aW9uXHJcbiAqICBAcGFyYW0gcG9zaXRpb24ge29iamVjdH1cclxuICpcclxuICogICAgICAgICAgcG9zaXRpb249e1xyXG4gKiAgICAgICAgICAgICAgc3RhcnQ6W3gseV0sXHJcbiAqICAgICAgICAgICAgICBlbmQ6W3gseV1cclxuICogICAgICAgICAgfVxyXG4gKi9cclxuTGluZS5wcm90b3R5cGUuc2V0UG9zaXRpb249ZnVuY3Rpb24ocG9zaXRpb24pe1xyXG4gICAgdmFyIHN0YXJ0PXRoaXMuYXR0ci5wYXRoLnN0YXJ0O1xyXG4gICAgdmFyIGVuZD10aGlzLmF0dHIucGF0aC5lbmQ7XHJcbiAgICBpZigkLmlzQXJyYXkocG9zaXRpb24uc3RhcnQpJiYkLmlzTnVtZXJpYyhwb3NpdGlvbi5zdGFydFswXSkmJiQuaXNOdW1lcmljKHBvc2l0aW9uLnN0YXJ0WzFdKSl7XHJcbiAgICAgICAgc3RhcnQuc2V0TG9jYXRpb24ocGFyc2VJbnQocG9zaXRpb24uc3RhcnRbMF0pLCBwYXJzZUludChwb3NpdGlvbi5zdGFydFsxXSkpO1xyXG4gICAgfVxyXG4gICAgaWYoJC5pc0FycmF5KHBvc2l0aW9uLmVuZCkmJiQuaXNOdW1lcmljKHBvc2l0aW9uLmVuZFswXSkmJiQuaXNOdW1lcmljKHBvc2l0aW9uLmVuZFsxXSkpe1xyXG4gICAgICAgIGVuZC5zZXRMb2NhdGlvbihwYXJzZUludChwb3NpdGlvbi5lbmRbMF0pLCBwYXJzZUludChwb3NpdGlvbi5lbmRbMV0pKTtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5wb3NpdGlvbj17XHJcbiAgICAgICAgc3RhcnQ6W3N0YXJ0Lngsc3RhcnQueV0sXHJcbiAgICAgICAgZW5kOltlbmQueCxlbmQueV1cclxuICAgIH07XHJcbn07XHJcbi8qKlxyXG4gKiAg6I635Y+W5Z+65pys57G75Z6LXHJcbiAqICBAbWV0aG9kIFtMRV0gZ2V0VHlwZVxyXG4gKiAgQHJldHVybiBRVG9wby5jb25zdGFudC5MaW5lIHtzdHJpbmd9XHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKCl7XHJcbiAgICByZXR1cm4gUVRvcG8uY29uc3RhbnQuTGluZTtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7nur/mrrXpopzoibJcclxuICogIEBtZXRob2QgW0xFXSBzZXRDb2xvclxyXG4gKiAgQHBhcmFtIGNvbG9ye3N0cmluZ30gXCIyNTUsMjU1LDI1NVwiL1wiI2ZmZmZmZlwiXHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5zZXRDb2xvciA9IGZ1bmN0aW9uIChjb2xvcikge1xyXG4gICAgaWYgKGNvbG9yKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zdHJva2VDb2xvciA9IFFUb3BvLnV0aWwudHJhbnNIZXgoY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuY29sb3I9dGhpcy5qdG9wby5zdHJva2VDb2xvcjtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7nur/mrrXorqHmlbBcclxuICogIEBtZXRob2QgW0xFXSBzZXROdW1cclxuICogIEBwYXJhbSB7bnVtYmVyfSBudW1cclxuICovXHJcbkxpbmUucHJvdG90eXBlLnNldE51bSA9IGZ1bmN0aW9uIChudW0pIHtcclxuICAgIGlmICgkLmlzTnVtZXJpYyhudW0pKSB7XHJcbiAgICAgICAgaWYobnVtID4gMSl7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8udGV4dCA9ICcoKycgKyBudW0gKyAnKSc7XHJcbiAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLnRleHQgPSAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hdHRyLm51bT1udW07XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u57q/5q615a695bqmXHJcbiAqICBAbWV0aG9kIFtMRV0gc2V0V2lkdGhcclxuICogIEBwYXJhbSB7bnVtYmVyfSB3aWR0aFxyXG4gKi9cclxuTGluZS5wcm90b3R5cGUuc2V0V2lkdGg9ZnVuY3Rpb24od2lkdGgpe1xyXG4gICAgaWYoJC5pc051bWVyaWMod2lkdGgpKXtcclxuICAgICAgICB0aGlzLmp0b3BvLmxpbmVXaWR0aCA9IHdpZHRoOyAvLyDnur/lrr1cclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci53aWR0aD10aGlzLmp0b3BvLmxpbmVXaWR0aDtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7nur/mrrXkuKTnq6/nrq3lpLTlj4LmlbBcclxuICogIEBtZXRob2QgW0xFXSBzZXRBcnJvd1xyXG4gKiAgQHBhcmFtIGFycm93IHtvYmplY3R9XHJcbiAqXHJcbiAqICAgICAgICAgIGFycm93PXtcclxuICogICAgICAgICAgICAgIHNpemU6566t5aS05aSn5bCPe251bWJlcn0sXHJcbiAqICAgICAgICAgICAgICBvZmZzZXQ6566t5aS05Zyo6ZO+6Lev5LiK55qE5YGP56e76YePe251bWJlcn0sXHJcbiAqICAgICAgICAgICAgICBzdGFydDrmmK/lkKbmmL7npLrotbfngrnnrq3lpLR7Ym9vbGVhbn0sXHJcbiAqICAgICAgICAgICAgICBlbmQ65piv5ZCm5pi+56S657uI54K5566t5aS0e2Jvb2xlYW59LFxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5zZXRBcnJvdyA9IGZ1bmN0aW9uKGFycm93KXtcclxuICAgIGlmKGFycm93KXtcclxuICAgICAgICB0aGlzLmp0b3BvLmFycm93c1JhZGl1cyA9ICQuaXNOdW1lcmljKGFycm93LnNpemUpP2Fycm93LnNpemU6MDtcclxuICAgICAgICB0aGlzLmp0b3BvLmFycm93c09mZnNldCA9ICQuaXNOdW1lcmljKGFycm93Lm9mZnNldCk/YXJyb3cub2Zmc2V0OjA7XHJcbiAgICB9XHJcbiAgICBpZighdGhpcy5hdHRyLmFycm93KXtcclxuICAgICAgICB0aGlzLmF0dHIuYXJyb3c9e307XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuYXJyb3cuc2l6ZT10aGlzLmp0b3BvLmFycm93c1JhZGl1cztcclxuICAgIHRoaXMuYXR0ci5hcnJvdy5vZmZzZXQ9dGhpcy5qdG9wby5hcnJvd3NPZmZzZXQ7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u55u45ZCM6LW354K55ZKM57uI54K555qE6ZO+6Lev5LmL6Ze055qE6Ze06ZqU5aSn5bCPXHJcbiAqXHJcbiAqICBAbWV0aG9kIFtMRV0gc2V0R2FwXHJcbiAqICBAcGFyYW0gZ2FwIHtudW1iZXJ9XHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5zZXRHYXA9ZnVuY3Rpb24oZ2FwKXtcclxuICAgIGlmKGdhcCl7XHJcbiAgICAgICAgdGhpcy5qdG9wby5idW5kbGVHYXAgPSAkLmlzTnVtZXJpYyhnYXApP2dhcDowOyAvLyDnur/mnaHkuYvpl7TnmoTpl7TpmpRcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5nYXA9dGhpcy5qdG9wby5idW5kbGVHYXA7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u6ZO+6Lev55qE6Jma57q/57q/5q616ZW/5bqmXHJcbiAqXHJcbiAqICDorr7nva7kuI3kuLpudW1iZXLnsbvlnovmiJblsI/kuo4w5pe277yM5YiZ6K6k5Li65LiN6KaB6Jma57q/XHJcbiAqXHJcbiAqICBAbWV0aG9kIFtMRV0gc2V0RGFzaGVkXHJcbiAqICBAcGFyYW0gZGFzaGVkUGF0dGVybiB7bnVtYmVyfG51bGx9XHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5zZXREYXNoZWQ9ZnVuY3Rpb24oZGFzaGVkUGF0dGVybil7XHJcbiAgICBpZigkLmlzTnVtZXJpYyhkYXNoZWRQYXR0ZXJuKSYmZGFzaGVkUGF0dGVybj4wKXtcclxuICAgICAgICB0aGlzLmp0b3BvLmRhc2hlZFBhdHRlcm49cGFyc2VJbnQoZGFzaGVkUGF0dGVybik7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgICB0aGlzLmp0b3BvLmRhc2hlZFBhdHRlcm49bnVsbDtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5kYXNoZWQ9dGhpcy5qdG9wby5kYXNoZWRQYXR0ZXJuO1xyXG59O1xyXG4vKipcclxuICogIOWNleS4quWvueixoeeahOWxnuaAp+aPkOWPllxyXG4gKiAgQG1ldGhvZCBbTEVdIHRvSnNvblxyXG4gKiAgQHJldHVybiB7b2JqZWN0fVxyXG4gKi9cclxuTGluZS5wcm90b3R5cGUudG9Kc29uPWZ1bmN0aW9uKCl7XHJcbiAgICB2YXIganNvbj0kLmV4dGVuZCh7fSx0aGlzLmF0dHIpO1xyXG4gICAganNvbi5leHRyYT0kLmV4dGVuZCh7fSx0aGlzLmV4dHJhKTtcclxuICAgIHJldHVybiBqc29uO1xyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbGluZS9MaW5lLmpzXG4vLyBtb2R1bGUgaWQgPSA1OFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9")},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 曲线链路\r\n * @class  CurveLink\r\n * @constructor\r\n * @extends [L] Link\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Link = __webpack_require__(3);\r\nmodule.exports = {\r\n    constructor: CurveLink,\r\n    setDefault: setDefault,\r\n    getDefault: getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n    number: 1,\r\n    alpha: 1,\r\n    color: \'22,124,255\',\r\n    arrow: {\r\n        type:\'close\',\r\n        size: 10,\r\n        offset: 2,\r\n        start: false,\r\n        end: false\r\n    },\r\n    jsonId:"",\r\n    gap: 20,\r\n    width: 2,\r\n    dashed: [],\r\n    zIndex: 2,\r\n    font: {\r\n        size: 16,\r\n        type: "微软雅黑",\r\n        color: \'255,255,255\'\r\n    },\r\n    useType: QTopo.constant.link.CURVE,\r\n    offset: 200    //可由curveOffset指定弧度\r\n};\r\nfunction setDefault(config) {\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault() {\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\nfunction CurveLink(config) {\r\n    if (!config.start || !config.end || !config.start.jtopo || !config.end.jtopo) {\r\n        QTopo.util.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Link.call(this, new JTopo.CurveLink(config.start.jtopo, config.end.jtopo));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(CurveLink, Link);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self = this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\n//-\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *          var DEFAULT = {\r\n                                number: 1,\r\n                                alpha: 1,\r\n                                color: \'22,124,255\',\r\n                                arrow: {\r\n                                    size: 10,\r\n                                    offset: 0,\r\n                                    start: false,\r\n                                    end: false\r\n                                },\r\n                                jsonId:"",\r\n                                gap: 20,\r\n                                width: 2,\r\n                                dashed: null,\r\n                                zIndex: 2,\r\n                                font: {\r\n                                    size: 16,\r\n                                    type: "微软雅黑",\r\n                                    color: \'255,255,255\'\r\n                                },\r\n                                useType: QTopo.constant.link.CURVE,\r\n                                offset: 200\r\n                            };\r\n */\r\nCurveLink.prototype.getDefault = getDefault;\r\n//-//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0N1cnZlLmpzP2QwZTMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiI1OS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDmm7Lnur/pk77ot69cclxuICogQGNsYXNzICBDdXJ2ZUxpbmtcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBleHRlbmRzIFtMXSBMaW5rXHJcbiAqIEBwYXJhbSBbY29uZmlnXSDphY3nva7lj4LmlbDvvIzml6Dlj4LliJnmjInlhajlsYDphY3nva7liJvlu7pcclxuICovXHJcbnZhciBMaW5rID0gcmVxdWlyZShcIi4vTGluay5qc1wiKTtcclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBjb25zdHJ1Y3RvcjogQ3VydmVMaW5rLFxyXG4gICAgc2V0RGVmYXVsdDogc2V0RGVmYXVsdCxcclxuICAgIGdldERlZmF1bHQ6IGdldERlZmF1bHRcclxufTtcclxuLy8tXHJcbnZhciBERUZBVUxUID0ge1xyXG4gICAgbnVtYmVyOiAxLFxyXG4gICAgYWxwaGE6IDEsXHJcbiAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgYXJyb3c6IHtcclxuICAgICAgICB0eXBlOidjbG9zZScsXHJcbiAgICAgICAgc2l6ZTogMTAsXHJcbiAgICAgICAgb2Zmc2V0OiAyLFxyXG4gICAgICAgIHN0YXJ0OiBmYWxzZSxcclxuICAgICAgICBlbmQ6IGZhbHNlXHJcbiAgICB9LFxyXG4gICAganNvbklkOlwiXCIsXHJcbiAgICBnYXA6IDIwLFxyXG4gICAgd2lkdGg6IDIsXHJcbiAgICBkYXNoZWQ6IFtdLFxyXG4gICAgekluZGV4OiAyLFxyXG4gICAgZm9udDoge1xyXG4gICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgY29sb3I6ICcyNTUsMjU1LDI1NSdcclxuICAgIH0sXHJcbiAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5rLkNVUlZFLFxyXG4gICAgb2Zmc2V0OiAyMDAgICAgLy/lj6/nlLFjdXJ2ZU9mZnNldOaMh+WumuW8p+W6plxyXG59O1xyXG5mdW5jdGlvbiBzZXREZWZhdWx0KGNvbmZpZykge1xyXG4gICAgUVRvcG8udXRpbC5leHRlbmQoREVGQVVMVCwgY29uZmlnIHx8IHt9KTtcclxufVxyXG5mdW5jdGlvbiBnZXREZWZhdWx0KCkge1xyXG4gICAgcmV0dXJuIFFUb3BvLnV0aWwuZGVlcENsb25lKERFRkFVTFQpO1xyXG59XHJcbi8vLVxyXG5mdW5jdGlvbiBDdXJ2ZUxpbmsoY29uZmlnKSB7XHJcbiAgICBpZiAoIWNvbmZpZy5zdGFydCB8fCAhY29uZmlnLmVuZCB8fCAhY29uZmlnLnN0YXJ0Lmp0b3BvIHx8ICFjb25maWcuZW5kLmp0b3BvKSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcIkNyZWF0ZSBMaW5rIG5lZWQgc3RhcnQgYW5kIGVuZFwiKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIgPSBRVG9wby51dGlsLmV4dGVuZChnZXREZWZhdWx0KCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICBMaW5rLmNhbGwodGhpcywgbmV3IEpUb3BvLkN1cnZlTGluayhjb25maWcuc3RhcnQuanRvcG8sIGNvbmZpZy5lbmQuanRvcG8pKTtcclxuICAgIC8v5Ye95pWwXHJcbiAgICB0aGlzLnNldCA9IHNldEpUb3BvO1xyXG4gICAgLy/liJ3lp4vljJZcclxuICAgIHRoaXMuc2V0KHRoaXMuYXR0cik7XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhDdXJ2ZUxpbmssIExpbmspO1xyXG4vLy1cclxuLyoqXHJcbiAqICDlhYPntKDlr7nlsZ7mgKfnmoTnu5/kuIDorr7nva7lh73mlbDvvIzmjqjojZDkvb/nlKhcclxuICpcclxuICogIOWPguaVsOWPr+iuvue9ruS4gOmhueaIluWkmumhuSzmnKrorr7nva7pg6jliIblj4LogIPlhajlsYDphY3nva5cclxuICogIEBtZXRob2Qgc2V0XHJcbiAqICBAcGFyYW0gY29uZmlnXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICAgICDlrp7pmYXlj4LmlbDlj4LogINhdHRy5YaF5bGe5oCnLOWPquS8muS/ruaUueacieWvueW6lHNldOWHveaVsOeahOWxnuaApyzoi6XmlrDlop7lsZ7mgKfkuJTmt7vliqDkuoZzZXRYWFjlh73mlbDvvIzkuZ/lj6/nlKjmraTlh73mlbDphY3nva5cclxuICogICAgICAgICAg5aaCOm5hbWUg5a+55bqUIHNldE5hbWUoXCIuLlwiKVxyXG4gKiAgICAgICAgICDlj4LmlbDmoLzlvI/lpoLkuItcclxuICogICAgICAgICAgY29uZmlnPXtcclxuICogICAgICAgICAgICAgIHh4Oi4uLixcclxuICogICAgICAgICAgICAgIHh4Oi4uLlxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5mdW5jdGlvbiBzZXRKVG9wbyhjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgc2VsZi5fc2V0QXR0cihjb25maWcpO1xyXG4gICAgfVxyXG59XHJcbi8vLVxyXG4vKipcclxuICog6I635Y+W5YWD57Sg5YWo5bGA5qC35byPXHJcbiAqIEBtZXRob2QgZ2V0RGVmYXVsdFxyXG4gKiBAcmV0dXJuIHtvYmplY3R9XHJcbiAqIEBleGFtcGxlXHJcbiAqICAgICAgICAgIHZhciBERUZBVUxUID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlcjogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFycm93OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDEwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbklkOlwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FwOiAyMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXNoZWQ6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgekluZGV4OiAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogMTYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5rLkNVUlZFLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogMjAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gKi9cclxuQ3VydmVMaW5rLnByb3RvdHlwZS5nZXREZWZhdWx0ID0gZ2V0RGVmYXVsdDtcclxuLy8tXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0N1cnZlLmpzXG4vLyBtb2R1bGUgaWQgPSA1OVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 直线链路\r\n * @class  DirectLink\r\n * @constructor\r\n * @extends [L] Link\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Link = __webpack_require__(3);\r\nmodule.exports = {\r\n    constructor: DirectLink,\r\n    setDefault: setDefault,\r\n    getDefault: getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n    number: 1,\r\n    alpha: 1,\r\n    color: \'22,124,255\',\r\n    arrow: {\r\n        type:\'close\',\r\n        size: 10,\r\n        offset: 2,\r\n        start: false,\r\n        end: false\r\n    },\r\n    jsonId: "",\r\n    gap: 20,\r\n    width: 3,\r\n    dashed: [],\r\n    zIndex: 2,\r\n    font: {\r\n        size: 16,\r\n        type: "微软雅黑",\r\n        color: \'255,255,255\'\r\n    },\r\n    expendAble: true,\r\n    useType: QTopo.constant.link.DIRECT,\r\n    offset: 60// 多条直线时，线条折线拐角处的长度\r\n};\r\nfunction setDefault(config) {\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault() {\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//------\r\n//------\r\n//-\r\nfunction DirectLink(config) {\r\n    if (!config.start || !config.end || !config.start.jtopo || !config.end.jtopo) {\r\n        QTopo.util.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Link.call(this, new JTopo.Link(config.start.jtopo, config.end.jtopo));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(DirectLink, Link);\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self = this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *          var DEFAULT = {\r\n                                number: 1,\r\n                                alpha: 1,\r\n                                color: \'22,124,255\',\r\n                                arrow: {\r\n                                    size: 10,\r\n                                    offset: 0,\r\n                                    start: false,\r\n                                    end: false\r\n                                },\r\n                                jsonId:"",\r\n                                gap: 20,\r\n                                width: 3,\r\n                                dashed: null,\r\n                                zIndex: 2,\r\n                                font: {\r\n                                    size: 16,\r\n                                    type: "微软雅黑",\r\n                                    color: \'255,255,255\'\r\n                                },\r\n                                expendAble: true,\r\n                                useType: QTopo.constant.link.DIRECT,\r\n                                offset: 60\r\n                            };\r\n */\r\nDirectLink.prototype.getDefault = getDefault;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0RpcmVjdC5qcz9jZjVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQ7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiI2MC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDnm7Tnur/pk77ot69cclxuICogQGNsYXNzICBEaXJlY3RMaW5rXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbTF0gTGlua1xyXG4gKiBAcGFyYW0gW2NvbmZpZ10g6YWN572u5Y+C5pWw77yM5peg5Y+C5YiZ5oyJ5YWo5bGA6YWN572u5Yib5bu6XHJcbiAqL1xyXG52YXIgTGluayA9IHJlcXVpcmUoXCIuL0xpbmsuanNcIik7XHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgY29uc3RydWN0b3I6IERpcmVjdExpbmssXHJcbiAgICBzZXREZWZhdWx0OiBzZXREZWZhdWx0LFxyXG4gICAgZ2V0RGVmYXVsdDogZ2V0RGVmYXVsdFxyXG59O1xyXG4vLy1cclxudmFyIERFRkFVTFQgPSB7XHJcbiAgICBudW1iZXI6IDEsXHJcbiAgICBhbHBoYTogMSxcclxuICAgIGNvbG9yOiAnMjIsMTI0LDI1NScsXHJcbiAgICBhcnJvdzoge1xyXG4gICAgICAgIHR5cGU6J2Nsb3NlJyxcclxuICAgICAgICBzaXplOiAxMCxcclxuICAgICAgICBvZmZzZXQ6IDIsXHJcbiAgICAgICAgc3RhcnQ6IGZhbHNlLFxyXG4gICAgICAgIGVuZDogZmFsc2VcclxuICAgIH0sXHJcbiAgICBqc29uSWQ6IFwiXCIsXHJcbiAgICBnYXA6IDIwLFxyXG4gICAgd2lkdGg6IDMsXHJcbiAgICBkYXNoZWQ6IFtdLFxyXG4gICAgekluZGV4OiAyLFxyXG4gICAgZm9udDoge1xyXG4gICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgY29sb3I6ICcyNTUsMjU1LDI1NSdcclxuICAgIH0sXHJcbiAgICBleHBlbmRBYmxlOiB0cnVlLFxyXG4gICAgdXNlVHlwZTogUVRvcG8uY29uc3RhbnQubGluay5ESVJFQ1QsXHJcbiAgICBvZmZzZXQ6IDYwLy8g5aSa5p2h55u057q/5pe277yM57q/5p2h5oqY57q/5ouQ6KeS5aSE55qE6ZW/5bqmXHJcbn07XHJcbmZ1bmN0aW9uIHNldERlZmF1bHQoY29uZmlnKSB7XHJcbiAgICBRVG9wby51dGlsLmV4dGVuZChERUZBVUxULCBjb25maWcgfHwge30pO1xyXG59XHJcbmZ1bmN0aW9uIGdldERlZmF1bHQoKSB7XHJcbiAgICByZXR1cm4gUVRvcG8udXRpbC5kZWVwQ2xvbmUoREVGQVVMVCk7XHJcbn1cclxuLy8tLS0tLS1cclxuLy8tLS0tLS1cclxuLy8tXHJcbmZ1bmN0aW9uIERpcmVjdExpbmsoY29uZmlnKSB7XHJcbiAgICBpZiAoIWNvbmZpZy5zdGFydCB8fCAhY29uZmlnLmVuZCB8fCAhY29uZmlnLnN0YXJ0Lmp0b3BvIHx8ICFjb25maWcuZW5kLmp0b3BvKSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcIkNyZWF0ZSBMaW5rIG5lZWQgc3RhcnQgYW5kIGVuZFwiKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIgPSBRVG9wby51dGlsLmV4dGVuZChnZXREZWZhdWx0KCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICBMaW5rLmNhbGwodGhpcywgbmV3IEpUb3BvLkxpbmsoY29uZmlnLnN0YXJ0Lmp0b3BvLCBjb25maWcuZW5kLmp0b3BvKSk7XHJcbiAgICAvL+WHveaVsFxyXG4gICAgdGhpcy5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICB0aGlzLnNldCh0aGlzLmF0dHIpO1xyXG59XHJcblFUb3BvLnV0aWwuaW5oZXJpdHMoRGlyZWN0TGluaywgTGluayk7XHJcbi8qKlxyXG4gKiAg5YWD57Sg5a+55bGe5oCn55qE57uf5LiA6K6+572u5Ye95pWw77yM5o6o6I2Q5L2/55SoXHJcbiAqXHJcbiAqICDlj4LmlbDlj6/orr7nva7kuIDpobnmiJblpJrpobks5pyq6K6+572u6YOo5YiG5Y+C6ICD5YWo5bGA6YWN572uXHJcbiAqICBAbWV0aG9kIHNldFxyXG4gKiAgQHBhcmFtIGNvbmZpZ1xyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAg5a6e6ZmF5Y+C5pWw5Y+C6ICDYXR0cuWGheWxnuaApyzlj6rkvJrkv67mlLnmnInlr7nlupRzZXTlh73mlbDnmoTlsZ7mgKcs6Iul5paw5aKe5bGe5oCn5LiU5re75Yqg5LqGc2V0WFhY5Ye95pWw77yM5Lmf5Y+v55So5q2k5Ye95pWw6YWN572uXHJcbiAqICAgICAgICAgIOWmgjpuYW1lIOWvueW6lCBzZXROYW1lKFwiLi5cIilcclxuICogICAgICAgICAg5Y+C5pWw5qC85byP5aaC5LiLXHJcbiAqICAgICAgICAgIGNvbmZpZz17XHJcbiAqICAgICAgICAgICAgICB4eDouLi4sXHJcbiAqICAgICAgICAgICAgICB4eDouLi5cclxuICogICAgICAgICAgfVxyXG4gKi9cclxuZnVuY3Rpb24gc2V0SlRvcG8oY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbGYuX3NldEF0dHIoY29uZmlnKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICog6I635Y+W5YWD57Sg5YWo5bGA5qC35byPXHJcbiAqIEBtZXRob2QgZ2V0RGVmYXVsdFxyXG4gKiBAcmV0dXJuIHtvYmplY3R9XHJcbiAqIEBleGFtcGxlXHJcbiAqICAgICAgICAgIHZhciBERUZBVUxUID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlcjogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFycm93OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDEwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbklkOlwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FwOiAyMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXNoZWQ6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgekluZGV4OiAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogMTYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlbmRBYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50LmxpbmsuRElSRUNULFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogNjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAqL1xyXG5EaXJlY3RMaW5rLnByb3RvdHlwZS5nZXREZWZhdWx0ID0gZ2V0RGVmYXVsdDtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9lbGVtZW50L2xpbmsvRGlyZWN0LmpzXG4vLyBtb2R1bGUgaWQgPSA2MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9');
},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 二次折线链路\r\n * @class  FlexionalLink\r\n * @constructor\r\n * @extends [L] Link\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Link = __webpack_require__(3);\r\nmodule.exports = {\r\n    constructor: FlexionalLink,\r\n    setDefault: setDefault,\r\n    getDefault: getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n    number: 1,\r\n    alpha: 1,\r\n    color: \'22,124,255\',\r\n    arrow: {\r\n        type:\'close\',\r\n        size: 10,\r\n        offset: 0,\r\n        start: false,\r\n        end: false\r\n    },\r\n    jsonId: "",\r\n    radius: 0,\r\n    gap: 20,\r\n    width: 2,\r\n    dashed: [],\r\n    zIndex: 2,\r\n    font: {\r\n        size: 16,\r\n        type: "微软雅黑",\r\n        color: \'255,255,255\'\r\n    },\r\n    useType: QTopo.constant.link.FLEXIONAL,\r\n    direction: "horizontal",\r\n    offset: 60//折线处长度\r\n};\r\nfunction setDefault(config) {\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault() {\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\nfunction FlexionalLink(config) {\r\n    if (!config.start || !config.end || !config.start.jtopo || !config.end.jtopo) {\r\n        QTopo.util.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Link.call(this, new JTopo.FlexionalLink(config.start.jtopo, config.end.jtopo));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(FlexionalLink, Link);\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self = this;\r\n        this._setAttr(config);\r\n    }\r\n}\r\n/**\r\n *  设置折线方向\r\n *\r\n *  @method setDirection\r\n *  @param direction {string} horizontal 水平 "vertical"垂直\r\n */\r\nFlexionalLink.prototype.setDirection = function (direction) {\r\n    //折线方向 horizontal 水平 "vertical"垂直\r\n    if (direction) {\r\n        this.jtopo.direction = direction;\r\n    }\r\n    this.attr.direction = this.jtopo.direction;\r\n};\r\n/**\r\n *  设置折角弧度\r\n *\r\n *  @method setRadius\r\n *  @param radius {number}\r\n */\r\nFlexionalLink.prototype.setRadius = function (radius) {\r\n    if ($.isNumeric(radius)) {\r\n        radius = parseInt(radius);\r\n        if (radius > 20) {\r\n            radius = 20;\r\n        } else if (radius < 0) {\r\n            radius = 0;\r\n        }\r\n        this.jtopo.radius=this.attr.radius = radius;\r\n    }\r\n};\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *         var DEFAULT = {\r\n                            number: 1,\r\n                            alpha: 1,\r\n                            color: \'22,124,255\',\r\n                            arrow: {\r\n                                size: 10,\r\n                                offset: 0,\r\n                                start: false,\r\n                                end: false\r\n                            },\r\n                            jsonId:"",\r\n                            radius: 0,\r\n                            gap: 20,\r\n                            width: 2,\r\n                            dashed: null,\r\n                            zIndex: 2,\r\n                            font: {\r\n                                size: 16,\r\n                                type: "微软雅黑",\r\n                                color: \'255,255,255\'\r\n                            },\r\n                            useType: QTopo.constant.link.FLEXIONAL,\r\n                            direction: "horizontal",\r\n                            offset: 60//两端折线线段的长度\r\n                        };\r\n */\r\nFlexionalLink.prototype.getDefault = getDefault;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0ZsZXhpb25hbC5qcz8wMDA2Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTREO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsT0FBTztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjYxLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLyoqXHJcbiAqIOS6jOasoeaKmOe6v+mTvui3r1xyXG4gKiBAY2xhc3MgIEZsZXhpb25hbExpbmtcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBleHRlbmRzIFtMXSBMaW5rXHJcbiAqIEBwYXJhbSBbY29uZmlnXSDphY3nva7lj4LmlbDvvIzml6Dlj4LliJnmjInlhajlsYDphY3nva7liJvlu7pcclxuICovXHJcbnZhciBMaW5rID0gcmVxdWlyZShcIi4vTGluay5qc1wiKTtcclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBjb25zdHJ1Y3RvcjogRmxleGlvbmFsTGluayxcclxuICAgIHNldERlZmF1bHQ6IHNldERlZmF1bHQsXHJcbiAgICBnZXREZWZhdWx0OiBnZXREZWZhdWx0XHJcbn07XHJcbi8vLVxyXG52YXIgREVGQVVMVCA9IHtcclxuICAgIG51bWJlcjogMSxcclxuICAgIGFscGhhOiAxLFxyXG4gICAgY29sb3I6ICcyMiwxMjQsMjU1JyxcclxuICAgIGFycm93OiB7XHJcbiAgICAgICAgdHlwZTonY2xvc2UnLFxyXG4gICAgICAgIHNpemU6IDEwLFxyXG4gICAgICAgIG9mZnNldDogMCxcclxuICAgICAgICBzdGFydDogZmFsc2UsXHJcbiAgICAgICAgZW5kOiBmYWxzZVxyXG4gICAgfSxcclxuICAgIGpzb25JZDogXCJcIixcclxuICAgIHJhZGl1czogMCxcclxuICAgIGdhcDogMjAsXHJcbiAgICB3aWR0aDogMixcclxuICAgIGRhc2hlZDogW10sXHJcbiAgICB6SW5kZXg6IDIsXHJcbiAgICBmb250OiB7XHJcbiAgICAgICAgc2l6ZTogMTYsXHJcbiAgICAgICAgdHlwZTogXCLlvq7ova/pm4Xpu5FcIixcclxuICAgICAgICBjb2xvcjogJzI1NSwyNTUsMjU1J1xyXG4gICAgfSxcclxuICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50LmxpbmsuRkxFWElPTkFMLFxyXG4gICAgZGlyZWN0aW9uOiBcImhvcml6b250YWxcIixcclxuICAgIG9mZnNldDogNjAvL+aKmOe6v+WkhOmVv+W6plxyXG59O1xyXG5mdW5jdGlvbiBzZXREZWZhdWx0KGNvbmZpZykge1xyXG4gICAgUVRvcG8udXRpbC5leHRlbmQoREVGQVVMVCwgY29uZmlnIHx8IHt9KTtcclxufVxyXG5mdW5jdGlvbiBnZXREZWZhdWx0KCkge1xyXG4gICAgcmV0dXJuIFFUb3BvLnV0aWwuZGVlcENsb25lKERFRkFVTFQpO1xyXG59XHJcbi8vLVxyXG5mdW5jdGlvbiBGbGV4aW9uYWxMaW5rKGNvbmZpZykge1xyXG4gICAgaWYgKCFjb25maWcuc3RhcnQgfHwgIWNvbmZpZy5lbmQgfHwgIWNvbmZpZy5zdGFydC5qdG9wbyB8fCAhY29uZmlnLmVuZC5qdG9wbykge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJDcmVhdGUgTGluayBuZWVkIHN0YXJ0IGFuZCBlbmRcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyID0gUVRvcG8udXRpbC5leHRlbmQoZ2V0RGVmYXVsdCgpLCBjb25maWcgfHwge30pO1xyXG4gICAgTGluay5jYWxsKHRoaXMsIG5ldyBKVG9wby5GbGV4aW9uYWxMaW5rKGNvbmZpZy5zdGFydC5qdG9wbywgY29uZmlnLmVuZC5qdG9wbykpO1xyXG4gICAgLy/lh73mlbBcclxuICAgIHRoaXMuc2V0ID0gc2V0SlRvcG87XHJcbiAgICAvL+WIneWni+WMllxyXG4gICAgdGhpcy5zZXQodGhpcy5hdHRyKTtcclxufVxyXG5RVG9wby51dGlsLmluaGVyaXRzKEZsZXhpb25hbExpbmssIExpbmspO1xyXG4vKipcclxuICogIOWFg+e0oOWvueWxnuaAp+eahOe7n+S4gOiuvue9ruWHveaVsO+8jOaOqOiNkOS9v+eUqFxyXG4gKlxyXG4gKiAg5Y+C5pWw5Y+v6K6+572u5LiA6aG55oiW5aSa6aG5LOacquiuvue9rumDqOWIhuWPguiAg+WFqOWxgOmFjee9rlxyXG4gKiAgQG1ldGhvZCBzZXRcclxuICogIEBwYXJhbSBjb25maWdcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOWunumZheWPguaVsOWPguiAg2F0dHLlhoXlsZ7mgKcs5Y+q5Lya5L+u5pS55pyJ5a+55bqUc2V05Ye95pWw55qE5bGe5oCnLOiLpeaWsOWinuWxnuaAp+S4lOa3u+WKoOS6hnNldFhYWOWHveaVsO+8jOS5n+WPr+eUqOatpOWHveaVsOmFjee9rlxyXG4gKiAgICAgICAgICDlpoI6bmFtZSDlr7nlupQgc2V0TmFtZShcIi4uXCIpXHJcbiAqICAgICAgICAgIOWPguaVsOagvOW8j+WmguS4i1xyXG4gKiAgICAgICAgICBjb25maWc9e1xyXG4gKiAgICAgICAgICAgICAgeHg6Li4uLFxyXG4gKiAgICAgICAgICAgICAgeHg6Li4uXHJcbiAqICAgICAgICAgIH1cclxuICovXHJcbmZ1bmN0aW9uIHNldEpUb3BvKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLl9zZXRBdHRyKGNvbmZpZyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqICDorr7nva7mipjnur/mlrnlkJFcclxuICpcclxuICogIEBtZXRob2Qgc2V0RGlyZWN0aW9uXHJcbiAqICBAcGFyYW0gZGlyZWN0aW9uIHtzdHJpbmd9IGhvcml6b250YWwg5rC05bmzIFwidmVydGljYWxcIuWeguebtFxyXG4gKi9cclxuRmxleGlvbmFsTGluay5wcm90b3R5cGUuc2V0RGlyZWN0aW9uID0gZnVuY3Rpb24gKGRpcmVjdGlvbikge1xyXG4gICAgLy/mipjnur/mlrnlkJEgaG9yaXpvbnRhbCDmsLTlubMgXCJ2ZXJ0aWNhbFwi5Z6C55u0XHJcbiAgICBpZiAoZGlyZWN0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5kaXJlY3Rpb24gPSBkaXJlY3Rpb247XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuZGlyZWN0aW9uID0gdGhpcy5qdG9wby5kaXJlY3Rpb247XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5oqY6KeS5byn5bqmXHJcbiAqXHJcbiAqICBAbWV0aG9kIHNldFJhZGl1c1xyXG4gKiAgQHBhcmFtIHJhZGl1cyB7bnVtYmVyfVxyXG4gKi9cclxuRmxleGlvbmFsTGluay5wcm90b3R5cGUuc2V0UmFkaXVzID0gZnVuY3Rpb24gKHJhZGl1cykge1xyXG4gICAgaWYgKCQuaXNOdW1lcmljKHJhZGl1cykpIHtcclxuICAgICAgICByYWRpdXMgPSBwYXJzZUludChyYWRpdXMpO1xyXG4gICAgICAgIGlmIChyYWRpdXMgPiAyMCkge1xyXG4gICAgICAgICAgICByYWRpdXMgPSAyMDtcclxuICAgICAgICB9IGVsc2UgaWYgKHJhZGl1cyA8IDApIHtcclxuICAgICAgICAgICAgcmFkaXVzID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5qdG9wby5yYWRpdXM9dGhpcy5hdHRyLnJhZGl1cyA9IHJhZGl1cztcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIOiOt+WPluWFg+e0oOWFqOWxgOagt+W8j1xyXG4gKiBAbWV0aG9kIGdldERlZmF1bHRcclxuICogQHJldHVybiB7b2JqZWN0fVxyXG4gKiBAZXhhbXBsZVxyXG4gKiAgICAgICAgIHZhciBERUZBVUxUID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyb3c6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uSWQ6XCJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1czogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhcDogMjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhc2hlZDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpJbmRleDogMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxNixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlVHlwZTogUVRvcG8uY29uc3RhbnQubGluay5GTEVYSU9OQUwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb246IFwiaG9yaXpvbnRhbFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiA2MC8v5Lik56uv5oqY57q/57q/5q6155qE6ZW/5bqmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAqL1xyXG5GbGV4aW9uYWxMaW5rLnByb3RvdHlwZS5nZXREZWZhdWx0ID0gZ2V0RGVmYXVsdDtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0ZsZXhpb25hbC5qc1xuLy8gbW9kdWxlIGlkID0gNjFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 折线链路\r\n * @class  FoldLink\r\n * @constructor\r\n * @extends [L] Link\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Link=__webpack_require__(3);\r\nmodule.exports =  {\r\n    constructor:FoldLink,\r\n    setDefault:setDefault,\r\n    getDefault:getDefault\r\n};\r\n//-\r\nvar DEFAULT ={\r\n        number:1,\r\n        alpha:1,\r\n        color: \'22,124,255\',\r\n        arrow:{\r\n            type:\'close\',\r\n            size:10,\r\n            offset:0,\r\n            start:false,\r\n            end:false\r\n        },\r\n        jsonId:"",\r\n        gap:20,\r\n        width: 2,\r\n        dashed:  [],\r\n        zIndex : 100,\r\n        radius:0,\r\n        font:{\r\n            size:16,\r\n            type:"微软雅黑",\r\n            color:\'255,255,255\'\r\n        },\r\n        useType: QTopo.constant.link.FOLD,\r\n        direction:"vertical"\r\n};\r\nfunction setDefault(config){\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault(){\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\nfunction FoldLink(config){\r\n    if(!config.start||!config.end||!config.start.jtopo||!config.end.jtopo){\r\n        QTopo.util.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    this.attr =  QTopo.util.extend(getDefault(), config || {});\r\n    Link.call(this, new JTopo.FoldLink(config.start.jtopo, config.end.jtopo));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(FoldLink,Link);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        this._setAttr(config);\r\n    }\r\n}\r\n//-\r\n/**\r\n *  设置折线方向\r\n *\r\n *  @method setDirection\r\n *  @param direction {string} /horizontal 水平 "vertical"垂直\r\n */\r\nFoldLink.prototype.setDirection=function(direction){\r\n    if(direction){\r\n        this.jtopo.direction=direction;\r\n    }\r\n    this.attr.direction=this.jtopo.direction;\r\n};\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *        var DEFAULT ={\r\n                            number:1,\r\n                            alpha:1,\r\n                            color: \'22,124,255\',\r\n                            arrow:{\r\n                                size:10,\r\n                                offset:0,\r\n                                start:false,\r\n                                end:false\r\n                            },\r\n                            jsonId:"",\r\n                            gap:20,\r\n                            width: 2,\r\n                            dashed:  null,\r\n                            zIndex : 100,\r\n                            radius:0,\r\n                            font:{\r\n                                size:16,\r\n                                type:"微软雅黑",\r\n                                color:\'255,255,255\'\r\n                            },\r\n                            useType: QTopo.constant.link.FOLD,\r\n                            direction:"vertical"\r\n                    };\r\n */\r\nFoldLink.prototype.getDefault=getDefault;\r\n/**\r\n *  设置折角弧度\r\n *\r\n *  @method setRadius\r\n *  @param radius {number}\r\n */\r\nFoldLink.prototype.setRadius = function (radius) {\r\n    if ($.isNumeric(radius)) {\r\n        radius = parseInt(radius);\r\n        if (radius > 20) {\r\n            radius = 20;\r\n        } else if (radius < 0) {\r\n            radius = 0;\r\n        }\r\n        this.jtopo.radius=this.attr.radius = radius;\r\n    }\r\n};\r\n//-//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0ZvbGQuanM/NTBiYiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQ7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsT0FBTztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiI2Mi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDmipjnur/pk77ot69cclxuICogQGNsYXNzICBGb2xkTGlua1xyXG4gKiBAY29uc3RydWN0b3JcclxuICogQGV4dGVuZHMgW0xdIExpbmtcclxuICogQHBhcmFtIFtjb25maWddIOmFjee9ruWPguaVsO+8jOaXoOWPguWImeaMieWFqOWxgOmFjee9ruWIm+W7ulxyXG4gKi9cclxudmFyIExpbms9cmVxdWlyZShcIi4vTGluay5qc1wiKTtcclxubW9kdWxlLmV4cG9ydHMgPSAge1xyXG4gICAgY29uc3RydWN0b3I6Rm9sZExpbmssXHJcbiAgICBzZXREZWZhdWx0OnNldERlZmF1bHQsXHJcbiAgICBnZXREZWZhdWx0OmdldERlZmF1bHRcclxufTtcclxuLy8tXHJcbnZhciBERUZBVUxUID17XHJcbiAgICAgICAgbnVtYmVyOjEsXHJcbiAgICAgICAgYWxwaGE6MSxcclxuICAgICAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgICAgIGFycm93OntcclxuICAgICAgICAgICAgdHlwZTonY2xvc2UnLFxyXG4gICAgICAgICAgICBzaXplOjEwLFxyXG4gICAgICAgICAgICBvZmZzZXQ6MCxcclxuICAgICAgICAgICAgc3RhcnQ6ZmFsc2UsXHJcbiAgICAgICAgICAgIGVuZDpmYWxzZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAganNvbklkOlwiXCIsXHJcbiAgICAgICAgZ2FwOjIwLFxyXG4gICAgICAgIHdpZHRoOiAyLFxyXG4gICAgICAgIGRhc2hlZDogIFtdLFxyXG4gICAgICAgIHpJbmRleCA6IDEwMCxcclxuICAgICAgICByYWRpdXM6MCxcclxuICAgICAgICBmb250OntcclxuICAgICAgICAgICAgc2l6ZToxNixcclxuICAgICAgICAgICAgdHlwZTpcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICBjb2xvcjonMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgfSxcclxuICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5rLkZPTEQsXHJcbiAgICAgICAgZGlyZWN0aW9uOlwidmVydGljYWxcIlxyXG59O1xyXG5mdW5jdGlvbiBzZXREZWZhdWx0KGNvbmZpZyl7XHJcbiAgICBRVG9wby51dGlsLmV4dGVuZChERUZBVUxULCBjb25maWcgfHwge30pO1xyXG59XHJcbmZ1bmN0aW9uIGdldERlZmF1bHQoKXtcclxuICAgIHJldHVybiBRVG9wby51dGlsLmRlZXBDbG9uZShERUZBVUxUKTtcclxufVxyXG4vLy1cclxuZnVuY3Rpb24gRm9sZExpbmsoY29uZmlnKXtcclxuICAgIGlmKCFjb25maWcuc3RhcnR8fCFjb25maWcuZW5kfHwhY29uZmlnLnN0YXJ0Lmp0b3BvfHwhY29uZmlnLmVuZC5qdG9wbyl7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcIkNyZWF0ZSBMaW5rIG5lZWQgc3RhcnQgYW5kIGVuZFwiKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIgPSAgUVRvcG8udXRpbC5leHRlbmQoZ2V0RGVmYXVsdCgpLCBjb25maWcgfHwge30pO1xyXG4gICAgTGluay5jYWxsKHRoaXMsIG5ldyBKVG9wby5Gb2xkTGluayhjb25maWcuc3RhcnQuanRvcG8sIGNvbmZpZy5lbmQuanRvcG8pKTtcclxuICAgIC8v5Ye95pWwXHJcbiAgICB0aGlzLnNldCA9IHNldEpUb3BvO1xyXG4gICAgLy/liJ3lp4vljJZcclxuICAgIHRoaXMuc2V0KHRoaXMuYXR0cik7XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhGb2xkTGluayxMaW5rKTtcclxuLy8tXHJcbi8qKlxyXG4gKiAg5YWD57Sg5a+55bGe5oCn55qE57uf5LiA6K6+572u5Ye95pWw77yM5o6o6I2Q5L2/55SoXHJcbiAqXHJcbiAqICDlj4LmlbDlj6/orr7nva7kuIDpobnmiJblpJrpobks5pyq6K6+572u6YOo5YiG5Y+C6ICD5YWo5bGA6YWN572uXHJcbiAqICBAbWV0aG9kIHNldFxyXG4gKiAgQHBhcmFtIGNvbmZpZ1xyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAg5a6e6ZmF5Y+C5pWw5Y+C6ICDYXR0cuWGheWxnuaApyzlj6rkvJrkv67mlLnmnInlr7nlupRzZXTlh73mlbDnmoTlsZ7mgKcs6Iul5paw5aKe5bGe5oCn5LiU5re75Yqg5LqGc2V0WFhY5Ye95pWw77yM5Lmf5Y+v55So5q2k5Ye95pWw6YWN572uXHJcbiAqICAgICAgICAgIOWmgjpuYW1lIOWvueW6lCBzZXROYW1lKFwiLi5cIilcclxuICogICAgICAgICAg5Y+C5pWw5qC85byP5aaC5LiLXHJcbiAqICAgICAgICAgIGNvbmZpZz17XHJcbiAqICAgICAgICAgICAgICB4eDouLi4sXHJcbiAqICAgICAgICAgICAgICB4eDouLi5cclxuICogICAgICAgICAgfVxyXG4gKi9cclxuZnVuY3Rpb24gc2V0SlRvcG8oY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGY9dGhpcztcclxuICAgICAgICB0aGlzLl9zZXRBdHRyKGNvbmZpZyk7XHJcbiAgICB9XHJcbn1cclxuLy8tXHJcbi8qKlxyXG4gKiAg6K6+572u5oqY57q/5pa55ZCRXHJcbiAqXHJcbiAqICBAbWV0aG9kIHNldERpcmVjdGlvblxyXG4gKiAgQHBhcmFtIGRpcmVjdGlvbiB7c3RyaW5nfSAvaG9yaXpvbnRhbCDmsLTlubMgXCJ2ZXJ0aWNhbFwi5Z6C55u0XHJcbiAqL1xyXG5Gb2xkTGluay5wcm90b3R5cGUuc2V0RGlyZWN0aW9uPWZ1bmN0aW9uKGRpcmVjdGlvbil7XHJcbiAgICBpZihkaXJlY3Rpb24pe1xyXG4gICAgICAgIHRoaXMuanRvcG8uZGlyZWN0aW9uPWRpcmVjdGlvbjtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5kaXJlY3Rpb249dGhpcy5qdG9wby5kaXJlY3Rpb247XHJcbn07XHJcbi8qKlxyXG4gKiDojrflj5blhYPntKDlhajlsYDmoLflvI9cclxuICogQG1ldGhvZCBnZXREZWZhdWx0XHJcbiAqIEByZXR1cm4ge29iamVjdH1cclxuICogQGV4YW1wbGVcclxuICogICAgICAgIHZhciBERUZBVUxUID17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXI6MSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOjEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyb3c6e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6MTAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6ZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOmZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbklkOlwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYXA6MjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhc2hlZDogIG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6SW5kZXggOiAxMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM6MCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6MTYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTpcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOicyNTUsMjU1LDI1NSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5rLkZPTEQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb246XCJ2ZXJ0aWNhbFwiXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICovXHJcbkZvbGRMaW5rLnByb3RvdHlwZS5nZXREZWZhdWx0PWdldERlZmF1bHQ7XHJcbi8qKlxyXG4gKiAg6K6+572u5oqY6KeS5byn5bqmXHJcbiAqXHJcbiAqICBAbWV0aG9kIHNldFJhZGl1c1xyXG4gKiAgQHBhcmFtIHJhZGl1cyB7bnVtYmVyfVxyXG4gKi9cclxuRm9sZExpbmsucHJvdG90eXBlLnNldFJhZGl1cyA9IGZ1bmN0aW9uIChyYWRpdXMpIHtcclxuICAgIGlmICgkLmlzTnVtZXJpYyhyYWRpdXMpKSB7XHJcbiAgICAgICAgcmFkaXVzID0gcGFyc2VJbnQocmFkaXVzKTtcclxuICAgICAgICBpZiAocmFkaXVzID4gMjApIHtcclxuICAgICAgICAgICAgcmFkaXVzID0gMjA7XHJcbiAgICAgICAgfSBlbHNlIGlmIChyYWRpdXMgPCAwKSB7XHJcbiAgICAgICAgICAgIHJhZGl1cyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuanRvcG8ucmFkaXVzPXRoaXMuYXR0ci5yYWRpdXMgPSByYWRpdXM7XHJcbiAgICB9XHJcbn07XHJcbi8vLVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbGluay9Gb2xkLmpzXG4vLyBtb2R1bGUgaWQgPSA2MlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 图形节点\r\n * @class  ImageNode\r\n * @constructor\r\n * @extends [N] Node\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Node=__webpack_require__(28);\r\nmodule.exports = {\r\n    constructor:ImageNode,\r\n    setDefault:setDefault,\r\n    getDefault:getDefault\r\n};\r\n//-\r\nvar DEFAULT= {\r\n    image: "",\r\n    size: [60, 60],\r\n    name: "node",\r\n    alpha: 1,\r\n    position: [0, 0],\r\n    font: {\r\n        size: 16,\r\n        type: \'微软雅黑\',\r\n        color: "255,255,255"\r\n    },\r\n    draggable: true,\r\n    jsonId:"",\r\n    border:{\r\n        width:0,\r\n        radius:0,\r\n        color:"255,0,0"\r\n    },\r\n    zIndex: 3,\r\n    color: JTopo.util.randomColor(),\r\n    namePosition: \'bottom\',\r\n    useType: QTopo.constant.node.IMAGE,\r\n    alarm: {\r\n        show: false,\r\n        text: "",\r\n        color: "255,255,255",\r\n        font: {\r\n            size: 16,\r\n            type: "微软雅黑"\r\n        }\r\n    }\r\n};\r\nfunction setDefault(config){\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault(){\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\n//------\r\nfunction ImageNode(config) {\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Node.call(this,new JTopo.Node());\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(ImageNode,Node);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        //处理一般属性的设置\r\n        this._setAttr(config);\r\n        //处理特殊属性的设置\r\n    }\r\n}\r\n//-\r\n/**\r\n *  设置节点图片,与setColor冲突，设了图片则颜色无效\r\n *\r\n *  未设置图片则显示方形节点，内部填充颜色\r\n *  @method setImage\r\n *  @param image {string} 图片相对路径\r\n */\r\nImageNode.prototype.setImage=function(image) {\r\n    if(image){\r\n        this.jtopo.setImage(image);\r\n        this.attr.image=image;\r\n    }\r\n};\r\n/**\r\n *  获取全局设置\r\n *  @method getDefault\r\n *  @return config {object} 全局配置的克隆对象[只读]，修改该对象不会直接修改全局配置，若要修改全局配置请使用scene.setDefault\r\n *  @example\r\n *          默认全局参数:\r\n *              var DEFAULT= {\r\n                        image: "",\r\n                        size: [60, 60],\r\n                        name: "node",\r\n                        alpha: 1,\r\n                        position: [0, 0],\r\n                        font: {\r\n                            size: 16,\r\n                            type: \'微软雅黑\',\r\n                            color: "255,255,255"\r\n                        },\r\n                        jsonId:"",\r\n                        border:{\r\n                            width:0,\r\n                            radius:0,\r\n                            color:"255,0,0"\r\n                        },\r\n                        zIndex: 3,\r\n                        color: JTopo.util.randomColor(),\r\n                        namePosition: \'bottom\',\r\n                        useType: QTopo.constant.node.IMAGE,\r\n                        alarm: {\r\n                            show: false,\r\n                            text: "",\r\n                            color: "255,255,255",\r\n                            font: {\r\n                                size: 16,\r\n                                type: "微软雅黑"\r\n                            }\r\n                        }\r\n                    };\r\n */\r\nImageNode.prototype.getDefault=getDefault;\r\n//--\r\n/**\r\n *  设置告警\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method setAlarm\r\n *  @param config {object}\r\n *  @example\r\n *          config={\r\n *              show: 是否显示告警{boolean},\r\n                text: 节点右上角告警板中内容,可为空{string},\r\n                color: 告警颜色{string} "255,255,255"/"#ffffff",\r\n                font: {\r\n                    size: 告警字体大小{number},\r\n                    type: 告警字体类型{string} 如"微软雅黑"\r\n                }\r\n *          }\r\n */\r\nImageNode.prototype.setAlarm=function(config) {\r\n    alarmAttr(this,this.attr.alarm,config);\r\n};\r\nfunction alarmAttr(qtopo,alarm,config){\r\n    var jtopo=qtopo.jtopo;\r\n    if(typeof config.show=="undefined"){\r\n        config.show=alarm.show;\r\n    }\r\n    if ((typeof config.show=="boolean"&&config.show)||(config.show=="true")) {\r\n        qtopo.setAlpha(1);\r\n        jtopo.shadow = true;\r\n        jtopo.alarm = config.text || "";\r\n        alarm.text=jtopo.alarm;\r\n        if(config.color){\r\n            jtopo.alarmColor = QTopo.util.transHex(config.color.toLowerCase());\r\n            alarm.color=jtopo.alarmColor;\r\n        }\r\n        var size=alarm.font.size;\r\n        var font=alarm.font.type;\r\n        if(config.font&&$.isNumeric(config.font.size)){\r\n            size=config.font.size;\r\n        }\r\n        if(config.font&&config.font.type){\r\n            font=config.font.type;\r\n        }\r\n        jtopo.alarmFont =  size+ \'px \' + font;\r\n        alarm.font.size=size;\r\n        alarm.font.type=font;\r\n        toggleAlarmFlash(jtopo,true);\r\n    } else {\r\n        jtopo.alarm = null;\r\n        toggleAlarmFlash(jtopo,false);\r\n    }\r\n    alarm.show=config.show;\r\n}\r\nfunction toggleAlarmFlash(node,show){\r\n    //切换闪烁\r\n    if(show){\r\n        node.shadowOffsetX = 0;\r\n        node.shadowOffsetY = 0;\r\n        node.shadowColor = "rgba(" + node.alarmColor + ",1)";\r\n        node.shadowBlur = 10;\r\n        node.allowAlarmFlash=true;\r\n    }else{\r\n        node.shadowOffsetX = 3;\r\n        node.shadowOffsetY = 6;\r\n        node.shadowColor="rgba(0,0,0,0.1)";\r\n        node.shadowBlur = 10;\r\n        node.allowAlarmFlash=false;\r\n    }\r\n}\r\n//--\r\n//-//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL0ltYWdlLmpzPzczNWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQ7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLE9BQU87QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsT0FBTztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0EsNkJBQTZCLFFBQVE7QUFDckMsc0NBQXNDLE9BQU87QUFDN0MsNEJBQTRCLE9BQU87QUFDbkM7QUFDQSxpQ0FBaUMsT0FBTztBQUN4QyxpQ0FBaUMsT0FBTztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiI2My5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDlm77lvaLoioLngrlcclxuICogQGNsYXNzICBJbWFnZU5vZGVcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBleHRlbmRzIFtOXSBOb2RlXHJcbiAqIEBwYXJhbSBbY29uZmlnXSDphY3nva7lj4LmlbDvvIzml6Dlj4LliJnmjInlhajlsYDphY3nva7liJvlu7pcclxuICovXHJcbnZhciBOb2RlPXJlcXVpcmUoXCIuL05vZGUuanNcIik7XHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgY29uc3RydWN0b3I6SW1hZ2VOb2RlLFxyXG4gICAgc2V0RGVmYXVsdDpzZXREZWZhdWx0LFxyXG4gICAgZ2V0RGVmYXVsdDpnZXREZWZhdWx0XHJcbn07XHJcbi8vLVxyXG52YXIgREVGQVVMVD0ge1xyXG4gICAgaW1hZ2U6IFwiXCIsXHJcbiAgICBzaXplOiBbNjAsIDYwXSxcclxuICAgIG5hbWU6IFwibm9kZVwiLFxyXG4gICAgYWxwaGE6IDEsXHJcbiAgICBwb3NpdGlvbjogWzAsIDBdLFxyXG4gICAgZm9udDoge1xyXG4gICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgIHR5cGU6ICflvq7ova/pm4Xpu5EnLFxyXG4gICAgICAgIGNvbG9yOiBcIjI1NSwyNTUsMjU1XCJcclxuICAgIH0sXHJcbiAgICBkcmFnZ2FibGU6IHRydWUsXHJcbiAgICBqc29uSWQ6XCJcIixcclxuICAgIGJvcmRlcjp7XHJcbiAgICAgICAgd2lkdGg6MCxcclxuICAgICAgICByYWRpdXM6MCxcclxuICAgICAgICBjb2xvcjpcIjI1NSwwLDBcIlxyXG4gICAgfSxcclxuICAgIHpJbmRleDogMyxcclxuICAgIGNvbG9yOiBKVG9wby51dGlsLnJhbmRvbUNvbG9yKCksXHJcbiAgICBuYW1lUG9zaXRpb246ICdib3R0b20nLFxyXG4gICAgdXNlVHlwZTogUVRvcG8uY29uc3RhbnQubm9kZS5JTUFHRSxcclxuICAgIGFsYXJtOiB7XHJcbiAgICAgICAgc2hvdzogZmFsc2UsXHJcbiAgICAgICAgdGV4dDogXCJcIixcclxuICAgICAgICBjb2xvcjogXCIyNTUsMjU1LDI1NVwiLFxyXG4gICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgc2l6ZTogMTYsXHJcbiAgICAgICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCJcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbmZ1bmN0aW9uIHNldERlZmF1bHQoY29uZmlnKXtcclxuICAgIFFUb3BvLnV0aWwuZXh0ZW5kKERFRkFVTFQsIGNvbmZpZyB8fCB7fSk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0RGVmYXVsdCgpe1xyXG4gICAgcmV0dXJuIFFUb3BvLnV0aWwuZGVlcENsb25lKERFRkFVTFQpO1xyXG59XHJcbi8vLVxyXG4vLy0tLS0tLVxyXG5mdW5jdGlvbiBJbWFnZU5vZGUoY29uZmlnKSB7XHJcbiAgICB0aGlzLmF0dHIgPSBRVG9wby51dGlsLmV4dGVuZChnZXREZWZhdWx0KCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICBOb2RlLmNhbGwodGhpcyxuZXcgSlRvcG8uTm9kZSgpKTtcclxuICAgIC8v5Ye95pWwXHJcbiAgICB0aGlzLnNldCA9IHNldEpUb3BvO1xyXG4gICAgLy/liJ3lp4vljJZcclxuICAgIHRoaXMuc2V0KHRoaXMuYXR0cik7XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhJbWFnZU5vZGUsTm9kZSk7XHJcbi8vLVxyXG4vKipcclxuICogIOWFg+e0oOWvueWxnuaAp+eahOe7n+S4gOiuvue9ruWHveaVsO+8jOaOqOiNkOS9v+eUqFxyXG4gKlxyXG4gKiAg5Y+C5pWw5Y+v6K6+572u5LiA6aG55oiW5aSa6aG5LOacquiuvue9rumDqOWIhuWPguiAg+WFqOWxgOmFjee9rlxyXG4gKiAgQG1ldGhvZCBzZXRcclxuICogIEBwYXJhbSBjb25maWdcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOWunumZheWPguaVsOWPguiAg2F0dHLlhoXlsZ7mgKcs5Y+q5Lya5L+u5pS55pyJ5a+55bqUc2V05Ye95pWw55qE5bGe5oCnLOiLpeaWsOWinuWxnuaAp+S4lOa3u+WKoOS6hnNldFhYWOWHveaVsO+8jOS5n+WPr+eUqOatpOWHveaVsOmFjee9rlxyXG4gKiAgICAgICAgICDlpoI6bmFtZSDlr7nlupQgc2V0TmFtZShcIi4uXCIpXHJcbiAqICAgICAgICAgIOWPguaVsOagvOW8j+WmguS4i1xyXG4gKiAgICAgICAgICBjb25maWc9e1xyXG4gKiAgICAgICAgICAgICAgeHg6Li4uLFxyXG4gKiAgICAgICAgICAgICAgeHg6Li4uXHJcbiAqICAgICAgICAgIH1cclxuICovXHJcbmZ1bmN0aW9uIHNldEpUb3BvKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIC8v5aSE55CG5LiA6Iis5bGe5oCn55qE6K6+572uXHJcbiAgICAgICAgdGhpcy5fc2V0QXR0cihjb25maWcpO1xyXG4gICAgICAgIC8v5aSE55CG54m55q6K5bGe5oCn55qE6K6+572uXHJcbiAgICB9XHJcbn1cclxuLy8tXHJcbi8qKlxyXG4gKiAg6K6+572u6IqC54K55Zu+54mHLOS4jnNldENvbG9y5Yay56qB77yM6K6+5LqG5Zu+54mH5YiZ6aKc6Imy5peg5pWIXHJcbiAqXHJcbiAqICDmnKrorr7nva7lm77niYfliJnmmL7npLrmlrnlvaLoioLngrnvvIzlhoXpg6jloavlhYXpopzoibJcclxuICogIEBtZXRob2Qgc2V0SW1hZ2VcclxuICogIEBwYXJhbSBpbWFnZSB7c3RyaW5nfSDlm77niYfnm7jlr7not6/lvoRcclxuICovXHJcbkltYWdlTm9kZS5wcm90b3R5cGUuc2V0SW1hZ2U9ZnVuY3Rpb24oaW1hZ2UpIHtcclxuICAgIGlmKGltYWdlKXtcclxuICAgICAgICB0aGlzLmp0b3BvLnNldEltYWdlKGltYWdlKTtcclxuICAgICAgICB0aGlzLmF0dHIuaW1hZ2U9aW1hZ2U7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg6I635Y+W5YWo5bGA6K6+572uXHJcbiAqICBAbWV0aG9kIGdldERlZmF1bHRcclxuICogIEByZXR1cm4gY29uZmlnIHtvYmplY3R9IOWFqOWxgOmFjee9rueahOWFi+mahuWvueixoVvlj6ror7td77yM5L+u5pS56K+l5a+56LGh5LiN5Lya55u05o6l5L+u5pS55YWo5bGA6YWN572u77yM6Iul6KaB5L+u5pS55YWo5bGA6YWN572u6K+35L2/55Soc2NlbmUuc2V0RGVmYXVsdFxyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAg6buY6K6k5YWo5bGA5Y+C5pWwOlxyXG4gKiAgICAgICAgICAgICAgdmFyIERFRkFVTFQ9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFs2MCwgNjBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIm5vZGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ+W+rui9r+mbhem7kScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogXCIyNTUsMjU1LDI1NVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGpzb25JZDpcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBib3JkZXI6e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6MCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1czowLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6XCIyNTUsMCwwXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgekluZGV4OiAzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogSlRvcG8udXRpbC5yYW5kb21Db2xvcigpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lUG9zaXRpb246ICdib3R0b20nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5ub2RlLklNQUdFLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGFybToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiMjU1LDI1NSwyNTVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxNixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIuW+rui9r+mbhem7kVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gKi9cclxuSW1hZ2VOb2RlLnByb3RvdHlwZS5nZXREZWZhdWx0PWdldERlZmF1bHQ7XHJcbi8vLS1cclxuLyoqXHJcbiAqICDorr7nva7lkYroraZcclxuICpcclxuICogIOWPguaVsOWPr+iuvue9ruS4gOmhueaIluWkmumhuSzmnKrorr7nva7pg6jliIblj4LogIPlhajlsYDphY3nva5cclxuICogIEBtZXRob2Qgc2V0QWxhcm1cclxuICogIEBwYXJhbSBjb25maWcge29iamVjdH1cclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIGNvbmZpZz17XHJcbiAqICAgICAgICAgICAgICBzaG93OiDmmK/lkKbmmL7npLrlkYroraZ7Ym9vbGVhbn0sXHJcbiAgICAgICAgICAgICAgICB0ZXh0OiDoioLngrnlj7PkuIrop5LlkYrorabmnb/kuK3lhoXlrrks5Y+v5Li656m6e3N0cmluZ30sXHJcbiAgICAgICAgICAgICAgICBjb2xvcjog5ZGK6K2m6aKc6Imye3N0cmluZ30gXCIyNTUsMjU1LDI1NVwiL1wiI2ZmZmZmZlwiLFxyXG4gICAgICAgICAgICAgICAgZm9udDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IOWRiuitpuWtl+S9k+Wkp+Wwj3tudW1iZXJ9LFxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IOWRiuitpuWtl+S9k+exu+Wei3tzdHJpbmd9IOWmglwi5b6u6L2v6ZuF6buRXCJcclxuICAgICAgICAgICAgICAgIH1cclxuICogICAgICAgICAgfVxyXG4gKi9cclxuSW1hZ2VOb2RlLnByb3RvdHlwZS5zZXRBbGFybT1mdW5jdGlvbihjb25maWcpIHtcclxuICAgIGFsYXJtQXR0cih0aGlzLHRoaXMuYXR0ci5hbGFybSxjb25maWcpO1xyXG59O1xyXG5mdW5jdGlvbiBhbGFybUF0dHIocXRvcG8sYWxhcm0sY29uZmlnKXtcclxuICAgIHZhciBqdG9wbz1xdG9wby5qdG9wbztcclxuICAgIGlmKHR5cGVvZiBjb25maWcuc2hvdz09XCJ1bmRlZmluZWRcIil7XHJcbiAgICAgICAgY29uZmlnLnNob3c9YWxhcm0uc2hvdztcclxuICAgIH1cclxuICAgIGlmICgodHlwZW9mIGNvbmZpZy5zaG93PT1cImJvb2xlYW5cIiYmY29uZmlnLnNob3cpfHwoY29uZmlnLnNob3c9PVwidHJ1ZVwiKSkge1xyXG4gICAgICAgIHF0b3BvLnNldEFscGhhKDEpO1xyXG4gICAgICAgIGp0b3BvLnNoYWRvdyA9IHRydWU7XHJcbiAgICAgICAganRvcG8uYWxhcm0gPSBjb25maWcudGV4dCB8fCBcIlwiO1xyXG4gICAgICAgIGFsYXJtLnRleHQ9anRvcG8uYWxhcm07XHJcbiAgICAgICAgaWYoY29uZmlnLmNvbG9yKXtcclxuICAgICAgICAgICAganRvcG8uYWxhcm1Db2xvciA9IFFUb3BvLnV0aWwudHJhbnNIZXgoY29uZmlnLmNvbG9yLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgICAgICAgICBhbGFybS5jb2xvcj1qdG9wby5hbGFybUNvbG9yO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc2l6ZT1hbGFybS5mb250LnNpemU7XHJcbiAgICAgICAgdmFyIGZvbnQ9YWxhcm0uZm9udC50eXBlO1xyXG4gICAgICAgIGlmKGNvbmZpZy5mb250JiYkLmlzTnVtZXJpYyhjb25maWcuZm9udC5zaXplKSl7XHJcbiAgICAgICAgICAgIHNpemU9Y29uZmlnLmZvbnQuc2l6ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoY29uZmlnLmZvbnQmJmNvbmZpZy5mb250LnR5cGUpe1xyXG4gICAgICAgICAgICBmb250PWNvbmZpZy5mb250LnR5cGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGp0b3BvLmFsYXJtRm9udCA9ICBzaXplKyAncHggJyArIGZvbnQ7XHJcbiAgICAgICAgYWxhcm0uZm9udC5zaXplPXNpemU7XHJcbiAgICAgICAgYWxhcm0uZm9udC50eXBlPWZvbnQ7XHJcbiAgICAgICAgdG9nZ2xlQWxhcm1GbGFzaChqdG9wbyx0cnVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAganRvcG8uYWxhcm0gPSBudWxsO1xyXG4gICAgICAgIHRvZ2dsZUFsYXJtRmxhc2goanRvcG8sZmFsc2UpO1xyXG4gICAgfVxyXG4gICAgYWxhcm0uc2hvdz1jb25maWcuc2hvdztcclxufVxyXG5mdW5jdGlvbiB0b2dnbGVBbGFybUZsYXNoKG5vZGUsc2hvdyl7XHJcbiAgICAvL+WIh+aNoumXqueDgVxyXG4gICAgaWYoc2hvdyl7XHJcbiAgICAgICAgbm9kZS5zaGFkb3dPZmZzZXRYID0gMDtcclxuICAgICAgICBub2RlLnNoYWRvd09mZnNldFkgPSAwO1xyXG4gICAgICAgIG5vZGUuc2hhZG93Q29sb3IgPSBcInJnYmEoXCIgKyBub2RlLmFsYXJtQ29sb3IgKyBcIiwxKVwiO1xyXG4gICAgICAgIG5vZGUuc2hhZG93Qmx1ciA9IDEwO1xyXG4gICAgICAgIG5vZGUuYWxsb3dBbGFybUZsYXNoPXRydWU7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgICBub2RlLnNoYWRvd09mZnNldFggPSAzO1xyXG4gICAgICAgIG5vZGUuc2hhZG93T2Zmc2V0WSA9IDY7XHJcbiAgICAgICAgbm9kZS5zaGFkb3dDb2xvcj1cInJnYmEoMCwwLDAsMC4xKVwiO1xyXG4gICAgICAgIG5vZGUuc2hhZG93Qmx1ciA9IDEwO1xyXG4gICAgICAgIG5vZGUuYWxsb3dBbGFybUZsYXNoPWZhbHNlO1xyXG4gICAgfVxyXG59XHJcbi8vLS1cclxuLy8tXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL0ltYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSA2M1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9');
},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\nvar Node=__webpack_require__(28);\r\nmodule.exports = {\r\n    constructor:ShapeNode,\r\n    setDefault:setDefault,\r\n    getDefault:getDefault\r\n};\r\n//-\r\nvar DEFAULT= {\r\n    size: [200, 100],\r\n    name: "shape",\r\n    alpha: 1,\r\n    position: [0, 0],\r\n    font: {\r\n        size: 16,\r\n        type: \'微软雅黑\',\r\n        color: "255,255,255"\r\n    },\r\n    jsonId:"",\r\n    border:{\r\n        width:0,\r\n        radius:0,\r\n        color:"255,0,0"\r\n    },\r\n    shapeType:\'ellipse\',\r\n    zIndex: 3,\r\n    color: JTopo.util.randomColor(),\r\n    namePosition: \'bottom\',\r\n    useType: QTopo.constant.node.SHAPE\r\n};\r\nfunction setDefault(config){\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault(){\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\n/**\r\n * 形状节点\r\n * @class  ShapeNode\r\n * @constructor\r\n * @extends [N] Node\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nfunction ShapeNode(config) {\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Node.call(this,new JTopo.Node());\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(ShapeNode,Node);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        //处理一般属性的设置\r\n        this._setAttr(config);\r\n        //处理特殊属性的设置\r\n    }\r\n}\r\n\r\n//-\r\n/**\r\n *  获取全局设置\r\n *  @method getDefault\r\n *  @return config {object} 全局配置的克隆对象[只读]，修改该对象不会直接修改全局配置，若要修改全局配置请使用scene.setDefault\r\n *  @example\r\n *          默认全局参数:\r\n *              var DEFAULT= {\r\n                        image: "",\r\n                        size: [200, 100],\r\n                        name: "node",\r\n                        alpha: 1,\r\n                        position: [0, 0],\r\n                        font: {\r\n                            size: 16,\r\n                            type: \'微软雅黑\',\r\n                            color: "255,255,255"\r\n                        },\r\n                        jsonId:"",\r\n                        border:{\r\n                            width:0,\r\n                            radius:0,\r\n                            color:"255,0,0"\r\n                        },\r\n                        zIndex: 3,\r\n                        color: JTopo.util.randomColor(),\r\n                        namePosition: \'bottom\',\r\n                        useType: QTopo.constant.node.IMAGE,\r\n                        alarm: {\r\n                            show: false,\r\n                            text: "",\r\n                            color: "255,255,255",\r\n                            font: {\r\n                                size: 16,\r\n                                type: "微软雅黑"\r\n                            }\r\n                        }\r\n                    };\r\n */\r\nShapeNode.prototype.getDefault=getDefault;\r\n//-\r\nShapeNode.prototype.setShapeType=function(type){\r\n    var jtopo=this.jtopo;\r\n    switch (type){\r\n        case \'ellipse\':\r\n            this.attr.shapeType=\'ellipse\';\r\n            jtopo.paint=paintEllipse;\r\n            break;\r\n    }\r\n};\r\nfunction paintEllipse(context){\r\n    context.save();\r\n    context._ellipse(0,0,this.width,this.height);\r\n    //context._star(0,0,this.width,this.height);\r\n    if(this.gradien){\r\n        context.fillStyle=this.gradien;\r\n    }else{\r\n        context.fillStyle = \'rgba(\'+this.fillColor+"," + this.alpha + ")";\r\n    }\r\n    context.fill();\r\n    context.restore();\r\n    this.paintCtrl(context);\r\n    this.paintAlarmText(context);\r\n    this.paintText(context);\r\n}\r\n//-//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL1NoYXBlLmpzP2ZkMDAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsT0FBTztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiI2NC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbnZhciBOb2RlPXJlcXVpcmUoXCIuL05vZGUuanNcIik7XHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgY29uc3RydWN0b3I6U2hhcGVOb2RlLFxyXG4gICAgc2V0RGVmYXVsdDpzZXREZWZhdWx0LFxyXG4gICAgZ2V0RGVmYXVsdDpnZXREZWZhdWx0XHJcbn07XHJcbi8vLVxyXG52YXIgREVGQVVMVD0ge1xyXG4gICAgc2l6ZTogWzIwMCwgMTAwXSxcclxuICAgIG5hbWU6IFwic2hhcGVcIixcclxuICAgIGFscGhhOiAxLFxyXG4gICAgcG9zaXRpb246IFswLCAwXSxcclxuICAgIGZvbnQ6IHtcclxuICAgICAgICBzaXplOiAxNixcclxuICAgICAgICB0eXBlOiAn5b6u6L2v6ZuF6buRJyxcclxuICAgICAgICBjb2xvcjogXCIyNTUsMjU1LDI1NVwiXHJcbiAgICB9LFxyXG4gICAganNvbklkOlwiXCIsXHJcbiAgICBib3JkZXI6e1xyXG4gICAgICAgIHdpZHRoOjAsXHJcbiAgICAgICAgcmFkaXVzOjAsXHJcbiAgICAgICAgY29sb3I6XCIyNTUsMCwwXCJcclxuICAgIH0sXHJcbiAgICBzaGFwZVR5cGU6J2VsbGlwc2UnLFxyXG4gICAgekluZGV4OiAzLFxyXG4gICAgY29sb3I6IEpUb3BvLnV0aWwucmFuZG9tQ29sb3IoKSxcclxuICAgIG5hbWVQb3NpdGlvbjogJ2JvdHRvbScsXHJcbiAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5ub2RlLlNIQVBFXHJcbn07XHJcbmZ1bmN0aW9uIHNldERlZmF1bHQoY29uZmlnKXtcclxuICAgIFFUb3BvLnV0aWwuZXh0ZW5kKERFRkFVTFQsIGNvbmZpZyB8fCB7fSk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0RGVmYXVsdCgpe1xyXG4gICAgcmV0dXJuIFFUb3BvLnV0aWwuZGVlcENsb25lKERFRkFVTFQpO1xyXG59XHJcbi8vLVxyXG4vKipcclxuICog5b2i54q26IqC54K5XHJcbiAqIEBjbGFzcyAgU2hhcGVOb2RlXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbTl0gTm9kZVxyXG4gKiBAcGFyYW0gW2NvbmZpZ10g6YWN572u5Y+C5pWw77yM5peg5Y+C5YiZ5oyJ5YWo5bGA6YWN572u5Yib5bu6XHJcbiAqL1xyXG5mdW5jdGlvbiBTaGFwZU5vZGUoY29uZmlnKSB7XHJcbiAgICB0aGlzLmF0dHIgPSBRVG9wby51dGlsLmV4dGVuZChnZXREZWZhdWx0KCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICBOb2RlLmNhbGwodGhpcyxuZXcgSlRvcG8uTm9kZSgpKTtcclxuICAgIC8v5Ye95pWwXHJcbiAgICB0aGlzLnNldCA9IHNldEpUb3BvO1xyXG4gICAgLy/liJ3lp4vljJZcclxuICAgIHRoaXMuc2V0KHRoaXMuYXR0cik7XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhTaGFwZU5vZGUsTm9kZSk7XHJcbi8vLVxyXG4vKipcclxuICogIOWFg+e0oOWvueWxnuaAp+eahOe7n+S4gOiuvue9ruWHveaVsO+8jOaOqOiNkOS9v+eUqFxyXG4gKlxyXG4gKiAg5Y+C5pWw5Y+v6K6+572u5LiA6aG55oiW5aSa6aG5LOacquiuvue9rumDqOWIhuWPguiAg+WFqOWxgOmFjee9rlxyXG4gKiAgQG1ldGhvZCBzZXRcclxuICogIEBwYXJhbSBjb25maWdcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOWunumZheWPguaVsOWPguiAg2F0dHLlhoXlsZ7mgKcs5Y+q5Lya5L+u5pS55pyJ5a+55bqUc2V05Ye95pWw55qE5bGe5oCnLOiLpeaWsOWinuWxnuaAp+S4lOa3u+WKoOS6hnNldFhYWOWHveaVsO+8jOS5n+WPr+eUqOatpOWHveaVsOmFjee9rlxyXG4gKiAgICAgICAgICDlpoI6bmFtZSDlr7nlupQgc2V0TmFtZShcIi4uXCIpXHJcbiAqICAgICAgICAgIOWPguaVsOagvOW8j+WmguS4i1xyXG4gKiAgICAgICAgICBjb25maWc9e1xyXG4gKiAgICAgICAgICAgICAgeHg6Li4uLFxyXG4gKiAgICAgICAgICAgICAgeHg6Li4uXHJcbiAqICAgICAgICAgIH1cclxuICovXHJcbmZ1bmN0aW9uIHNldEpUb3BvKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIC8v5aSE55CG5LiA6Iis5bGe5oCn55qE6K6+572uXHJcbiAgICAgICAgdGhpcy5fc2V0QXR0cihjb25maWcpO1xyXG4gICAgICAgIC8v5aSE55CG54m55q6K5bGe5oCn55qE6K6+572uXHJcbiAgICB9XHJcbn1cclxuXHJcbi8vLVxyXG4vKipcclxuICogIOiOt+WPluWFqOWxgOiuvue9rlxyXG4gKiAgQG1ldGhvZCBnZXREZWZhdWx0XHJcbiAqICBAcmV0dXJuIGNvbmZpZyB7b2JqZWN0fSDlhajlsYDphY3nva7nmoTlhYvpmoblr7nosaFb5Y+q6K+7Xe+8jOS/ruaUueivpeWvueixoeS4jeS8muebtOaOpeS/ruaUueWFqOWxgOmFjee9ru+8jOiLpeimgeS/ruaUueWFqOWxgOmFjee9ruivt+S9v+eUqHNjZW5lLnNldERlZmF1bHRcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOm7mOiupOWFqOWxgOWPguaVsDpcclxuICogICAgICAgICAgICAgIHZhciBERUZBVUxUPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbMjAwLCAxMDBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIm5vZGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ+W+rui9r+mbhem7kScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogXCIyNTUsMjU1LDI1NVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGpzb25JZDpcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBib3JkZXI6e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6MCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1czowLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6XCIyNTUsMCwwXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgekluZGV4OiAzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogSlRvcG8udXRpbC5yYW5kb21Db2xvcigpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lUG9zaXRpb246ICdib3R0b20nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5ub2RlLklNQUdFLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGFybToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiMjU1LDI1NSwyNTVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxNixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIuW+rui9r+mbhem7kVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gKi9cclxuU2hhcGVOb2RlLnByb3RvdHlwZS5nZXREZWZhdWx0PWdldERlZmF1bHQ7XHJcbi8vLVxyXG5TaGFwZU5vZGUucHJvdG90eXBlLnNldFNoYXBlVHlwZT1mdW5jdGlvbih0eXBlKXtcclxuICAgIHZhciBqdG9wbz10aGlzLmp0b3BvO1xyXG4gICAgc3dpdGNoICh0eXBlKXtcclxuICAgICAgICBjYXNlICdlbGxpcHNlJzpcclxuICAgICAgICAgICAgdGhpcy5hdHRyLnNoYXBlVHlwZT0nZWxsaXBzZSc7XHJcbiAgICAgICAgICAgIGp0b3BvLnBhaW50PXBhaW50RWxsaXBzZTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbn07XHJcbmZ1bmN0aW9uIHBhaW50RWxsaXBzZShjb250ZXh0KXtcclxuICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgY29udGV4dC5fZWxsaXBzZSgwLDAsdGhpcy53aWR0aCx0aGlzLmhlaWdodCk7XHJcbiAgICAvL2NvbnRleHQuX3N0YXIoMCwwLHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpO1xyXG4gICAgaWYodGhpcy5ncmFkaWVuKXtcclxuICAgICAgICBjb250ZXh0LmZpbGxTdHlsZT10aGlzLmdyYWRpZW47XHJcbiAgICB9ZWxzZXtcclxuICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9ICdyZ2JhKCcrdGhpcy5maWxsQ29sb3IrXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICB9XHJcbiAgICBjb250ZXh0LmZpbGwoKTtcclxuICAgIGNvbnRleHQucmVzdG9yZSgpO1xyXG4gICAgdGhpcy5wYWludEN0cmwoY29udGV4dCk7XHJcbiAgICB0aGlzLnBhaW50QWxhcm1UZXh0KGNvbnRleHQpO1xyXG4gICAgdGhpcy5wYWludFRleHQoY29udGV4dCk7XHJcbn1cclxuLy8tXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL1NoYXBlLmpzXG4vLyBtb2R1bGUgaWQgPSA2NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 文本节点\r\n * @class  initTextNode\r\n * @constructor\r\n * @extends [N] Node\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Node = __webpack_require__(28);\r\nmodule.exports = {\r\n    constructor: TextNode,\r\n    setDefault: setDefault,\r\n    getDefault: getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n    position: [0, 0],\r\n    font: {\r\n        size: 16,\r\n        type: \'微软雅黑\',\r\n        color: "255,255,255"\r\n    },\r\n    jsonId:"",\r\n    border: {\r\n        width: 0,\r\n        radius: 0,\r\n        color: "255,0,0"\r\n    },\r\n    zIndex: 3,\r\n    alpha: 1,\r\n    text: \'no text here\',\r\n    useType: QTopo.constant.node.TEXT\r\n};\r\nfunction setDefault(config) {\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault() {\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\nfunction TextNode(config) {\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Node.call(this, new JTopo.TextNode());\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(TextNode, Node);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *\r\n *  若传入参数的text未配置，则显示为  "not set text"\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        //处理一般属性的设置\r\n        if (!this.attr.text&&!config.text) {\r\n            config.text = "not set text";\r\n        }\r\n        this._setAttr(config);\r\n    }\r\n}\r\n//-\r\n/**\r\n *  获取全局设置\r\n *  @method getDefault\r\n *  @return config {object} 全局配置的克隆对象[只读]，修改该对象不会直接修改全局配置，若要修改全局配置请使用scene.setDefault\r\n *  @example\r\n *          默认全局参数:\r\n *              var DEFAULT = {\r\n                    position: [0, 0],\r\n                    font: {\r\n                        size: 16,\r\n                        type: \'微软雅黑\',\r\n                        color: "255,255,255"\r\n                    },\r\n                    jsonId:"",\r\n                    border: {\r\n                        width: 0,\r\n                        radius: 0,//最大160 最小0\r\n                        color: "255,0,0"\r\n                    },\r\n                    zIndex: 3,\r\n                    alpha: 1,\r\n                    text: \'no text here\',\r\n                    useType: QTopo.constant.node.TEXT\r\n                };\r\n */\r\nTextNode.prototype.getDefault = getDefault;\r\n//-\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL1RleHQuanM/MzM5ZiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixPQUFPO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjY1LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLyoqXHJcbiAqIOaWh+acrOiKgueCuVxyXG4gKiBAY2xhc3MgIGluaXRUZXh0Tm9kZVxyXG4gKiBAY29uc3RydWN0b3JcclxuICogQGV4dGVuZHMgW05dIE5vZGVcclxuICogQHBhcmFtIFtjb25maWddIOmFjee9ruWPguaVsO+8jOaXoOWPguWImeaMieWFqOWxgOmFjee9ruWIm+W7ulxyXG4gKi9cclxudmFyIE5vZGUgPSByZXF1aXJlKFwiLi9Ob2RlLmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICAgIGNvbnN0cnVjdG9yOiBUZXh0Tm9kZSxcclxuICAgIHNldERlZmF1bHQ6IHNldERlZmF1bHQsXHJcbiAgICBnZXREZWZhdWx0OiBnZXREZWZhdWx0XHJcbn07XHJcbi8vLVxyXG52YXIgREVGQVVMVCA9IHtcclxuICAgIHBvc2l0aW9uOiBbMCwgMF0sXHJcbiAgICBmb250OiB7XHJcbiAgICAgICAgc2l6ZTogMTYsXHJcbiAgICAgICAgdHlwZTogJ+W+rui9r+mbhem7kScsXHJcbiAgICAgICAgY29sb3I6IFwiMjU1LDI1NSwyNTVcIlxyXG4gICAgfSxcclxuICAgIGpzb25JZDpcIlwiLFxyXG4gICAgYm9yZGVyOiB7XHJcbiAgICAgICAgd2lkdGg6IDAsXHJcbiAgICAgICAgcmFkaXVzOiAwLFxyXG4gICAgICAgIGNvbG9yOiBcIjI1NSwwLDBcIlxyXG4gICAgfSxcclxuICAgIHpJbmRleDogMyxcclxuICAgIGFscGhhOiAxLFxyXG4gICAgdGV4dDogJ25vIHRleHQgaGVyZScsXHJcbiAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5ub2RlLlRFWFRcclxufTtcclxuZnVuY3Rpb24gc2V0RGVmYXVsdChjb25maWcpIHtcclxuICAgIFFUb3BvLnV0aWwuZXh0ZW5kKERFRkFVTFQsIGNvbmZpZyB8fCB7fSk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHtcclxuICAgIHJldHVybiBRVG9wby51dGlsLmRlZXBDbG9uZShERUZBVUxUKTtcclxufVxyXG4vLy1cclxuZnVuY3Rpb24gVGV4dE5vZGUoY29uZmlnKSB7XHJcbiAgICB0aGlzLmF0dHIgPSBRVG9wby51dGlsLmV4dGVuZChnZXREZWZhdWx0KCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICBOb2RlLmNhbGwodGhpcywgbmV3IEpUb3BvLlRleHROb2RlKCkpO1xyXG4gICAgdGhpcy5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICB0aGlzLnNldCh0aGlzLmF0dHIpO1xyXG59XHJcblFUb3BvLnV0aWwuaW5oZXJpdHMoVGV4dE5vZGUsIE5vZGUpO1xyXG4vLy1cclxuLyoqXHJcbiAqICDlhYPntKDlr7nlsZ7mgKfnmoTnu5/kuIDorr7nva7lh73mlbDvvIzmjqjojZDkvb/nlKhcclxuICpcclxuICogIOWPguaVsOWPr+iuvue9ruS4gOmhueaIluWkmumhuSzmnKrorr7nva7pg6jliIblj4LogIPlhajlsYDphY3nva5cclxuICpcclxuICogIOiLpeS8oOWFpeWPguaVsOeahHRleHTmnKrphY3nva7vvIzliJnmmL7npLrkuLogIFwibm90IHNldCB0ZXh0XCJcclxuICogIEBtZXRob2Qgc2V0XHJcbiAqICBAcGFyYW0gY29uZmlnXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICAgICDlrp7pmYXlj4LmlbDlj4LogINhdHRy5YaF5bGe5oCnLOWPquS8muS/ruaUueacieWvueW6lHNldOWHveaVsOeahOWxnuaApyzoi6XmlrDlop7lsZ7mgKfkuJTmt7vliqDkuoZzZXRYWFjlh73mlbDvvIzkuZ/lj6/nlKjmraTlh73mlbDphY3nva5cclxuICogICAgICAgICAg5aaCOm5hbWUg5a+55bqUIHNldE5hbWUoXCIuLlwiKVxyXG4gKiAgICAgICAgICDlj4LmlbDmoLzlvI/lpoLkuItcclxuICogICAgICAgICAgY29uZmlnPXtcclxuICogICAgICAgICAgICAgIHh4Oi4uLixcclxuICogICAgICAgICAgICAgIHh4Oi4uLlxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5mdW5jdGlvbiBzZXRKVG9wbyhjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICAvL+WkhOeQhuS4gOiIrOWxnuaAp+eahOiuvue9rlxyXG4gICAgICAgIGlmICghdGhpcy5hdHRyLnRleHQmJiFjb25maWcudGV4dCkge1xyXG4gICAgICAgICAgICBjb25maWcudGV4dCA9IFwibm90IHNldCB0ZXh0XCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3NldEF0dHIoY29uZmlnKTtcclxuICAgIH1cclxufVxyXG4vLy1cclxuLyoqXHJcbiAqICDojrflj5blhajlsYDorr7nva5cclxuICogIEBtZXRob2QgZ2V0RGVmYXVsdFxyXG4gKiAgQHJldHVybiBjb25maWcge29iamVjdH0g5YWo5bGA6YWN572u55qE5YWL6ZqG5a+56LGhW+WPquivu13vvIzkv67mlLnor6Xlr7nosaHkuI3kvJrnm7TmjqXkv67mlLnlhajlsYDphY3nva7vvIzoi6XopoHkv67mlLnlhajlsYDphY3nva7or7fkvb/nlKhzY2VuZS5zZXREZWZhdWx0XHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICAgICDpu5jorqTlhajlsYDlj4LmlbA6XHJcbiAqICAgICAgICAgICAgICB2YXIgREVGQVVMVCA9IHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDBdLFxyXG4gICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogMTYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICflvq7ova/pm4Xpu5EnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogXCIyNTUsMjU1LDI1NVwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBqc29uSWQ6XCJcIixcclxuICAgICAgICAgICAgICAgICAgICBib3JkZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1czogMCwvL+acgOWkpzE2MCDmnIDlsI8wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBcIjI1NSwwLDBcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgekluZGV4OiAzLFxyXG4gICAgICAgICAgICAgICAgICAgIGFscGhhOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdubyB0ZXh0IGhlcmUnLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50Lm5vZGUuVEVYVFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICovXHJcblRleHROb2RlLnByb3RvdHlwZS5nZXREZWZhdWx0ID0gZ2V0RGVmYXVsdDtcclxuLy8tXHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbm9kZS9UZXh0LmpzXG4vLyBtb2R1bGUgaWQgPSA2NVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * @class Scene\r\n */\r\nvar events = {\r\n    init: function (scene) {\r\n        /**\r\n         * 在图层上双击时\r\n         *\r\n         * 目标是分组,则分组可进行缩放和还原\r\n         *\r\n         * 目标为链路,QTopo.constant.link.DIRECT类型的链路计数大于1时可展开和合并\r\n         * @event dbclick\r\n         */\r\n        scene.on("dbclick", dbClick(scene));\r\n    }\r\n};\r\nfunction dbClick(scene) {\r\n    return function (e, qtopo) {\r\n        toggleGroup(e, qtopo, scene);\r\n        toggleLink(e, qtopo, scene);\r\n    }\r\n}\r\nfunction toggleGroup(e, qtopo, scene) {\r\n    //分组隐藏，显示缩放节点，节点位置根据分组长宽计算\r\n    if (qtopo) {\r\n        if (qtopo.getType() == QTopo.constant.CONTAINER) {\r\n            qtopo.toggle();\r\n        } else if (qtopo.getType() == QTopo.constant.NODE && qtopo.getUseType() == QTopo.constant.CASUAL) {\r\n            //分组显示，隐藏缩放节点，分组新位置根据节点位置和分组长宽计算\r\n            if (qtopo.toggleTo) {\r\n                qtopo.toggleTo.toggle();\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction toggleLink(e, qtopo, scene) {\r\n    if (qtopo && qtopo.getType() == QTopo.constant.LINK) {\r\n        qtopo.jtopo.expand=!qtopo.jtopo.expand;\r\n    }\r\n}\r\nmodule.exports = events;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZXZlbnRzLmpzP2FmNWMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjY2LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLyoqXHJcbiAqIEBjbGFzcyBTY2VuZVxyXG4gKi9cclxudmFyIGV2ZW50cyA9IHtcclxuICAgIGluaXQ6IGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWcqOWbvuWxguS4iuWPjOWHu+aXtlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICog55uu5qCH5piv5YiG57uELOWImeWIhue7hOWPr+i/m+ihjOe8qeaUvuWSjOi/mOWOn1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICog55uu5qCH5Li66ZO+6LevLFFUb3BvLmNvbnN0YW50LmxpbmsuRElSRUNU57G75Z6L55qE6ZO+6Lev6K6h5pWw5aSn5LqOMeaXtuWPr+WxleW8gOWSjOWQiOW5tlxyXG4gICAgICAgICAqIEBldmVudCBkYmNsaWNrXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2NlbmUub24oXCJkYmNsaWNrXCIsIGRiQ2xpY2soc2NlbmUpKTtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gZGJDbGljayhzY2VuZSkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChlLCBxdG9wbykge1xyXG4gICAgICAgIHRvZ2dsZUdyb3VwKGUsIHF0b3BvLCBzY2VuZSk7XHJcbiAgICAgICAgdG9nZ2xlTGluayhlLCBxdG9wbywgc2NlbmUpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHRvZ2dsZUdyb3VwKGUsIHF0b3BvLCBzY2VuZSkge1xyXG4gICAgLy/liIbnu4TpmpDol4/vvIzmmL7npLrnvKnmlL7oioLngrnvvIzoioLngrnkvY3nva7moLnmja7liIbnu4Tplb/lrr3orqHnrpdcclxuICAgIGlmIChxdG9wbykge1xyXG4gICAgICAgIGlmIChxdG9wby5nZXRUeXBlKCkgPT0gUVRvcG8uY29uc3RhbnQuQ09OVEFJTkVSKSB7XHJcbiAgICAgICAgICAgIHF0b3BvLnRvZ2dsZSgpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocXRvcG8uZ2V0VHlwZSgpID09IFFUb3BvLmNvbnN0YW50Lk5PREUgJiYgcXRvcG8uZ2V0VXNlVHlwZSgpID09IFFUb3BvLmNvbnN0YW50LkNBU1VBTCkge1xyXG4gICAgICAgICAgICAvL+WIhue7hOaYvuekuu+8jOmakOiXj+e8qeaUvuiKgueCue+8jOWIhue7hOaWsOS9jee9ruagueaNruiKgueCueS9jee9ruWSjOWIhue7hOmVv+Wuveiuoeeul1xyXG4gICAgICAgICAgICBpZiAocXRvcG8udG9nZ2xlVG8pIHtcclxuICAgICAgICAgICAgICAgIHF0b3BvLnRvZ2dsZVRvLnRvZ2dsZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHRvZ2dsZUxpbmsoZSwgcXRvcG8sIHNjZW5lKSB7XHJcbiAgICBpZiAocXRvcG8gJiYgcXRvcG8uZ2V0VHlwZSgpID09IFFUb3BvLmNvbnN0YW50LkxJTkspIHtcclxuICAgICAgICBxdG9wby5qdG9wby5leHBhbmQ9IXF0b3BvLmp0b3BvLmV4cGFuZDtcclxuICAgIH1cclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IGV2ZW50cztcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZXZlbnRzLmpzXG4vLyBtb2R1bGUgaWQgPSA2NlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9')},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";eval('/**\r\n * @module QTopo\r\n */\r\n\r\n__webpack_require__(27);\r\nif (typeof jQuery == "undefined") {\r\n    throw new Error("need jquery");\r\n}\r\n/**\r\n * 主入口,window.QTopo\r\n * @class QTopo\r\n * @static\r\n */\r\nvar QTopo = {\r\n    /**\r\n     * 存放当前页面中所初始化的topo实例\r\n     * @property instance {array}\r\n     */\r\n    instance: [],\r\n    /**\r\n     * 一系列工具函数,详细内容参考 QTopo.util\r\n     * @property util {object}\r\n     */\r\n    util: __webpack_require__(37),\r\n    constant: __webpack_require__(35),\r\n    /**\r\n     * 可开启或屏蔽控制台日志,对应用QTopo.util.info以及QTopo.util.error函数输出的日志\r\n     * @property log {object}\r\n     * @param error {boolean} 默认为true,开启\r\n     * @param info {boolean} 默认为true,开启\r\n     */\r\n    log: {\r\n        error: true,\r\n        info: true\r\n    }\r\n};\r\nwindow.QTopo = QTopo;\r\nvar Scene = __webpack_require__(36);\r\n/**\r\n * 初始化Qtopo实例,创建并将其保存在QTopo.instance数组内,实例api参考QTopo.instance\r\n *  @method init\r\n *  @param dom {document} 指定初始化所在的dom,若是数组则自动取第一个\r\n *  @param [config] {object} 配置参数,配置内容为图层scene配置(参考scene配置)\r\n *  @returns [instance] QTopo实例对象，QTopo.instance\r\n *  @example\r\n *      IPOSS = QTopo.init(\r\n *           document.getElementsByClassName("topo_base")[0],\r\n *          {\r\n *              backgroundColor: "#06243e",//基本属性配置背景色\r\n *              path:[] //自定义属性,插入到图层对象scene的额外属性中\r\n *          }\r\n *      );\r\n */\r\nQTopo.init = function (dom, config) {\r\n    dom = dom instanceof Array ? dom[0] : dom;\r\n    var canvas = initCanvas(dom, $(dom).width(), $(dom).height());\r\n    /**\r\n     * QTopo初始化的topo实例,QTopo.init后的返回对象，或是QTopo.instance数组内保存的对象\r\n     * @class QTopo.instance\r\n     * @static\r\n     */\r\n    var QtopoInstance = {\r\n        /**\r\n         * topo实例化的图层对象\r\n         * @property scene {object}\r\n         */\r\n        scene: new Scene(canvas, config),\r\n        setOption: setOption,\r\n        /**\r\n         * topo实例所在dom\r\n         * @property document {document}\r\n         */\r\n        document: dom,\r\n        resize: resize(dom, canvas),\r\n        toJson: toJson\r\n    };\r\n    this.instance.push(QtopoInstance);\r\n    return QtopoInstance;\r\n};\r\nmodule.exports = QTopo;\r\n//---------------------\r\n/**\r\n * 图层绘制主函数\r\n *\r\n * 可以随时使用setOption生成一个或多个元素,或配置告警，也可以一次性全局配置\r\n *\r\n * 相关的全局样式请参考各元素自身的attr属性,或通过 元素的getDefault() / scene.getDefault(type)来获取对应元素的全局样式\r\n *\r\n * 前端绘图过程可以用工具栏和右键菜单绘制完成后,配合实例的toJson函数取得图层数据,(实例通过QTopo.init初始化且保存在QTopo.instance数组内)\r\n *\r\n * 直接将返回对象的option属性传入setOption可复制绘图\r\n *\r\n * 每个元素配置的data数组内成员的属性可以是样式也可以是额外属性,自适应取值配置，过滤的额外属性自动分配到元素的extra属性中保存,可以通过node.val(\'id\')的形式获取\r\n *\r\n * 和样式重名的额外属性可以放在extra中，extra中的属性将默认全部覆盖到元素的extra属性内\r\n *\r\n *  @method setOption\r\n *  @param option {object} 配置属性,参数可以是instance.toJson().option对象\r\n *      @param [option.node] {object} 创建node元素\r\n *          @param [option.node.style] {object} 设定全局的节点样式，未配置样式的节点会采用默认样式\r\n *          @param option.node.data {array} 细则看示例\r\n *      @param [option.container] {object} 创建container元素\r\n *          @param [option.container.style] {object} 设定全局的分组样式，未配置样式的分组会采用默认样式\r\n *          @param option.container.findChildren {string} 通知分组通过什么属性去查找成员\r\n *          @param option.container.data {array} 细则看示例\r\n *      @param [option.link] {object} 创建link元素\r\n *          @param [option.link.style] {object} 设定全局的分组样式，未配置样式的分组会采用默认样式\r\n *          @param option.link.path {array} 通知链接通过什么属性去查找起始点和终点,数组参数可以为1个或2个，当设置为2个时，通过不同属性查找起始点和终点\r\n *          @param option.link.data {array} 细则看示例\r\n *      @param [option.line] {object} 创建line元素\r\n *      @param [option.alarm] {object} 配置告警\r\n *          @param option.alarm.node {string} 通知告警模块如何查找需要设定告警的节点,现只支持节点上的告警\r\n *          @param [option.alarm.animate] {object} 配置告警动画,包含2个属性 ：\r\n *                     1. time:{number}设定间隔时间,单位为毫秒 ,\r\n *                     2. callBack:{function}回调函数,参数为当前处理告警的节点\r\n *          @param option.alarm.data {array} 告警设置,包含3个属性 ：\r\n *                     1. color {string}:告警展示的颜色,255,255,255/#ffffff ,\r\n *                     2. node {string}:对应告警属性下的node为键,此处为值来查找对应的节点 ,\r\n *                     3. [text] {string}:告警显示的文字信息，可不设或为空 ,\r\n *  @param [clear=false] {boolean} 是否清空图层，默认不清除\r\n *  @returns instance\r\n *  QTopo实例自身,用以链式操作\r\n *  @example\r\n *       topo.setOption({\r\n                node: {\r\n                    style:{//全局样式\r\n                        size:[60,60],\r\n                        image: "img/node.png"\r\n                    },\r\n                    data: [{\r\n                            position:[-200,-200],\r\n                            size:[100,100],\r\n                            id:1111,\r\n                            name:"测试1\\nhhhh" //\\n为名称换行\r\n                           },\r\n                           {\r\n                            position:[0,0],\r\n                            size:[100,100],\r\n                            id:2222,\r\n                            name:"测试2\\nhhhh" //\r\n                           }]\r\n                },\r\n                container: {\r\n                    style:{\r\n                        color:"#165782",\r\n                        alpha:0.3,\r\n                        border:{\r\n                            radius:10\r\n                        },\r\n                        namePosition:"top"\r\n                    },\r\n                    findChildren: "id",//这个决定了 每个分组根据data中的数据查找该加入的子,该属性应在node中的value中有配置\r\n                    data: [{\r\n                            size:[400,400],\r\n                            position:[0,0],\r\n                            layout:{\r\n                                type:"fixed"//布局为固定\r\n                            },\r\n                            children: childrenData,\r\n                            toggle:{ //分组切换的节点样式\r\n                                image: "img/node.png"\r\n                            }\r\n                          //  findChildren: "id", 当然也可以针对某个分组单独设置其查找子元素的标记\r\n                            children:["1111","2222"]//findChildren定义为id ，此处就该是对应元素的id属性\r\n                        }]\r\n                },\r\n                link: {\r\n                    style:{\r\n                        color:"#00FFFF"\r\n                    },\r\n                    path: ["id"],   //决定了线的起始节点由什么属性决定,数组长度为1则起始节点按统一属性查找，可分别设不同，0为起始节点属性.1为终点,该属性应在node中的value中有配置\r\n                    data: [{\r\n                                start:1111,//path指明起始点和终点都是找id属性，那此处就是起点的id\r\n                                end:2222,   //终点的id\r\n                                width:10,   //样式配置，详细参考对应元素的属性\r\n                                radius:25,\r\n                                arrow:{\r\n                                    end:true,\r\n                                    start:true,\r\n                                    size:10\r\n                                },\r\n                                extra:{\r\n                                    type:1  //额外属性，因与下述链路类型的名称一致，移直extra内赋值到生成的链路extra上,可通过link.val(\'type\')取到\r\n                                },\r\n                                type:QTopo.constant.link.FLEXIONAL //建立的链路类型\r\n                            }]\r\n                },\r\n                alarm: {\r\n                    node: "alarmId",    //指明节点上对应的查找属性,该属性应在node中的value中有配置,暂只支持节点告警\r\n                    data: [],\r\n                    animate:{   //可设置动画，每个点亮之间延迟多少毫秒，回调函数中能获取到点亮的节点信息\r\n                        time:1000,\r\n                        callBack:function(node){\r\n                            console.info(node)\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n */\r\nfunction setOption(option, clear) {\r\n    option = option || {};\r\n    QTopo.util.info("start set topo: ", option);\r\n    var scene = this.scene;\r\n    if (clear) {\r\n        scene.clear();\r\n    }\r\n    createNode(scene, option.node);\r\n    createContainer(scene, option.container);\r\n    createLink(scene, option.link);\r\n    createLine(scene, option.line);\r\n    drawAlarm(scene, option.alarm);\r\n    QTopo.util.info("set topo complete: ", {\r\n        node: scene.children.node.length,\r\n        link: scene.children.link.length,\r\n        container: scene.children.container.length,\r\n        line: scene.children.line.length\r\n    });\r\n    return this;\r\n}\r\n/**\r\n * 实例自适应大小\r\n *  @method resize\r\n *  @returns instance QTopo实例自身,用以链式操作\r\n *  @example\r\n *      $(window).resize(function () {\r\n *          IPOSS.resize();\r\n *      });\r\n */\r\nfunction resize(dom, canvas) {\r\n    return function () {\r\n        canvas.setAttribute(\'width\', $(dom).width());\r\n        canvas.setAttribute(\'height\', $(dom).height());\r\n        return this;\r\n    }\r\n}\r\n/**\r\n * 当前图层数据转化为json结构\r\n *  @method toJson\r\n *  @returns {object}\r\n *  @example\r\n        var IPOSS=QTopo.instance[0];\r\n        var json=IPOSS.toJson();    //json={\r\n                                    //         init:图层参数,scene对象的参数配置,\r\n                                    //         option:图层内所有对象的属性提取，可直接用于setOption还原,其中jsonId用做每个元素的唯一标识\r\n                                    //      }\r\n        IPOSS.setOption(json.option,true);\r\n */\r\nfunction toJson() {\r\n    var data = this.scene.children;\r\n    var serialized = {\r\n        init: this.scene.toJson(),\r\n        option: {\r\n            node: {\r\n                data: []\r\n            },\r\n            link: {\r\n                data: []\r\n            },\r\n            container: {\r\n                data: []\r\n            },\r\n            line: {\r\n                data: []\r\n            }\r\n        }\r\n    };\r\n    $.each(data, function (name, elements) {\r\n        if ($.isArray(elements)) {\r\n            elements.map(function (element) {\r\n                if (serialized.option[name]) {\r\n                    serialized.option[name].data.push(element.toJson());\r\n                }\r\n            });\r\n        }\r\n    });\r\n    return serialized;\r\n}\r\nfunction initCanvas(dom, width, height) {\r\n    if (width <= 0 || height <= 0) {\r\n        throw new Error("The dom is not exist /not config width and height!");\r\n    }\r\n    dom.style.position = \'relative\';\r\n    dom.style.overflow = \'hidden\';\r\n    var canvas = document.createElement(\'canvas\');\r\n    dom.appendChild(canvas);\r\n    canvas.setAttribute(\'width\', width);\r\n    canvas.setAttribute(\'height\', height);\r\n    canvas.style.position = "absolute";\r\n    canvas.style.top = 0;\r\n    canvas.style.left = 0;\r\n    canvas.style[\'user-select\'] = \'none\';\r\n    canvas.style[\'-webkit-tap-highlight-color\'] = \'rgba(0, 0, 0, 0)\';\r\n    return canvas;\r\n}\r\n\r\nfunction createNode(scene, config) {\r\n    if (config) {\r\n        setDefaults(scene, QTopo.constant.node, config.style);\r\n        if ($.isArray(config.data)) {\r\n            $.each(config.data, function (i, item) {\r\n                var node = scene.createNode(item);\r\n                //额外属性添加\r\n                setExtra(node, item);\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\n//排除临时元素\r\nfunction notCasual(arr) {\r\n    if (arr.length == 1) {\r\n        return arr[0];\r\n    } else {\r\n        for (var i = 0; i < arr.length; i++) {\r\n            if (arr[i].getUseType() != QTopo.constant.CASUAL) {\r\n                arr = arr[i];\r\n                return arr;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction createContainer(scene, config) {\r\n    if (config) {\r\n        setDefaults(scene, QTopo.constant.container, config.style);\r\n        makeContainer(scene, config);\r\n    }\r\n}\r\nfunction makeContainer(scene, config) {\r\n    //搜索子的总标记\r\n    var findChild;\r\n    if (config.findChildren) {\r\n        findChild = config.findChildren;\r\n    }\r\n    if ($.isArray(config.data)) {\r\n        //开始构造分组\r\n        $.each(config.data, function (i, item) {\r\n            //无论是否有子元素，分组先创造出来\r\n            var container = scene.createContainer(item);\r\n            //额外属性添加\r\n            setExtra(container, item);\r\n            //确定查找子元素的标记\r\n            var findChild_exact = findChild;\r\n            if (item.findChildren) {\r\n                findChild_exact = item.findChildren;\r\n            }\r\n            makeChildren(scene, container, item, findChild_exact);\r\n        });\r\n    }\r\n}\r\nfunction makeChildren(scene, container, config, findChild) {\r\n    //过滤搜索子类的标记\r\n    findChild = filterTag(findChild);\r\n    if ($.isArray(config.children)) {\r\n        var errorInfo = [];\r\n        $.each(config.children, function (j, children) {\r\n            var child = scene.find(findChild + "=" + children);\r\n            if (child && child.length > 0) {\r\n                $.each(child, function (m, one) {\r\n                    if (one.getUseType() != QTopo.constant.CASUAL) {\r\n                        container.add(one);\r\n                    }\r\n                });\r\n            } else {\r\n                errorInfo.push({\r\n                    index: j,\r\n                    search: findChild + "=" + children\r\n                });\r\n            }\r\n        });\r\n        if (errorInfo.length > 0) {\r\n            QTopo.util.error("some child not found : ", errorInfo);\r\n        }\r\n    }\r\n}\r\nfunction filterTag(tag) {\r\n    if (!tag) {\r\n        tag = \'jsonId\'\r\n    }\r\n    return tag;\r\n}\r\n\r\nfunction createLink(scene, config) {\r\n    if (config) {\r\n        var path = config.path;\r\n        var findStart;\r\n        var findEnd;\r\n        if ($.isArray(path) && path.length > 0) {\r\n            //path为数组，0为起点条件1为终点条件,确定搜索条件,起始点条件可不同\r\n            if (path.length == 1) {\r\n                findEnd = path[0];\r\n                findStart = findEnd;\r\n            } else {\r\n                findStart = path[0];\r\n                findEnd = path[1];\r\n            }\r\n        } else {\r\n            findStart = filterTag(findStart);\r\n            findEnd = filterTag(findEnd);\r\n        }\r\n        //设置默认属性\r\n        setDefaults(scene, QTopo.constant.link, config.style);\r\n        //开始创建\r\n        makeLink(scene, config, findStart, findEnd);\r\n    }\r\n}\r\nfunction makeLink(scene, config, findStart, findEnd) {\r\n    if ($.isArray(config.data)) {\r\n        var errorInfo = [];\r\n        $.each(config.data, function (i, item) {\r\n            if (item) {\r\n                var link;\r\n                //根据确定的条件进行搜索\r\n                var start = notCasual(scene.find(findStart + "=" + item.start));\r\n                var end = notCasual(scene.find(findEnd + "=" + item.end));\r\n                if (start && end) {\r\n                    item.start = start;\r\n                    item.end = end;\r\n                    link = scene.addLink(item);\r\n                    //额外属性添加\r\n                    setExtra(link, item);\r\n                } else {\r\n                    var errorDate = {\r\n                        index: i,\r\n                        data: item\r\n                    };\r\n                    if (!start) {\r\n                        errorDate.missStart = item.start;\r\n                    }\r\n                    if (!end) {\r\n                        errorDate.missEnd = item.end;\r\n                    }\r\n                    errorInfo.push(errorDate);\r\n                }\r\n            } else {\r\n                errorInfo.push({\r\n                    index: i,\r\n                    info: "undefined data"\r\n                });\r\n            }\r\n        });\r\n        if (errorInfo.length > 0) {\r\n            QTopo.util.error("some link invalid : ", errorInfo);\r\n        }\r\n    }\r\n}\r\n//根据配置创建线段\r\nfunction createLine(scene, config) {\r\n    if (config) {\r\n        //设置默认属性\r\n        //设置默认属性\r\n        setDefaults(scene, QTopo.constant.line, config.style);\r\n        //开始创建\r\n        if ($.isArray(config.data)) {\r\n            $.each(config.data, function (i, v) {\r\n                var line = scene.createLine(v);\r\n                //额外属性添加\r\n                setExtra(line, v);\r\n            });\r\n        } else {\r\n            QTopo.util.error("can not draw line,need config \'path\' and \'path\' is Array and not empty,path\'s element need config x y, path used to find start and end");\r\n        }\r\n    }\r\n}\r\n\r\nfunction drawAlarm(scene, config) {\r\n    if (config) {\r\n        if ($.isArray(config.data) && config.node) {\r\n            var alarmData = config.data;\r\n            var alarmNodes = makeAlarmData(scene, alarmData, config);\r\n            QTopo.util.info("告警绘制 :", {\r\n                config: alarmData.length,\r\n                success: alarmNodes.length\r\n            });\r\n            if (config.animate) {\r\n                alarmAnimate(config.animate, alarmNodes);\r\n            } else {\r\n                $.each(alarmNodes, function (i, v) {\r\n                    v.node.set({\r\n                        alarm: v.alarm\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction makeAlarmData(scene, alarmData, config) {\r\n    var alarms = [];\r\n    $.each(alarmData, function (k, v) {\r\n        var node = notCasual(scene.find(config.node + "=" + v["node"], "node"));\r\n        if (node) {\r\n            alarms.push({\r\n                node: node,\r\n                alarm: {\r\n                    show: typeof v.show == "boolean" ? v.show : true,\r\n                    text: v.text,\r\n                    color: v.color,\r\n                    font: v.font\r\n                }\r\n            });\r\n        }\r\n    });\r\n    return alarms;\r\n}\r\nvar animateRuning;\r\nfunction alarmAnimate(animate, alarmNodes) {\r\n    if (animate) {\r\n        if ($.isNumeric(animate.time)) {\r\n            clearAnimat();\r\n            QTopo.util.info("启用告警动画");\r\n            animateRuning = setInterval(function () {\r\n                if (alarmNodes.length > 0) {\r\n                    var data = alarmNodes.pop();\r\n                    data.node.set({\r\n                        alarm: data.alarm\r\n                    });\r\n                    if ($.isFunction(animate.callBack)) {\r\n                        animate.callBack(data.node);\r\n                    }\r\n                } else {\r\n                    QTopo.util.info("告警动画结束");\r\n                    clearAnimat();\r\n                }\r\n            }, parseInt(animate.time));\r\n        }\r\n    }\r\n}\r\nfunction clearAnimat() {\r\n    if (animateRuning) {\r\n        clearInterval(animateRuning);\r\n        animateRuning = "";\r\n    }\r\n}\r\nfunction setExtra(element, data) {\r\n    if (data) {\r\n        $.each(data, function (key, value) {\r\n            if (filterConfig(element, key) && ["start", "end", "children", "toggle", "type", "extra"].indexOf(key) < 0) {\r\n                element.extra[key] = value;\r\n            }\r\n        });\r\n        if (data.extra) {\r\n            $.each(data.extra, function (key, value) {\r\n                if (value) {\r\n                    element.extra[key] = value;\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\nfunction filterConfig(element, key) {\r\n    return element && typeof element.attr[key] == \'undefined\';\r\n}\r\nfunction setDefaults(scene, typeArr, style) {\r\n    if (style) {\r\n        $.each(typeArr, function (i, types) {\r\n            scene.setDefault(types, style);\r\n        })\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL21haW4uanM/ZjkwOSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCLHFCQUFxQixRQUFRO0FBQzdCLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsU0FBUztBQUN6QixxQkFBcUIsT0FBTztBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLE9BQU87QUFDMUIsOEJBQThCLE9BQU87QUFDckMsd0NBQXdDLE9BQU87QUFDL0MscUNBQXFDLE1BQU07QUFDM0MsbUNBQW1DLE9BQU87QUFDMUMsNkNBQTZDLE9BQU87QUFDcEQsa0RBQWtELE9BQU87QUFDekQsMENBQTBDLE1BQU07QUFDaEQsOEJBQThCLE9BQU87QUFDckMsd0NBQXdDLE9BQU87QUFDL0MscUNBQXFDLE1BQU07QUFDM0MscUNBQXFDLE1BQU07QUFDM0MsOEJBQThCLE9BQU87QUFDckMsK0JBQStCLE9BQU87QUFDdEMsc0NBQXNDLE9BQU87QUFDN0MsMkNBQTJDLE9BQU87QUFDbEQsZ0NBQWdDLE9BQU87QUFDdkMsb0NBQW9DLFNBQVM7QUFDN0Msc0NBQXNDLE1BQU07QUFDNUMsaUNBQWlDLE9BQU87QUFDeEMsZ0NBQWdDLE9BQU87QUFDdkMsa0NBQWtDLE9BQU87QUFDekMsMEJBQTBCLFFBQVE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQSw2QkFBNkI7QUFDN0IsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLHVCQUF1QixnQkFBZ0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBIiwiZmlsZSI6IjEwMy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIFFUb3BvXHJcbiAqL1xyXG5cInVzZSBzdHJpY3RcIjtcclxucmVxdWlyZShcIi4vY29yZS9qdG9wby9pbmRleC5qc1wiKTtcclxuaWYgKHR5cGVvZiBqUXVlcnkgPT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwibmVlZCBqcXVlcnlcIik7XHJcbn1cclxuLyoqXHJcbiAqIOS4u+WFpeWPoyx3aW5kb3cuUVRvcG9cclxuICogQGNsYXNzIFFUb3BvXHJcbiAqIEBzdGF0aWNcclxuICovXHJcbnZhciBRVG9wbyA9IHtcclxuICAgIC8qKlxyXG4gICAgICog5a2Y5pS+5b2T5YmN6aG16Z2i5Lit5omA5Yid5aeL5YyW55qEdG9wb+WunuS+i1xyXG4gICAgICogQHByb3BlcnR5IGluc3RhbmNlIHthcnJheX1cclxuICAgICAqL1xyXG4gICAgaW5zdGFuY2U6IFtdLFxyXG4gICAgLyoqXHJcbiAgICAgKiDkuIDns7vliJflt6Xlhbflh73mlbAs6K+m57uG5YaF5a655Y+C6ICDIFFUb3BvLnV0aWxcclxuICAgICAqIEBwcm9wZXJ0eSB1dGlsIHtvYmplY3R9XHJcbiAgICAgKi9cclxuICAgIHV0aWw6IHJlcXVpcmUoJy4vdXRpbC5qcycpLFxyXG4gICAgY29uc3RhbnQ6IHJlcXVpcmUoJy4vY29uc3RhbnQuanMnKSxcclxuICAgIC8qKlxyXG4gICAgICog5Y+v5byA5ZCv5oiW5bGP6JS95o6n5Yi25Y+w5pel5b+XLOWvueW6lOeUqFFUb3BvLnV0aWwuaW5mb+S7peWPilFUb3BvLnV0aWwuZXJyb3Llh73mlbDovpPlh7rnmoTml6Xlv5dcclxuICAgICAqIEBwcm9wZXJ0eSBsb2cge29iamVjdH1cclxuICAgICAqIEBwYXJhbSBlcnJvciB7Ym9vbGVhbn0g6buY6K6k5Li6dHJ1ZSzlvIDlkK9cclxuICAgICAqIEBwYXJhbSBpbmZvIHtib29sZWFufSDpu5jorqTkuLp0cnVlLOW8gOWQr1xyXG4gICAgICovXHJcbiAgICBsb2c6IHtcclxuICAgICAgICBlcnJvcjogdHJ1ZSxcclxuICAgICAgICBpbmZvOiB0cnVlXHJcbiAgICB9XHJcbn07XHJcbndpbmRvdy5RVG9wbyA9IFFUb3BvO1xyXG52YXIgU2NlbmUgPSByZXF1aXJlKCcuL2NvcmUvU2NlbmUuanMnKTtcclxuLyoqXHJcbiAqIOWIneWni+WMllF0b3Bv5a6e5L6LLOWIm+W7uuW5tuWwhuWFtuS/neWtmOWcqFFUb3BvLmluc3RhbmNl5pWw57uE5YaFLOWunuS+i2FwaeWPguiAg1FUb3BvLmluc3RhbmNlXHJcbiAqICBAbWV0aG9kIGluaXRcclxuICogIEBwYXJhbSBkb20ge2RvY3VtZW50fSDmjIflrprliJ3lp4vljJbmiYDlnKjnmoRkb20s6Iul5piv5pWw57uE5YiZ6Ieq5Yqo5Y+W56ys5LiA5LiqXHJcbiAqICBAcGFyYW0gW2NvbmZpZ10ge29iamVjdH0g6YWN572u5Y+C5pWwLOmFjee9ruWGheWuueS4uuWbvuWxgnNjZW5l6YWN572uKOWPguiAg3NjZW5l6YWN572uKVxyXG4gKiAgQHJldHVybnMgW2luc3RhbmNlXSBRVG9wb+WunuS+i+Wvueixoe+8jFFUb3BvLmluc3RhbmNlXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgIElQT1NTID0gUVRvcG8uaW5pdChcclxuICogICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ0b3BvX2Jhc2VcIilbMF0sXHJcbiAqICAgICAgICAgIHtcclxuICogICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogXCIjMDYyNDNlXCIsLy/ln7rmnKzlsZ7mgKfphY3nva7og4zmma/oibJcclxuICogICAgICAgICAgICAgIHBhdGg6W10gLy/oh6rlrprkuYnlsZ7mgKcs5o+S5YWl5Yiw5Zu+5bGC5a+56LGhc2NlbmXnmoTpop3lpJblsZ7mgKfkuK1cclxuICogICAgICAgICAgfVxyXG4gKiAgICAgICk7XHJcbiAqL1xyXG5RVG9wby5pbml0ID0gZnVuY3Rpb24gKGRvbSwgY29uZmlnKSB7XHJcbiAgICBkb20gPSBkb20gaW5zdGFuY2VvZiBBcnJheSA/IGRvbVswXSA6IGRvbTtcclxuICAgIHZhciBjYW52YXMgPSBpbml0Q2FudmFzKGRvbSwgJChkb20pLndpZHRoKCksICQoZG9tKS5oZWlnaHQoKSk7XHJcbiAgICAvKipcclxuICAgICAqIFFUb3Bv5Yid5aeL5YyW55qEdG9wb+WunuS+iyxRVG9wby5pbml05ZCO55qE6L+U5Zue5a+56LGh77yM5oiW5pivUVRvcG8uaW5zdGFuY2XmlbDnu4TlhoXkv53lrZjnmoTlr7nosaFcclxuICAgICAqIEBjbGFzcyBRVG9wby5pbnN0YW5jZVxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICovXHJcbiAgICB2YXIgUXRvcG9JbnN0YW5jZSA9IHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiB0b3Bv5a6e5L6L5YyW55qE5Zu+5bGC5a+56LGhXHJcbiAgICAgICAgICogQHByb3BlcnR5IHNjZW5lIHtvYmplY3R9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2NlbmU6IG5ldyBTY2VuZShjYW52YXMsIGNvbmZpZyksXHJcbiAgICAgICAgc2V0T3B0aW9uOiBzZXRPcHRpb24sXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogdG9wb+WunuS+i+aJgOWcqGRvbVxyXG4gICAgICAgICAqIEBwcm9wZXJ0eSBkb2N1bWVudCB7ZG9jdW1lbnR9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZG9jdW1lbnQ6IGRvbSxcclxuICAgICAgICByZXNpemU6IHJlc2l6ZShkb20sIGNhbnZhcyksXHJcbiAgICAgICAgdG9Kc29uOiB0b0pzb25cclxuICAgIH07XHJcbiAgICB0aGlzLmluc3RhbmNlLnB1c2goUXRvcG9JbnN0YW5jZSk7XHJcbiAgICByZXR1cm4gUXRvcG9JbnN0YW5jZTtcclxufTtcclxubW9kdWxlLmV4cG9ydHMgPSBRVG9wbztcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLyoqXHJcbiAqIOWbvuWxgue7mOWItuS4u+WHveaVsFxyXG4gKlxyXG4gKiDlj6/ku6Xpmo/ml7bkvb/nlKhzZXRPcHRpb27nlJ/miJDkuIDkuKrmiJblpJrkuKrlhYPntKAs5oiW6YWN572u5ZGK6K2m77yM5Lmf5Y+v5Lul5LiA5qyh5oCn5YWo5bGA6YWN572uXHJcbiAqXHJcbiAqIOebuOWFs+eahOWFqOWxgOagt+W8j+ivt+WPguiAg+WQhOWFg+e0oOiHqui6q+eahGF0dHLlsZ7mgKcs5oiW6YCa6L+HIOWFg+e0oOeahGdldERlZmF1bHQoKSAvIHNjZW5lLmdldERlZmF1bHQodHlwZSnmnaXojrflj5blr7nlupTlhYPntKDnmoTlhajlsYDmoLflvI9cclxuICpcclxuICog5YmN56uv57uY5Zu+6L+H56iL5Y+v5Lul55So5bel5YW35qCP5ZKM5Y+z6ZSu6I+c5Y2V57uY5Yi25a6M5oiQ5ZCOLOmFjeWQiOWunuS+i+eahHRvSnNvbuWHveaVsOWPluW+l+WbvuWxguaVsOaNriwo5a6e5L6L6YCa6L+HUVRvcG8uaW5pdOWIneWni+WMluS4lOS/neWtmOWcqFFUb3BvLmluc3RhbmNl5pWw57uE5YaFKVxyXG4gKlxyXG4gKiDnm7TmjqXlsIbov5Tlm57lr7nosaHnmoRvcHRpb27lsZ7mgKfkvKDlhaVzZXRPcHRpb27lj6/lpI3liLbnu5jlm75cclxuICpcclxuICog5q+P5Liq5YWD57Sg6YWN572u55qEZGF0YeaVsOe7hOWGheaIkOWRmOeahOWxnuaAp+WPr+S7peaYr+agt+W8j+S5n+WPr+S7peaYr+mineWkluWxnuaApyzoh6rpgILlupTlj5blgLzphY3nva7vvIzov4fmu6TnmoTpop3lpJblsZ7mgKfoh6rliqjliIbphY3liLDlhYPntKDnmoRleHRyYeWxnuaAp+S4reS/neWtmCzlj6/ku6XpgJrov4dub2RlLnZhbCgnaWQnKeeahOW9ouW8j+iOt+WPllxyXG4gKlxyXG4gKiDlkozmoLflvI/ph43lkI3nmoTpop3lpJblsZ7mgKflj6/ku6XmlL7lnKhleHRyYeS4re+8jGV4dHJh5Lit55qE5bGe5oCn5bCG6buY6K6k5YWo6YOo6KaG55uW5Yiw5YWD57Sg55qEZXh0cmHlsZ7mgKflhoVcclxuICpcclxuICogIEBtZXRob2Qgc2V0T3B0aW9uXHJcbiAqICBAcGFyYW0gb3B0aW9uIHtvYmplY3R9IOmFjee9ruWxnuaApyzlj4LmlbDlj6/ku6XmmK9pbnN0YW5jZS50b0pzb24oKS5vcHRpb27lr7nosaFcclxuICogICAgICBAcGFyYW0gW29wdGlvbi5ub2RlXSB7b2JqZWN0fSDliJvlu7pub2Rl5YWD57SgXHJcbiAqICAgICAgICAgIEBwYXJhbSBbb3B0aW9uLm5vZGUuc3R5bGVdIHtvYmplY3R9IOiuvuWumuWFqOWxgOeahOiKgueCueagt+W8j++8jOacqumFjee9ruagt+W8j+eahOiKgueCueS8mumHh+eUqOm7mOiupOagt+W8j1xyXG4gKiAgICAgICAgICBAcGFyYW0gb3B0aW9uLm5vZGUuZGF0YSB7YXJyYXl9IOe7huWImeeci+ekuuS+i1xyXG4gKiAgICAgIEBwYXJhbSBbb3B0aW9uLmNvbnRhaW5lcl0ge29iamVjdH0g5Yib5bu6Y29udGFpbmVy5YWD57SgXHJcbiAqICAgICAgICAgIEBwYXJhbSBbb3B0aW9uLmNvbnRhaW5lci5zdHlsZV0ge29iamVjdH0g6K6+5a6a5YWo5bGA55qE5YiG57uE5qC35byP77yM5pyq6YWN572u5qC35byP55qE5YiG57uE5Lya6YeH55So6buY6K6k5qC35byPXHJcbiAqICAgICAgICAgIEBwYXJhbSBvcHRpb24uY29udGFpbmVyLmZpbmRDaGlsZHJlbiB7c3RyaW5nfSDpgJrnn6XliIbnu4TpgJrov4fku4DkuYjlsZ7mgKfljrvmn6Xmib7miJDlkZhcclxuICogICAgICAgICAgQHBhcmFtIG9wdGlvbi5jb250YWluZXIuZGF0YSB7YXJyYXl9IOe7huWImeeci+ekuuS+i1xyXG4gKiAgICAgIEBwYXJhbSBbb3B0aW9uLmxpbmtdIHtvYmplY3R9IOWIm+W7umxpbmvlhYPntKBcclxuICogICAgICAgICAgQHBhcmFtIFtvcHRpb24ubGluay5zdHlsZV0ge29iamVjdH0g6K6+5a6a5YWo5bGA55qE5YiG57uE5qC35byP77yM5pyq6YWN572u5qC35byP55qE5YiG57uE5Lya6YeH55So6buY6K6k5qC35byPXHJcbiAqICAgICAgICAgIEBwYXJhbSBvcHRpb24ubGluay5wYXRoIHthcnJheX0g6YCa55+l6ZO+5o6l6YCa6L+H5LuA5LmI5bGe5oCn5Y675p+l5om+6LW35aeL54K55ZKM57uI54K5LOaVsOe7hOWPguaVsOWPr+S7peS4ujHkuKrmiJYy5Liq77yM5b2T6K6+572u5Li6MuS4quaXtu+8jOmAmui/h+S4jeWQjOWxnuaAp+afpeaJvui1t+Wni+eCueWSjOe7iOeCuVxyXG4gKiAgICAgICAgICBAcGFyYW0gb3B0aW9uLmxpbmsuZGF0YSB7YXJyYXl9IOe7huWImeeci+ekuuS+i1xyXG4gKiAgICAgIEBwYXJhbSBbb3B0aW9uLmxpbmVdIHtvYmplY3R9IOWIm+W7umxpbmXlhYPntKBcclxuICogICAgICBAcGFyYW0gW29wdGlvbi5hbGFybV0ge29iamVjdH0g6YWN572u5ZGK6K2mXHJcbiAqICAgICAgICAgIEBwYXJhbSBvcHRpb24uYWxhcm0ubm9kZSB7c3RyaW5nfSDpgJrnn6XlkYrorabmqKHlnZflpoLkvZXmn6Xmib7pnIDopoHorr7lrprlkYrorabnmoToioLngrks546w5Y+q5pSv5oyB6IqC54K55LiK55qE5ZGK6K2mXHJcbiAqICAgICAgICAgIEBwYXJhbSBbb3B0aW9uLmFsYXJtLmFuaW1hdGVdIHtvYmplY3R9IOmFjee9ruWRiuitpuWKqOeUuyzljIXlkKsy5Liq5bGe5oCnIO+8mlxyXG4gKiAgICAgICAgICAgICAgICAgICAgIDEuIHRpbWU6e251bWJlcn3orr7lrprpl7TpmpTml7bpl7Qs5Y2V5L2N5Li65q+r56eSICxcclxuICogICAgICAgICAgICAgICAgICAgICAyLiBjYWxsQmFjazp7ZnVuY3Rpb2595Zue6LCD5Ye95pWwLOWPguaVsOS4uuW9k+WJjeWkhOeQhuWRiuitpueahOiKgueCuVxyXG4gKiAgICAgICAgICBAcGFyYW0gb3B0aW9uLmFsYXJtLmRhdGEge2FycmF5fSDlkYroraborr7nva4s5YyF5ZCrM+S4quWxnuaApyDvvJpcclxuICogICAgICAgICAgICAgICAgICAgICAxLiBjb2xvciB7c3RyaW5nfTrlkYrorablsZXnpLrnmoTpopzoibIsMjU1LDI1NSwyNTUvI2ZmZmZmZiAsXHJcbiAqICAgICAgICAgICAgICAgICAgICAgMi4gbm9kZSB7c3RyaW5nfTrlr7nlupTlkYrorablsZ7mgKfkuIvnmoRub2Rl5Li66ZSuLOatpOWkhOS4uuWAvOadpeafpeaJvuWvueW6lOeahOiKgueCuSAsXHJcbiAqICAgICAgICAgICAgICAgICAgICAgMy4gW3RleHRdIHtzdHJpbmd9OuWRiuitpuaYvuekuueahOaWh+Wtl+S/oeaBr++8jOWPr+S4jeiuvuaIluS4uuepuiAsXHJcbiAqICBAcGFyYW0gW2NsZWFyPWZhbHNlXSB7Ym9vbGVhbn0g5piv5ZCm5riF56m65Zu+5bGC77yM6buY6K6k5LiN5riF6ZmkXHJcbiAqICBAcmV0dXJucyBpbnN0YW5jZVxyXG4gKiAgUVRvcG/lrp7kvovoh6rouqss55So5Lul6ZO+5byP5pON5L2cXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICB0b3BvLnNldE9wdGlvbih7XHJcbiAgICAgICAgICAgICAgICBub2RlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU6ey8v5YWo5bGA5qC35byPXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6WzYwLDYwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IFwiaW1nL25vZGUucG5nXCJcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjpbLTIwMCwtMjAwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6WzEwMCwxMDBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6MTExMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6XCLmtYvor5UxXFxuaGhoaFwiIC8vXFxu5Li65ZCN56ew5o2i6KGMXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOlswLDBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTpbMTAwLDEwMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDoyMjIyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTpcIua1i+ivlTJcXG5oaGhoXCIgLy9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgfV1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBjb250YWluZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZTp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOlwiIzE2NTc4MlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTowLjMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlcjp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM6MTBcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVBvc2l0aW9uOlwidG9wXCJcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbmRDaGlsZHJlbjogXCJpZFwiLC8v6L+Z5Liq5Yaz5a6a5LqGIOavj+S4quWIhue7hOagueaNrmRhdGHkuK3nmoTmlbDmja7mn6Xmib7or6XliqDlhaXnmoTlrZAs6K+l5bGe5oCn5bqU5Zyobm9kZeS4reeahHZhbHVl5Lit5pyJ6YWN572uXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogW3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6WzQwMCw0MDBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246WzAsMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXQ6e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6XCJmaXhlZFwiLy/luIPlsYDkuLrlm7rlrppcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogY2hpbGRyZW5EYXRhLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlOnsgLy/liIbnu4TliIfmjaLnmoToioLngrnmoLflvI9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZTogXCJpbWcvbm9kZS5wbmdcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8vICBmaW5kQ2hpbGRyZW46IFwiaWRcIiwg5b2T54S25Lmf5Y+v5Lul6ZKI5a+55p+Q5Liq5YiG57uE5Y2V54us6K6+572u5YW25p+l5om+5a2Q5YWD57Sg55qE5qCH6K6wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjpbXCIxMTExXCIsXCIyMjIyXCJdLy9maW5kQ2hpbGRyZW7lrprkuYnkuLppZCDvvIzmraTlpITlsLHor6XmmK/lr7nlupTlhYPntKDnmoRpZOWxnuaAp1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGxpbms6IHtcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZTp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOlwiIzAwRkZGRlwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBwYXRoOiBbXCJpZFwiXSwgICAvL+WGs+WumuS6hue6v+eahOi1t+Wni+iKgueCueeUseS7gOS5iOWxnuaAp+WGs+WumizmlbDnu4Tplb/luqbkuLox5YiZ6LW35aeL6IqC54K55oyJ57uf5LiA5bGe5oCn5p+l5om+77yM5Y+v5YiG5Yir6K6+5LiN5ZCM77yMMOS4uui1t+Wni+iKgueCueWxnuaApy4x5Li657uI54K5LOivpeWxnuaAp+W6lOWcqG5vZGXkuK3nmoR2YWx1ZeS4reaciemFjee9rlxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6MTExMSwvL3BhdGjmjIfmmI7otbflp4vngrnlkoznu4jngrnpg73mmK/mib5pZOWxnuaAp++8jOmCo+atpOWkhOWwseaYr+i1t+eCueeahGlkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOjIyMjIsICAgLy/nu4jngrnnmoRpZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOjEwLCAgIC8v5qC35byP6YWN572u77yM6K+m57uG5Y+C6ICD5a+55bqU5YWD57Sg55qE5bGe5oCnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFkaXVzOjI1LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFycm93OntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOnRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OnRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6MTBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhOntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZToxICAvL+mineWkluWxnuaAp++8jOWboOS4juS4i+i/sOmTvui3r+exu+Wei+eahOWQjeensOS4gOiHtO+8jOenu+ebtGV4dHJh5YaF6LWL5YC85Yiw55Sf5oiQ55qE6ZO+6LevZXh0cmHkuIos5Y+v6YCa6L+HbGluay52YWwoJ3R5cGUnKeWPluWIsFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTpRVG9wby5jb25zdGFudC5saW5rLkZMRVhJT05BTCAvL+W7uueri+eahOmTvui3r+exu+Wei1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBhbGFybToge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGU6IFwiYWxhcm1JZFwiLCAgICAvL+aMh+aYjuiKgueCueS4iuWvueW6lOeahOafpeaJvuWxnuaApyzor6XlsZ7mgKflupTlnKhub2Rl5Lit55qEdmFsdWXkuK3mnInphY3nva4s5pqC5Y+q5pSv5oyB6IqC54K55ZGK6K2mXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0ZTp7ICAgLy/lj6/orr7nva7liqjnlLvvvIzmr4/kuKrngrnkuq7kuYvpl7Tlu7bov5/lpJrlsJHmr6vnp5LvvIzlm57osIPlh73mlbDkuK3og73ojrflj5bliLDngrnkuq7nmoToioLngrnkv6Hmga9cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGltZToxMDAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsQmFjazpmdW5jdGlvbihub2RlKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhub2RlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gKi9cclxuZnVuY3Rpb24gc2V0T3B0aW9uKG9wdGlvbiwgY2xlYXIpIHtcclxuICAgIG9wdGlvbiA9IG9wdGlvbiB8fCB7fTtcclxuICAgIFFUb3BvLnV0aWwuaW5mbyhcInN0YXJ0IHNldCB0b3BvOiBcIiwgb3B0aW9uKTtcclxuICAgIHZhciBzY2VuZSA9IHRoaXMuc2NlbmU7XHJcbiAgICBpZiAoY2xlYXIpIHtcclxuICAgICAgICBzY2VuZS5jbGVhcigpO1xyXG4gICAgfVxyXG4gICAgY3JlYXRlTm9kZShzY2VuZSwgb3B0aW9uLm5vZGUpO1xyXG4gICAgY3JlYXRlQ29udGFpbmVyKHNjZW5lLCBvcHRpb24uY29udGFpbmVyKTtcclxuICAgIGNyZWF0ZUxpbmsoc2NlbmUsIG9wdGlvbi5saW5rKTtcclxuICAgIGNyZWF0ZUxpbmUoc2NlbmUsIG9wdGlvbi5saW5lKTtcclxuICAgIGRyYXdBbGFybShzY2VuZSwgb3B0aW9uLmFsYXJtKTtcclxuICAgIFFUb3BvLnV0aWwuaW5mbyhcInNldCB0b3BvIGNvbXBsZXRlOiBcIiwge1xyXG4gICAgICAgIG5vZGU6IHNjZW5lLmNoaWxkcmVuLm5vZGUubGVuZ3RoLFxyXG4gICAgICAgIGxpbms6IHNjZW5lLmNoaWxkcmVuLmxpbmsubGVuZ3RoLFxyXG4gICAgICAgIGNvbnRhaW5lcjogc2NlbmUuY2hpbGRyZW4uY29udGFpbmVyLmxlbmd0aCxcclxuICAgICAgICBsaW5lOiBzY2VuZS5jaGlsZHJlbi5saW5lLmxlbmd0aFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGhpcztcclxufVxyXG4vKipcclxuICog5a6e5L6L6Ieq6YCC5bqU5aSn5bCPXHJcbiAqICBAbWV0aG9kIHJlc2l6ZVxyXG4gKiAgQHJldHVybnMgaW5zdGFuY2UgUVRvcG/lrp7kvovoh6rouqss55So5Lul6ZO+5byP5pON5L2cXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24gKCkge1xyXG4gKiAgICAgICAgICBJUE9TUy5yZXNpemUoKTtcclxuICogICAgICB9KTtcclxuICovXHJcbmZ1bmN0aW9uIHJlc2l6ZShkb20sIGNhbnZhcykge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjYW52YXMuc2V0QXR0cmlidXRlKCd3aWR0aCcsICQoZG9tKS53aWR0aCgpKTtcclxuICAgICAgICBjYW52YXMuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAkKGRvbSkuaGVpZ2h0KCkpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiDlvZPliY3lm77lsYLmlbDmja7ovazljJbkuLpqc29u57uT5p6EXHJcbiAqICBAbWV0aG9kIHRvSnNvblxyXG4gKiAgQHJldHVybnMge29iamVjdH1cclxuICogIEBleGFtcGxlXHJcbiAgICAgICAgdmFyIElQT1NTPVFUb3BvLmluc3RhbmNlWzBdO1xyXG4gICAgICAgIHZhciBqc29uPUlQT1NTLnRvSnNvbigpOyAgICAvL2pzb249e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGluaXQ65Zu+5bGC5Y+C5pWwLHNjZW5l5a+56LGh55qE5Y+C5pWw6YWN572uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIG9wdGlvbjrlm77lsYLlhoXmiYDmnInlr7nosaHnmoTlsZ7mgKfmj5Dlj5bvvIzlj6/nm7TmjqXnlKjkuo5zZXRPcHRpb27ov5jljp8s5YW25LitanNvbklk55So5YGa5q+P5Liq5YWD57Sg55qE5ZSv5LiA5qCH6K+GXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgfVxyXG4gICAgICAgIElQT1NTLnNldE9wdGlvbihqc29uLm9wdGlvbix0cnVlKTtcclxuICovXHJcbmZ1bmN0aW9uIHRvSnNvbigpIHtcclxuICAgIHZhciBkYXRhID0gdGhpcy5zY2VuZS5jaGlsZHJlbjtcclxuICAgIHZhciBzZXJpYWxpemVkID0ge1xyXG4gICAgICAgIGluaXQ6IHRoaXMuc2NlbmUudG9Kc29uKCksXHJcbiAgICAgICAgb3B0aW9uOiB7XHJcbiAgICAgICAgICAgIG5vZGU6IHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IFtdXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxpbms6IHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IFtdXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNvbnRhaW5lcjoge1xyXG4gICAgICAgICAgICAgICAgZGF0YTogW11cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGluZToge1xyXG4gICAgICAgICAgICAgICAgZGF0YTogW11cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAkLmVhY2goZGF0YSwgZnVuY3Rpb24gKG5hbWUsIGVsZW1lbnRzKSB7XHJcbiAgICAgICAgaWYgKCQuaXNBcnJheShlbGVtZW50cykpIHtcclxuICAgICAgICAgICAgZWxlbWVudHMubWFwKGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VyaWFsaXplZC5vcHRpb25bbmFtZV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXJpYWxpemVkLm9wdGlvbltuYW1lXS5kYXRhLnB1c2goZWxlbWVudC50b0pzb24oKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHNlcmlhbGl6ZWQ7XHJcbn1cclxuZnVuY3Rpb24gaW5pdENhbnZhcyhkb20sIHdpZHRoLCBoZWlnaHQpIHtcclxuICAgIGlmICh3aWR0aCA8PSAwIHx8IGhlaWdodCA8PSAwKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIGRvbSBpcyBub3QgZXhpc3QgL25vdCBjb25maWcgd2lkdGggYW5kIGhlaWdodCFcIik7XHJcbiAgICB9XHJcbiAgICBkb20uc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xyXG4gICAgZG9tLnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XHJcbiAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICBkb20uYXBwZW5kQ2hpbGQoY2FudmFzKTtcclxuICAgIGNhbnZhcy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgd2lkdGgpO1xyXG4gICAgY2FudmFzLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgaGVpZ2h0KTtcclxuICAgIGNhbnZhcy5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcclxuICAgIGNhbnZhcy5zdHlsZS50b3AgPSAwO1xyXG4gICAgY2FudmFzLnN0eWxlLmxlZnQgPSAwO1xyXG4gICAgY2FudmFzLnN0eWxlWyd1c2VyLXNlbGVjdCddID0gJ25vbmUnO1xyXG4gICAgY2FudmFzLnN0eWxlWyctd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3InXSA9ICdyZ2JhKDAsIDAsIDAsIDApJztcclxuICAgIHJldHVybiBjYW52YXM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZU5vZGUoc2NlbmUsIGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHNldERlZmF1bHRzKHNjZW5lLCBRVG9wby5jb25zdGFudC5ub2RlLCBjb25maWcuc3R5bGUpO1xyXG4gICAgICAgIGlmICgkLmlzQXJyYXkoY29uZmlnLmRhdGEpKSB7XHJcbiAgICAgICAgICAgICQuZWFjaChjb25maWcuZGF0YSwgZnVuY3Rpb24gKGksIGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBub2RlID0gc2NlbmUuY3JlYXRlTm9kZShpdGVtKTtcclxuICAgICAgICAgICAgICAgIC8v6aKd5aSW5bGe5oCn5re75YqgXHJcbiAgICAgICAgICAgICAgICBzZXRFeHRyYShub2RlLCBpdGVtKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4vL+aOkumZpOS4tOaXtuWFg+e0oFxyXG5mdW5jdGlvbiBub3RDYXN1YWwoYXJyKSB7XHJcbiAgICBpZiAoYXJyLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgcmV0dXJuIGFyclswXTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGFycltpXS5nZXRVc2VUeXBlKCkgIT0gUVRvcG8uY29uc3RhbnQuQ0FTVUFMKSB7XHJcbiAgICAgICAgICAgICAgICBhcnIgPSBhcnJbaV07XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYXJyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDb250YWluZXIoc2NlbmUsIGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHNldERlZmF1bHRzKHNjZW5lLCBRVG9wby5jb25zdGFudC5jb250YWluZXIsIGNvbmZpZy5zdHlsZSk7XHJcbiAgICAgICAgbWFrZUNvbnRhaW5lcihzY2VuZSwgY29uZmlnKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBtYWtlQ29udGFpbmVyKHNjZW5lLCBjb25maWcpIHtcclxuICAgIC8v5pCc57Si5a2Q55qE5oC75qCH6K6wXHJcbiAgICB2YXIgZmluZENoaWxkO1xyXG4gICAgaWYgKGNvbmZpZy5maW5kQ2hpbGRyZW4pIHtcclxuICAgICAgICBmaW5kQ2hpbGQgPSBjb25maWcuZmluZENoaWxkcmVuO1xyXG4gICAgfVxyXG4gICAgaWYgKCQuaXNBcnJheShjb25maWcuZGF0YSkpIHtcclxuICAgICAgICAvL+W8gOWni+aehOmAoOWIhue7hFxyXG4gICAgICAgICQuZWFjaChjb25maWcuZGF0YSwgZnVuY3Rpb24gKGksIGl0ZW0pIHtcclxuICAgICAgICAgICAgLy/ml6DorrrmmK/lkKbmnInlrZDlhYPntKDvvIzliIbnu4TlhYjliJvpgKDlh7rmnaVcclxuICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IHNjZW5lLmNyZWF0ZUNvbnRhaW5lcihpdGVtKTtcclxuICAgICAgICAgICAgLy/pop3lpJblsZ7mgKfmt7vliqBcclxuICAgICAgICAgICAgc2V0RXh0cmEoY29udGFpbmVyLCBpdGVtKTtcclxuICAgICAgICAgICAgLy/noa7lrprmn6Xmib7lrZDlhYPntKDnmoTmoIforrBcclxuICAgICAgICAgICAgdmFyIGZpbmRDaGlsZF9leGFjdCA9IGZpbmRDaGlsZDtcclxuICAgICAgICAgICAgaWYgKGl0ZW0uZmluZENoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICBmaW5kQ2hpbGRfZXhhY3QgPSBpdGVtLmZpbmRDaGlsZHJlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBtYWtlQ2hpbGRyZW4oc2NlbmUsIGNvbnRhaW5lciwgaXRlbSwgZmluZENoaWxkX2V4YWN0KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBtYWtlQ2hpbGRyZW4oc2NlbmUsIGNvbnRhaW5lciwgY29uZmlnLCBmaW5kQ2hpbGQpIHtcclxuICAgIC8v6L+H5ruk5pCc57Si5a2Q57G755qE5qCH6K6wXHJcbiAgICBmaW5kQ2hpbGQgPSBmaWx0ZXJUYWcoZmluZENoaWxkKTtcclxuICAgIGlmICgkLmlzQXJyYXkoY29uZmlnLmNoaWxkcmVuKSkge1xyXG4gICAgICAgIHZhciBlcnJvckluZm8gPSBbXTtcclxuICAgICAgICAkLmVhY2goY29uZmlnLmNoaWxkcmVuLCBmdW5jdGlvbiAoaiwgY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgdmFyIGNoaWxkID0gc2NlbmUuZmluZChmaW5kQ2hpbGQgKyBcIj1cIiArIGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgaWYgKGNoaWxkICYmIGNoaWxkLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICQuZWFjaChjaGlsZCwgZnVuY3Rpb24gKG0sIG9uZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvbmUuZ2V0VXNlVHlwZSgpICE9IFFUb3BvLmNvbnN0YW50LkNBU1VBTCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuYWRkKG9uZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBlcnJvckluZm8ucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGosXHJcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoOiBmaW5kQ2hpbGQgKyBcIj1cIiArIGNoaWxkcmVuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChlcnJvckluZm8ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBRVG9wby51dGlsLmVycm9yKFwic29tZSBjaGlsZCBub3QgZm91bmQgOiBcIiwgZXJyb3JJbmZvKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZmlsdGVyVGFnKHRhZykge1xyXG4gICAgaWYgKCF0YWcpIHtcclxuICAgICAgICB0YWcgPSAnanNvbklkJ1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRhZztcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlTGluayhzY2VuZSwgY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHBhdGggPSBjb25maWcucGF0aDtcclxuICAgICAgICB2YXIgZmluZFN0YXJ0O1xyXG4gICAgICAgIHZhciBmaW5kRW5kO1xyXG4gICAgICAgIGlmICgkLmlzQXJyYXkocGF0aCkgJiYgcGF0aC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIC8vcGF0aOS4uuaVsOe7hO+8jDDkuLrotbfngrnmnaHku7Yx5Li657uI54K55p2h5Lu2LOehruWumuaQnOe0ouadoeS7tizotbflp4vngrnmnaHku7blj6/kuI3lkIxcclxuICAgICAgICAgICAgaWYgKHBhdGgubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAgICAgICAgIGZpbmRFbmQgPSBwYXRoWzBdO1xyXG4gICAgICAgICAgICAgICAgZmluZFN0YXJ0ID0gZmluZEVuZDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGZpbmRTdGFydCA9IHBhdGhbMF07XHJcbiAgICAgICAgICAgICAgICBmaW5kRW5kID0gcGF0aFsxXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGZpbmRTdGFydCA9IGZpbHRlclRhZyhmaW5kU3RhcnQpO1xyXG4gICAgICAgICAgICBmaW5kRW5kID0gZmlsdGVyVGFnKGZpbmRFbmQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL+iuvue9rum7mOiupOWxnuaAp1xyXG4gICAgICAgIHNldERlZmF1bHRzKHNjZW5lLCBRVG9wby5jb25zdGFudC5saW5rLCBjb25maWcuc3R5bGUpO1xyXG4gICAgICAgIC8v5byA5aeL5Yib5bu6XHJcbiAgICAgICAgbWFrZUxpbmsoc2NlbmUsIGNvbmZpZywgZmluZFN0YXJ0LCBmaW5kRW5kKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBtYWtlTGluayhzY2VuZSwgY29uZmlnLCBmaW5kU3RhcnQsIGZpbmRFbmQpIHtcclxuICAgIGlmICgkLmlzQXJyYXkoY29uZmlnLmRhdGEpKSB7XHJcbiAgICAgICAgdmFyIGVycm9ySW5mbyA9IFtdO1xyXG4gICAgICAgICQuZWFjaChjb25maWcuZGF0YSwgZnVuY3Rpb24gKGksIGl0ZW0pIHtcclxuICAgICAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaW5rO1xyXG4gICAgICAgICAgICAgICAgLy/moLnmja7noa7lrprnmoTmnaHku7bov5vooYzmkJzntKJcclxuICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IG5vdENhc3VhbChzY2VuZS5maW5kKGZpbmRTdGFydCArIFwiPVwiICsgaXRlbS5zdGFydCkpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGVuZCA9IG5vdENhc3VhbChzY2VuZS5maW5kKGZpbmRFbmQgKyBcIj1cIiArIGl0ZW0uZW5kKSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3RhcnQgJiYgZW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zdGFydCA9IHN0YXJ0O1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uZW5kID0gZW5kO1xyXG4gICAgICAgICAgICAgICAgICAgIGxpbmsgPSBzY2VuZS5hZGRMaW5rKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIC8v6aKd5aSW5bGe5oCn5re75YqgXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0RXh0cmEobGluaywgaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlcnJvckRhdGUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4OiBpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBpdGVtXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yRGF0ZS5taXNzU3RhcnQgPSBpdGVtLnN0YXJ0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvckRhdGUubWlzc0VuZCA9IGl0ZW0uZW5kO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlcnJvckluZm8ucHVzaChlcnJvckRhdGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZXJyb3JJbmZvLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4OiBpLFxyXG4gICAgICAgICAgICAgICAgICAgIGluZm86IFwidW5kZWZpbmVkIGRhdGFcIlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoZXJyb3JJbmZvLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcInNvbWUgbGluayBpbnZhbGlkIDogXCIsIGVycm9ySW5mbyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8v5qC55o2u6YWN572u5Yib5bu657q/5q61XHJcbmZ1bmN0aW9uIGNyZWF0ZUxpbmUoc2NlbmUsIGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIC8v6K6+572u6buY6K6k5bGe5oCnXHJcbiAgICAgICAgLy/orr7nva7pu5jorqTlsZ7mgKdcclxuICAgICAgICBzZXREZWZhdWx0cyhzY2VuZSwgUVRvcG8uY29uc3RhbnQubGluZSwgY29uZmlnLnN0eWxlKTtcclxuICAgICAgICAvL+W8gOWni+WIm+W7ulxyXG4gICAgICAgIGlmICgkLmlzQXJyYXkoY29uZmlnLmRhdGEpKSB7XHJcbiAgICAgICAgICAgICQuZWFjaChjb25maWcuZGF0YSwgZnVuY3Rpb24gKGksIHYpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaW5lID0gc2NlbmUuY3JlYXRlTGluZSh2KTtcclxuICAgICAgICAgICAgICAgIC8v6aKd5aSW5bGe5oCn5re75YqgXHJcbiAgICAgICAgICAgICAgICBzZXRFeHRyYShsaW5lLCB2KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcImNhbiBub3QgZHJhdyBsaW5lLG5lZWQgY29uZmlnICdwYXRoJyBhbmQgJ3BhdGgnIGlzIEFycmF5IGFuZCBub3QgZW1wdHkscGF0aCdzIGVsZW1lbnQgbmVlZCBjb25maWcgeCB5LCBwYXRoIHVzZWQgdG8gZmluZCBzdGFydCBhbmQgZW5kXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZHJhd0FsYXJtKHNjZW5lLCBjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICBpZiAoJC5pc0FycmF5KGNvbmZpZy5kYXRhKSAmJiBjb25maWcubm9kZSkge1xyXG4gICAgICAgICAgICB2YXIgYWxhcm1EYXRhID0gY29uZmlnLmRhdGE7XHJcbiAgICAgICAgICAgIHZhciBhbGFybU5vZGVzID0gbWFrZUFsYXJtRGF0YShzY2VuZSwgYWxhcm1EYXRhLCBjb25maWcpO1xyXG4gICAgICAgICAgICBRVG9wby51dGlsLmluZm8oXCLlkYrorabnu5jliLYgOlwiLCB7XHJcbiAgICAgICAgICAgICAgICBjb25maWc6IGFsYXJtRGF0YS5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBhbGFybU5vZGVzLmxlbmd0aFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKGNvbmZpZy5hbmltYXRlKSB7XHJcbiAgICAgICAgICAgICAgICBhbGFybUFuaW1hdGUoY29uZmlnLmFuaW1hdGUsIGFsYXJtTm9kZXMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJC5lYWNoKGFsYXJtTm9kZXMsIGZ1bmN0aW9uIChpLCB2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdi5ub2RlLnNldCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsYXJtOiB2LmFsYXJtXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBtYWtlQWxhcm1EYXRhKHNjZW5lLCBhbGFybURhdGEsIGNvbmZpZykge1xyXG4gICAgdmFyIGFsYXJtcyA9IFtdO1xyXG4gICAgJC5lYWNoKGFsYXJtRGF0YSwgZnVuY3Rpb24gKGssIHYpIHtcclxuICAgICAgICB2YXIgbm9kZSA9IG5vdENhc3VhbChzY2VuZS5maW5kKGNvbmZpZy5ub2RlICsgXCI9XCIgKyB2W1wibm9kZVwiXSwgXCJub2RlXCIpKTtcclxuICAgICAgICBpZiAobm9kZSkge1xyXG4gICAgICAgICAgICBhbGFybXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBub2RlOiBub2RlLFxyXG4gICAgICAgICAgICAgICAgYWxhcm06IHtcclxuICAgICAgICAgICAgICAgICAgICBzaG93OiB0eXBlb2Ygdi5zaG93ID09IFwiYm9vbGVhblwiID8gdi5zaG93IDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB2LnRleHQsXHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHYuY29sb3IsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9udDogdi5mb250XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGFsYXJtcztcclxufVxyXG52YXIgYW5pbWF0ZVJ1bmluZztcclxuZnVuY3Rpb24gYWxhcm1BbmltYXRlKGFuaW1hdGUsIGFsYXJtTm9kZXMpIHtcclxuICAgIGlmIChhbmltYXRlKSB7XHJcbiAgICAgICAgaWYgKCQuaXNOdW1lcmljKGFuaW1hdGUudGltZSkpIHtcclxuICAgICAgICAgICAgY2xlYXJBbmltYXQoKTtcclxuICAgICAgICAgICAgUVRvcG8udXRpbC5pbmZvKFwi5ZCv55So5ZGK6K2m5Yqo55S7XCIpO1xyXG4gICAgICAgICAgICBhbmltYXRlUnVuaW5nID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFsYXJtTm9kZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gYWxhcm1Ob2Rlcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLm5vZGUuc2V0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxhcm06IGRhdGEuYWxhcm1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJC5pc0Z1bmN0aW9uKGFuaW1hdGUuY2FsbEJhY2spKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGUuY2FsbEJhY2soZGF0YS5ub2RlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIFFUb3BvLnV0aWwuaW5mbyhcIuWRiuitpuWKqOeUu+e7k+adn1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBjbGVhckFuaW1hdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBwYXJzZUludChhbmltYXRlLnRpbWUpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gY2xlYXJBbmltYXQoKSB7XHJcbiAgICBpZiAoYW5pbWF0ZVJ1bmluZykge1xyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwoYW5pbWF0ZVJ1bmluZyk7XHJcbiAgICAgICAgYW5pbWF0ZVJ1bmluZyA9IFwiXCI7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gc2V0RXh0cmEoZWxlbWVudCwgZGF0YSkge1xyXG4gICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAkLmVhY2goZGF0YSwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKGZpbHRlckNvbmZpZyhlbGVtZW50LCBrZXkpICYmIFtcInN0YXJ0XCIsIFwiZW5kXCIsIFwiY2hpbGRyZW5cIiwgXCJ0b2dnbGVcIiwgXCJ0eXBlXCIsIFwiZXh0cmFcIl0uaW5kZXhPZihrZXkpIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5leHRyYVtrZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoZGF0YS5leHRyYSkge1xyXG4gICAgICAgICAgICAkLmVhY2goZGF0YS5leHRyYSwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZXh0cmFba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZmlsdGVyQ29uZmlnKGVsZW1lbnQsIGtleSkge1xyXG4gICAgcmV0dXJuIGVsZW1lbnQgJiYgdHlwZW9mIGVsZW1lbnQuYXR0cltrZXldID09ICd1bmRlZmluZWQnO1xyXG59XHJcbmZ1bmN0aW9uIHNldERlZmF1bHRzKHNjZW5lLCB0eXBlQXJyLCBzdHlsZSkge1xyXG4gICAgaWYgKHN0eWxlKSB7XHJcbiAgICAgICAgJC5lYWNoKHR5cGVBcnIsIGZ1bmN0aW9uIChpLCB0eXBlcykge1xyXG4gICAgICAgICAgICBzY2VuZS5zZXREZWZhdWx0KHR5cGVzLCBzdHlsZSk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL21haW4uanNcbi8vIG1vZHVsZSBpZCA9IDEwM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9');
}]);